<!DOCTYPE html>
<html lang = "en">
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <title>NodeJS Graph Visualization</title>
    </head>
    <body>
        <form>
            <button id = "get-graph-data-mesh">Click here to get graph from mesh terms</button>
            <button id = "get-graph-data-ner">Click here to get graph from NER entities</button>
            <button id = "get-graph-test">test 20k</button>
        </form>
        <h3 id = "nodes-count" style = "display: none;">Nodes count: </h3>
        <h3 id = "edges-count" style = "display: none;">Edges count: </h3>
        <div id="graph"></div>


        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
        <script src="https://gw.alipayobjects.com/os/lib/antv/g6/4.3.11/dist/g6.min.js"></script>
        <script>
            $(document).ready(function(){
                let button1 = document.getElementById("get-graph-data-mesh");
                let button2 = document.getElementById("get-graph-data-ner");
                let button3 = document.getElementById("get-graph-test");
                let base_url = "http://127.0.0.1:5000/";

                button1.addEventListener("click", getGraphData);
                button2.addEventListener("click", getGraphDataNer);
                button3.addEventListener("click", testFunct);

                async function getGraphData(event){
                    event.preventDefault();
                    let response = await fetch(base_url + "meshterms_graph", {
                        method: "GET"
                    });
                    let data = await response.json();

                    $("#nodes-count").css({"display": "block"});
                    $("#edges-count").css({"display": "block"});

                    const gdata = {
                        nodes: data.graph_nodes,
                        edges: data.graph_edges,
                    };
                      
                      
                    const graph = new G6.Graph({container: 'graph', width: 1500, height: 750});
                    console.log(gdata);
                    graph.data(gdata);
                    graph.render();
                }

                async function getGraphDataNer(event){
                    event.preventDefault();
                    let response = await fetch(base_url + "network", {
                        method: "GET"
                    });
                    let data = await response.json();

                    $("#nodes-count").css({"display": "block"});
                    $("#edges-count").css({"display": "block"});

                    const gdata = {
                        nodes: data.graph_nodes,
                        edges: data.graph_edges,
                    };
                      
                      
                    const graph = new G6.Graph({container: 'graph', width: 1500, height: 750});
                    console.log(gdata);
                    graph.data(gdata);
                    graph.render();
                }

                async function testFunct(event){
                    event.preventDefault();
                    let response = await fetch('https://assets.antv.antgroup.com/g6/5000.json');
                    let data = await response.json();

                    const gdata = {
                        nodes: data.nodes,
                        edges: data.edges,
                    };

                    const graph = new G6.Graph({
                        container: 'graph',
                        animation: true,
                        autoFit: 'view',
                        node: {
                            style: {
                            size: 8,
                            },
                            palette: {
                            type: 'group',
                            field: 'cluster',
                            },
                        },
                        behaviors: ['zoom-canvas', 'drag-canvas'],
                    });

                    console.log(gdata);
                    graph.data(gdata);
                    graph.render();
                }
            });
        </script>
    </body>
</html>