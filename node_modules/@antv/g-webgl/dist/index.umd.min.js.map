{"version":3,"file":"index.umd.min.js","sources":["../../../node_modules/.pnpm/node_modules/tslib/tslib.es6.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-nil.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-type.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-string.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/clamp.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/lodash/is-number.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/common.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/mat4.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/vec3.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/path/util/rotate-vector.js","../../../node_modules/.pnpm/@antv+util@3.3.5/node_modules/@antv/util/esm/path/process/arc-2-cubic.js","../../../node_modules/.pnpm/eventemitter3@5.0.1/node_modules/eventemitter3/index.js","../../../node_modules/.pnpm/@antv+g-device-api@1.6.10/node_modules/@antv/g-device-api/es/index.js","../../../node_modules/.pnpm/earcut@2.2.3/node_modules/earcut/src/earcut.js","../../g-math/dist/index.esm.js","../../g-plugin-device-renderer/dist/index.esm.js","../../g-plugin-dom-interaction/dist/index.esm.js","../../g-plugin-html-renderer/dist/index.esm.js","../../g-plugin-image-loader/dist/index.esm.js","../src/packages/g-webgl/src/WebGLContextService.ts","../src/packages/g-webgl/src/ContextRegisterPlugin.ts","../src/packages/g-webgl/src/WebXRController.ts","../src/packages/g-webgl/src/WebXRManager.ts","../src/packages/g-webgl/src/ARButton.ts","../src/packages/g-webgl/src/index.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport default {\r\n    __extends,\r\n    __assign,\r\n    __rest,\r\n    __decorate,\r\n    __param,\r\n    __metadata,\r\n    __awaiter,\r\n    __generator,\r\n    __createBinding,\r\n    __exportStar,\r\n    __values,\r\n    __read,\r\n    __spread,\r\n    __spreadArrays,\r\n    __spreadArray,\r\n    __await,\r\n    __asyncGenerator,\r\n    __asyncDelegator,\r\n    __asyncValues,\r\n    __makeTemplateObject,\r\n    __importStar,\r\n    __importDefault,\r\n    __classPrivateFieldGet,\r\n    __classPrivateFieldSet,\r\n    __classPrivateFieldIn,\r\n};\r\n","// isFinite,\nvar isNil = function (value) {\n    /**\n     * isNil(null) => true\n     * isNil() => true\n     */\n    return value === null || value === undefined;\n};\nexport default isNil;\n//# sourceMappingURL=is-nil.js.map","var toString = {}.toString;\nvar isType = function (value, type) { return toString.call(value) === '[object ' + type + ']'; };\nexport default isType;\n//# sourceMappingURL=is-type.js.map","import isType from './is-type';\nexport default (function (str) {\n    return isType(str, 'String');\n});\n//# sourceMappingURL=is-string.js.map","var clamp = function (a, min, max) {\n    if (a < min) {\n        return min;\n    }\n    else if (a > max) {\n        return max;\n    }\n    return a;\n};\nexport default clamp;\n//# sourceMappingURL=clamp.js.map","/**\n * 判断是否数字\n * @return {Boolean} 是否数字\n */\nimport isType from './is-type';\nvar isNumber = function (value) {\n    return isType(value, 'Number');\n};\nexport default isNumber;\n//# sourceMappingURL=is-number.js.map","/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","export function rotateVector(x, y, rad) {\n    var X = x * Math.cos(rad) - y * Math.sin(rad);\n    var Y = x * Math.sin(rad) + y * Math.cos(rad);\n    return { x: X, y: Y };\n}\n//# sourceMappingURL=rotate-vector.js.map","import { rotateVector } from '../util/rotate-vector';\n/**\n * Converts A (arc-to) segments to C (cubic-bezier-to).\n *\n * For more information of where this math came from visit:\n * http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n */\nexport function arcToCubic(X1, Y1, RX, RY, angle, LAF, SF, X2, Y2, recursive) {\n    var x1 = X1;\n    var y1 = Y1;\n    var rx = RX;\n    var ry = RY;\n    var x2 = X2;\n    var y2 = Y2;\n    // for more information of where this Math came from visit:\n    // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n    var d120 = (Math.PI * 120) / 180;\n    var rad = (Math.PI / 180) * (+angle || 0);\n    /** @type {number[]} */\n    var res = [];\n    var xy;\n    var f1;\n    var f2;\n    var cx;\n    var cy;\n    if (!recursive) {\n        xy = rotateVector(x1, y1, -rad);\n        x1 = xy.x;\n        y1 = xy.y;\n        xy = rotateVector(x2, y2, -rad);\n        x2 = xy.x;\n        y2 = xy.y;\n        var x = (x1 - x2) / 2;\n        var y = (y1 - y2) / 2;\n        var h = (x * x) / (rx * rx) + (y * y) / (ry * ry);\n        if (h > 1) {\n            h = Math.sqrt(h);\n            rx *= h;\n            ry *= h;\n        }\n        var rx2 = rx * rx;\n        var ry2 = ry * ry;\n        var k = (LAF === SF ? -1 : 1) *\n            Math.sqrt(Math.abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x)));\n        cx = (k * rx * y) / ry + (x1 + x2) / 2;\n        cy = (k * -ry * x) / rx + (y1 + y2) / 2;\n        // eslint-disable-next-line no-bitwise -- Impossible to satisfy no-bitwise\n        f1 = Math.asin(((((y1 - cy) / ry) * Math.pow(10, 9)) >> 0) / Math.pow(10, 9));\n        // eslint-disable-next-line no-bitwise -- Impossible to satisfy no-bitwise\n        f2 = Math.asin(((((y2 - cy) / ry) * Math.pow(10, 9)) >> 0) / Math.pow(10, 9));\n        f1 = x1 < cx ? Math.PI - f1 : f1;\n        f2 = x2 < cx ? Math.PI - f2 : f2;\n        if (f1 < 0)\n            f1 = Math.PI * 2 + f1;\n        if (f2 < 0)\n            f2 = Math.PI * 2 + f2;\n        if (SF && f1 > f2) {\n            f1 -= Math.PI * 2;\n        }\n        if (!SF && f2 > f1) {\n            f2 -= Math.PI * 2;\n        }\n    }\n    else {\n        f1 = recursive[0], f2 = recursive[1], cx = recursive[2], cy = recursive[3];\n    }\n    var df = f2 - f1;\n    if (Math.abs(df) > d120) {\n        var f2old = f2;\n        var x2old = x2;\n        var y2old = y2;\n        f2 = f1 + d120 * (SF && f2 > f1 ? 1 : -1);\n        x2 = cx + rx * Math.cos(f2);\n        y2 = cy + ry * Math.sin(f2);\n        res = arcToCubic(x2, y2, rx, ry, angle, 0, SF, x2old, y2old, [f2, f2old, cx, cy]);\n    }\n    df = f2 - f1;\n    var c1 = Math.cos(f1);\n    var s1 = Math.sin(f1);\n    var c2 = Math.cos(f2);\n    var s2 = Math.sin(f2);\n    var t = Math.tan(df / 4);\n    var hx = (4 / 3) * rx * t;\n    var hy = (4 / 3) * ry * t;\n    var m1 = [x1, y1];\n    var m2 = [x1 + hx * s1, y1 - hy * c1];\n    var m3 = [x2 + hx * s2, y2 - hy * c2];\n    var m4 = [x2, y2];\n    m2[0] = 2 * m1[0] - m2[0];\n    m2[1] = 2 * m1[1] - m2[1];\n    if (recursive) {\n        return m2.concat(m3, m4, res);\n        // return [...m2, ...m3, ...m4, ...res];\n    }\n    res = m2.concat(m3, m4, res);\n    // res = [...m2, ...m3, ...m4, ...res];\n    var newres = [];\n    for (var i = 0, ii = res.length; i < ii; i += 1) {\n        newres[i] = i % 2 ? rotateVector(res[i - 1], res[i], rad).y : rotateVector(res[i], res[i + 1], rad).x;\n    }\n    return newres;\n}\n// const TAU = Math.PI * 2;\n// const mapToEllipse = (\n//   { x, y }: { x: number; y: number },\n//   rx: number,\n//   ry: number,\n//   cosphi: number,\n//   sinphi: number,\n//   centerx: number,\n//   centery: number,\n// ) => {\n//   x *= rx;\n//   y *= ry;\n//   const xp = cosphi * x - sinphi * y;\n//   const yp = sinphi * x + cosphi * y;\n//   return {\n//     x: xp + centerx,\n//     y: yp + centery,\n//   };\n// };\n// const approxUnitArc = (ang1: number, ang2: number) => {\n//   // If 90 degree circular arc, use a constant\n//   // as derived from http://spencermortensen.com/articles/bezier-circle\n//   const a =\n//     ang2 === 1.5707963267948966\n//       ? 0.551915024494\n//       : ang2 === -1.5707963267948966\n//       ? -0.551915024494\n//       : (4 / 3) * Math.tan(ang2 / 4);\n//   const x1 = Math.cos(ang1);\n//   const y1 = Math.sin(ang1);\n//   const x2 = Math.cos(ang1 + ang2);\n//   const y2 = Math.sin(ang1 + ang2);\n//   return [\n//     {\n//       x: x1 - y1 * a,\n//       y: y1 + x1 * a,\n//     },\n//     {\n//       x: x2 + y2 * a,\n//       y: y2 - x2 * a,\n//     },\n//     {\n//       x: x2,\n//       y: y2,\n//     },\n//   ];\n// };\n// const vectorAngle = (ux: number, uy: number, vx: number, vy: number) => {\n//   const sign = ux * vy - uy * vx < 0 ? -1 : 1;\n//   let dot = ux * vx + uy * vy;\n//   if (dot > 1) {\n//     dot = 1;\n//   }\n//   if (dot < -1) {\n//     dot = -1;\n//   }\n//   return sign * Math.acos(dot);\n// };\n// const getArcCenter = (\n//   px: any,\n//   py: any,\n//   cx: any,\n//   cy: any,\n//   rx: number,\n//   ry: number,\n//   largeArcFlag: number,\n//   sweepFlag: number,\n//   sinphi: number,\n//   cosphi: number,\n//   pxp: number,\n//   pyp: number,\n// ) => {\n//   const rxsq = Math.pow(rx, 2);\n//   const rysq = Math.pow(ry, 2);\n//   const pxpsq = Math.pow(pxp, 2);\n//   const pypsq = Math.pow(pyp, 2);\n//   let radicant = rxsq * rysq - rxsq * pypsq - rysq * pxpsq;\n//   if (radicant < 0) {\n//     radicant = 0;\n//   }\n//   radicant /= rxsq * pypsq + rysq * pxpsq;\n//   radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n//   const centerxp = ((radicant * rx) / ry) * pyp;\n//   const centeryp = ((radicant * -ry) / rx) * pxp;\n//   const centerx = cosphi * centerxp - sinphi * centeryp + (px + cx) / 2;\n//   const centery = sinphi * centerxp + cosphi * centeryp + (py + cy) / 2;\n//   const vx1 = (pxp - centerxp) / rx;\n//   const vy1 = (pyp - centeryp) / ry;\n//   const vx2 = (-pxp - centerxp) / rx;\n//   const vy2 = (-pyp - centeryp) / ry;\n//   const ang1 = vectorAngle(1, 0, vx1, vy1);\n//   let ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n//   if (sweepFlag === 0 && ang2 > 0) {\n//     ang2 -= TAU;\n//   }\n//   if (sweepFlag === 1 && ang2 < 0) {\n//     ang2 += TAU;\n//   }\n//   return [centerx, centery, ang1, ang2];\n// };\n// const arcToBezier = ({ px, py, cx, cy, rx, ry, xAxisRotation = 0, largeArcFlag = 0, sweepFlag = 0 }) => {\n//   const curves = [];\n//   if (rx === 0 || ry === 0) {\n//     return [{ x1: 0, y1: 0, x2: 0, y2: 0, x: cx, y: cy }];\n//   }\n//   const sinphi = Math.sin((xAxisRotation * TAU) / 360);\n//   const cosphi = Math.cos((xAxisRotation * TAU) / 360);\n//   const pxp = (cosphi * (px - cx)) / 2 + (sinphi * (py - cy)) / 2;\n//   const pyp = (-sinphi * (px - cx)) / 2 + (cosphi * (py - cy)) / 2;\n//   if (pxp === 0 && pyp === 0) {\n//     return [{ x1: 0, y1: 0, x2: 0, y2: 0, x: cx, y: cy }];\n//   }\n//   rx = Math.abs(rx);\n//   ry = Math.abs(ry);\n//   const lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n//   if (lambda > 1) {\n//     rx *= Math.sqrt(lambda);\n//     ry *= Math.sqrt(lambda);\n//   }\n//   let [centerx, centery, ang1, ang2] = getArcCenter(\n//     px,\n//     py,\n//     cx,\n//     cy,\n//     rx,\n//     ry,\n//     largeArcFlag,\n//     sweepFlag,\n//     sinphi,\n//     cosphi,\n//     pxp,\n//     pyp,\n//   );\n//   // If 'ang2' == 90.0000000001, then `ratio` will evaluate to\n//   // 1.0000000001. This causes `segments` to be greater than one, which is an\n//   // unecessary split, and adds extra points to the bezier curve. To alleviate\n//   // this issue, we round to 1.0 when the ratio is close to 1.0.\n//   let ratio = Math.abs(ang2) / (TAU / 4);\n//   if (Math.abs(1.0 - ratio) < 0.0000001) {\n//     ratio = 1.0;\n//   }\n//   const segments = Math.max(Math.ceil(ratio), 1);\n//   ang2 /= segments;\n//   for (let i = 0; i < segments; i++) {\n//     curves.push(approxUnitArc(ang1, ang2));\n//     ang1 += ang2;\n//   }\n//   return curves.map((curve) => {\n//     const { x: x1, y: y1 } = mapToEllipse(curve[0], rx, ry, cosphi, sinphi, centerx, centery);\n//     const { x: x2, y: y2 } = mapToEllipse(curve[1], rx, ry, cosphi, sinphi, centerx, centery);\n//     const { x, y } = mapToEllipse(curve[2], rx, ry, cosphi, sinphi, centerx, centery);\n//     return { x1, y1, x2, y2, x, y };\n//   });\n// };\n// export function arcToCubic(\n//   x1: number,\n//   y1: number,\n//   rx: number,\n//   ry: number,\n//   angle: number,\n//   LAF: number,\n//   SF: number,\n//   x2: number,\n//   y2: number,\n// ) {\n//   const curves = arcToBezier({\n//     px: x1,\n//     py: y1,\n//     cx: x2,\n//     cy: y2,\n//     rx,\n//     ry,\n//     xAxisRotation: angle,\n//     largeArcFlag: LAF,\n//     sweepFlag: SF,\n//   });\n//   return curves.reduce((prev, cur) => {\n//     const { x1, y1, x2, y2, x, y } = cur;\n//     prev.push(x1, y1, x2, y2, x, y);\n//     return prev;\n//   }, [] as number[]);\n// }\n//# sourceMappingURL=arc-2-cubic.js.map","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import { isNil, isNumber, clamp } from '@antv/util';\nimport { __read, __extends, __values, __assign, __awaiter, __generator, __spreadArray, __rest } from 'tslib';\nimport EventEmitter from 'eventemitter3';\n\n/**\n * ported from @luma.gl/constants\n *\n * Standard WebGL and WebGL2 constants\n * These constants are also defined on the WebGLRenderingContext interface.\n */\nvar GL;\n(function (GL) {\n    // Clearing buffers\n    // Constants passed to clear() to clear buffer masks.\n    GL[GL[\"DEPTH_BUFFER_BIT\"] = 256] = \"DEPTH_BUFFER_BIT\";\n    GL[GL[\"STENCIL_BUFFER_BIT\"] = 1024] = \"STENCIL_BUFFER_BIT\";\n    GL[GL[\"COLOR_BUFFER_BIT\"] = 16384] = \"COLOR_BUFFER_BIT\";\n    // Rendering primitives\n    // Constants passed to drawElements() or drawArrays() to specify what kind of primitive to render.\n    GL[GL[\"POINTS\"] = 0] = \"POINTS\";\n    GL[GL[\"LINES\"] = 1] = \"LINES\";\n    GL[GL[\"LINE_LOOP\"] = 2] = \"LINE_LOOP\";\n    GL[GL[\"LINE_STRIP\"] = 3] = \"LINE_STRIP\";\n    GL[GL[\"TRIANGLES\"] = 4] = \"TRIANGLES\";\n    GL[GL[\"TRIANGLE_STRIP\"] = 5] = \"TRIANGLE_STRIP\";\n    GL[GL[\"TRIANGLE_FAN\"] = 6] = \"TRIANGLE_FAN\";\n    // Blending modes\n    // Constants passed to blendFunc() or blendFuncSeparate() to specify the blending mode (for both, RBG and alpha, or separately).\n    GL[GL[\"ZERO\"] = 0] = \"ZERO\";\n    GL[GL[\"ONE\"] = 1] = \"ONE\";\n    GL[GL[\"SRC_COLOR\"] = 768] = \"SRC_COLOR\";\n    GL[GL[\"ONE_MINUS_SRC_COLOR\"] = 769] = \"ONE_MINUS_SRC_COLOR\";\n    GL[GL[\"SRC_ALPHA\"] = 770] = \"SRC_ALPHA\";\n    GL[GL[\"ONE_MINUS_SRC_ALPHA\"] = 771] = \"ONE_MINUS_SRC_ALPHA\";\n    GL[GL[\"DST_ALPHA\"] = 772] = \"DST_ALPHA\";\n    GL[GL[\"ONE_MINUS_DST_ALPHA\"] = 773] = \"ONE_MINUS_DST_ALPHA\";\n    GL[GL[\"DST_COLOR\"] = 774] = \"DST_COLOR\";\n    GL[GL[\"ONE_MINUS_DST_COLOR\"] = 775] = \"ONE_MINUS_DST_COLOR\";\n    GL[GL[\"SRC_ALPHA_SATURATE\"] = 776] = \"SRC_ALPHA_SATURATE\";\n    GL[GL[\"CONSTANT_COLOR\"] = 32769] = \"CONSTANT_COLOR\";\n    GL[GL[\"ONE_MINUS_CONSTANT_COLOR\"] = 32770] = \"ONE_MINUS_CONSTANT_COLOR\";\n    GL[GL[\"CONSTANT_ALPHA\"] = 32771] = \"CONSTANT_ALPHA\";\n    GL[GL[\"ONE_MINUS_CONSTANT_ALPHA\"] = 32772] = \"ONE_MINUS_CONSTANT_ALPHA\";\n    // Blending equations\n    // Constants passed to blendEquation() or blendEquationSeparate() to control\n    // how the blending is calculated (for both, RBG and alpha, or separately).\n    GL[GL[\"FUNC_ADD\"] = 32774] = \"FUNC_ADD\";\n    GL[GL[\"FUNC_SUBTRACT\"] = 32778] = \"FUNC_SUBTRACT\";\n    GL[GL[\"FUNC_REVERSE_SUBTRACT\"] = 32779] = \"FUNC_REVERSE_SUBTRACT\";\n    // Getting GL parameter information\n    // Constants passed to getParameter() to specify what information to return.\n    GL[GL[\"BLEND_EQUATION\"] = 32777] = \"BLEND_EQUATION\";\n    GL[GL[\"BLEND_EQUATION_RGB\"] = 32777] = \"BLEND_EQUATION_RGB\";\n    GL[GL[\"BLEND_EQUATION_ALPHA\"] = 34877] = \"BLEND_EQUATION_ALPHA\";\n    GL[GL[\"BLEND_DST_RGB\"] = 32968] = \"BLEND_DST_RGB\";\n    GL[GL[\"BLEND_SRC_RGB\"] = 32969] = \"BLEND_SRC_RGB\";\n    GL[GL[\"BLEND_DST_ALPHA\"] = 32970] = \"BLEND_DST_ALPHA\";\n    GL[GL[\"BLEND_SRC_ALPHA\"] = 32971] = \"BLEND_SRC_ALPHA\";\n    GL[GL[\"BLEND_COLOR\"] = 32773] = \"BLEND_COLOR\";\n    GL[GL[\"ARRAY_BUFFER_BINDING\"] = 34964] = \"ARRAY_BUFFER_BINDING\";\n    GL[GL[\"ELEMENT_ARRAY_BUFFER_BINDING\"] = 34965] = \"ELEMENT_ARRAY_BUFFER_BINDING\";\n    GL[GL[\"LINE_WIDTH\"] = 2849] = \"LINE_WIDTH\";\n    GL[GL[\"ALIASED_POINT_SIZE_RANGE\"] = 33901] = \"ALIASED_POINT_SIZE_RANGE\";\n    GL[GL[\"ALIASED_LINE_WIDTH_RANGE\"] = 33902] = \"ALIASED_LINE_WIDTH_RANGE\";\n    GL[GL[\"CULL_FACE_MODE\"] = 2885] = \"CULL_FACE_MODE\";\n    GL[GL[\"FRONT_FACE\"] = 2886] = \"FRONT_FACE\";\n    GL[GL[\"DEPTH_RANGE\"] = 2928] = \"DEPTH_RANGE\";\n    GL[GL[\"DEPTH_WRITEMASK\"] = 2930] = \"DEPTH_WRITEMASK\";\n    GL[GL[\"DEPTH_CLEAR_VALUE\"] = 2931] = \"DEPTH_CLEAR_VALUE\";\n    GL[GL[\"DEPTH_FUNC\"] = 2932] = \"DEPTH_FUNC\";\n    GL[GL[\"STENCIL_CLEAR_VALUE\"] = 2961] = \"STENCIL_CLEAR_VALUE\";\n    GL[GL[\"STENCIL_FUNC\"] = 2962] = \"STENCIL_FUNC\";\n    GL[GL[\"STENCIL_FAIL\"] = 2964] = \"STENCIL_FAIL\";\n    GL[GL[\"STENCIL_PASS_DEPTH_FAIL\"] = 2965] = \"STENCIL_PASS_DEPTH_FAIL\";\n    GL[GL[\"STENCIL_PASS_DEPTH_PASS\"] = 2966] = \"STENCIL_PASS_DEPTH_PASS\";\n    GL[GL[\"STENCIL_REF\"] = 2967] = \"STENCIL_REF\";\n    GL[GL[\"STENCIL_VALUE_MASK\"] = 2963] = \"STENCIL_VALUE_MASK\";\n    GL[GL[\"STENCIL_WRITEMASK\"] = 2968] = \"STENCIL_WRITEMASK\";\n    GL[GL[\"STENCIL_BACK_FUNC\"] = 34816] = \"STENCIL_BACK_FUNC\";\n    GL[GL[\"STENCIL_BACK_FAIL\"] = 34817] = \"STENCIL_BACK_FAIL\";\n    GL[GL[\"STENCIL_BACK_PASS_DEPTH_FAIL\"] = 34818] = \"STENCIL_BACK_PASS_DEPTH_FAIL\";\n    GL[GL[\"STENCIL_BACK_PASS_DEPTH_PASS\"] = 34819] = \"STENCIL_BACK_PASS_DEPTH_PASS\";\n    GL[GL[\"STENCIL_BACK_REF\"] = 36003] = \"STENCIL_BACK_REF\";\n    GL[GL[\"STENCIL_BACK_VALUE_MASK\"] = 36004] = \"STENCIL_BACK_VALUE_MASK\";\n    GL[GL[\"STENCIL_BACK_WRITEMASK\"] = 36005] = \"STENCIL_BACK_WRITEMASK\";\n    GL[GL[\"VIEWPORT\"] = 2978] = \"VIEWPORT\";\n    GL[GL[\"SCISSOR_BOX\"] = 3088] = \"SCISSOR_BOX\";\n    GL[GL[\"COLOR_CLEAR_VALUE\"] = 3106] = \"COLOR_CLEAR_VALUE\";\n    GL[GL[\"COLOR_WRITEMASK\"] = 3107] = \"COLOR_WRITEMASK\";\n    GL[GL[\"UNPACK_ALIGNMENT\"] = 3317] = \"UNPACK_ALIGNMENT\";\n    GL[GL[\"PACK_ALIGNMENT\"] = 3333] = \"PACK_ALIGNMENT\";\n    GL[GL[\"MAX_TEXTURE_SIZE\"] = 3379] = \"MAX_TEXTURE_SIZE\";\n    GL[GL[\"MAX_VIEWPORT_DIMS\"] = 3386] = \"MAX_VIEWPORT_DIMS\";\n    GL[GL[\"SUBPIXEL_BITS\"] = 3408] = \"SUBPIXEL_BITS\";\n    GL[GL[\"RED_BITS\"] = 3410] = \"RED_BITS\";\n    GL[GL[\"GREEN_BITS\"] = 3411] = \"GREEN_BITS\";\n    GL[GL[\"BLUE_BITS\"] = 3412] = \"BLUE_BITS\";\n    GL[GL[\"ALPHA_BITS\"] = 3413] = \"ALPHA_BITS\";\n    GL[GL[\"DEPTH_BITS\"] = 3414] = \"DEPTH_BITS\";\n    GL[GL[\"STENCIL_BITS\"] = 3415] = \"STENCIL_BITS\";\n    GL[GL[\"POLYGON_OFFSET_UNITS\"] = 10752] = \"POLYGON_OFFSET_UNITS\";\n    GL[GL[\"POLYGON_OFFSET_FACTOR\"] = 32824] = \"POLYGON_OFFSET_FACTOR\";\n    GL[GL[\"TEXTURE_BINDING_2D\"] = 32873] = \"TEXTURE_BINDING_2D\";\n    GL[GL[\"SAMPLE_BUFFERS\"] = 32936] = \"SAMPLE_BUFFERS\";\n    GL[GL[\"SAMPLES\"] = 32937] = \"SAMPLES\";\n    GL[GL[\"SAMPLE_COVERAGE_VALUE\"] = 32938] = \"SAMPLE_COVERAGE_VALUE\";\n    GL[GL[\"SAMPLE_COVERAGE_INVERT\"] = 32939] = \"SAMPLE_COVERAGE_INVERT\";\n    GL[GL[\"COMPRESSED_TEXTURE_FORMATS\"] = 34467] = \"COMPRESSED_TEXTURE_FORMATS\";\n    GL[GL[\"VENDOR\"] = 7936] = \"VENDOR\";\n    GL[GL[\"RENDERER\"] = 7937] = \"RENDERER\";\n    GL[GL[\"VERSION\"] = 7938] = \"VERSION\";\n    GL[GL[\"IMPLEMENTATION_COLOR_READ_TYPE\"] = 35738] = \"IMPLEMENTATION_COLOR_READ_TYPE\";\n    GL[GL[\"IMPLEMENTATION_COLOR_READ_FORMAT\"] = 35739] = \"IMPLEMENTATION_COLOR_READ_FORMAT\";\n    GL[GL[\"BROWSER_DEFAULT_WEBGL\"] = 37444] = \"BROWSER_DEFAULT_WEBGL\";\n    // Buffers\n    // Constants passed to bufferData(), bufferSubData(), bindBuffer(), or\n    // getBufferParameter().\n    GL[GL[\"STATIC_DRAW\"] = 35044] = \"STATIC_DRAW\";\n    GL[GL[\"STREAM_DRAW\"] = 35040] = \"STREAM_DRAW\";\n    GL[GL[\"DYNAMIC_DRAW\"] = 35048] = \"DYNAMIC_DRAW\";\n    GL[GL[\"ARRAY_BUFFER\"] = 34962] = \"ARRAY_BUFFER\";\n    GL[GL[\"ELEMENT_ARRAY_BUFFER\"] = 34963] = \"ELEMENT_ARRAY_BUFFER\";\n    GL[GL[\"BUFFER_SIZE\"] = 34660] = \"BUFFER_SIZE\";\n    GL[GL[\"BUFFER_USAGE\"] = 34661] = \"BUFFER_USAGE\";\n    // Vertex attributes\n    // Constants passed to getVertexAttrib().\n    GL[GL[\"CURRENT_VERTEX_ATTRIB\"] = 34342] = \"CURRENT_VERTEX_ATTRIB\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_ENABLED\"] = 34338] = \"VERTEX_ATTRIB_ARRAY_ENABLED\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_SIZE\"] = 34339] = \"VERTEX_ATTRIB_ARRAY_SIZE\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_STRIDE\"] = 34340] = \"VERTEX_ATTRIB_ARRAY_STRIDE\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_TYPE\"] = 34341] = \"VERTEX_ATTRIB_ARRAY_TYPE\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_NORMALIZED\"] = 34922] = \"VERTEX_ATTRIB_ARRAY_NORMALIZED\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_POINTER\"] = 34373] = \"VERTEX_ATTRIB_ARRAY_POINTER\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING\"] = 34975] = \"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING\";\n    // Culling\n    // Constants passed to cullFace().\n    GL[GL[\"CULL_FACE\"] = 2884] = \"CULL_FACE\";\n    GL[GL[\"FRONT\"] = 1028] = \"FRONT\";\n    GL[GL[\"BACK\"] = 1029] = \"BACK\";\n    GL[GL[\"FRONT_AND_BACK\"] = 1032] = \"FRONT_AND_BACK\";\n    // Enabling and disabling\n    // Constants passed to enable() or disable().\n    GL[GL[\"BLEND\"] = 3042] = \"BLEND\";\n    GL[GL[\"DEPTH_TEST\"] = 2929] = \"DEPTH_TEST\";\n    GL[GL[\"DITHER\"] = 3024] = \"DITHER\";\n    GL[GL[\"POLYGON_OFFSET_FILL\"] = 32823] = \"POLYGON_OFFSET_FILL\";\n    GL[GL[\"SAMPLE_ALPHA_TO_COVERAGE\"] = 32926] = \"SAMPLE_ALPHA_TO_COVERAGE\";\n    GL[GL[\"SAMPLE_COVERAGE\"] = 32928] = \"SAMPLE_COVERAGE\";\n    GL[GL[\"SCISSOR_TEST\"] = 3089] = \"SCISSOR_TEST\";\n    GL[GL[\"STENCIL_TEST\"] = 2960] = \"STENCIL_TEST\";\n    // Errors\n    // Constants returned from getError().\n    GL[GL[\"NO_ERROR\"] = 0] = \"NO_ERROR\";\n    GL[GL[\"INVALID_ENUM\"] = 1280] = \"INVALID_ENUM\";\n    GL[GL[\"INVALID_VALUE\"] = 1281] = \"INVALID_VALUE\";\n    GL[GL[\"INVALID_OPERATION\"] = 1282] = \"INVALID_OPERATION\";\n    GL[GL[\"OUT_OF_MEMORY\"] = 1285] = \"OUT_OF_MEMORY\";\n    GL[GL[\"CONTEXT_LOST_WEBGL\"] = 37442] = \"CONTEXT_LOST_WEBGL\";\n    // Front face directions\n    // Constants passed to frontFace().\n    GL[GL[\"CW\"] = 2304] = \"CW\";\n    GL[GL[\"CCW\"] = 2305] = \"CCW\";\n    // Hints\n    // Constants passed to hint()\n    GL[GL[\"DONT_CARE\"] = 4352] = \"DONT_CARE\";\n    GL[GL[\"FASTEST\"] = 4353] = \"FASTEST\";\n    GL[GL[\"NICEST\"] = 4354] = \"NICEST\";\n    GL[GL[\"GENERATE_MIPMAP_HINT\"] = 33170] = \"GENERATE_MIPMAP_HINT\";\n    // Data types\n    GL[GL[\"BYTE\"] = 5120] = \"BYTE\";\n    GL[GL[\"UNSIGNED_BYTE\"] = 5121] = \"UNSIGNED_BYTE\";\n    GL[GL[\"SHORT\"] = 5122] = \"SHORT\";\n    GL[GL[\"UNSIGNED_SHORT\"] = 5123] = \"UNSIGNED_SHORT\";\n    GL[GL[\"INT\"] = 5124] = \"INT\";\n    GL[GL[\"UNSIGNED_INT\"] = 5125] = \"UNSIGNED_INT\";\n    GL[GL[\"FLOAT\"] = 5126] = \"FLOAT\";\n    GL[GL[\"DOUBLE\"] = 5130] = \"DOUBLE\";\n    // Pixel formats\n    GL[GL[\"DEPTH_COMPONENT\"] = 6402] = \"DEPTH_COMPONENT\";\n    GL[GL[\"ALPHA\"] = 6406] = \"ALPHA\";\n    GL[GL[\"RGB\"] = 6407] = \"RGB\";\n    GL[GL[\"RGBA\"] = 6408] = \"RGBA\";\n    GL[GL[\"LUMINANCE\"] = 6409] = \"LUMINANCE\";\n    GL[GL[\"LUMINANCE_ALPHA\"] = 6410] = \"LUMINANCE_ALPHA\";\n    // Pixel types\n    // UNSIGNED_BYTE = 0x1401,\n    GL[GL[\"UNSIGNED_SHORT_4_4_4_4\"] = 32819] = \"UNSIGNED_SHORT_4_4_4_4\";\n    GL[GL[\"UNSIGNED_SHORT_5_5_5_1\"] = 32820] = \"UNSIGNED_SHORT_5_5_5_1\";\n    GL[GL[\"UNSIGNED_SHORT_5_6_5\"] = 33635] = \"UNSIGNED_SHORT_5_6_5\";\n    // Shaders\n    // Constants passed to createShader() or getShaderParameter()\n    GL[GL[\"FRAGMENT_SHADER\"] = 35632] = \"FRAGMENT_SHADER\";\n    GL[GL[\"VERTEX_SHADER\"] = 35633] = \"VERTEX_SHADER\";\n    GL[GL[\"COMPILE_STATUS\"] = 35713] = \"COMPILE_STATUS\";\n    GL[GL[\"DELETE_STATUS\"] = 35712] = \"DELETE_STATUS\";\n    GL[GL[\"LINK_STATUS\"] = 35714] = \"LINK_STATUS\";\n    GL[GL[\"VALIDATE_STATUS\"] = 35715] = \"VALIDATE_STATUS\";\n    GL[GL[\"ATTACHED_SHADERS\"] = 35717] = \"ATTACHED_SHADERS\";\n    GL[GL[\"ACTIVE_ATTRIBUTES\"] = 35721] = \"ACTIVE_ATTRIBUTES\";\n    GL[GL[\"ACTIVE_UNIFORMS\"] = 35718] = \"ACTIVE_UNIFORMS\";\n    GL[GL[\"MAX_VERTEX_ATTRIBS\"] = 34921] = \"MAX_VERTEX_ATTRIBS\";\n    GL[GL[\"MAX_VERTEX_UNIFORM_VECTORS\"] = 36347] = \"MAX_VERTEX_UNIFORM_VECTORS\";\n    GL[GL[\"MAX_VARYING_VECTORS\"] = 36348] = \"MAX_VARYING_VECTORS\";\n    GL[GL[\"MAX_COMBINED_TEXTURE_IMAGE_UNITS\"] = 35661] = \"MAX_COMBINED_TEXTURE_IMAGE_UNITS\";\n    GL[GL[\"MAX_VERTEX_TEXTURE_IMAGE_UNITS\"] = 35660] = \"MAX_VERTEX_TEXTURE_IMAGE_UNITS\";\n    GL[GL[\"MAX_TEXTURE_IMAGE_UNITS\"] = 34930] = \"MAX_TEXTURE_IMAGE_UNITS\";\n    GL[GL[\"MAX_FRAGMENT_UNIFORM_VECTORS\"] = 36349] = \"MAX_FRAGMENT_UNIFORM_VECTORS\";\n    GL[GL[\"SHADER_TYPE\"] = 35663] = \"SHADER_TYPE\";\n    GL[GL[\"SHADING_LANGUAGE_VERSION\"] = 35724] = \"SHADING_LANGUAGE_VERSION\";\n    GL[GL[\"CURRENT_PROGRAM\"] = 35725] = \"CURRENT_PROGRAM\";\n    // Depth or stencil tests\n    // Constants passed to depthFunc() or stencilFunc().\n    GL[GL[\"NEVER\"] = 512] = \"NEVER\";\n    GL[GL[\"ALWAYS\"] = 519] = \"ALWAYS\";\n    GL[GL[\"LESS\"] = 513] = \"LESS\";\n    GL[GL[\"EQUAL\"] = 514] = \"EQUAL\";\n    GL[GL[\"LEQUAL\"] = 515] = \"LEQUAL\";\n    GL[GL[\"GREATER\"] = 516] = \"GREATER\";\n    GL[GL[\"GEQUAL\"] = 518] = \"GEQUAL\";\n    GL[GL[\"NOTEQUAL\"] = 517] = \"NOTEQUAL\";\n    // Stencil actions\n    // Constants passed to stencilOp().\n    GL[GL[\"KEEP\"] = 7680] = \"KEEP\";\n    GL[GL[\"REPLACE\"] = 7681] = \"REPLACE\";\n    GL[GL[\"INCR\"] = 7682] = \"INCR\";\n    GL[GL[\"DECR\"] = 7683] = \"DECR\";\n    GL[GL[\"INVERT\"] = 5386] = \"INVERT\";\n    GL[GL[\"INCR_WRAP\"] = 34055] = \"INCR_WRAP\";\n    GL[GL[\"DECR_WRAP\"] = 34056] = \"DECR_WRAP\";\n    // Textures\n    // Constants passed to texParameteri(),\n    // texParameterf(), bindTexture(), texImage2D(), and others.\n    GL[GL[\"NEAREST\"] = 9728] = \"NEAREST\";\n    GL[GL[\"LINEAR\"] = 9729] = \"LINEAR\";\n    GL[GL[\"NEAREST_MIPMAP_NEAREST\"] = 9984] = \"NEAREST_MIPMAP_NEAREST\";\n    GL[GL[\"LINEAR_MIPMAP_NEAREST\"] = 9985] = \"LINEAR_MIPMAP_NEAREST\";\n    GL[GL[\"NEAREST_MIPMAP_LINEAR\"] = 9986] = \"NEAREST_MIPMAP_LINEAR\";\n    GL[GL[\"LINEAR_MIPMAP_LINEAR\"] = 9987] = \"LINEAR_MIPMAP_LINEAR\";\n    GL[GL[\"TEXTURE_MAG_FILTER\"] = 10240] = \"TEXTURE_MAG_FILTER\";\n    GL[GL[\"TEXTURE_MIN_FILTER\"] = 10241] = \"TEXTURE_MIN_FILTER\";\n    GL[GL[\"TEXTURE_WRAP_S\"] = 10242] = \"TEXTURE_WRAP_S\";\n    GL[GL[\"TEXTURE_WRAP_T\"] = 10243] = \"TEXTURE_WRAP_T\";\n    GL[GL[\"TEXTURE_2D\"] = 3553] = \"TEXTURE_2D\";\n    GL[GL[\"TEXTURE\"] = 5890] = \"TEXTURE\";\n    GL[GL[\"TEXTURE_CUBE_MAP\"] = 34067] = \"TEXTURE_CUBE_MAP\";\n    GL[GL[\"TEXTURE_BINDING_CUBE_MAP\"] = 34068] = \"TEXTURE_BINDING_CUBE_MAP\";\n    GL[GL[\"TEXTURE_CUBE_MAP_POSITIVE_X\"] = 34069] = \"TEXTURE_CUBE_MAP_POSITIVE_X\";\n    GL[GL[\"TEXTURE_CUBE_MAP_NEGATIVE_X\"] = 34070] = \"TEXTURE_CUBE_MAP_NEGATIVE_X\";\n    GL[GL[\"TEXTURE_CUBE_MAP_POSITIVE_Y\"] = 34071] = \"TEXTURE_CUBE_MAP_POSITIVE_Y\";\n    GL[GL[\"TEXTURE_CUBE_MAP_NEGATIVE_Y\"] = 34072] = \"TEXTURE_CUBE_MAP_NEGATIVE_Y\";\n    GL[GL[\"TEXTURE_CUBE_MAP_POSITIVE_Z\"] = 34073] = \"TEXTURE_CUBE_MAP_POSITIVE_Z\";\n    GL[GL[\"TEXTURE_CUBE_MAP_NEGATIVE_Z\"] = 34074] = \"TEXTURE_CUBE_MAP_NEGATIVE_Z\";\n    GL[GL[\"MAX_CUBE_MAP_TEXTURE_SIZE\"] = 34076] = \"MAX_CUBE_MAP_TEXTURE_SIZE\";\n    // TEXTURE0 - 31 0x84C0 - 0x84DF A texture unit.\n    GL[GL[\"TEXTURE0\"] = 33984] = \"TEXTURE0\";\n    GL[GL[\"ACTIVE_TEXTURE\"] = 34016] = \"ACTIVE_TEXTURE\";\n    GL[GL[\"REPEAT\"] = 10497] = \"REPEAT\";\n    GL[GL[\"CLAMP_TO_EDGE\"] = 33071] = \"CLAMP_TO_EDGE\";\n    GL[GL[\"MIRRORED_REPEAT\"] = 33648] = \"MIRRORED_REPEAT\";\n    // Emulation\n    GL[GL[\"TEXTURE_WIDTH\"] = 4096] = \"TEXTURE_WIDTH\";\n    GL[GL[\"TEXTURE_HEIGHT\"] = 4097] = \"TEXTURE_HEIGHT\";\n    // Uniform types\n    GL[GL[\"FLOAT_VEC2\"] = 35664] = \"FLOAT_VEC2\";\n    GL[GL[\"FLOAT_VEC3\"] = 35665] = \"FLOAT_VEC3\";\n    GL[GL[\"FLOAT_VEC4\"] = 35666] = \"FLOAT_VEC4\";\n    GL[GL[\"INT_VEC2\"] = 35667] = \"INT_VEC2\";\n    GL[GL[\"INT_VEC3\"] = 35668] = \"INT_VEC3\";\n    GL[GL[\"INT_VEC4\"] = 35669] = \"INT_VEC4\";\n    GL[GL[\"BOOL\"] = 35670] = \"BOOL\";\n    GL[GL[\"BOOL_VEC2\"] = 35671] = \"BOOL_VEC2\";\n    GL[GL[\"BOOL_VEC3\"] = 35672] = \"BOOL_VEC3\";\n    GL[GL[\"BOOL_VEC4\"] = 35673] = \"BOOL_VEC4\";\n    GL[GL[\"FLOAT_MAT2\"] = 35674] = \"FLOAT_MAT2\";\n    GL[GL[\"FLOAT_MAT3\"] = 35675] = \"FLOAT_MAT3\";\n    GL[GL[\"FLOAT_MAT4\"] = 35676] = \"FLOAT_MAT4\";\n    GL[GL[\"SAMPLER_2D\"] = 35678] = \"SAMPLER_2D\";\n    GL[GL[\"SAMPLER_CUBE\"] = 35680] = \"SAMPLER_CUBE\";\n    // Shader precision-specified types\n    GL[GL[\"LOW_FLOAT\"] = 36336] = \"LOW_FLOAT\";\n    GL[GL[\"MEDIUM_FLOAT\"] = 36337] = \"MEDIUM_FLOAT\";\n    GL[GL[\"HIGH_FLOAT\"] = 36338] = \"HIGH_FLOAT\";\n    GL[GL[\"LOW_INT\"] = 36339] = \"LOW_INT\";\n    GL[GL[\"MEDIUM_INT\"] = 36340] = \"MEDIUM_INT\";\n    GL[GL[\"HIGH_INT\"] = 36341] = \"HIGH_INT\";\n    // Framebuffers and renderbuffers\n    GL[GL[\"FRAMEBUFFER\"] = 36160] = \"FRAMEBUFFER\";\n    GL[GL[\"RENDERBUFFER\"] = 36161] = \"RENDERBUFFER\";\n    GL[GL[\"RGBA4\"] = 32854] = \"RGBA4\";\n    GL[GL[\"RGB5_A1\"] = 32855] = \"RGB5_A1\";\n    GL[GL[\"RGB565\"] = 36194] = \"RGB565\";\n    GL[GL[\"DEPTH_COMPONENT16\"] = 33189] = \"DEPTH_COMPONENT16\";\n    GL[GL[\"STENCIL_INDEX\"] = 6401] = \"STENCIL_INDEX\";\n    GL[GL[\"STENCIL_INDEX8\"] = 36168] = \"STENCIL_INDEX8\";\n    GL[GL[\"DEPTH_STENCIL\"] = 34041] = \"DEPTH_STENCIL\";\n    GL[GL[\"RENDERBUFFER_WIDTH\"] = 36162] = \"RENDERBUFFER_WIDTH\";\n    GL[GL[\"RENDERBUFFER_HEIGHT\"] = 36163] = \"RENDERBUFFER_HEIGHT\";\n    GL[GL[\"RENDERBUFFER_INTERNAL_FORMAT\"] = 36164] = \"RENDERBUFFER_INTERNAL_FORMAT\";\n    GL[GL[\"RENDERBUFFER_RED_SIZE\"] = 36176] = \"RENDERBUFFER_RED_SIZE\";\n    GL[GL[\"RENDERBUFFER_GREEN_SIZE\"] = 36177] = \"RENDERBUFFER_GREEN_SIZE\";\n    GL[GL[\"RENDERBUFFER_BLUE_SIZE\"] = 36178] = \"RENDERBUFFER_BLUE_SIZE\";\n    GL[GL[\"RENDERBUFFER_ALPHA_SIZE\"] = 36179] = \"RENDERBUFFER_ALPHA_SIZE\";\n    GL[GL[\"RENDERBUFFER_DEPTH_SIZE\"] = 36180] = \"RENDERBUFFER_DEPTH_SIZE\";\n    GL[GL[\"RENDERBUFFER_STENCIL_SIZE\"] = 36181] = \"RENDERBUFFER_STENCIL_SIZE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE\"] = 36048] = \"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME\"] = 36049] = \"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL\"] = 36050] = \"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE\"] = 36051] = \"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE\";\n    GL[GL[\"COLOR_ATTACHMENT0\"] = 36064] = \"COLOR_ATTACHMENT0\";\n    GL[GL[\"DEPTH_ATTACHMENT\"] = 36096] = \"DEPTH_ATTACHMENT\";\n    GL[GL[\"STENCIL_ATTACHMENT\"] = 36128] = \"STENCIL_ATTACHMENT\";\n    GL[GL[\"DEPTH_STENCIL_ATTACHMENT\"] = 33306] = \"DEPTH_STENCIL_ATTACHMENT\";\n    GL[GL[\"NONE\"] = 0] = \"NONE\";\n    GL[GL[\"FRAMEBUFFER_COMPLETE\"] = 36053] = \"FRAMEBUFFER_COMPLETE\";\n    GL[GL[\"FRAMEBUFFER_INCOMPLETE_ATTACHMENT\"] = 36054] = \"FRAMEBUFFER_INCOMPLETE_ATTACHMENT\";\n    GL[GL[\"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\"] = 36055] = \"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\";\n    GL[GL[\"FRAMEBUFFER_INCOMPLETE_DIMENSIONS\"] = 36057] = \"FRAMEBUFFER_INCOMPLETE_DIMENSIONS\";\n    GL[GL[\"FRAMEBUFFER_UNSUPPORTED\"] = 36061] = \"FRAMEBUFFER_UNSUPPORTED\";\n    GL[GL[\"FRAMEBUFFER_BINDING\"] = 36006] = \"FRAMEBUFFER_BINDING\";\n    GL[GL[\"RENDERBUFFER_BINDING\"] = 36007] = \"RENDERBUFFER_BINDING\";\n    GL[GL[\"READ_FRAMEBUFFER\"] = 36008] = \"READ_FRAMEBUFFER\";\n    GL[GL[\"DRAW_FRAMEBUFFER\"] = 36009] = \"DRAW_FRAMEBUFFER\";\n    GL[GL[\"MAX_RENDERBUFFER_SIZE\"] = 34024] = \"MAX_RENDERBUFFER_SIZE\";\n    GL[GL[\"INVALID_FRAMEBUFFER_OPERATION\"] = 1286] = \"INVALID_FRAMEBUFFER_OPERATION\";\n    // Pixel storage modes\n    // Constants passed to pixelStorei().\n    GL[GL[\"UNPACK_FLIP_Y_WEBGL\"] = 37440] = \"UNPACK_FLIP_Y_WEBGL\";\n    GL[GL[\"UNPACK_PREMULTIPLY_ALPHA_WEBGL\"] = 37441] = \"UNPACK_PREMULTIPLY_ALPHA_WEBGL\";\n    GL[GL[\"UNPACK_COLORSPACE_CONVERSION_WEBGL\"] = 37443] = \"UNPACK_COLORSPACE_CONVERSION_WEBGL\";\n    // /////////////////////////////////////////////////////\n    // Additional constants defined WebGL 2\n    // These constants are defined on the WebGL2RenderingContext interface.\n    // All WebGL 1 constants are also available in a WebGL 2 context.\n    // /////////////////////////////////////////////////////\n    // Getting GL parameter information\n    // Constants passed to getParameter()\n    // to specify what information to return.\n    GL[GL[\"READ_BUFFER\"] = 3074] = \"READ_BUFFER\";\n    GL[GL[\"UNPACK_ROW_LENGTH\"] = 3314] = \"UNPACK_ROW_LENGTH\";\n    GL[GL[\"UNPACK_SKIP_ROWS\"] = 3315] = \"UNPACK_SKIP_ROWS\";\n    GL[GL[\"UNPACK_SKIP_PIXELS\"] = 3316] = \"UNPACK_SKIP_PIXELS\";\n    GL[GL[\"PACK_ROW_LENGTH\"] = 3330] = \"PACK_ROW_LENGTH\";\n    GL[GL[\"PACK_SKIP_ROWS\"] = 3331] = \"PACK_SKIP_ROWS\";\n    GL[GL[\"PACK_SKIP_PIXELS\"] = 3332] = \"PACK_SKIP_PIXELS\";\n    GL[GL[\"TEXTURE_BINDING_3D\"] = 32874] = \"TEXTURE_BINDING_3D\";\n    GL[GL[\"UNPACK_SKIP_IMAGES\"] = 32877] = \"UNPACK_SKIP_IMAGES\";\n    GL[GL[\"UNPACK_IMAGE_HEIGHT\"] = 32878] = \"UNPACK_IMAGE_HEIGHT\";\n    GL[GL[\"MAX_3D_TEXTURE_SIZE\"] = 32883] = \"MAX_3D_TEXTURE_SIZE\";\n    GL[GL[\"MAX_ELEMENTS_VERTICES\"] = 33000] = \"MAX_ELEMENTS_VERTICES\";\n    GL[GL[\"MAX_ELEMENTS_INDICES\"] = 33001] = \"MAX_ELEMENTS_INDICES\";\n    GL[GL[\"MAX_TEXTURE_LOD_BIAS\"] = 34045] = \"MAX_TEXTURE_LOD_BIAS\";\n    GL[GL[\"MAX_FRAGMENT_UNIFORM_COMPONENTS\"] = 35657] = \"MAX_FRAGMENT_UNIFORM_COMPONENTS\";\n    GL[GL[\"MAX_VERTEX_UNIFORM_COMPONENTS\"] = 35658] = \"MAX_VERTEX_UNIFORM_COMPONENTS\";\n    GL[GL[\"MAX_ARRAY_TEXTURE_LAYERS\"] = 35071] = \"MAX_ARRAY_TEXTURE_LAYERS\";\n    GL[GL[\"MIN_PROGRAM_TEXEL_OFFSET\"] = 35076] = \"MIN_PROGRAM_TEXEL_OFFSET\";\n    GL[GL[\"MAX_PROGRAM_TEXEL_OFFSET\"] = 35077] = \"MAX_PROGRAM_TEXEL_OFFSET\";\n    GL[GL[\"MAX_VARYING_COMPONENTS\"] = 35659] = \"MAX_VARYING_COMPONENTS\";\n    GL[GL[\"FRAGMENT_SHADER_DERIVATIVE_HINT\"] = 35723] = \"FRAGMENT_SHADER_DERIVATIVE_HINT\";\n    GL[GL[\"RASTERIZER_DISCARD\"] = 35977] = \"RASTERIZER_DISCARD\";\n    GL[GL[\"VERTEX_ARRAY_BINDING\"] = 34229] = \"VERTEX_ARRAY_BINDING\";\n    GL[GL[\"MAX_VERTEX_OUTPUT_COMPONENTS\"] = 37154] = \"MAX_VERTEX_OUTPUT_COMPONENTS\";\n    GL[GL[\"MAX_FRAGMENT_INPUT_COMPONENTS\"] = 37157] = \"MAX_FRAGMENT_INPUT_COMPONENTS\";\n    GL[GL[\"MAX_SERVER_WAIT_TIMEOUT\"] = 37137] = \"MAX_SERVER_WAIT_TIMEOUT\";\n    GL[GL[\"MAX_ELEMENT_INDEX\"] = 36203] = \"MAX_ELEMENT_INDEX\";\n    // Textures\n    // Constants passed to texParameteri(),\n    // texParameterf(), bindTexture(), texImage2D(), and others.\n    GL[GL[\"RED\"] = 6403] = \"RED\";\n    GL[GL[\"RGB8\"] = 32849] = \"RGB8\";\n    GL[GL[\"RGBA8\"] = 32856] = \"RGBA8\";\n    GL[GL[\"RGB10_A2\"] = 32857] = \"RGB10_A2\";\n    GL[GL[\"TEXTURE_3D\"] = 32879] = \"TEXTURE_3D\";\n    GL[GL[\"TEXTURE_WRAP_R\"] = 32882] = \"TEXTURE_WRAP_R\";\n    GL[GL[\"TEXTURE_MIN_LOD\"] = 33082] = \"TEXTURE_MIN_LOD\";\n    GL[GL[\"TEXTURE_MAX_LOD\"] = 33083] = \"TEXTURE_MAX_LOD\";\n    GL[GL[\"TEXTURE_BASE_LEVEL\"] = 33084] = \"TEXTURE_BASE_LEVEL\";\n    GL[GL[\"TEXTURE_MAX_LEVEL\"] = 33085] = \"TEXTURE_MAX_LEVEL\";\n    GL[GL[\"TEXTURE_COMPARE_MODE\"] = 34892] = \"TEXTURE_COMPARE_MODE\";\n    GL[GL[\"TEXTURE_COMPARE_FUNC\"] = 34893] = \"TEXTURE_COMPARE_FUNC\";\n    GL[GL[\"SRGB\"] = 35904] = \"SRGB\";\n    GL[GL[\"SRGB8\"] = 35905] = \"SRGB8\";\n    GL[GL[\"SRGB8_ALPHA8\"] = 35907] = \"SRGB8_ALPHA8\";\n    GL[GL[\"COMPARE_REF_TO_TEXTURE\"] = 34894] = \"COMPARE_REF_TO_TEXTURE\";\n    GL[GL[\"RGBA32F\"] = 34836] = \"RGBA32F\";\n    GL[GL[\"RGB32F\"] = 34837] = \"RGB32F\";\n    GL[GL[\"RGBA16F\"] = 34842] = \"RGBA16F\";\n    GL[GL[\"RGB16F\"] = 34843] = \"RGB16F\";\n    GL[GL[\"TEXTURE_2D_ARRAY\"] = 35866] = \"TEXTURE_2D_ARRAY\";\n    GL[GL[\"TEXTURE_BINDING_2D_ARRAY\"] = 35869] = \"TEXTURE_BINDING_2D_ARRAY\";\n    GL[GL[\"R11F_G11F_B10F\"] = 35898] = \"R11F_G11F_B10F\";\n    GL[GL[\"RGB9_E5\"] = 35901] = \"RGB9_E5\";\n    GL[GL[\"RGBA32UI\"] = 36208] = \"RGBA32UI\";\n    GL[GL[\"RGB32UI\"] = 36209] = \"RGB32UI\";\n    GL[GL[\"RGBA16UI\"] = 36214] = \"RGBA16UI\";\n    GL[GL[\"RGB16UI\"] = 36215] = \"RGB16UI\";\n    GL[GL[\"RGBA8UI\"] = 36220] = \"RGBA8UI\";\n    GL[GL[\"RGB8UI\"] = 36221] = \"RGB8UI\";\n    GL[GL[\"RGBA32I\"] = 36226] = \"RGBA32I\";\n    GL[GL[\"RGB32I\"] = 36227] = \"RGB32I\";\n    GL[GL[\"RGBA16I\"] = 36232] = \"RGBA16I\";\n    GL[GL[\"RGB16I\"] = 36233] = \"RGB16I\";\n    GL[GL[\"RGBA8I\"] = 36238] = \"RGBA8I\";\n    GL[GL[\"RGB8I\"] = 36239] = \"RGB8I\";\n    GL[GL[\"RED_INTEGER\"] = 36244] = \"RED_INTEGER\";\n    GL[GL[\"RGB_INTEGER\"] = 36248] = \"RGB_INTEGER\";\n    GL[GL[\"RGBA_INTEGER\"] = 36249] = \"RGBA_INTEGER\";\n    GL[GL[\"R8\"] = 33321] = \"R8\";\n    GL[GL[\"RG8\"] = 33323] = \"RG8\";\n    GL[GL[\"R16F\"] = 33325] = \"R16F\";\n    GL[GL[\"R32F\"] = 33326] = \"R32F\";\n    GL[GL[\"RG16F\"] = 33327] = \"RG16F\";\n    GL[GL[\"RG32F\"] = 33328] = \"RG32F\";\n    GL[GL[\"R8I\"] = 33329] = \"R8I\";\n    GL[GL[\"R8UI\"] = 33330] = \"R8UI\";\n    GL[GL[\"R16I\"] = 33331] = \"R16I\";\n    GL[GL[\"R16UI\"] = 33332] = \"R16UI\";\n    GL[GL[\"R32I\"] = 33333] = \"R32I\";\n    GL[GL[\"R32UI\"] = 33334] = \"R32UI\";\n    GL[GL[\"RG8I\"] = 33335] = \"RG8I\";\n    GL[GL[\"RG8UI\"] = 33336] = \"RG8UI\";\n    GL[GL[\"RG16I\"] = 33337] = \"RG16I\";\n    GL[GL[\"RG16UI\"] = 33338] = \"RG16UI\";\n    GL[GL[\"RG32I\"] = 33339] = \"RG32I\";\n    GL[GL[\"RG32UI\"] = 33340] = \"RG32UI\";\n    GL[GL[\"R8_SNORM\"] = 36756] = \"R8_SNORM\";\n    GL[GL[\"RG8_SNORM\"] = 36757] = \"RG8_SNORM\";\n    GL[GL[\"RGB8_SNORM\"] = 36758] = \"RGB8_SNORM\";\n    GL[GL[\"RGBA8_SNORM\"] = 36759] = \"RGBA8_SNORM\";\n    GL[GL[\"RGB10_A2UI\"] = 36975] = \"RGB10_A2UI\";\n    /* covered by extension\n      COMPRESSED_R11_EAC  = 0x9270,\n      COMPRESSED_SIGNED_R11_EAC = 0x9271,\n      COMPRESSED_RG11_EAC = 0x9272,\n      COMPRESSED_SIGNED_RG11_EAC  = 0x9273,\n      COMPRESSED_RGB8_ETC2  = 0x9274,\n      COMPRESSED_SRGB8_ETC2 = 0x9275,\n      COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2  = 0x9276,\n      COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC  = 0x9277,\n      COMPRESSED_RGBA8_ETC2_EAC = 0x9278,\n      COMPRESSED_SRGB8_ALPHA8_ETC2_EAC  = 0x9279,\n      */\n    GL[GL[\"TEXTURE_IMMUTABLE_FORMAT\"] = 37167] = \"TEXTURE_IMMUTABLE_FORMAT\";\n    GL[GL[\"TEXTURE_IMMUTABLE_LEVELS\"] = 33503] = \"TEXTURE_IMMUTABLE_LEVELS\";\n    // Pixel types\n    GL[GL[\"UNSIGNED_INT_2_10_10_10_REV\"] = 33640] = \"UNSIGNED_INT_2_10_10_10_REV\";\n    GL[GL[\"UNSIGNED_INT_10F_11F_11F_REV\"] = 35899] = \"UNSIGNED_INT_10F_11F_11F_REV\";\n    GL[GL[\"UNSIGNED_INT_5_9_9_9_REV\"] = 35902] = \"UNSIGNED_INT_5_9_9_9_REV\";\n    GL[GL[\"FLOAT_32_UNSIGNED_INT_24_8_REV\"] = 36269] = \"FLOAT_32_UNSIGNED_INT_24_8_REV\";\n    GL[GL[\"UNSIGNED_INT_24_8\"] = 34042] = \"UNSIGNED_INT_24_8\";\n    GL[GL[\"HALF_FLOAT\"] = 5131] = \"HALF_FLOAT\";\n    GL[GL[\"RG\"] = 33319] = \"RG\";\n    GL[GL[\"RG_INTEGER\"] = 33320] = \"RG_INTEGER\";\n    GL[GL[\"INT_2_10_10_10_REV\"] = 36255] = \"INT_2_10_10_10_REV\";\n    // Queries\n    GL[GL[\"CURRENT_QUERY\"] = 34917] = \"CURRENT_QUERY\";\n    GL[GL[\"QUERY_RESULT\"] = 34918] = \"QUERY_RESULT\";\n    GL[GL[\"QUERY_RESULT_AVAILABLE\"] = 34919] = \"QUERY_RESULT_AVAILABLE\";\n    GL[GL[\"ANY_SAMPLES_PASSED\"] = 35887] = \"ANY_SAMPLES_PASSED\";\n    GL[GL[\"ANY_SAMPLES_PASSED_CONSERVATIVE\"] = 36202] = \"ANY_SAMPLES_PASSED_CONSERVATIVE\";\n    // Draw buffers\n    GL[GL[\"MAX_DRAW_BUFFERS\"] = 34852] = \"MAX_DRAW_BUFFERS\";\n    GL[GL[\"DRAW_BUFFER0\"] = 34853] = \"DRAW_BUFFER0\";\n    GL[GL[\"DRAW_BUFFER1\"] = 34854] = \"DRAW_BUFFER1\";\n    GL[GL[\"DRAW_BUFFER2\"] = 34855] = \"DRAW_BUFFER2\";\n    GL[GL[\"DRAW_BUFFER3\"] = 34856] = \"DRAW_BUFFER3\";\n    GL[GL[\"DRAW_BUFFER4\"] = 34857] = \"DRAW_BUFFER4\";\n    GL[GL[\"DRAW_BUFFER5\"] = 34858] = \"DRAW_BUFFER5\";\n    GL[GL[\"DRAW_BUFFER6\"] = 34859] = \"DRAW_BUFFER6\";\n    GL[GL[\"DRAW_BUFFER7\"] = 34860] = \"DRAW_BUFFER7\";\n    GL[GL[\"DRAW_BUFFER8\"] = 34861] = \"DRAW_BUFFER8\";\n    GL[GL[\"DRAW_BUFFER9\"] = 34862] = \"DRAW_BUFFER9\";\n    GL[GL[\"DRAW_BUFFER10\"] = 34863] = \"DRAW_BUFFER10\";\n    GL[GL[\"DRAW_BUFFER11\"] = 34864] = \"DRAW_BUFFER11\";\n    GL[GL[\"DRAW_BUFFER12\"] = 34865] = \"DRAW_BUFFER12\";\n    GL[GL[\"DRAW_BUFFER13\"] = 34866] = \"DRAW_BUFFER13\";\n    GL[GL[\"DRAW_BUFFER14\"] = 34867] = \"DRAW_BUFFER14\";\n    GL[GL[\"DRAW_BUFFER15\"] = 34868] = \"DRAW_BUFFER15\";\n    GL[GL[\"MAX_COLOR_ATTACHMENTS\"] = 36063] = \"MAX_COLOR_ATTACHMENTS\";\n    GL[GL[\"COLOR_ATTACHMENT1\"] = 36065] = \"COLOR_ATTACHMENT1\";\n    GL[GL[\"COLOR_ATTACHMENT2\"] = 36066] = \"COLOR_ATTACHMENT2\";\n    GL[GL[\"COLOR_ATTACHMENT3\"] = 36067] = \"COLOR_ATTACHMENT3\";\n    GL[GL[\"COLOR_ATTACHMENT4\"] = 36068] = \"COLOR_ATTACHMENT4\";\n    GL[GL[\"COLOR_ATTACHMENT5\"] = 36069] = \"COLOR_ATTACHMENT5\";\n    GL[GL[\"COLOR_ATTACHMENT6\"] = 36070] = \"COLOR_ATTACHMENT6\";\n    GL[GL[\"COLOR_ATTACHMENT7\"] = 36071] = \"COLOR_ATTACHMENT7\";\n    GL[GL[\"COLOR_ATTACHMENT8\"] = 36072] = \"COLOR_ATTACHMENT8\";\n    GL[GL[\"COLOR_ATTACHMENT9\"] = 36073] = \"COLOR_ATTACHMENT9\";\n    GL[GL[\"COLOR_ATTACHMENT10\"] = 36074] = \"COLOR_ATTACHMENT10\";\n    GL[GL[\"COLOR_ATTACHMENT11\"] = 36075] = \"COLOR_ATTACHMENT11\";\n    GL[GL[\"COLOR_ATTACHMENT12\"] = 36076] = \"COLOR_ATTACHMENT12\";\n    GL[GL[\"COLOR_ATTACHMENT13\"] = 36077] = \"COLOR_ATTACHMENT13\";\n    GL[GL[\"COLOR_ATTACHMENT14\"] = 36078] = \"COLOR_ATTACHMENT14\";\n    GL[GL[\"COLOR_ATTACHMENT15\"] = 36079] = \"COLOR_ATTACHMENT15\";\n    // Samplers\n    GL[GL[\"SAMPLER_3D\"] = 35679] = \"SAMPLER_3D\";\n    GL[GL[\"SAMPLER_2D_SHADOW\"] = 35682] = \"SAMPLER_2D_SHADOW\";\n    GL[GL[\"SAMPLER_2D_ARRAY\"] = 36289] = \"SAMPLER_2D_ARRAY\";\n    GL[GL[\"SAMPLER_2D_ARRAY_SHADOW\"] = 36292] = \"SAMPLER_2D_ARRAY_SHADOW\";\n    GL[GL[\"SAMPLER_CUBE_SHADOW\"] = 36293] = \"SAMPLER_CUBE_SHADOW\";\n    GL[GL[\"INT_SAMPLER_2D\"] = 36298] = \"INT_SAMPLER_2D\";\n    GL[GL[\"INT_SAMPLER_3D\"] = 36299] = \"INT_SAMPLER_3D\";\n    GL[GL[\"INT_SAMPLER_CUBE\"] = 36300] = \"INT_SAMPLER_CUBE\";\n    GL[GL[\"INT_SAMPLER_2D_ARRAY\"] = 36303] = \"INT_SAMPLER_2D_ARRAY\";\n    GL[GL[\"UNSIGNED_INT_SAMPLER_2D\"] = 36306] = \"UNSIGNED_INT_SAMPLER_2D\";\n    GL[GL[\"UNSIGNED_INT_SAMPLER_3D\"] = 36307] = \"UNSIGNED_INT_SAMPLER_3D\";\n    GL[GL[\"UNSIGNED_INT_SAMPLER_CUBE\"] = 36308] = \"UNSIGNED_INT_SAMPLER_CUBE\";\n    GL[GL[\"UNSIGNED_INT_SAMPLER_2D_ARRAY\"] = 36311] = \"UNSIGNED_INT_SAMPLER_2D_ARRAY\";\n    GL[GL[\"MAX_SAMPLES\"] = 36183] = \"MAX_SAMPLES\";\n    GL[GL[\"SAMPLER_BINDING\"] = 35097] = \"SAMPLER_BINDING\";\n    // Buffers\n    GL[GL[\"PIXEL_PACK_BUFFER\"] = 35051] = \"PIXEL_PACK_BUFFER\";\n    GL[GL[\"PIXEL_UNPACK_BUFFER\"] = 35052] = \"PIXEL_UNPACK_BUFFER\";\n    GL[GL[\"PIXEL_PACK_BUFFER_BINDING\"] = 35053] = \"PIXEL_PACK_BUFFER_BINDING\";\n    GL[GL[\"PIXEL_UNPACK_BUFFER_BINDING\"] = 35055] = \"PIXEL_UNPACK_BUFFER_BINDING\";\n    GL[GL[\"COPY_READ_BUFFER\"] = 36662] = \"COPY_READ_BUFFER\";\n    GL[GL[\"COPY_WRITE_BUFFER\"] = 36663] = \"COPY_WRITE_BUFFER\";\n    GL[GL[\"COPY_READ_BUFFER_BINDING\"] = 36662] = \"COPY_READ_BUFFER_BINDING\";\n    GL[GL[\"COPY_WRITE_BUFFER_BINDING\"] = 36663] = \"COPY_WRITE_BUFFER_BINDING\";\n    // Data types\n    GL[GL[\"FLOAT_MAT2x3\"] = 35685] = \"FLOAT_MAT2x3\";\n    GL[GL[\"FLOAT_MAT2x4\"] = 35686] = \"FLOAT_MAT2x4\";\n    GL[GL[\"FLOAT_MAT3x2\"] = 35687] = \"FLOAT_MAT3x2\";\n    GL[GL[\"FLOAT_MAT3x4\"] = 35688] = \"FLOAT_MAT3x4\";\n    GL[GL[\"FLOAT_MAT4x2\"] = 35689] = \"FLOAT_MAT4x2\";\n    GL[GL[\"FLOAT_MAT4x3\"] = 35690] = \"FLOAT_MAT4x3\";\n    GL[GL[\"UNSIGNED_INT_VEC2\"] = 36294] = \"UNSIGNED_INT_VEC2\";\n    GL[GL[\"UNSIGNED_INT_VEC3\"] = 36295] = \"UNSIGNED_INT_VEC3\";\n    GL[GL[\"UNSIGNED_INT_VEC4\"] = 36296] = \"UNSIGNED_INT_VEC4\";\n    GL[GL[\"UNSIGNED_NORMALIZED\"] = 35863] = \"UNSIGNED_NORMALIZED\";\n    GL[GL[\"SIGNED_NORMALIZED\"] = 36764] = \"SIGNED_NORMALIZED\";\n    // Vertex attributes\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_INTEGER\"] = 35069] = \"VERTEX_ATTRIB_ARRAY_INTEGER\";\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_DIVISOR\"] = 35070] = \"VERTEX_ATTRIB_ARRAY_DIVISOR\";\n    // Transform feedback\n    GL[GL[\"TRANSFORM_FEEDBACK_BUFFER_MODE\"] = 35967] = \"TRANSFORM_FEEDBACK_BUFFER_MODE\";\n    GL[GL[\"MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS\"] = 35968] = \"MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS\";\n    GL[GL[\"TRANSFORM_FEEDBACK_VARYINGS\"] = 35971] = \"TRANSFORM_FEEDBACK_VARYINGS\";\n    GL[GL[\"TRANSFORM_FEEDBACK_BUFFER_START\"] = 35972] = \"TRANSFORM_FEEDBACK_BUFFER_START\";\n    GL[GL[\"TRANSFORM_FEEDBACK_BUFFER_SIZE\"] = 35973] = \"TRANSFORM_FEEDBACK_BUFFER_SIZE\";\n    GL[GL[\"TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN\"] = 35976] = \"TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN\";\n    GL[GL[\"MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS\"] = 35978] = \"MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS\";\n    GL[GL[\"MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS\"] = 35979] = \"MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS\";\n    GL[GL[\"INTERLEAVED_ATTRIBS\"] = 35980] = \"INTERLEAVED_ATTRIBS\";\n    GL[GL[\"SEPARATE_ATTRIBS\"] = 35981] = \"SEPARATE_ATTRIBS\";\n    GL[GL[\"TRANSFORM_FEEDBACK_BUFFER\"] = 35982] = \"TRANSFORM_FEEDBACK_BUFFER\";\n    GL[GL[\"TRANSFORM_FEEDBACK_BUFFER_BINDING\"] = 35983] = \"TRANSFORM_FEEDBACK_BUFFER_BINDING\";\n    GL[GL[\"TRANSFORM_FEEDBACK\"] = 36386] = \"TRANSFORM_FEEDBACK\";\n    GL[GL[\"TRANSFORM_FEEDBACK_PAUSED\"] = 36387] = \"TRANSFORM_FEEDBACK_PAUSED\";\n    GL[GL[\"TRANSFORM_FEEDBACK_ACTIVE\"] = 36388] = \"TRANSFORM_FEEDBACK_ACTIVE\";\n    GL[GL[\"TRANSFORM_FEEDBACK_BINDING\"] = 36389] = \"TRANSFORM_FEEDBACK_BINDING\";\n    // Framebuffers and renderbuffers\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING\"] = 33296] = \"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE\"] = 33297] = \"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_RED_SIZE\"] = 33298] = \"FRAMEBUFFER_ATTACHMENT_RED_SIZE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_GREEN_SIZE\"] = 33299] = \"FRAMEBUFFER_ATTACHMENT_GREEN_SIZE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_BLUE_SIZE\"] = 33300] = \"FRAMEBUFFER_ATTACHMENT_BLUE_SIZE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE\"] = 33301] = \"FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE\"] = 33302] = \"FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE\"] = 33303] = \"FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE\";\n    GL[GL[\"FRAMEBUFFER_DEFAULT\"] = 33304] = \"FRAMEBUFFER_DEFAULT\";\n    // DEPTH_STENCIL_ATTACHMENT  = 0x821A,\n    // DEPTH_STENCIL = 0x84F9,\n    GL[GL[\"DEPTH24_STENCIL8\"] = 35056] = \"DEPTH24_STENCIL8\";\n    GL[GL[\"DRAW_FRAMEBUFFER_BINDING\"] = 36006] = \"DRAW_FRAMEBUFFER_BINDING\";\n    GL[GL[\"READ_FRAMEBUFFER_BINDING\"] = 36010] = \"READ_FRAMEBUFFER_BINDING\";\n    GL[GL[\"RENDERBUFFER_SAMPLES\"] = 36011] = \"RENDERBUFFER_SAMPLES\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER\"] = 36052] = \"FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER\";\n    GL[GL[\"FRAMEBUFFER_INCOMPLETE_MULTISAMPLE\"] = 36182] = \"FRAMEBUFFER_INCOMPLETE_MULTISAMPLE\";\n    // Uniforms\n    GL[GL[\"UNIFORM_BUFFER\"] = 35345] = \"UNIFORM_BUFFER\";\n    GL[GL[\"UNIFORM_BUFFER_BINDING\"] = 35368] = \"UNIFORM_BUFFER_BINDING\";\n    GL[GL[\"UNIFORM_BUFFER_START\"] = 35369] = \"UNIFORM_BUFFER_START\";\n    GL[GL[\"UNIFORM_BUFFER_SIZE\"] = 35370] = \"UNIFORM_BUFFER_SIZE\";\n    GL[GL[\"MAX_VERTEX_UNIFORM_BLOCKS\"] = 35371] = \"MAX_VERTEX_UNIFORM_BLOCKS\";\n    GL[GL[\"MAX_FRAGMENT_UNIFORM_BLOCKS\"] = 35373] = \"MAX_FRAGMENT_UNIFORM_BLOCKS\";\n    GL[GL[\"MAX_COMBINED_UNIFORM_BLOCKS\"] = 35374] = \"MAX_COMBINED_UNIFORM_BLOCKS\";\n    GL[GL[\"MAX_UNIFORM_BUFFER_BINDINGS\"] = 35375] = \"MAX_UNIFORM_BUFFER_BINDINGS\";\n    GL[GL[\"MAX_UNIFORM_BLOCK_SIZE\"] = 35376] = \"MAX_UNIFORM_BLOCK_SIZE\";\n    GL[GL[\"MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS\"] = 35377] = \"MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS\";\n    GL[GL[\"MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS\"] = 35379] = \"MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS\";\n    GL[GL[\"UNIFORM_BUFFER_OFFSET_ALIGNMENT\"] = 35380] = \"UNIFORM_BUFFER_OFFSET_ALIGNMENT\";\n    GL[GL[\"ACTIVE_UNIFORM_BLOCKS\"] = 35382] = \"ACTIVE_UNIFORM_BLOCKS\";\n    GL[GL[\"UNIFORM_TYPE\"] = 35383] = \"UNIFORM_TYPE\";\n    GL[GL[\"UNIFORM_SIZE\"] = 35384] = \"UNIFORM_SIZE\";\n    GL[GL[\"UNIFORM_BLOCK_INDEX\"] = 35386] = \"UNIFORM_BLOCK_INDEX\";\n    GL[GL[\"UNIFORM_OFFSET\"] = 35387] = \"UNIFORM_OFFSET\";\n    GL[GL[\"UNIFORM_ARRAY_STRIDE\"] = 35388] = \"UNIFORM_ARRAY_STRIDE\";\n    GL[GL[\"UNIFORM_MATRIX_STRIDE\"] = 35389] = \"UNIFORM_MATRIX_STRIDE\";\n    GL[GL[\"UNIFORM_IS_ROW_MAJOR\"] = 35390] = \"UNIFORM_IS_ROW_MAJOR\";\n    GL[GL[\"UNIFORM_BLOCK_BINDING\"] = 35391] = \"UNIFORM_BLOCK_BINDING\";\n    GL[GL[\"UNIFORM_BLOCK_DATA_SIZE\"] = 35392] = \"UNIFORM_BLOCK_DATA_SIZE\";\n    GL[GL[\"UNIFORM_BLOCK_ACTIVE_UNIFORMS\"] = 35394] = \"UNIFORM_BLOCK_ACTIVE_UNIFORMS\";\n    GL[GL[\"UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES\"] = 35395] = \"UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES\";\n    GL[GL[\"UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER\"] = 35396] = \"UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER\";\n    GL[GL[\"UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER\"] = 35398] = \"UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER\";\n    // Sync objects\n    GL[GL[\"OBJECT_TYPE\"] = 37138] = \"OBJECT_TYPE\";\n    GL[GL[\"SYNC_CONDITION\"] = 37139] = \"SYNC_CONDITION\";\n    GL[GL[\"SYNC_STATUS\"] = 37140] = \"SYNC_STATUS\";\n    GL[GL[\"SYNC_FLAGS\"] = 37141] = \"SYNC_FLAGS\";\n    GL[GL[\"SYNC_FENCE\"] = 37142] = \"SYNC_FENCE\";\n    GL[GL[\"SYNC_GPU_COMMANDS_COMPLETE\"] = 37143] = \"SYNC_GPU_COMMANDS_COMPLETE\";\n    GL[GL[\"UNSIGNALED\"] = 37144] = \"UNSIGNALED\";\n    GL[GL[\"SIGNALED\"] = 37145] = \"SIGNALED\";\n    GL[GL[\"ALREADY_SIGNALED\"] = 37146] = \"ALREADY_SIGNALED\";\n    GL[GL[\"TIMEOUT_EXPIRED\"] = 37147] = \"TIMEOUT_EXPIRED\";\n    GL[GL[\"CONDITION_SATISFIED\"] = 37148] = \"CONDITION_SATISFIED\";\n    GL[GL[\"WAIT_FAILED\"] = 37149] = \"WAIT_FAILED\";\n    GL[GL[\"SYNC_FLUSH_COMMANDS_BIT\"] = 1] = \"SYNC_FLUSH_COMMANDS_BIT\";\n    // Miscellaneous constants\n    GL[GL[\"COLOR\"] = 6144] = \"COLOR\";\n    GL[GL[\"DEPTH\"] = 6145] = \"DEPTH\";\n    GL[GL[\"STENCIL\"] = 6146] = \"STENCIL\";\n    GL[GL[\"MIN\"] = 32775] = \"MIN\";\n    GL[GL[\"MAX\"] = 32776] = \"MAX\";\n    GL[GL[\"DEPTH_COMPONENT24\"] = 33190] = \"DEPTH_COMPONENT24\";\n    GL[GL[\"STREAM_READ\"] = 35041] = \"STREAM_READ\";\n    GL[GL[\"STREAM_COPY\"] = 35042] = \"STREAM_COPY\";\n    GL[GL[\"STATIC_READ\"] = 35045] = \"STATIC_READ\";\n    GL[GL[\"STATIC_COPY\"] = 35046] = \"STATIC_COPY\";\n    GL[GL[\"DYNAMIC_READ\"] = 35049] = \"DYNAMIC_READ\";\n    GL[GL[\"DYNAMIC_COPY\"] = 35050] = \"DYNAMIC_COPY\";\n    GL[GL[\"DEPTH_COMPONENT32F\"] = 36012] = \"DEPTH_COMPONENT32F\";\n    GL[GL[\"DEPTH32F_STENCIL8\"] = 36013] = \"DEPTH32F_STENCIL8\";\n    GL[GL[\"INVALID_INDEX\"] = 4294967295] = \"INVALID_INDEX\";\n    GL[GL[\"TIMEOUT_IGNORED\"] = -1] = \"TIMEOUT_IGNORED\";\n    GL[GL[\"MAX_CLIENT_WAIT_TIMEOUT_WEBGL\"] = 37447] = \"MAX_CLIENT_WAIT_TIMEOUT_WEBGL\";\n    // Constants defined in WebGL extensions\n    // ANGLE_instanced_arrays\n    GL[GL[\"VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE\"] = 35070] = \"VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE\";\n    // WEBGL_debug_renderer_info\n    GL[GL[\"UNMASKED_VENDOR_WEBGL\"] = 37445] = \"UNMASKED_VENDOR_WEBGL\";\n    GL[GL[\"UNMASKED_RENDERER_WEBGL\"] = 37446] = \"UNMASKED_RENDERER_WEBGL\";\n    // EXT_texture_filter_anisotropic\n    GL[GL[\"MAX_TEXTURE_MAX_ANISOTROPY_EXT\"] = 34047] = \"MAX_TEXTURE_MAX_ANISOTROPY_EXT\";\n    GL[GL[\"TEXTURE_MAX_ANISOTROPY_EXT\"] = 34046] = \"TEXTURE_MAX_ANISOTROPY_EXT\";\n    // WEBGL_compressed_texture_s3tc\n    GL[GL[\"COMPRESSED_RGB_S3TC_DXT1_EXT\"] = 33776] = \"COMPRESSED_RGB_S3TC_DXT1_EXT\";\n    GL[GL[\"COMPRESSED_RGBA_S3TC_DXT1_EXT\"] = 33777] = \"COMPRESSED_RGBA_S3TC_DXT1_EXT\";\n    GL[GL[\"COMPRESSED_RGBA_S3TC_DXT3_EXT\"] = 33778] = \"COMPRESSED_RGBA_S3TC_DXT3_EXT\";\n    GL[GL[\"COMPRESSED_RGBA_S3TC_DXT5_EXT\"] = 33779] = \"COMPRESSED_RGBA_S3TC_DXT5_EXT\";\n    // WEBGL_compressed_texture_es3\n    GL[GL[\"COMPRESSED_R11_EAC\"] = 37488] = \"COMPRESSED_R11_EAC\";\n    GL[GL[\"COMPRESSED_SIGNED_R11_EAC\"] = 37489] = \"COMPRESSED_SIGNED_R11_EAC\";\n    GL[GL[\"COMPRESSED_RG11_EAC\"] = 37490] = \"COMPRESSED_RG11_EAC\";\n    GL[GL[\"COMPRESSED_SIGNED_RG11_EAC\"] = 37491] = \"COMPRESSED_SIGNED_RG11_EAC\";\n    GL[GL[\"COMPRESSED_RGB8_ETC2\"] = 37492] = \"COMPRESSED_RGB8_ETC2\";\n    GL[GL[\"COMPRESSED_RGBA8_ETC2_EAC\"] = 37493] = \"COMPRESSED_RGBA8_ETC2_EAC\";\n    GL[GL[\"COMPRESSED_SRGB8_ETC2\"] = 37494] = \"COMPRESSED_SRGB8_ETC2\";\n    GL[GL[\"COMPRESSED_SRGB8_ALPHA8_ETC2_EAC\"] = 37495] = \"COMPRESSED_SRGB8_ALPHA8_ETC2_EAC\";\n    GL[GL[\"COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2\"] = 37496] = \"COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2\";\n    GL[GL[\"COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2\"] = 37497] = \"COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2\";\n    // WEBGL_compressed_texture_pvrtc\n    GL[GL[\"COMPRESSED_RGB_PVRTC_4BPPV1_IMG\"] = 35840] = \"COMPRESSED_RGB_PVRTC_4BPPV1_IMG\";\n    GL[GL[\"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\"] = 35842] = \"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\";\n    GL[GL[\"COMPRESSED_RGB_PVRTC_2BPPV1_IMG\"] = 35841] = \"COMPRESSED_RGB_PVRTC_2BPPV1_IMG\";\n    GL[GL[\"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\"] = 35843] = \"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\";\n    // WEBGL_compressed_texture_etc1\n    GL[GL[\"COMPRESSED_RGB_ETC1_WEBGL\"] = 36196] = \"COMPRESSED_RGB_ETC1_WEBGL\";\n    // WEBGL_compressed_texture_atc\n    GL[GL[\"COMPRESSED_RGB_ATC_WEBGL\"] = 35986] = \"COMPRESSED_RGB_ATC_WEBGL\";\n    GL[GL[\"COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL\"] = 35986] = \"COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL\";\n    GL[GL[\"COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL\"] = 34798] = \"COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL\";\n    // WEBGL_depth_texture\n    GL[GL[\"UNSIGNED_INT_24_8_WEBGL\"] = 34042] = \"UNSIGNED_INT_24_8_WEBGL\";\n    // OES_texture_half_float\n    GL[GL[\"HALF_FLOAT_OES\"] = 36193] = \"HALF_FLOAT_OES\";\n    // WEBGL_color_buffer_float\n    GL[GL[\"RGBA32F_EXT\"] = 34836] = \"RGBA32F_EXT\";\n    GL[GL[\"RGB32F_EXT\"] = 34837] = \"RGB32F_EXT\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT\"] = 33297] = \"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT\";\n    GL[GL[\"UNSIGNED_NORMALIZED_EXT\"] = 35863] = \"UNSIGNED_NORMALIZED_EXT\";\n    // EXT_blend_minmax\n    GL[GL[\"MIN_EXT\"] = 32775] = \"MIN_EXT\";\n    GL[GL[\"MAX_EXT\"] = 32776] = \"MAX_EXT\";\n    // EXT_sRGB\n    GL[GL[\"SRGB_EXT\"] = 35904] = \"SRGB_EXT\";\n    GL[GL[\"SRGB_ALPHA_EXT\"] = 35906] = \"SRGB_ALPHA_EXT\";\n    GL[GL[\"SRGB8_ALPHA8_EXT\"] = 35907] = \"SRGB8_ALPHA8_EXT\";\n    GL[GL[\"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT\"] = 33296] = \"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT\";\n    // OES_standard_derivatives\n    GL[GL[\"FRAGMENT_SHADER_DERIVATIVE_HINT_OES\"] = 35723] = \"FRAGMENT_SHADER_DERIVATIVE_HINT_OES\";\n    // WEBGL_draw_buffers\n    GL[GL[\"COLOR_ATTACHMENT0_WEBGL\"] = 36064] = \"COLOR_ATTACHMENT0_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT1_WEBGL\"] = 36065] = \"COLOR_ATTACHMENT1_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT2_WEBGL\"] = 36066] = \"COLOR_ATTACHMENT2_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT3_WEBGL\"] = 36067] = \"COLOR_ATTACHMENT3_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT4_WEBGL\"] = 36068] = \"COLOR_ATTACHMENT4_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT5_WEBGL\"] = 36069] = \"COLOR_ATTACHMENT5_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT6_WEBGL\"] = 36070] = \"COLOR_ATTACHMENT6_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT7_WEBGL\"] = 36071] = \"COLOR_ATTACHMENT7_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT8_WEBGL\"] = 36072] = \"COLOR_ATTACHMENT8_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT9_WEBGL\"] = 36073] = \"COLOR_ATTACHMENT9_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT10_WEBGL\"] = 36074] = \"COLOR_ATTACHMENT10_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT11_WEBGL\"] = 36075] = \"COLOR_ATTACHMENT11_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT12_WEBGL\"] = 36076] = \"COLOR_ATTACHMENT12_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT13_WEBGL\"] = 36077] = \"COLOR_ATTACHMENT13_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT14_WEBGL\"] = 36078] = \"COLOR_ATTACHMENT14_WEBGL\";\n    GL[GL[\"COLOR_ATTACHMENT15_WEBGL\"] = 36079] = \"COLOR_ATTACHMENT15_WEBGL\";\n    GL[GL[\"DRAW_BUFFER0_WEBGL\"] = 34853] = \"DRAW_BUFFER0_WEBGL\";\n    GL[GL[\"DRAW_BUFFER1_WEBGL\"] = 34854] = \"DRAW_BUFFER1_WEBGL\";\n    GL[GL[\"DRAW_BUFFER2_WEBGL\"] = 34855] = \"DRAW_BUFFER2_WEBGL\";\n    GL[GL[\"DRAW_BUFFER3_WEBGL\"] = 34856] = \"DRAW_BUFFER3_WEBGL\";\n    GL[GL[\"DRAW_BUFFER4_WEBGL\"] = 34857] = \"DRAW_BUFFER4_WEBGL\";\n    GL[GL[\"DRAW_BUFFER5_WEBGL\"] = 34858] = \"DRAW_BUFFER5_WEBGL\";\n    GL[GL[\"DRAW_BUFFER6_WEBGL\"] = 34859] = \"DRAW_BUFFER6_WEBGL\";\n    GL[GL[\"DRAW_BUFFER7_WEBGL\"] = 34860] = \"DRAW_BUFFER7_WEBGL\";\n    GL[GL[\"DRAW_BUFFER8_WEBGL\"] = 34861] = \"DRAW_BUFFER8_WEBGL\";\n    GL[GL[\"DRAW_BUFFER9_WEBGL\"] = 34862] = \"DRAW_BUFFER9_WEBGL\";\n    GL[GL[\"DRAW_BUFFER10_WEBGL\"] = 34863] = \"DRAW_BUFFER10_WEBGL\";\n    GL[GL[\"DRAW_BUFFER11_WEBGL\"] = 34864] = \"DRAW_BUFFER11_WEBGL\";\n    GL[GL[\"DRAW_BUFFER12_WEBGL\"] = 34865] = \"DRAW_BUFFER12_WEBGL\";\n    GL[GL[\"DRAW_BUFFER13_WEBGL\"] = 34866] = \"DRAW_BUFFER13_WEBGL\";\n    GL[GL[\"DRAW_BUFFER14_WEBGL\"] = 34867] = \"DRAW_BUFFER14_WEBGL\";\n    GL[GL[\"DRAW_BUFFER15_WEBGL\"] = 34868] = \"DRAW_BUFFER15_WEBGL\";\n    GL[GL[\"MAX_COLOR_ATTACHMENTS_WEBGL\"] = 36063] = \"MAX_COLOR_ATTACHMENTS_WEBGL\";\n    GL[GL[\"MAX_DRAW_BUFFERS_WEBGL\"] = 34852] = \"MAX_DRAW_BUFFERS_WEBGL\";\n    // OES_vertex_array_object\n    GL[GL[\"VERTEX_ARRAY_BINDING_OES\"] = 34229] = \"VERTEX_ARRAY_BINDING_OES\";\n    // EXT_disjoint_timer_query\n    GL[GL[\"QUERY_COUNTER_BITS_EXT\"] = 34916] = \"QUERY_COUNTER_BITS_EXT\";\n    GL[GL[\"CURRENT_QUERY_EXT\"] = 34917] = \"CURRENT_QUERY_EXT\";\n    GL[GL[\"QUERY_RESULT_EXT\"] = 34918] = \"QUERY_RESULT_EXT\";\n    GL[GL[\"QUERY_RESULT_AVAILABLE_EXT\"] = 34919] = \"QUERY_RESULT_AVAILABLE_EXT\";\n    GL[GL[\"TIME_ELAPSED_EXT\"] = 35007] = \"TIME_ELAPSED_EXT\";\n    GL[GL[\"TIMESTAMP_EXT\"] = 36392] = \"TIMESTAMP_EXT\";\n    GL[GL[\"GPU_DISJOINT_EXT\"] = 36795] = \"GPU_DISJOINT_EXT\";\n})(GL || (GL = {}));\n\nvar ResourceType;\n(function (ResourceType) {\n    ResourceType[ResourceType[\"Buffer\"] = 0] = \"Buffer\";\n    ResourceType[ResourceType[\"Texture\"] = 1] = \"Texture\";\n    ResourceType[ResourceType[\"RenderTarget\"] = 2] = \"RenderTarget\";\n    ResourceType[ResourceType[\"Sampler\"] = 3] = \"Sampler\";\n    ResourceType[ResourceType[\"Program\"] = 4] = \"Program\";\n    ResourceType[ResourceType[\"Bindings\"] = 5] = \"Bindings\";\n    ResourceType[ResourceType[\"InputLayout\"] = 6] = \"InputLayout\";\n    ResourceType[ResourceType[\"RenderPipeline\"] = 7] = \"RenderPipeline\";\n    ResourceType[ResourceType[\"ComputePipeline\"] = 8] = \"ComputePipeline\";\n    ResourceType[ResourceType[\"Readback\"] = 9] = \"Readback\";\n    ResourceType[ResourceType[\"QueryPool\"] = 10] = \"QueryPool\";\n    ResourceType[ResourceType[\"RenderBundle\"] = 11] = \"RenderBundle\";\n})(ResourceType || (ResourceType = {}));\nvar CompareFunction;\n(function (CompareFunction) {\n    CompareFunction[CompareFunction[\"NEVER\"] = 512] = \"NEVER\";\n    CompareFunction[CompareFunction[\"LESS\"] = 513] = \"LESS\";\n    CompareFunction[CompareFunction[\"EQUAL\"] = 514] = \"EQUAL\";\n    CompareFunction[CompareFunction[\"LEQUAL\"] = 515] = \"LEQUAL\";\n    CompareFunction[CompareFunction[\"GREATER\"] = 516] = \"GREATER\";\n    CompareFunction[CompareFunction[\"NOTEQUAL\"] = 517] = \"NOTEQUAL\";\n    CompareFunction[CompareFunction[\"GEQUAL\"] = 518] = \"GEQUAL\";\n    CompareFunction[CompareFunction[\"ALWAYS\"] = 519] = \"ALWAYS\";\n})(CompareFunction || (CompareFunction = {}));\nvar FrontFace;\n(function (FrontFace) {\n    FrontFace[FrontFace[\"CCW\"] = 2305] = \"CCW\";\n    FrontFace[FrontFace[\"CW\"] = 2304] = \"CW\";\n})(FrontFace || (FrontFace = {}));\nvar CullMode;\n(function (CullMode) {\n    CullMode[CullMode[\"NONE\"] = 0] = \"NONE\";\n    CullMode[CullMode[\"FRONT\"] = 1] = \"FRONT\";\n    CullMode[CullMode[\"BACK\"] = 2] = \"BACK\";\n    CullMode[CullMode[\"FRONT_AND_BACK\"] = 3] = \"FRONT_AND_BACK\";\n})(CullMode || (CullMode = {}));\n/**\n * Blend factor RGBA components.\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpublendfactor\n */\nvar BlendFactor;\n(function (BlendFactor) {\n    /**\n     * (0, 0, 0, 0)\n     */\n    BlendFactor[BlendFactor[\"ZERO\"] = 0] = \"ZERO\";\n    /**\n     * (1, 1, 1, 1)\n     */\n    BlendFactor[BlendFactor[\"ONE\"] = 1] = \"ONE\";\n    /**\n     * (Rsrc, Gsrc, Bsrc, Asrc)\n     */\n    BlendFactor[BlendFactor[\"SRC\"] = 768] = \"SRC\";\n    /**\n     * (1 - Rsrc, 1 - Gsrc, 1 - Bsrc, 1 - Asrc)\n     */\n    BlendFactor[BlendFactor[\"ONE_MINUS_SRC\"] = 769] = \"ONE_MINUS_SRC\";\n    /**\n     * (Rdst, Gdst, Bdst, Adst)\n     */\n    BlendFactor[BlendFactor[\"DST\"] = 774] = \"DST\";\n    /**\n     * (1 - Rdst, 1 - Gdst, 1 - Bdst, 1 - Adst)\n     */\n    BlendFactor[BlendFactor[\"ONE_MINUS_DST\"] = 775] = \"ONE_MINUS_DST\";\n    /**\n     * (Asrc, Asrc, Asrc, Asrc)\n     */\n    BlendFactor[BlendFactor[\"SRC_ALPHA\"] = 770] = \"SRC_ALPHA\";\n    /**\n     * (1 - Asrc, 1 - Asrc, 1 - Asrc, 1 - Asrc)\n     */\n    BlendFactor[BlendFactor[\"ONE_MINUS_SRC_ALPHA\"] = 771] = \"ONE_MINUS_SRC_ALPHA\";\n    /**\n     * (Adst, Adst, Adst, Adst)\n     */\n    BlendFactor[BlendFactor[\"DST_ALPHA\"] = 772] = \"DST_ALPHA\";\n    /**\n     * (1 - Adst, 1 - Adst, 1 - Adst, 1 - Adst)\n     */\n    BlendFactor[BlendFactor[\"ONE_MINUS_DST_ALPHA\"] = 773] = \"ONE_MINUS_DST_ALPHA\";\n    /**\n     * (Rconst, Gconst, Bconst, Aconst)\n     */\n    BlendFactor[BlendFactor[\"CONST\"] = 32769] = \"CONST\";\n    /**\n     * (1 - Rconst, 1 - Gconst, 1 - Bconst, 1 - Aconst)\n     */\n    BlendFactor[BlendFactor[\"ONE_MINUS_CONSTANT\"] = 32770] = \"ONE_MINUS_CONSTANT\";\n    /**\n     * (min(Asrc, 1 - Adst), min(Asrc, 1 - Adst), min(Asrc, 1 - Adst), 1)\n     */\n    BlendFactor[BlendFactor[\"SRC_ALPHA_SATURATE\"] = 776] = \"SRC_ALPHA_SATURATE\";\n})(BlendFactor || (BlendFactor = {}));\n/**\n * Defines the algorithm used to combine source and destination blend factors.\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpublendoperation\n */\nvar BlendMode;\n(function (BlendMode) {\n    /**\n     * RGBAsrc × RGBAsrcFactor + RGBAdst × RGBAdstFactor\n     */\n    BlendMode[BlendMode[\"ADD\"] = 32774] = \"ADD\";\n    /**\n     * RGBAsrc × RGBAsrcFactor - RGBAdst × RGBAdstFactor\n     */\n    BlendMode[BlendMode[\"SUBSTRACT\"] = 32778] = \"SUBSTRACT\";\n    /**\n     * RGBAdst × RGBAdstFactor - RGBAsrc × RGBAsrcFactor\n     */\n    BlendMode[BlendMode[\"REVERSE_SUBSTRACT\"] = 32779] = \"REVERSE_SUBSTRACT\";\n    // TODO: WebGL 1 should use ext\n    // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/blendEquation#parameters\n    /**\n     * min(RGBAsrc, RGBAdst)\n     */\n    BlendMode[BlendMode[\"MIN\"] = 32775] = \"MIN\";\n    /**\n     * max(RGBAsrc, RGBAdst)\n     */\n    BlendMode[BlendMode[\"MAX\"] = 32776] = \"MAX\";\n})(BlendMode || (BlendMode = {}));\nvar AddressMode;\n(function (AddressMode) {\n    AddressMode[AddressMode[\"CLAMP_TO_EDGE\"] = 0] = \"CLAMP_TO_EDGE\";\n    AddressMode[AddressMode[\"REPEAT\"] = 1] = \"REPEAT\";\n    AddressMode[AddressMode[\"MIRRORED_REPEAT\"] = 2] = \"MIRRORED_REPEAT\";\n})(AddressMode || (AddressMode = {}));\nvar FilterMode;\n(function (FilterMode) {\n    FilterMode[FilterMode[\"POINT\"] = 0] = \"POINT\";\n    FilterMode[FilterMode[\"BILINEAR\"] = 1] = \"BILINEAR\";\n})(FilterMode || (FilterMode = {}));\nvar MipmapFilterMode;\n(function (MipmapFilterMode) {\n    MipmapFilterMode[MipmapFilterMode[\"NO_MIP\"] = 0] = \"NO_MIP\";\n    MipmapFilterMode[MipmapFilterMode[\"NEAREST\"] = 1] = \"NEAREST\";\n    MipmapFilterMode[MipmapFilterMode[\"LINEAR\"] = 2] = \"LINEAR\";\n})(MipmapFilterMode || (MipmapFilterMode = {}));\nvar PrimitiveTopology;\n(function (PrimitiveTopology) {\n    PrimitiveTopology[PrimitiveTopology[\"POINTS\"] = 0] = \"POINTS\";\n    PrimitiveTopology[PrimitiveTopology[\"TRIANGLES\"] = 1] = \"TRIANGLES\";\n    PrimitiveTopology[PrimitiveTopology[\"TRIANGLE_STRIP\"] = 2] = \"TRIANGLE_STRIP\";\n    PrimitiveTopology[PrimitiveTopology[\"LINES\"] = 3] = \"LINES\";\n    PrimitiveTopology[PrimitiveTopology[\"LINE_STRIP\"] = 4] = \"LINE_STRIP\";\n})(PrimitiveTopology || (PrimitiveTopology = {}));\n/**\n * @see https://www.w3.org/TR/webgpu/#buffer-usage\n */\nvar BufferUsage;\n(function (BufferUsage) {\n    BufferUsage[BufferUsage[\"MAP_READ\"] = 1] = \"MAP_READ\";\n    BufferUsage[BufferUsage[\"MAP_WRITE\"] = 2] = \"MAP_WRITE\";\n    BufferUsage[BufferUsage[\"COPY_SRC\"] = 4] = \"COPY_SRC\";\n    BufferUsage[BufferUsage[\"COPY_DST\"] = 8] = \"COPY_DST\";\n    BufferUsage[BufferUsage[\"INDEX\"] = 16] = \"INDEX\";\n    BufferUsage[BufferUsage[\"VERTEX\"] = 32] = \"VERTEX\";\n    BufferUsage[BufferUsage[\"UNIFORM\"] = 64] = \"UNIFORM\";\n    BufferUsage[BufferUsage[\"STORAGE\"] = 128] = \"STORAGE\";\n    BufferUsage[BufferUsage[\"INDIRECT\"] = 256] = \"INDIRECT\";\n    BufferUsage[BufferUsage[\"QUERY_RESOLVE\"] = 512] = \"QUERY_RESOLVE\";\n})(BufferUsage || (BufferUsage = {}));\nvar BufferFrequencyHint;\n(function (BufferFrequencyHint) {\n    BufferFrequencyHint[BufferFrequencyHint[\"STATIC\"] = 1] = \"STATIC\";\n    BufferFrequencyHint[BufferFrequencyHint[\"DYNAMIC\"] = 2] = \"DYNAMIC\";\n})(BufferFrequencyHint || (BufferFrequencyHint = {}));\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpuvertexstepmode\n */\nvar VertexStepMode;\n(function (VertexStepMode) {\n    VertexStepMode[VertexStepMode[\"VERTEX\"] = 1] = \"VERTEX\";\n    VertexStepMode[VertexStepMode[\"INSTANCE\"] = 2] = \"INSTANCE\";\n})(VertexStepMode || (VertexStepMode = {}));\nvar TextureEvent;\n(function (TextureEvent) {\n    TextureEvent[\"LOADED\"] = \"loaded\";\n})(TextureEvent || (TextureEvent = {}));\nvar TextureDimension;\n(function (TextureDimension) {\n    TextureDimension[TextureDimension[\"TEXTURE_2D\"] = 0] = \"TEXTURE_2D\";\n    TextureDimension[TextureDimension[\"TEXTURE_2D_ARRAY\"] = 1] = \"TEXTURE_2D_ARRAY\";\n    TextureDimension[TextureDimension[\"TEXTURE_3D\"] = 2] = \"TEXTURE_3D\";\n    TextureDimension[TextureDimension[\"TEXTURE_CUBE_MAP\"] = 3] = \"TEXTURE_CUBE_MAP\";\n})(TextureDimension || (TextureDimension = {}));\nvar TextureUsage;\n(function (TextureUsage) {\n    TextureUsage[TextureUsage[\"SAMPLED\"] = 1] = \"SAMPLED\";\n    TextureUsage[TextureUsage[\"RENDER_TARGET\"] = 2] = \"RENDER_TARGET\";\n    TextureUsage[TextureUsage[\"STORAGE\"] = 4] = \"STORAGE\";\n})(TextureUsage || (TextureUsage = {}));\nvar ChannelWriteMask;\n(function (ChannelWriteMask) {\n    ChannelWriteMask[ChannelWriteMask[\"NONE\"] = 0] = \"NONE\";\n    ChannelWriteMask[ChannelWriteMask[\"RED\"] = 1] = \"RED\";\n    ChannelWriteMask[ChannelWriteMask[\"GREEN\"] = 2] = \"GREEN\";\n    ChannelWriteMask[ChannelWriteMask[\"BLUE\"] = 4] = \"BLUE\";\n    ChannelWriteMask[ChannelWriteMask[\"ALPHA\"] = 8] = \"ALPHA\";\n    ChannelWriteMask[ChannelWriteMask[\"RGB\"] = 7] = \"RGB\";\n    ChannelWriteMask[ChannelWriteMask[\"ALL\"] = 15] = \"ALL\";\n})(ChannelWriteMask || (ChannelWriteMask = {}));\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpustenciloperation\n */\nvar StencilOp;\n(function (StencilOp) {\n    StencilOp[StencilOp[\"KEEP\"] = 7680] = \"KEEP\";\n    StencilOp[StencilOp[\"ZERO\"] = 0] = \"ZERO\";\n    StencilOp[StencilOp[\"REPLACE\"] = 7681] = \"REPLACE\";\n    StencilOp[StencilOp[\"INVERT\"] = 5386] = \"INVERT\";\n    StencilOp[StencilOp[\"INCREMENT_CLAMP\"] = 7682] = \"INCREMENT_CLAMP\";\n    StencilOp[StencilOp[\"DECREMENT_CLAMP\"] = 7683] = \"DECREMENT_CLAMP\";\n    StencilOp[StencilOp[\"INCREMENT_WRAP\"] = 34055] = \"INCREMENT_WRAP\";\n    StencilOp[StencilOp[\"DECREMENT_WRAP\"] = 34056] = \"DECREMENT_WRAP\";\n})(StencilOp || (StencilOp = {}));\nfunction makeTextureDescriptor2D(format, width, height, mipLevelCount) {\n    var dimension = TextureDimension.TEXTURE_2D;\n    var depthOrArrayLayers = 1;\n    var usage = TextureUsage.SAMPLED;\n    return {\n        dimension: dimension,\n        format: format,\n        width: width,\n        height: height,\n        depthOrArrayLayers: depthOrArrayLayers,\n        mipLevelCount: mipLevelCount,\n        usage: usage,\n    };\n}\nvar SamplerFormatKind;\n(function (SamplerFormatKind) {\n    SamplerFormatKind[SamplerFormatKind[\"Float\"] = 0] = \"Float\";\n    SamplerFormatKind[SamplerFormatKind[\"UnfilterableFloat\"] = 1] = \"UnfilterableFloat\";\n    SamplerFormatKind[SamplerFormatKind[\"Uint\"] = 2] = \"Uint\";\n    SamplerFormatKind[SamplerFormatKind[\"Sint\"] = 3] = \"Sint\";\n    SamplerFormatKind[SamplerFormatKind[\"Depth\"] = 4] = \"Depth\";\n})(SamplerFormatKind || (SamplerFormatKind = {}));\nvar ViewportOrigin;\n(function (ViewportOrigin) {\n    ViewportOrigin[ViewportOrigin[\"LOWER_LEFT\"] = 0] = \"LOWER_LEFT\";\n    ViewportOrigin[ViewportOrigin[\"UPPER_LEFT\"] = 1] = \"UPPER_LEFT\";\n})(ViewportOrigin || (ViewportOrigin = {}));\nvar ClipSpaceNearZ;\n(function (ClipSpaceNearZ) {\n    ClipSpaceNearZ[ClipSpaceNearZ[\"NEGATIVE_ONE\"] = 0] = \"NEGATIVE_ONE\";\n    ClipSpaceNearZ[ClipSpaceNearZ[\"ZERO\"] = 1] = \"ZERO\";\n})(ClipSpaceNearZ || (ClipSpaceNearZ = {}));\nvar QueryPoolType;\n(function (QueryPoolType) {\n    QueryPoolType[QueryPoolType[\"OcclusionConservative\"] = 0] = \"OcclusionConservative\";\n})(QueryPoolType || (QueryPoolType = {}));\n\nvar FormatTypeFlags;\n(function (FormatTypeFlags) {\n    FormatTypeFlags[FormatTypeFlags[\"U8\"] = 1] = \"U8\";\n    FormatTypeFlags[FormatTypeFlags[\"U16\"] = 2] = \"U16\";\n    FormatTypeFlags[FormatTypeFlags[\"U32\"] = 3] = \"U32\";\n    FormatTypeFlags[FormatTypeFlags[\"S8\"] = 4] = \"S8\";\n    FormatTypeFlags[FormatTypeFlags[\"S16\"] = 5] = \"S16\";\n    FormatTypeFlags[FormatTypeFlags[\"S32\"] = 6] = \"S32\";\n    FormatTypeFlags[FormatTypeFlags[\"F16\"] = 7] = \"F16\";\n    FormatTypeFlags[FormatTypeFlags[\"F32\"] = 8] = \"F32\";\n    // Compressed texture formats.\n    FormatTypeFlags[FormatTypeFlags[\"BC1\"] = 65] = \"BC1\";\n    FormatTypeFlags[FormatTypeFlags[\"BC2\"] = 66] = \"BC2\";\n    FormatTypeFlags[FormatTypeFlags[\"BC3\"] = 67] = \"BC3\";\n    FormatTypeFlags[FormatTypeFlags[\"BC4_UNORM\"] = 68] = \"BC4_UNORM\";\n    FormatTypeFlags[FormatTypeFlags[\"BC4_SNORM\"] = 69] = \"BC4_SNORM\";\n    FormatTypeFlags[FormatTypeFlags[\"BC5_UNORM\"] = 70] = \"BC5_UNORM\";\n    FormatTypeFlags[FormatTypeFlags[\"BC5_SNORM\"] = 71] = \"BC5_SNORM\";\n    // Special-case packed texture formats.\n    FormatTypeFlags[FormatTypeFlags[\"U16_PACKED_5551\"] = 97] = \"U16_PACKED_5551\";\n    FormatTypeFlags[FormatTypeFlags[\"U16_PACKED_565\"] = 98] = \"U16_PACKED_565\";\n    // Depth/stencil texture formats.\n    FormatTypeFlags[FormatTypeFlags[\"D24\"] = 129] = \"D24\";\n    FormatTypeFlags[FormatTypeFlags[\"D32F\"] = 130] = \"D32F\";\n    FormatTypeFlags[FormatTypeFlags[\"D24S8\"] = 131] = \"D24S8\";\n    FormatTypeFlags[FormatTypeFlags[\"D32FS8\"] = 132] = \"D32FS8\";\n})(FormatTypeFlags || (FormatTypeFlags = {}));\nvar FormatCompFlags;\n(function (FormatCompFlags) {\n    FormatCompFlags[FormatCompFlags[\"R\"] = 1] = \"R\";\n    FormatCompFlags[FormatCompFlags[\"RG\"] = 2] = \"RG\";\n    FormatCompFlags[FormatCompFlags[\"RGB\"] = 3] = \"RGB\";\n    FormatCompFlags[FormatCompFlags[\"RGBA\"] = 4] = \"RGBA\";\n    FormatCompFlags[FormatCompFlags[\"A\"] = 5] = \"A\";\n})(FormatCompFlags || (FormatCompFlags = {}));\nfunction getFormatCompFlagsComponentCount(n) {\n    // The number of components is the flag value. Easy.\n    return n;\n}\nvar FormatFlags;\n(function (FormatFlags) {\n    FormatFlags[FormatFlags[\"None\"] = 0] = \"None\";\n    FormatFlags[FormatFlags[\"Normalized\"] = 1] = \"Normalized\";\n    FormatFlags[FormatFlags[\"sRGB\"] = 2] = \"sRGB\";\n    FormatFlags[FormatFlags[\"Depth\"] = 4] = \"Depth\";\n    FormatFlags[FormatFlags[\"Stencil\"] = 8] = \"Stencil\";\n    FormatFlags[FormatFlags[\"RenderTarget\"] = 16] = \"RenderTarget\";\n    FormatFlags[FormatFlags[\"Luminance\"] = 32] = \"Luminance\";\n})(FormatFlags || (FormatFlags = {}));\nfunction makeFormat(type, comp, flags) {\n    return (type << 16) | (comp << 8) | flags;\n}\nvar Format;\n(function (Format) {\n    Format[Format[\"ALPHA\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.A, FormatFlags.None)] = \"ALPHA\";\n    Format[Format[\"U8_LUMINANCE\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.A, FormatFlags.Luminance)] = \"U8_LUMINANCE\";\n    Format[Format[\"F16_LUMINANCE\"] = makeFormat(FormatTypeFlags.F16, FormatCompFlags.A, FormatFlags.Luminance)] = \"F16_LUMINANCE\";\n    Format[Format[\"F32_LUMINANCE\"] = makeFormat(FormatTypeFlags.F32, FormatCompFlags.A, FormatFlags.Luminance)] = \"F32_LUMINANCE\";\n    Format[Format[\"F16_R\"] = makeFormat(FormatTypeFlags.F16, FormatCompFlags.R, FormatFlags.None)] = \"F16_R\";\n    Format[Format[\"F16_RG\"] = makeFormat(FormatTypeFlags.F16, FormatCompFlags.RG, FormatFlags.None)] = \"F16_RG\";\n    Format[Format[\"F16_RGB\"] = makeFormat(FormatTypeFlags.F16, FormatCompFlags.RGB, FormatFlags.None)] = \"F16_RGB\";\n    Format[Format[\"F16_RGBA\"] = makeFormat(FormatTypeFlags.F16, FormatCompFlags.RGBA, FormatFlags.None)] = \"F16_RGBA\";\n    Format[Format[\"F32_R\"] = makeFormat(FormatTypeFlags.F32, FormatCompFlags.R, FormatFlags.None)] = \"F32_R\";\n    Format[Format[\"F32_RG\"] = makeFormat(FormatTypeFlags.F32, FormatCompFlags.RG, FormatFlags.None)] = \"F32_RG\";\n    Format[Format[\"F32_RGB\"] = makeFormat(FormatTypeFlags.F32, FormatCompFlags.RGB, FormatFlags.None)] = \"F32_RGB\";\n    Format[Format[\"F32_RGBA\"] = makeFormat(FormatTypeFlags.F32, FormatCompFlags.RGBA, FormatFlags.None)] = \"F32_RGBA\";\n    Format[Format[\"U8_R\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.R, FormatFlags.None)] = \"U8_R\";\n    Format[Format[\"U8_R_NORM\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.R, FormatFlags.Normalized)] = \"U8_R_NORM\";\n    Format[Format[\"U8_RG\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RG, FormatFlags.None)] = \"U8_RG\";\n    Format[Format[\"U8_RG_NORM\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RG, FormatFlags.Normalized)] = \"U8_RG_NORM\";\n    Format[Format[\"U8_RGB\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGB, FormatFlags.None)] = \"U8_RGB\";\n    Format[Format[\"U8_RGB_NORM\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGB, FormatFlags.Normalized)] = \"U8_RGB_NORM\";\n    Format[Format[\"U8_RGB_SRGB\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGB, FormatFlags.sRGB | FormatFlags.Normalized)] = \"U8_RGB_SRGB\";\n    Format[Format[\"U8_RGBA\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGBA, FormatFlags.None)] = \"U8_RGBA\";\n    Format[Format[\"U8_RGBA_NORM\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"U8_RGBA_NORM\";\n    Format[Format[\"U8_RGBA_SRGB\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGBA, FormatFlags.sRGB | FormatFlags.Normalized)] = \"U8_RGBA_SRGB\";\n    Format[Format[\"U16_R\"] = makeFormat(FormatTypeFlags.U16, FormatCompFlags.R, FormatFlags.None)] = \"U16_R\";\n    Format[Format[\"U16_R_NORM\"] = makeFormat(FormatTypeFlags.U16, FormatCompFlags.R, FormatFlags.Normalized)] = \"U16_R_NORM\";\n    Format[Format[\"U16_RG_NORM\"] = makeFormat(FormatTypeFlags.U16, FormatCompFlags.RG, FormatFlags.Normalized)] = \"U16_RG_NORM\";\n    Format[Format[\"U16_RGBA_NORM\"] = makeFormat(FormatTypeFlags.U16, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"U16_RGBA_NORM\";\n    Format[Format[\"U16_RGBA\"] = makeFormat(FormatTypeFlags.U16, FormatCompFlags.RGBA, FormatFlags.None)] = \"U16_RGBA\";\n    Format[Format[\"U16_RGB\"] = makeFormat(FormatTypeFlags.U16, FormatCompFlags.RGB, FormatFlags.None)] = \"U16_RGB\";\n    Format[Format[\"U16_RG\"] = makeFormat(FormatTypeFlags.U16, FormatCompFlags.RG, FormatFlags.None)] = \"U16_RG\";\n    Format[Format[\"U32_R\"] = makeFormat(FormatTypeFlags.U32, FormatCompFlags.R, FormatFlags.None)] = \"U32_R\";\n    Format[Format[\"U32_RG\"] = makeFormat(FormatTypeFlags.U32, FormatCompFlags.RG, FormatFlags.None)] = \"U32_RG\";\n    Format[Format[\"U32_RGB\"] = makeFormat(FormatTypeFlags.U32, FormatCompFlags.RGB, FormatFlags.None)] = \"U32_RGB\";\n    Format[Format[\"U32_RGBA\"] = makeFormat(FormatTypeFlags.U32, FormatCompFlags.RGBA, FormatFlags.None)] = \"U32_RGBA\";\n    Format[Format[\"S8_R\"] = makeFormat(FormatTypeFlags.S8, FormatCompFlags.R, FormatFlags.None)] = \"S8_R\";\n    Format[Format[\"S8_R_NORM\"] = makeFormat(FormatTypeFlags.S8, FormatCompFlags.R, FormatFlags.Normalized)] = \"S8_R_NORM\";\n    Format[Format[\"S8_RG_NORM\"] = makeFormat(FormatTypeFlags.S8, FormatCompFlags.RG, FormatFlags.Normalized)] = \"S8_RG_NORM\";\n    Format[Format[\"S8_RGB_NORM\"] = makeFormat(FormatTypeFlags.S8, FormatCompFlags.RGB, FormatFlags.Normalized)] = \"S8_RGB_NORM\";\n    Format[Format[\"S8_RGBA_NORM\"] = makeFormat(FormatTypeFlags.S8, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"S8_RGBA_NORM\";\n    Format[Format[\"S16_R\"] = makeFormat(FormatTypeFlags.S16, FormatCompFlags.R, FormatFlags.None)] = \"S16_R\";\n    Format[Format[\"S16_RG\"] = makeFormat(FormatTypeFlags.S16, FormatCompFlags.RG, FormatFlags.None)] = \"S16_RG\";\n    Format[Format[\"S16_RG_NORM\"] = makeFormat(FormatTypeFlags.S16, FormatCompFlags.RG, FormatFlags.Normalized)] = \"S16_RG_NORM\";\n    Format[Format[\"S16_RGB_NORM\"] = makeFormat(FormatTypeFlags.S16, FormatCompFlags.RGB, FormatFlags.Normalized)] = \"S16_RGB_NORM\";\n    Format[Format[\"S16_RGBA\"] = makeFormat(FormatTypeFlags.S16, FormatCompFlags.RGBA, FormatFlags.None)] = \"S16_RGBA\";\n    Format[Format[\"S16_RGBA_NORM\"] = makeFormat(FormatTypeFlags.S16, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"S16_RGBA_NORM\";\n    Format[Format[\"S32_R\"] = makeFormat(FormatTypeFlags.S32, FormatCompFlags.R, FormatFlags.None)] = \"S32_R\";\n    Format[Format[\"S32_RG\"] = makeFormat(FormatTypeFlags.S32, FormatCompFlags.RG, FormatFlags.None)] = \"S32_RG\";\n    Format[Format[\"S32_RGB\"] = makeFormat(FormatTypeFlags.S32, FormatCompFlags.RGB, FormatFlags.None)] = \"S32_RGB\";\n    Format[Format[\"S32_RGBA\"] = makeFormat(FormatTypeFlags.S32, FormatCompFlags.RGBA, FormatFlags.None)] = \"S32_RGBA\";\n    // Packed texture formats.\n    Format[Format[\"U16_RGBA_5551\"] = makeFormat(FormatTypeFlags.U16_PACKED_5551, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"U16_RGBA_5551\";\n    Format[Format[\"U16_RGB_565\"] = makeFormat(FormatTypeFlags.U16_PACKED_565, FormatCompFlags.RGB, FormatFlags.Normalized)] = \"U16_RGB_565\";\n    // Compressed\n    Format[Format[\"BC1\"] = makeFormat(FormatTypeFlags.BC1, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"BC1\";\n    Format[Format[\"BC1_SRGB\"] = makeFormat(FormatTypeFlags.BC1, FormatCompFlags.RGBA, FormatFlags.Normalized | FormatFlags.sRGB)] = \"BC1_SRGB\";\n    Format[Format[\"BC2\"] = makeFormat(FormatTypeFlags.BC2, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"BC2\";\n    Format[Format[\"BC2_SRGB\"] = makeFormat(FormatTypeFlags.BC2, FormatCompFlags.RGBA, FormatFlags.Normalized | FormatFlags.sRGB)] = \"BC2_SRGB\";\n    Format[Format[\"BC3\"] = makeFormat(FormatTypeFlags.BC3, FormatCompFlags.RGBA, FormatFlags.Normalized)] = \"BC3\";\n    Format[Format[\"BC3_SRGB\"] = makeFormat(FormatTypeFlags.BC3, FormatCompFlags.RGBA, FormatFlags.Normalized | FormatFlags.sRGB)] = \"BC3_SRGB\";\n    Format[Format[\"BC4_UNORM\"] = makeFormat(FormatTypeFlags.BC4_UNORM, FormatCompFlags.R, FormatFlags.Normalized)] = \"BC4_UNORM\";\n    Format[Format[\"BC4_SNORM\"] = makeFormat(FormatTypeFlags.BC4_SNORM, FormatCompFlags.R, FormatFlags.Normalized)] = \"BC4_SNORM\";\n    Format[Format[\"BC5_UNORM\"] = makeFormat(FormatTypeFlags.BC5_UNORM, FormatCompFlags.RG, FormatFlags.Normalized)] = \"BC5_UNORM\";\n    Format[Format[\"BC5_SNORM\"] = makeFormat(FormatTypeFlags.BC5_SNORM, FormatCompFlags.RG, FormatFlags.Normalized)] = \"BC5_SNORM\";\n    // Depth/Stencil\n    Format[Format[\"D24\"] = makeFormat(FormatTypeFlags.D24, FormatCompFlags.R, FormatFlags.Depth)] = \"D24\";\n    Format[Format[\"D24_S8\"] = makeFormat(FormatTypeFlags.D24S8, FormatCompFlags.RG, FormatFlags.Depth | FormatFlags.Stencil)] = \"D24_S8\";\n    Format[Format[\"D32F\"] = makeFormat(FormatTypeFlags.D32F, FormatCompFlags.R, FormatFlags.Depth)] = \"D32F\";\n    Format[Format[\"D32F_S8\"] = makeFormat(FormatTypeFlags.D32FS8, FormatCompFlags.RG, FormatFlags.Depth | FormatFlags.Stencil)] = \"D32F_S8\";\n    // Special RT formats for preferred backend support.\n    Format[Format[\"U8_RGB_RT\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGB, FormatFlags.RenderTarget | FormatFlags.Normalized)] = \"U8_RGB_RT\";\n    Format[Format[\"U8_RGBA_RT\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGBA, FormatFlags.RenderTarget | FormatFlags.Normalized)] = \"U8_RGBA_RT\";\n    Format[Format[\"U8_RGBA_RT_SRGB\"] = makeFormat(FormatTypeFlags.U8, FormatCompFlags.RGBA, FormatFlags.RenderTarget | FormatFlags.Normalized | FormatFlags.sRGB)] = \"U8_RGBA_RT_SRGB\";\n})(Format || (Format = {}));\nfunction getFormatCompFlags(fmt) {\n    return (fmt >>> 8) & 0xff;\n}\nfunction getFormatTypeFlags(fmt) {\n    return (fmt >>> 16) & 0xff;\n}\nfunction getFormatFlags(fmt) {\n    return fmt & 0xff;\n}\nfunction getFormatTypeFlagsByteSize(typeFlags) {\n    switch (typeFlags) {\n        case FormatTypeFlags.F32:\n        case FormatTypeFlags.U32:\n        case FormatTypeFlags.S32:\n            return 4;\n        case FormatTypeFlags.U16:\n        case FormatTypeFlags.S16:\n        case FormatTypeFlags.F16:\n            return 2;\n        case FormatTypeFlags.U8:\n        case FormatTypeFlags.S8:\n            return 1;\n        default:\n            throw new Error('whoops');\n    }\n}\n/**\n * Gets the byte size for an individual component.\n * e.g. for F32_RGB, this will return \"4\", since F32 has 4 bytes.\n */\nfunction getFormatCompByteSize(fmt) {\n    return getFormatTypeFlagsByteSize(getFormatTypeFlags(fmt));\n}\nfunction getFormatComponentCount(fmt) {\n    return getFormatCompFlagsComponentCount(getFormatCompFlags(fmt));\n}\nfunction getFormatByteSize(fmt) {\n    var typeByteSize = getFormatTypeFlagsByteSize(getFormatTypeFlags(fmt));\n    var componentCount = getFormatCompFlagsComponentCount(getFormatCompFlags(fmt));\n    return typeByteSize * componentCount;\n}\nfunction setFormatFlags(fmt, flags) {\n    return (fmt & 0xffffff00) | flags;\n}\nfunction setFormatComponentCount(fmt, compFlags) {\n    return (fmt & 0xffff00ff) | (compFlags << 8);\n}\nfunction getFormatSamplerKind(fmt) {\n    var flags = getFormatFlags(fmt);\n    if (flags & FormatFlags.Depth) {\n        return SamplerFormatKind.Depth;\n    }\n    if (flags & FormatFlags.Normalized) {\n        return SamplerFormatKind.Float;\n    }\n    var typeFlags = getFormatTypeFlags(fmt);\n    if (typeFlags === FormatTypeFlags.F16 || typeFlags === FormatTypeFlags.F32) {\n        return SamplerFormatKind.Float;\n    }\n    else if (typeFlags === FormatTypeFlags.U8 ||\n        typeFlags === FormatTypeFlags.U16 ||\n        typeFlags === FormatTypeFlags.U32) {\n        return SamplerFormatKind.Uint;\n    }\n    else if (typeFlags === FormatTypeFlags.S8 ||\n        typeFlags === FormatTypeFlags.S16 ||\n        typeFlags === FormatTypeFlags.S32) {\n        return SamplerFormatKind.Sint;\n    }\n    else {\n        throw new Error('whoops');\n    }\n}\n\nfunction assert(b, message) {\n    if (message === void 0) { message = ''; }\n    if (!b) {\n        // console.error(new Error().stack);\n        throw new Error(\"Assert fail: \".concat(message));\n    }\n}\nfunction assertExists(v) {\n    if (v !== undefined && v !== null)\n        return v;\n    else\n        throw new Error('Missing object');\n}\n\nfunction colorEqual(c0, c1) {\n    return c0.r === c1.r && c0.g === c1.g && c0.b === c1.b && c0.a === c1.a;\n}\nfunction colorCopy(dst, src) {\n    dst.r = src.r;\n    dst.g = src.g;\n    dst.b = src.b;\n    dst.a = src.a;\n}\nfunction colorNewCopy(src) {\n    var r = src.r, g = src.g, b = src.b, a = src.a;\n    return { r: r, g: g, b: b, a: a };\n}\nfunction colorNewFromRGBA(r, g, b, a) {\n    if (a === void 0) { a = 1.0; }\n    return { r: r, g: g, b: b, a: a };\n}\nvar TransparentBlack = colorNewFromRGBA(0, 0, 0, 0);\nvar OpaqueBlack = colorNewFromRGBA(0, 0, 0, 1);\nvar TransparentWhite = colorNewFromRGBA(1, 1, 1, 0);\nvar OpaqueWhite = colorNewFromRGBA(1, 1, 1, 1);\n\n/**\n * @see https://forum.babylonjs.com/t/reverse-depth-buffer-z-buffer/6905/2\n */\nvar IsDepthReversed = true;\nfunction reverseDepthForPerspectiveProjectionMatrix(m, isDepthReversed) {\n    if (isDepthReversed === void 0) { isDepthReversed = IsDepthReversed; }\n    if (isDepthReversed) {\n        m[10] = -m[10];\n        m[14] = -m[14];\n    }\n}\nfunction reverseDepthForOrthographicProjectionMatrix(m, isDepthReversed) {\n    if (isDepthReversed === void 0) { isDepthReversed = IsDepthReversed; }\n    if (isDepthReversed) {\n        m[10] = -m[10];\n        m[14] = -m[14] + 1;\n    }\n}\nfunction reverseDepthForCompareFunction(compareFunction, isDepthReversed) {\n    if (isDepthReversed === void 0) { isDepthReversed = IsDepthReversed; }\n    if (isDepthReversed) {\n        switch (compareFunction) {\n            case CompareFunction.LESS:\n                return CompareFunction.GREATER;\n            case CompareFunction.LEQUAL:\n                return CompareFunction.GEQUAL;\n            case CompareFunction.GEQUAL:\n                return CompareFunction.LEQUAL;\n            case CompareFunction.GREATER:\n                return CompareFunction.LESS;\n            default:\n                return compareFunction;\n        }\n    }\n    else {\n        return compareFunction;\n    }\n}\nfunction reverseDepthForClearValue(n, isDepthReversed) {\n    if (isDepthReversed === void 0) { isDepthReversed = IsDepthReversed; }\n    if (isDepthReversed) {\n        return 1.0 - n;\n    }\n    else {\n        return n;\n    }\n}\nfunction reverseDepthForDepthOffset(n, isDepthReversed) {\n    if (isDepthReversed === void 0) { isDepthReversed = IsDepthReversed; }\n    if (isDepthReversed) {\n        return -n;\n    }\n    else {\n        return n;\n    }\n}\nfunction compareDepthValues(a, b, op, isDepthReversed) {\n    if (isDepthReversed === void 0) { isDepthReversed = IsDepthReversed; }\n    op = reverseDepthForCompareFunction(op, isDepthReversed);\n    if (op === CompareFunction.LESS)\n        return a < b;\n    else if (op === CompareFunction.LEQUAL)\n        return a <= b;\n    else if (op === CompareFunction.GREATER)\n        return a > b;\n    else if (op === CompareFunction.GEQUAL)\n        return a >= b;\n    else\n        throw new Error('whoops');\n}\n\n// import { reverseDepthForCompareFunction } from './depth';\nfunction isPowerOfTwo(n) {\n    return !!(n && (n & (n - 1)) === 0);\n}\nfunction fallbackUndefined(v, fallback) {\n    return v !== null && v !== undefined ? v : fallback;\n}\nfunction nullify(v) {\n    return v === undefined ? null : v;\n}\nfunction fillArray(L, n, v) {\n    L.length = n;\n    L.fill(v);\n}\nfunction align(n, multiple) {\n    var mask = multiple - 1;\n    return (n + mask) & ~mask;\n}\nfunction alignNonPowerOfTwo(n, multiple) {\n    return (((n + multiple - 1) / multiple) | 0) * multiple;\n}\n// @see https://github.com/d3/d3-array#bisectRight\nfunction bisectRight(L, e, compare) {\n    var lo = 0, hi = L.length;\n    while (lo < hi) {\n        var mid = lo + ((hi - lo) >>> 1);\n        var cmp = compare(e, L[mid]);\n        if (cmp < 0)\n            hi = mid;\n        else\n            lo = mid + 1;\n    }\n    return lo;\n}\nfunction spliceBisectRight(L, e, compare) {\n    var idx = bisectRight(L, e, compare);\n    L.splice(idx, 0, e);\n}\nfunction setBitFlagEnabled(v, mask, enabled) {\n    if (enabled)\n        v |= mask;\n    else\n        v &= ~mask;\n    return v;\n}\nfunction nArray(n, c) {\n    var d = new Array(n);\n    for (var i = 0; i < n; i++)\n        d[i] = c();\n    return d;\n}\nfunction prependLineNo(str, lineStart) {\n    if (lineStart === void 0) { lineStart = 1; }\n    var lines = str.split('\\n');\n    return lines\n        .map(function (s, i) { return \"\".concat(leftPad('' + (lineStart + i), 4, ' '), \"  \").concat(s); })\n        .join('\\n');\n}\nfunction leftPad(S, spaces, ch) {\n    if (ch === void 0) { ch = '0'; }\n    while (S.length < spaces)\n        S = \"\".concat(ch).concat(S);\n    return S;\n}\nfunction range(start, count) {\n    var L = [];\n    for (var i = start; i < start + count; i++)\n        L.push(i);\n    return L;\n}\nfunction copyChannelBlendState(dst, src) {\n    dst.blendDstFactor = src.blendDstFactor;\n    dst.blendSrcFactor = src.blendSrcFactor;\n    dst.blendMode = src.blendMode;\n}\nfunction copyStencilFaceState(dst, src) {\n    if (dst === undefined) {\n        dst = {};\n    }\n    dst.compare = src.compare;\n    dst.depthFailOp = src.depthFailOp;\n    dst.passOp = src.passOp;\n    dst.failOp = src.failOp;\n    dst.mask = src.mask;\n    return dst;\n}\nfunction copyAttachmentState(dst, src) {\n    if (dst === undefined) {\n        dst = {\n            rgbBlendState: {},\n            alphaBlendState: {},\n            channelWriteMask: 0,\n        };\n    }\n    copyChannelBlendState(dst.rgbBlendState, src.rgbBlendState);\n    copyChannelBlendState(dst.alphaBlendState, src.alphaBlendState);\n    dst.channelWriteMask = src.channelWriteMask;\n    return dst;\n}\nfunction copyAttachmentsState(dst, src) {\n    if (dst.length !== src.length)\n        dst.length = src.length;\n    for (var i = 0; i < src.length; i++)\n        dst[i] = copyAttachmentState(dst[i], src[i]);\n}\nfunction setMegaStateFlags(dst, src) {\n    if (src.attachmentsState !== undefined) {\n        copyAttachmentsState(dst.attachmentsState, src.attachmentsState);\n    }\n    if (dst.blendConstant && src.blendConstant) {\n        colorCopy(dst.blendConstant, src.blendConstant);\n    }\n    dst.depthCompare = fallbackUndefined(src.depthCompare, dst.depthCompare);\n    dst.depthWrite = fallbackUndefined(src.depthWrite, dst.depthWrite);\n    dst.stencilWrite = fallbackUndefined(src.stencilWrite, dst.stencilWrite);\n    if (dst.stencilFront && src.stencilFront) {\n        copyStencilFaceState(dst.stencilFront, src.stencilFront);\n    }\n    if (dst.stencilBack && src.stencilBack) {\n        copyStencilFaceState(dst.stencilBack, src.stencilBack);\n    }\n    dst.cullMode = fallbackUndefined(src.cullMode, dst.cullMode);\n    dst.frontFace = fallbackUndefined(src.frontFace, dst.frontFace);\n    dst.polygonOffset = fallbackUndefined(src.polygonOffset, dst.polygonOffset);\n}\nfunction copyMegaState(src) {\n    var dst = Object.assign({}, src);\n    // Copy fields that need copying.\n    dst.attachmentsState = [];\n    copyAttachmentsState(dst.attachmentsState, src.attachmentsState);\n    dst.blendConstant = dst.blendConstant && colorNewCopy(dst.blendConstant);\n    dst.stencilFront = copyStencilFaceState(undefined, src.stencilFront);\n    dst.stencilBack = copyStencilFaceState(undefined, src.stencilBack);\n    return dst;\n}\nfunction copyAttachmentStateFromSimple(dst, src) {\n    if (src.channelWriteMask !== undefined) {\n        dst.channelWriteMask = src.channelWriteMask;\n    }\n    if (src.rgbBlendMode !== undefined) {\n        dst.rgbBlendState.blendMode = src.rgbBlendMode;\n    }\n    if (src.alphaBlendMode !== undefined) {\n        dst.alphaBlendState.blendMode = src.alphaBlendMode;\n    }\n    if (src.rgbBlendSrcFactor !== undefined) {\n        dst.rgbBlendState.blendSrcFactor = src.rgbBlendSrcFactor;\n    }\n    if (src.alphaBlendSrcFactor !== undefined) {\n        dst.alphaBlendState.blendSrcFactor = src.alphaBlendSrcFactor;\n    }\n    if (src.rgbBlendDstFactor !== undefined) {\n        dst.rgbBlendState.blendDstFactor = src.rgbBlendDstFactor;\n    }\n    if (src.alphaBlendDstFactor !== undefined) {\n        dst.alphaBlendState.blendDstFactor = src.alphaBlendDstFactor;\n    }\n}\nvar defaultBlendState = {\n    blendMode: BlendMode.ADD,\n    blendSrcFactor: BlendFactor.ONE,\n    blendDstFactor: BlendFactor.ZERO,\n};\nvar defaultMegaState = {\n    attachmentsState: [\n        {\n            channelWriteMask: ChannelWriteMask.ALL,\n            rgbBlendState: defaultBlendState,\n            alphaBlendState: defaultBlendState,\n        },\n    ],\n    blendConstant: colorNewCopy(TransparentBlack),\n    depthWrite: true,\n    depthCompare: CompareFunction.LEQUAL,\n    stencilWrite: false,\n    stencilFront: {\n        compare: CompareFunction.ALWAYS,\n        passOp: StencilOp.KEEP,\n        depthFailOp: StencilOp.KEEP,\n        failOp: StencilOp.KEEP,\n    },\n    stencilBack: {\n        compare: CompareFunction.ALWAYS,\n        passOp: StencilOp.KEEP,\n        depthFailOp: StencilOp.KEEP,\n        failOp: StencilOp.KEEP,\n    },\n    cullMode: CullMode.NONE,\n    frontFace: FrontFace.CCW,\n    polygonOffset: false,\n};\nfunction makeMegaState(other, src) {\n    if (other === void 0) { other = null; }\n    if (src === void 0) { src = defaultMegaState; }\n    var dst = copyMegaState(src);\n    if (other !== null)\n        setMegaStateFlags(dst, other);\n    return dst;\n}\nvar fullscreenMegaState = makeMegaState({ depthCompare: CompareFunction.ALWAYS, depthWrite: false }, defaultMegaState);\nfunction setAttachmentStateSimple(dst, simple) {\n    if (dst.attachmentsState === undefined) {\n        dst.attachmentsState = [];\n        copyAttachmentsState(dst.attachmentsState, defaultMegaState.attachmentsState);\n    }\n    copyAttachmentStateFromSimple(dst.attachmentsState[0], simple);\n    return dst;\n}\nvar defaultBindingLayoutSamplerDescriptor = {\n    texture: null,\n    sampler: null,\n    formatKind: SamplerFormatKind.Float,\n    dimension: TextureDimension.TEXTURE_2D,\n};\n\nfunction arrayEqual(a, b, e) {\n    if (a.length !== b.length)\n        return false;\n    for (var i = 0; i < a.length; i++)\n        if (!e(a[i], b[i]))\n            return false;\n    return true;\n}\nfunction arrayCopy(a, copyFunc) {\n    var b = Array(a.length);\n    for (var i = 0; i < a.length; i++)\n        b[i] = copyFunc(a[i]);\n    return b;\n}\nfunction textureBindingEquals(a, b) {\n    return a.texture === b.texture && a.binding === b.binding;\n}\nfunction bufferBindingEquals(a, b) {\n    return (a.buffer === b.buffer &&\n        a.size === b.size &&\n        a.binding === b.binding &&\n        a.offset === b.offset);\n}\nfunction samplerBindingEquals(a, b) {\n    if (a === null)\n        return b === null;\n    if (b === null)\n        return false;\n    return (a.sampler === b.sampler &&\n        a.texture === b.texture &&\n        a.dimension === b.dimension &&\n        a.formatKind === b.formatKind &&\n        a.comparison === b.comparison);\n}\nfunction bindingsDescriptorEquals(a, b) {\n    a.samplerBindings = a.samplerBindings || [];\n    a.uniformBufferBindings = a.uniformBufferBindings || [];\n    a.storageBufferBindings = a.storageBufferBindings || [];\n    a.storageTextureBindings = a.storageTextureBindings || [];\n    b.samplerBindings = b.samplerBindings || [];\n    b.uniformBufferBindings = b.uniformBufferBindings || [];\n    b.storageBufferBindings = b.storageBufferBindings || [];\n    b.storageTextureBindings = b.storageTextureBindings || [];\n    if (a.samplerBindings.length !== b.samplerBindings.length)\n        return false;\n    if (!arrayEqual(a.samplerBindings, b.samplerBindings, samplerBindingEquals))\n        return false;\n    if (!arrayEqual(a.uniformBufferBindings, b.uniformBufferBindings, bufferBindingEquals))\n        return false;\n    if (!arrayEqual(a.storageBufferBindings, b.storageBufferBindings, bufferBindingEquals))\n        return false;\n    if (!arrayEqual(a.storageTextureBindings, b.storageTextureBindings, textureBindingEquals))\n        return false;\n    return true;\n}\nfunction channelBlendStateEquals(a, b) {\n    return (a.blendMode == b.blendMode &&\n        a.blendSrcFactor === b.blendSrcFactor &&\n        a.blendDstFactor === b.blendDstFactor);\n}\nfunction attachmentStateEquals(a, b) {\n    if (!channelBlendStateEquals(a.rgbBlendState, b.rgbBlendState))\n        return false;\n    if (!channelBlendStateEquals(a.alphaBlendState, b.alphaBlendState))\n        return false;\n    if (a.channelWriteMask !== b.channelWriteMask)\n        return false;\n    return true;\n}\nfunction stencilFaceStateEquals(a, b) {\n    return (a.compare == b.compare &&\n        a.depthFailOp === b.depthFailOp &&\n        a.failOp === b.failOp &&\n        a.passOp === b.passOp &&\n        a.mask === b.mask);\n}\nfunction megaStateDescriptorEquals(a, b) {\n    if (!arrayEqual(a.attachmentsState, b.attachmentsState, attachmentStateEquals))\n        return false;\n    if (a.blendConstant &&\n        b.blendConstant &&\n        !colorEqual(a.blendConstant, b.blendConstant))\n        return false;\n    if (a.stencilFront &&\n        b.stencilFront &&\n        !stencilFaceStateEquals(a.stencilFront, b.stencilFront))\n        return false;\n    if (a.stencilBack &&\n        b.stencilBack &&\n        !stencilFaceStateEquals(a.stencilBack, b.stencilBack))\n        return false;\n    return (a.depthCompare === b.depthCompare &&\n        a.depthWrite === b.depthWrite &&\n        a.stencilWrite === b.stencilWrite &&\n        a.cullMode === b.cullMode &&\n        a.frontFace === b.frontFace &&\n        a.polygonOffset === b.polygonOffset);\n}\nfunction programEquals(a, b) {\n    return a.id === b.id;\n}\nfunction formatEquals(a, b) {\n    return a === b;\n}\nfunction renderPipelineDescriptorEquals(a, b) {\n    if (a.topology !== b.topology)\n        return false;\n    if (a.inputLayout !== b.inputLayout)\n        return false;\n    if (a.sampleCount !== b.sampleCount)\n        return false;\n    if (a.megaStateDescriptor &&\n        b.megaStateDescriptor &&\n        !megaStateDescriptorEquals(a.megaStateDescriptor, b.megaStateDescriptor))\n        return false;\n    if (!programEquals(a.program, b.program))\n        return false;\n    if (!arrayEqual(a.colorAttachmentFormats, b.colorAttachmentFormats, formatEquals))\n        return false;\n    if (a.depthStencilAttachmentFormat !== b.depthStencilAttachmentFormat)\n        return false;\n    return true;\n}\nfunction vertexAttributeDescriptorEquals(a, b) {\n    return (a.offset === b.offset &&\n        a.shaderLocation === b.shaderLocation &&\n        a.format === b.format &&\n        a.divisor === b.divisor);\n}\nfunction inputLayoutBufferDescriptorEquals(a, b) {\n    if (isNil(a))\n        return isNil(b);\n    if (isNil(b))\n        return false;\n    return (a.arrayStride === b.arrayStride &&\n        a.stepMode === b.stepMode &&\n        arrayEqual(a.attributes, b.attributes, vertexAttributeDescriptorEquals));\n}\nfunction inputLayoutDescriptorEquals(a, b) {\n    if (a.indexBufferFormat !== b.indexBufferFormat)\n        return false;\n    if (!arrayEqual(a.vertexBufferDescriptors, b.vertexBufferDescriptors, inputLayoutBufferDescriptorEquals))\n        return false;\n    if (!programEquals(a.program, b.program))\n        return false;\n    return true;\n}\nfunction samplerDescriptorEquals(a, b) {\n    return (a.addressModeU === b.addressModeU &&\n        a.addressModeV === b.addressModeV &&\n        a.minFilter === b.minFilter &&\n        a.magFilter === b.magFilter &&\n        a.mipmapFilter === b.mipmapFilter &&\n        a.lodMinClamp === b.lodMinClamp &&\n        a.lodMaxClamp === b.lodMaxClamp &&\n        a.maxAnisotropy === b.maxAnisotropy &&\n        a.compareFunction === b.compareFunction);\n}\nfunction samplerBindingCopy(a) {\n    var sampler = a.sampler;\n    var texture = a.texture;\n    var dimension = a.dimension;\n    var formatKind = a.formatKind;\n    var comparison = a.comparison;\n    return { sampler: sampler, texture: texture, dimension: dimension, formatKind: formatKind, comparison: comparison };\n}\nfunction bufferBindingCopy(a) {\n    var buffer = a.buffer;\n    var size = a.size;\n    var binding = a.binding;\n    var offset = a.offset;\n    return { binding: binding, buffer: buffer, offset: offset, size: size };\n}\nfunction textureBindingCopy(a) {\n    var binding = a.binding;\n    var texture = a.texture;\n    return { binding: binding, texture: texture };\n}\nfunction bindingsDescriptorCopy(a) {\n    var samplerBindings = a.samplerBindings && arrayCopy(a.samplerBindings, samplerBindingCopy);\n    var uniformBufferBindings = a.uniformBufferBindings &&\n        arrayCopy(a.uniformBufferBindings, bufferBindingCopy);\n    var storageBufferBindings = a.storageBufferBindings &&\n        arrayCopy(a.storageBufferBindings, bufferBindingCopy);\n    var storageTextureBindings = a.storageTextureBindings &&\n        arrayCopy(a.storageTextureBindings, textureBindingCopy);\n    return {\n        samplerBindings: samplerBindings,\n        uniformBufferBindings: uniformBufferBindings,\n        storageBufferBindings: storageBufferBindings,\n        storageTextureBindings: storageTextureBindings,\n        pipeline: a.pipeline,\n    };\n}\nfunction renderPipelineDescriptorCopy(a) {\n    var inputLayout = a.inputLayout;\n    var program = a.program;\n    var topology = a.topology;\n    var megaStateDescriptor = a.megaStateDescriptor && copyMegaState(a.megaStateDescriptor);\n    var colorAttachmentFormats = a.colorAttachmentFormats.slice();\n    var depthStencilAttachmentFormat = a.depthStencilAttachmentFormat;\n    var sampleCount = a.sampleCount;\n    return {\n        inputLayout: inputLayout,\n        megaStateDescriptor: megaStateDescriptor,\n        program: program,\n        topology: topology,\n        colorAttachmentFormats: colorAttachmentFormats,\n        depthStencilAttachmentFormat: depthStencilAttachmentFormat,\n        sampleCount: sampleCount,\n    };\n}\nfunction vertexAttributeDescriptorCopy(a) {\n    var shaderLocation = a.shaderLocation;\n    var format = a.format;\n    var offset = a.offset;\n    var divisor = a.divisor;\n    return {\n        shaderLocation: shaderLocation,\n        format: format,\n        offset: offset,\n        divisor: divisor,\n    };\n}\nfunction inputLayoutBufferDescriptorCopy(a) {\n    if (!isNil(a)) {\n        var arrayStride = a.arrayStride;\n        var stepMode = a.stepMode;\n        var attributes = arrayCopy(a.attributes, vertexAttributeDescriptorCopy);\n        return { arrayStride: arrayStride, stepMode: stepMode, attributes: attributes };\n    }\n    else {\n        return a;\n    }\n}\nfunction inputLayoutDescriptorCopy(a) {\n    var vertexBufferDescriptors = arrayCopy(a.vertexBufferDescriptors, inputLayoutBufferDescriptorCopy);\n    var indexBufferFormat = a.indexBufferFormat;\n    var program = a.program;\n    return {\n        vertexBufferDescriptors: vertexBufferDescriptors,\n        indexBufferFormat: indexBufferFormat,\n        program: program,\n    };\n}\n\nvar _a;\n// if array name then clean the array brackets\nvar UNIFORM_NAME_REGEXP = /([^[]*)(\\[[0-9]+\\])?/;\nfunction parseUniformName(name) {\n    // Shortcut to avoid redundant or bad matches\n    if (name[name.length - 1] !== ']') {\n        return {\n            name: name,\n            length: 1,\n            isArray: false,\n        };\n    }\n    var matches = name.match(UNIFORM_NAME_REGEXP);\n    if (!matches || matches.length < 2) {\n        throw new Error(\"Failed to parse GLSL uniform name \".concat(name));\n    }\n    return {\n        name: matches[1],\n        length: Number(matches[2]) || 1,\n        isArray: Boolean(matches[2]),\n    };\n}\nfunction getSamplerSetter() {\n    var cache = null;\n    return function (gl, location, \n    // eslint-disable-next-line\n    value) {\n        var update = cache !== value;\n        if (update) {\n            gl.uniform1i(location, value);\n            cache = value;\n        }\n        return update;\n    };\n}\nfunction getArraySetter(functionName, toArray, size, uniformSetter) {\n    var cache = null;\n    var cacheLength = null;\n    // eslint-disable-next-line\n    return function (gl, location, value) {\n        var arrayValue = toArray(value, size);\n        var length = arrayValue.length;\n        var update = false;\n        if (cache === null) {\n            cache = new Float32Array(length);\n            cacheLength = length;\n            update = true;\n        }\n        else {\n            assert(cacheLength === length, 'Uniform length cannot change.');\n            for (var i = 0; i < length; ++i) {\n                if (arrayValue[i] !== cache[i]) {\n                    update = true;\n                    break;\n                }\n            }\n        }\n        if (update) {\n            uniformSetter(gl, functionName, location, arrayValue);\n            cache.set(arrayValue);\n        }\n        return update;\n    };\n}\nfunction setVectorUniform(gl, functionName, location, \n// eslint-disable-next-line\nvalue) {\n    gl[functionName](location, value);\n}\nfunction setMatrixUniform(gl, functionName, location, \n// eslint-disable-next-line\nvalue) {\n    gl[functionName](location, false, value);\n}\nvar FLOAT_ARRAY = {};\nvar INT_ARRAY = {};\nvar UINT_ARRAY = {};\nvar array1 = [0];\nfunction toTypedArray(value, uniformLength, Type, \n// eslint-disable-next-line\ncache) {\n    // convert boolean uniforms to Number\n    if (uniformLength === 1 && typeof value === 'boolean') {\n        value = value ? 1 : 0;\n    }\n    if (Number.isFinite(value)) {\n        array1[0] = value;\n        value = array1;\n    }\n    var length = value.length;\n    if (value instanceof Type) {\n        return value;\n    }\n    var result = cache[length];\n    if (!result) {\n        result = new Type(length);\n        cache[length] = result;\n    }\n    for (var i = 0; i < length; i++) {\n        result[i] = value[i];\n    }\n    return result;\n}\nfunction toFloatArray(value, uniformLength) {\n    return toTypedArray(value, uniformLength, Float32Array, FLOAT_ARRAY);\n}\nfunction toIntArray(value, uniformLength) {\n    return toTypedArray(value, uniformLength, Int32Array, INT_ARRAY);\n}\nfunction toUIntArray(value, uniformLength) {\n    return toTypedArray(value, uniformLength, Uint32Array, UINT_ARRAY);\n}\nvar UNIFORM_SETTERS = (_a = {},\n    // WEBGL1\n    _a[GL.FLOAT] = getArraySetter.bind(null, 'uniform1fv', toFloatArray, 1, setVectorUniform),\n    _a[GL.FLOAT_VEC2] = getArraySetter.bind(null, 'uniform2fv', toFloatArray, 2, setVectorUniform),\n    _a[GL.FLOAT_VEC3] = getArraySetter.bind(null, 'uniform3fv', toFloatArray, 3, setVectorUniform),\n    _a[GL.FLOAT_VEC4] = getArraySetter.bind(null, 'uniform4fv', toFloatArray, 4, setVectorUniform),\n    _a[GL.INT] = getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n    _a[GL.INT_VEC2] = getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n    _a[GL.INT_VEC3] = getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n    _a[GL.INT_VEC4] = getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n    _a[GL.BOOL] = getArraySetter.bind(null, 'uniform1iv', toIntArray, 1, setVectorUniform),\n    _a[GL.BOOL_VEC2] = getArraySetter.bind(null, 'uniform2iv', toIntArray, 2, setVectorUniform),\n    _a[GL.BOOL_VEC3] = getArraySetter.bind(null, 'uniform3iv', toIntArray, 3, setVectorUniform),\n    _a[GL.BOOL_VEC4] = getArraySetter.bind(null, 'uniform4iv', toIntArray, 4, setVectorUniform),\n    // uniformMatrix(false): don't transpose the matrix\n    _a[GL.FLOAT_MAT2] = getArraySetter.bind(null, 'uniformMatrix2fv', toFloatArray, 4, setMatrixUniform),\n    _a[GL.FLOAT_MAT3] = getArraySetter.bind(null, 'uniformMatrix3fv', toFloatArray, 9, setMatrixUniform),\n    _a[GL.FLOAT_MAT4] = getArraySetter.bind(null, 'uniformMatrix4fv', toFloatArray, 16, setMatrixUniform),\n    // WEBGL2 - unsigned integers, irregular matrices, additional texture samplers\n    _a[GL.UNSIGNED_INT] = getArraySetter.bind(null, 'uniform1uiv', toUIntArray, 1, setVectorUniform),\n    _a[GL.UNSIGNED_INT_VEC2] = getArraySetter.bind(null, 'uniform2uiv', toUIntArray, 2, setVectorUniform),\n    _a[GL.UNSIGNED_INT_VEC3] = getArraySetter.bind(null, 'uniform3uiv', toUIntArray, 3, setVectorUniform),\n    _a[GL.UNSIGNED_INT_VEC4] = getArraySetter.bind(null, 'uniform4uiv', toUIntArray, 4, setVectorUniform),\n    // uniformMatrix(false): don't transpose the matrix\n    _a[GL.FLOAT_MAT2x3] = getArraySetter.bind(null, 'uniformMatrix2x3fv', toFloatArray, 6, setMatrixUniform),\n    _a[GL.FLOAT_MAT2x4] = getArraySetter.bind(null, 'uniformMatrix2x4fv', toFloatArray, 8, setMatrixUniform),\n    _a[GL.FLOAT_MAT3x2] = getArraySetter.bind(null, 'uniformMatrix3x2fv', toFloatArray, 6, setMatrixUniform),\n    _a[GL.FLOAT_MAT3x4] = getArraySetter.bind(null, 'uniformMatrix3x4fv', toFloatArray, 12, setMatrixUniform),\n    _a[GL.FLOAT_MAT4x2] = getArraySetter.bind(null, 'uniformMatrix4x2fv', toFloatArray, 8, setMatrixUniform),\n    _a[GL.FLOAT_MAT4x3] = getArraySetter.bind(null, 'uniformMatrix4x3fv', toFloatArray, 12, setMatrixUniform),\n    _a[GL.SAMPLER_2D] = getSamplerSetter,\n    _a[GL.SAMPLER_CUBE] = getSamplerSetter,\n    _a[GL.SAMPLER_3D] = getSamplerSetter,\n    _a[GL.SAMPLER_2D_SHADOW] = getSamplerSetter,\n    _a[GL.SAMPLER_2D_ARRAY] = getSamplerSetter,\n    _a[GL.SAMPLER_2D_ARRAY_SHADOW] = getSamplerSetter,\n    _a[GL.SAMPLER_CUBE_SHADOW] = getSamplerSetter,\n    _a[GL.INT_SAMPLER_2D] = getSamplerSetter,\n    _a[GL.INT_SAMPLER_3D] = getSamplerSetter,\n    _a[GL.INT_SAMPLER_CUBE] = getSamplerSetter,\n    _a[GL.INT_SAMPLER_2D_ARRAY] = getSamplerSetter,\n    _a[GL.UNSIGNED_INT_SAMPLER_2D] = getSamplerSetter,\n    _a[GL.UNSIGNED_INT_SAMPLER_3D] = getSamplerSetter,\n    _a[GL.UNSIGNED_INT_SAMPLER_CUBE] = getSamplerSetter,\n    _a[GL.UNSIGNED_INT_SAMPLER_2D_ARRAY] = getSamplerSetter,\n    _a);\nfunction getUniformSetter(gl, location, info) {\n    var setter = UNIFORM_SETTERS[info.type];\n    if (!setter) {\n        throw new Error(\"Unknown GLSL uniform type \".concat(info.type));\n    }\n    return setter().bind(null, gl, location);\n}\n\nvar dtypes = {\n    '[object Int8Array]': 5120,\n    '[object Int16Array]': 5122,\n    '[object Int32Array]': 5124,\n    '[object Uint8Array]': 5121,\n    '[object Uint8ClampedArray]': 5121,\n    '[object Uint16Array]': 5123,\n    '[object Uint32Array]': 5125,\n    '[object Float32Array]': 5126,\n    '[object Float64Array]': 5121,\n    '[object ArrayBuffer]': 5121,\n};\n// eslint-disable-next-line\nfunction isTypedArray(x) {\n    return Object.prototype.toString.call(x) in dtypes;\n}\n\n// const ES100_REPLACEMENTS: [RegExp, string][] = [\n//   // In GLSL 1.00 ES these functions are provided by an extension\n//   [/\\btexture(2D|2DProj|Cube)Lod\\(/g, 'texture$1LodEXT('],\n//   // Overloads in GLSL 3.00 map to individual functions. Note that we cannot\n//   // differentiate 2D,2DProj,Cube without type analysis so we choose the most common variant.\n//   [/\\btexture\\(/g, 'texture2D('],\n//   [/\\btextureLod\\(/g, 'texture2DLodEXT('],\n// ];\nfunction defineStr(k, v) {\n    return \"#define \".concat(k, \" \").concat(v);\n}\nfunction getDefines(shader) {\n    var defines = {};\n    shader.replace(/^\\s*#define\\s*(\\S*)\\s*(\\S*)\\s*$/gm, function (_, name, value) {\n        var v = Number(value);\n        defines[name] = isNaN(v) ? value : v;\n        return '';\n    });\n    return defines;\n}\nfunction getAttributeLocations(vert, defines) {\n    var locations = [];\n    vert.replace(/^\\s*layout\\(location\\s*=\\s*(\\S*)\\)\\s*in\\s+\\S+\\s*(.*);$/gm, function (_, location, name) {\n        var l = Number(location);\n        locations.push({ location: isNaN(l) ? defines[location] : l, name: name });\n        return '';\n    });\n    return locations;\n}\nfunction getUniforms(vert) {\n    var uniformNames = [];\n    var structs = [];\n    vert.replace(/\\s*struct\\s*(.*)\\s*{((?:\\s*.*\\s*)*?)};/g, function (_, type, uniformStr) {\n        var uniforms = [];\n        uniformStr\n            .trim()\n            .replace('\\r\\n', '\\n')\n            .split('\\n')\n            .forEach(function (line) {\n            var _a = __read(line.trim().split(/\\s+/), 2), type = _a[0], name = _a[1];\n            uniforms.push({\n                type: type.trim(),\n                name: name.replace(';', '').trim(),\n            });\n        });\n        structs.push({\n            type: type.trim(),\n            uniforms: uniforms,\n        });\n        return '';\n    });\n    vert.replace(/\\s*uniform(?:\\s+)(?:\\w+)(?:\\s?){([^]*?)};?/g, function (_, uniforms) {\n        uniforms\n            .trim()\n            .replace('\\r\\n', '\\n')\n            .split('\\n')\n            .forEach(function (line) {\n            var result = line.trim().split(' ');\n            var type = result[0] || '';\n            var name = result[1] || '';\n            // DirectionalLight directionalLights[  NUM_DIR_LIGHTS ];\n            var isArray = name.indexOf('[') > -1;\n            name = name.replace(';', '').replace('[', '').trim();\n            // ignore conditional comments\n            if (type.startsWith('#')) {\n                return;\n            }\n            // account for structs\n            if (type) {\n                var struct = structs.find(function (struct) { return type === struct.type; });\n                if (struct) {\n                    if (isArray) {\n                        var _loop_1 = function (i) {\n                            struct.uniforms.forEach(function (uniform) {\n                                uniformNames.push(\"\".concat(name, \"[\").concat(i, \"].\").concat(uniform.name));\n                            });\n                        };\n                        for (var i = 0; i < 5; i++) {\n                            _loop_1(i);\n                        }\n                    }\n                    else {\n                        struct.uniforms.forEach(function (uniform) {\n                            uniformNames.push(\"\".concat(name, \".\").concat(uniform.name));\n                        });\n                    }\n                }\n            }\n            if (name) {\n                uniformNames.push(name);\n            }\n        });\n        return '';\n    });\n    return uniformNames;\n}\nfunction parseBinding(layout) {\n    if (layout === undefined)\n        return null;\n    var g = /binding\\s*=\\s*(\\d+)/.exec(layout);\n    if (g !== null) {\n        var bindingNum = parseInt(g[1], 10);\n        if (!Number.isNaN(bindingNum))\n            return bindingNum;\n    }\n    return null;\n}\nfunction getSeparateSamplerTypes(combinedSamplerType) {\n    var samplerType = '';\n    var textureType = combinedSamplerType;\n    // if (combinedSamplerType.endsWith(`Shadow`)) {\n    //   textureType = textureType.slice(0, -6);\n    //   samplerType = `Shadow`;\n    // }\n    return [textureType, samplerType];\n}\nfunction preprocessShader_GLSL(vendorInfo, type, source, defines, usePrecision) {\n    var _a;\n    if (defines === void 0) { defines = null; }\n    if (usePrecision === void 0) { usePrecision = true; }\n    var isGLSL100 = vendorInfo.glslVersion === '#version 100';\n    var useMRT = type === 'frag' &&\n        ((_a = source.match(/^\\s*layout\\(location\\s*=\\s*\\d*\\)\\s*out\\s+vec4\\s*(.*);$/gm)) === null || _a === void 0 ? void 0 : _a.length) > 1;\n    var lines = source\n        .replace('\\r\\n', '\\n')\n        .split('\\n')\n        .map(function (n) {\n        // Remove comments.\n        return n.replace(/[/][/].*$/, '');\n    })\n        .filter(function (n) {\n        // Filter whitespace.\n        var isEmpty = !n || /^\\s+$/.test(n);\n        return !isEmpty;\n    });\n    // #define KEY VAR\n    var definesString = '';\n    if (defines !== null)\n        definesString = Object.keys(defines)\n            .map(function (key) { return defineStr(key, defines[key]); })\n            .join('\\n');\n    var precision = lines.find(function (line) { return line.startsWith('precision'); }) ||\n        'precision mediump float;';\n    var rest = usePrecision\n        ? lines.filter(function (line) { return !line.startsWith('precision'); }).join('\\n')\n        : lines.join('\\n');\n    var extraDefines = '';\n    if (vendorInfo.viewportOrigin === ViewportOrigin.UPPER_LEFT) {\n        extraDefines += \"\".concat(defineStr(\"VIEWPORT_ORIGIN_TL\", \"1\"), \"\\n\");\n    }\n    if (vendorInfo.clipSpaceNearZ === ClipSpaceNearZ.ZERO) {\n        extraDefines += \"\".concat(defineStr(\"CLIPSPACE_NEAR_ZERO\", \"1\"), \"\\n\");\n    }\n    if (vendorInfo.explicitBindingLocations) {\n        var set_1 = 0, implicitBinding_1 = 0, location_1 = 0;\n        rest = rest.replace(/^\\s*(layout\\((.*)\\))?\\s*uniform(.+{)$/gm, function (substr, cap, layout, rest) {\n            var layout2 = layout ? \"\".concat(layout, \", \") : \"\";\n            return \"layout(\".concat(layout2, \"set = \").concat(set_1, \", binding = \").concat(implicitBinding_1++, \") uniform \").concat(rest);\n        });\n        // XXX(jstpierre): WebGPU now binds UBOs and textures in different sets as a porting hack, hrm...\n        set_1++;\n        implicitBinding_1 = 0;\n        assert(vendorInfo.separateSamplerTextures);\n        rest = rest.replace(/^\\s*(layout\\((.*)\\))?\\s*uniform sampler(\\w+) (.*);/gm, function (substr, cap, layout, combinedSamplerType, samplerName) {\n            var binding = parseBinding(layout);\n            if (binding === null)\n                binding = implicitBinding_1++;\n            var _a = __read(getSeparateSamplerTypes(combinedSamplerType), 2), textureType = _a[0], samplerType = _a[1];\n            return type === 'frag'\n                ? \"\\nlayout(set = \".concat(set_1, \", binding = \").concat(binding * 2 + 0, \") uniform texture\").concat(textureType, \" T_\").concat(samplerName, \";\\nlayout(set = \").concat(set_1, \", binding = \").concat(binding * 2 + 1, \") uniform sampler\").concat(samplerType, \" S_\").concat(samplerName, \";\").trim()\n                : '';\n        });\n        rest = rest.replace(type === 'frag' ? /^\\s*\\b(varying|in)\\b/gm : /^\\s*\\b(varying|out)\\b/gm, function (substr, tok) {\n            return \"layout(location = \".concat(location_1++, \") \").concat(tok);\n        });\n        /**\n         * @see https://github.com/gfx-rs/naga/issues/1994\n         */\n        extraDefines += \"\".concat(defineStr(\"gl_VertexID\", \"gl_VertexIndex\"), \"\\n\");\n        extraDefines += \"\".concat(defineStr(\"gl_InstanceID\", \"gl_InstanceIndex\"), \"\\n\");\n        // Workaround for Naga\n        // https://github.com/gfx-rs/naga/issues/1353\n        precision = precision.replace(/^precision (.*) sampler(.*);$/gm, '');\n    }\n    else {\n        var implicitBinding_2 = 0;\n        rest = rest.replace(/^\\s*(layout\\((.*)\\))?\\s*uniform sampler(\\w+) (.*);/gm, function (substr, cap, layout, combinedSamplerType, samplerName) {\n            var binding = parseBinding(layout);\n            if (binding === null)\n                binding = implicitBinding_2++;\n            return \"uniform sampler\".concat(combinedSamplerType, \" \").concat(samplerName, \"; // BINDING=\").concat(binding);\n        });\n    }\n    rest = rest.replace(/\\bPU_SAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n        return \"SAMPLER_\".concat(combinedSamplerType, \"(P_\").concat(samplerName, \")\");\n    });\n    rest = rest.replace(/\\bPF_SAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n        return \"PP_SAMPLER_\".concat(combinedSamplerType, \"(P_\").concat(samplerName, \")\");\n    });\n    rest = rest.replace(/\\bPU_TEXTURE\\((.*?)\\)/g, function (substr, samplerName) {\n        return \"TEXTURE(P_\".concat(samplerName, \")\");\n    });\n    if (vendorInfo.separateSamplerTextures) {\n        rest = rest.replace(/\\bPD_SAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n            var _a = __read(getSeparateSamplerTypes(combinedSamplerType), 2), textureType = _a[0], samplerType = _a[1];\n            return \"texture\".concat(textureType, \" T_P_\").concat(samplerName, \", sampler\").concat(samplerType, \" S_P_\").concat(samplerName);\n        });\n        rest = rest.replace(/\\bPP_SAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n            return \"T_\".concat(samplerName, \", S_\").concat(samplerName);\n        });\n        rest = rest.replace(/\\bSAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n            return \"sampler\".concat(combinedSamplerType, \"(T_\").concat(samplerName, \", S_\").concat(samplerName, \")\");\n        });\n        rest = rest.replace(/\\bTEXTURE\\((.*?)\\)/g, function (substr, samplerName) {\n            return \"T_\".concat(samplerName);\n        });\n    }\n    else {\n        var samplerNames_1 = [];\n        rest = rest.replace(/\\bPD_SAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n            return \"sampler\".concat(combinedSamplerType, \" P_\").concat(samplerName);\n        });\n        rest = rest.replace(/\\bPP_SAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n            return samplerName;\n        });\n        rest = rest.replace(/\\bSAMPLER_(\\w+)\\((.*?)\\)/g, function (substr, combinedSamplerType, samplerName) {\n            samplerNames_1.push([samplerName, combinedSamplerType]);\n            return samplerName;\n        });\n        if (isGLSL100) {\n            samplerNames_1.forEach(function (_a) {\n                var _b = __read(_a, 2), samplerName = _b[0], combinedSamplerType = _b[1];\n                // texture(u_T) -> texture2D(u_T) or textureCube(u_T)\n                rest = rest.replace(new RegExp(\"texture\\\\(\".concat(samplerName), 'g'), function () {\n                    return \"texture\".concat(combinedSamplerType, \"(\").concat(samplerName);\n                });\n            });\n        }\n        rest = rest.replace(/\\bTEXTURE\\((.*?)\\)/g, function (substr, samplerName) {\n            return samplerName;\n        });\n    }\n    // using #define means we can't use `const in/out` in params\n    //   ${isGLSL100 && type === 'vert' ? '#define in attribute\\n#define out varying' : ''}\n    // ${isGLSL100 && type === 'frag' ? '#define in varying' : ''}\n    // headless-gl will throw the following error if we prepend `#version 100`:\n    // #version directive must occur before anything else, except for comments and white space\n    var concat = \"\".concat(isGLSL100 ? '' : vendorInfo.glslVersion, \"\\n\").concat(isGLSL100 && useMRT ? '#extension GL_EXT_draw_buffers : require\\n' : '', \"\\n\").concat(isGLSL100 && type === 'frag'\n        ? '#extension GL_OES_standard_derivatives : enable\\n'\n        : '').concat(usePrecision ? precision : '', \"\\n\").concat(extraDefines ? extraDefines : '').concat(definesString ? definesString + '\\n' : '', \"\\n\").concat(rest, \"\\n\").trim();\n    // out vec4 outputColor; -> layout(location = 0) out vec4 outputColor;\n    if (vendorInfo.explicitBindingLocations && type === 'frag') {\n        concat = concat.replace(/^\\b(out)\\b/g, function (substr, tok) {\n            return \"layout(location = 0) \".concat(tok);\n        });\n    }\n    // GLSL 300 -> 100\n    // @see https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html\n    if (isGLSL100) {\n        // in -> varying\n        if (type === 'frag') {\n            concat = concat.replace(/^\\s*in\\s+(\\S+)\\s*(.*);$/gm, function (_, dataType, name) {\n                return \"varying \".concat(dataType, \" \").concat(name, \";\\n\");\n            });\n        }\n        if (type === 'vert') {\n            // out -> varying\n            concat = concat.replace(/^\\s*out\\s+(\\S+)\\s*(.*);$/gm, function (_, dataType, name) {\n                return \"varying \".concat(dataType, \" \").concat(name, \";\\n\");\n            });\n            // in -> attribute\n            concat = concat.replace(\n            // /^\\s*layout\\(location\\s*=\\s*\\d*\\)\\s*in\\s*(.*)\\s*(.*);$/gm,\n            /^\\s*layout\\(location\\s*=\\s*\\S*\\)\\s*in\\s+(\\S+)\\s*(.*);$/gm, function (_, dataType, name) {\n                return \"attribute \".concat(dataType, \" \").concat(name, \";\\n\");\n            });\n        }\n        // interface blocks supported in GLSL ES 3.00 and above only\n        concat = concat.replace(/\\s*uniform\\s*.*\\s*{((?:\\s*.*\\s*)*?)};/g, function (substr, uniforms) {\n            return uniforms.trim().replace(/^.*$/gm, function (uniform) {\n                // eg. #ifdef\n                var trimmed = uniform.trim();\n                if (trimmed.startsWith('#')) {\n                    return trimmed;\n                }\n                return uniform ? \"uniform \".concat(trimmed) : '';\n            });\n        });\n        if (type === 'frag') {\n            if (useMRT) {\n                var gBuffers_1 = [];\n                concat = concat.replace(/^\\s*layout\\(location\\s*=\\s*\\d*\\)\\s*out\\s+vec4\\s*(.*);$/gm, function (_, buffer) {\n                    gBuffers_1.push(buffer);\n                    return \"vec4 \".concat(buffer, \";\\n\");\n                });\n                var lastIndexOfMain = concat.lastIndexOf('}');\n                concat =\n                    concat.substring(0, lastIndexOfMain) +\n                        \"\\n    \".concat(gBuffers_1\n                            .map(function (gBuffer, i) { return \"gl_FragData[\".concat(i, \"] = \").concat(gBuffer, \";\\n    \"); })\n                            .join('\\n')) +\n                        concat.substring(lastIndexOfMain);\n            }\n            else {\n                var glFragColor_1;\n                concat = concat.replace(/^\\s*out\\s+(\\S+)\\s*(.*);$/gm, function (_, dataType, name) {\n                    glFragColor_1 = name;\n                    return \"\".concat(dataType, \" \").concat(name, \";\\n\");\n                });\n                if (glFragColor_1) {\n                    var lastIndexOfMain = concat.lastIndexOf('}');\n                    concat =\n                        concat.substring(0, lastIndexOfMain) +\n                            \"\\n  gl_FragColor = vec4(\".concat(glFragColor_1, \");\\n\") +\n                            concat.substring(lastIndexOfMain);\n                }\n            }\n        }\n        // remove layout(location = 0)\n        concat = concat.replace(/^\\s*layout\\((.*)\\)/gm, '');\n        // replace texture with texture2D\n        // for (const [pattern, replacement] of ES100_REPLACEMENTS) {\n        //   concat = concat.replace(pattern, replacement);\n        // }\n    }\n    return concat;\n}\nfunction preprocessProgram_GLSL(vendorInfo, vert, frag, defines) {\n    if (defines === void 0) { defines = null; }\n    var preprocessedVert = preprocessShader_GLSL(vendorInfo, 'vert', vert, defines);\n    var preprocessedFrag = preprocessShader_GLSL(vendorInfo, 'frag', frag, defines);\n    return { vert: vert, frag: frag, preprocessedVert: preprocessedVert, preprocessedFrag: preprocessedFrag };\n}\n\nvar ResourceBase_GL = /** @class */ (function (_super) {\n    __extends(ResourceBase_GL, _super);\n    function ResourceBase_GL(_a) {\n        var id = _a.id, device = _a.device;\n        var _this = _super.call(this) || this;\n        _this.id = id;\n        _this.device = device;\n        if (_this.device['resourceCreationTracker'] !== null) {\n            _this.device['resourceCreationTracker'].trackResourceCreated(_this);\n        }\n        return _this;\n    }\n    ResourceBase_GL.prototype.destroy = function () {\n        if (this.device['resourceCreationTracker'] !== null) {\n            this.device['resourceCreationTracker'].trackResourceDestroyed(this);\n        }\n    };\n    return ResourceBase_GL;\n}(EventEmitter));\n\nvar Bindings_GL = /** @class */ (function (_super) {\n    __extends(Bindings_GL, _super);\n    function Bindings_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Bindings;\n        var uniformBufferBindings = descriptor.uniformBufferBindings, samplerBindings = descriptor.samplerBindings;\n        _this.uniformBufferBindings = uniformBufferBindings || [];\n        _this.samplerBindings = samplerBindings || [];\n        _this.bindingLayouts = _this.createBindingLayouts();\n        return _this;\n    }\n    Bindings_GL.prototype.createBindingLayouts = function () {\n        var firstUniformBuffer = 0;\n        var firstSampler = 0;\n        var bindingLayoutTables = [];\n        // Support only 1 bindGroup for now.\n        var numUniformBuffers = this.uniformBufferBindings.length;\n        var numSamplers = this.samplerBindings.length;\n        bindingLayoutTables.push({\n            firstUniformBuffer: firstUniformBuffer,\n            numUniformBuffers: numUniformBuffers,\n            firstSampler: firstSampler,\n            numSamplers: numSamplers,\n        });\n        firstUniformBuffer += numUniformBuffers;\n        firstSampler += numSamplers;\n        return {\n            numUniformBuffers: firstUniformBuffer,\n            numSamplers: firstSampler,\n            bindingLayoutTables: bindingLayoutTables,\n        };\n    };\n    return Bindings_GL;\n}(ResourceBase_GL));\n\n// @see https://github.com/visgl/luma.gl/blob/30a1039573576d73641de7c1ba222e8992eb526e/modules/gltools/src/utils/webgl-checks.ts#L22\nfunction isWebGL2(gl) {\n    if (typeof WebGL2RenderingContext !== 'undefined' &&\n        gl instanceof WebGL2RenderingContext) {\n        return true;\n    }\n    // Look for debug contexts, headless gl etc\n    // @ts-ignore\n    return Boolean(gl && gl._version === 2);\n}\nfunction isTextureFormatCompressed(fmt) {\n    var typeFlags = getFormatTypeFlags(fmt);\n    switch (typeFlags) {\n        case FormatTypeFlags.BC1:\n        case FormatTypeFlags.BC2:\n        case FormatTypeFlags.BC3:\n        case FormatTypeFlags.BC4_UNORM:\n        case FormatTypeFlags.BC4_SNORM:\n        case FormatTypeFlags.BC5_UNORM:\n        case FormatTypeFlags.BC5_SNORM:\n            return true;\n        default:\n            return false;\n    }\n}\nfunction isFormatSizedInteger(fmt) {\n    var flags = getFormatFlags(fmt);\n    if (flags & FormatFlags.Normalized)\n        return false;\n    var typeFlags = getFormatTypeFlags(fmt);\n    // Check for integer types.\n    if (typeFlags === FormatTypeFlags.S8 ||\n        typeFlags === FormatTypeFlags.S16 ||\n        typeFlags === FormatTypeFlags.S32)\n        return true;\n    if (typeFlags === FormatTypeFlags.U8 ||\n        typeFlags === FormatTypeFlags.U16 ||\n        typeFlags === FormatTypeFlags.U32)\n        return true;\n    return false;\n}\nfunction translateBufferHint(hint) {\n    switch (hint) {\n        case BufferFrequencyHint.STATIC:\n            return GL.STATIC_DRAW;\n        case BufferFrequencyHint.DYNAMIC:\n            return GL.DYNAMIC_DRAW;\n    }\n}\nfunction translateBufferUsageToTarget(usage) {\n    if (usage & BufferUsage.INDEX) {\n        return GL.ELEMENT_ARRAY_BUFFER;\n    }\n    else if (usage & BufferUsage.VERTEX) {\n        return GL.ARRAY_BUFFER;\n    }\n    else if (usage & BufferUsage.UNIFORM) {\n        return GL.UNIFORM_BUFFER;\n    }\n}\nfunction translatePrimitiveTopology(topology) {\n    switch (topology) {\n        case PrimitiveTopology.TRIANGLES:\n            return GL.TRIANGLES;\n        case PrimitiveTopology.POINTS:\n            return GL.POINTS;\n        case PrimitiveTopology.TRIANGLE_STRIP:\n            return GL.TRIANGLE_STRIP;\n        case PrimitiveTopology.LINES:\n            return GL.LINES;\n        case PrimitiveTopology.LINE_STRIP:\n            return GL.LINE_STRIP;\n        default:\n            throw new Error('Unknown primitive topology mode');\n    }\n}\nfunction translateType(flags) {\n    switch (flags) {\n        case FormatTypeFlags.U8:\n            return GL.UNSIGNED_BYTE;\n        case FormatTypeFlags.U16:\n            return GL.UNSIGNED_SHORT;\n        case FormatTypeFlags.U32:\n            return GL.UNSIGNED_INT;\n        case FormatTypeFlags.S8:\n            return GL.BYTE;\n        case FormatTypeFlags.S16:\n            return GL.SHORT;\n        case FormatTypeFlags.S32:\n            return GL.INT;\n        case FormatTypeFlags.F16:\n            return GL.HALF_FLOAT;\n        case FormatTypeFlags.F32:\n            return GL.FLOAT;\n        default:\n            throw new Error('whoops');\n    }\n}\nfunction translateSize(flags) {\n    switch (flags) {\n        case FormatCompFlags.R:\n            return 1;\n        case FormatCompFlags.RG:\n            return 2;\n        case FormatCompFlags.RGB:\n            return 3;\n        case FormatCompFlags.RGBA:\n            return 4;\n        default:\n            return 1;\n    }\n}\nfunction translateVertexFormat$1(fmt) {\n    var typeFlags = getFormatTypeFlags(fmt);\n    var compFlags = getFormatCompFlags(fmt);\n    var flags = getFormatFlags(fmt);\n    var type = translateType(typeFlags);\n    var size = translateSize(compFlags);\n    var normalized = !!(flags & FormatFlags.Normalized);\n    return { size: size, type: type, normalized: normalized };\n}\nfunction translateIndexFormat$1(format) {\n    switch (format) {\n        case Format.U8_R:\n            return GL.UNSIGNED_BYTE;\n        case Format.U16_R:\n            return GL.UNSIGNED_SHORT;\n        case Format.U32_R:\n            return GL.UNSIGNED_INT;\n        default:\n            throw new Error('whoops');\n    }\n}\nfunction translateAddressMode$1(wrapMode) {\n    switch (wrapMode) {\n        case AddressMode.CLAMP_TO_EDGE:\n            return GL.CLAMP_TO_EDGE;\n        case AddressMode.REPEAT:\n            return GL.REPEAT;\n        case AddressMode.MIRRORED_REPEAT:\n            return GL.MIRRORED_REPEAT;\n        default:\n            throw new Error('whoops');\n    }\n}\nfunction translateFilterMode(filter, mipmapFilter) {\n    if (mipmapFilter === MipmapFilterMode.LINEAR &&\n        filter === FilterMode.BILINEAR) {\n        return GL.LINEAR_MIPMAP_LINEAR;\n    }\n    if (mipmapFilter === MipmapFilterMode.LINEAR && filter === FilterMode.POINT) {\n        return GL.NEAREST_MIPMAP_LINEAR;\n    }\n    if (mipmapFilter === MipmapFilterMode.NEAREST &&\n        filter === FilterMode.BILINEAR) {\n        return GL.LINEAR_MIPMAP_NEAREST;\n    }\n    if (mipmapFilter === MipmapFilterMode.NEAREST &&\n        filter === FilterMode.POINT) {\n        return GL.NEAREST_MIPMAP_NEAREST;\n    }\n    if (mipmapFilter === MipmapFilterMode.NO_MIP &&\n        filter === FilterMode.BILINEAR) {\n        return GL.LINEAR;\n    }\n    if (mipmapFilter === MipmapFilterMode.NO_MIP && filter === FilterMode.POINT) {\n        return GL.NEAREST;\n    }\n    throw new Error('Unknown texture filter mode');\n}\nfunction getPlatformBuffer$1(buffer_, byteOffset) {\n    if (byteOffset === void 0) { byteOffset = 0; }\n    var buffer = buffer_;\n    return buffer.gl_buffer_pages[(byteOffset / buffer.pageByteSize) | 0];\n}\nfunction getPlatformTexture(texture_) {\n    var texture = texture_;\n    return texture.gl_texture;\n}\nfunction getPlatformSampler$1(sampler_) {\n    var sampler = sampler_;\n    return sampler.gl_sampler;\n}\n// eslint-disable-next-line\nfunction assignPlatformName(o, name) {\n    o.name = name;\n    o.__SPECTOR_Metadata = { name: name };\n}\nfunction findall(haystack, needle) {\n    var results = [];\n    while (true) {\n        var result = needle.exec(haystack);\n        if (!result)\n            break;\n        results.push(result);\n    }\n    return results;\n}\nfunction isBlendStateNone(blendState) {\n    return (blendState.blendMode == BlendMode.ADD &&\n        blendState.blendSrcFactor == BlendFactor.ONE &&\n        blendState.blendDstFactor === BlendFactor.ZERO);\n}\nfunction translateQueryPoolType$1(type) {\n    switch (type) {\n        case QueryPoolType.OcclusionConservative:\n            return GL.ANY_SAMPLES_PASSED_CONSERVATIVE;\n        default:\n            throw new Error('whoops');\n    }\n}\nfunction translateTextureDimension$1(dimension) {\n    if (dimension === TextureDimension.TEXTURE_2D)\n        return GL.TEXTURE_2D;\n    else if (dimension === TextureDimension.TEXTURE_2D_ARRAY)\n        return GL.TEXTURE_2D_ARRAY;\n    else if (dimension === TextureDimension.TEXTURE_CUBE_MAP)\n        return GL.TEXTURE_CUBE_MAP;\n    else if (dimension === TextureDimension.TEXTURE_3D)\n        return GL.TEXTURE_3D;\n    else\n        throw new Error('whoops');\n}\nfunction isBlockCompressSized(w, h, bw, bh) {\n    if (w % bw !== 0)\n        return false;\n    if (h % bh !== 0)\n        return false;\n    return true;\n}\n\nvar Buffer_GL = /** @class */ (function (_super) {\n    __extends(Buffer_GL, _super);\n    function Buffer_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Buffer;\n        var viewOrSize = descriptor.viewOrSize, usage = descriptor.usage, _b = descriptor.hint, hint = _b === void 0 ? BufferFrequencyHint.STATIC : _b;\n        var uniformBufferMaxPageByteSize = device.uniformBufferMaxPageByteSize, gl = device.gl;\n        var isUBO = usage & BufferUsage.UNIFORM;\n        if (!isUBO) {\n            if (isWebGL2(gl)) {\n                // Temporarily unbind VAO when creating buffers to not stomp on the VAO configuration.\n                gl.bindVertexArray(null);\n            }\n            else {\n                device.OES_vertex_array_object.bindVertexArrayOES(null);\n            }\n        }\n        // const byteSize = isNumber(viewOrSize)\n        //   ? viewOrSize * 4\n        //   : viewOrSize.byteLength * 4;\n        var byteSize = isNumber(viewOrSize)\n            ? align(viewOrSize, 4)\n            : align(viewOrSize.byteLength, 4);\n        _this.gl_buffer_pages = [];\n        var pageByteSize;\n        if (isUBO) {\n            // assert(byteSize % uniformBufferMaxPageByteSize === 0);\n            var byteSizeLeft = byteSize;\n            while (byteSizeLeft > 0) {\n                _this.gl_buffer_pages.push(_this.createBufferPage(Math.min(byteSizeLeft, uniformBufferMaxPageByteSize), usage, hint));\n                byteSizeLeft -= uniformBufferMaxPageByteSize;\n            }\n            pageByteSize = uniformBufferMaxPageByteSize;\n            // TODO: uniform in WebGL1\n        }\n        else {\n            _this.gl_buffer_pages.push(_this.createBufferPage(byteSize, usage, hint));\n            pageByteSize = byteSize;\n        }\n        _this.pageByteSize = pageByteSize;\n        _this.byteSize = byteSize;\n        _this.usage = usage;\n        _this.gl_target = translateBufferUsageToTarget(usage);\n        // init data\n        if (!isNumber(viewOrSize)) {\n            _this.setSubData(0, new Uint8Array(viewOrSize.buffer));\n        }\n        if (!isUBO) {\n            if (isWebGL2(gl)) {\n                gl.bindVertexArray(_this.device['currentBoundVAO']);\n            }\n            else {\n                device.OES_vertex_array_object.bindVertexArrayOES(_this.device['currentBoundVAO']);\n            }\n        }\n        return _this;\n    }\n    Buffer_GL.prototype.setSubData = function (dstByteOffset, data, srcByteOffset, byteSize) {\n        if (srcByteOffset === void 0) { srcByteOffset = 0; }\n        if (byteSize === void 0) { byteSize = data.byteLength - srcByteOffset; }\n        var gl = this.device.gl;\n        var \n        // gl_target,\n        // byteSize: dstByteSize,\n        dstPageByteSize = this.pageByteSize;\n        // Account for setSubData being called with a dstByteOffset that is beyond the end of the buffer.\n        // if (isWebGL2(gl) && gl_target === gl.UNIFORM_BUFFER) {\n        //   // Manually check asserts for speed.\n        //   if (!(dstByteOffset % dstPageByteSize === 0))\n        //     throw new Error(\n        //       `Assert fail: (dstByteOffset [${dstByteOffset}] % dstPageByteSize [${dstPageByteSize}]) === 0`,\n        //     );\n        //   if (!(byteSize % dstPageByteSize === 0))\n        //     throw new Error(\n        //       `Assert fail: (byteSize [${byteSize}] % dstPageByteSize [${dstPageByteSize}]) === 0`,\n        //     );\n        // }\n        // if (!(dstByteOffset + byteSize <= dstByteSize)) {\n        //   throw new Error(\n        //     `Assert fail: (dstByteOffset [${dstByteOffset}] + byteSize [${byteSize}]) <= dstByteSize [${dstByteSize}], gl_target ${gl_target}`,\n        //   );\n        //   // exceed, need to recreate\n        // }\n        var virtBufferByteOffsetEnd = dstByteOffset + byteSize;\n        var virtBufferByteOffset = dstByteOffset;\n        var physBufferByteOffset = dstByteOffset % dstPageByteSize;\n        while (virtBufferByteOffset < virtBufferByteOffsetEnd) {\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bindBuffer#parameters\n            var target = isWebGL2(gl) ? gl.COPY_WRITE_BUFFER : this.gl_target;\n            var buffer = getPlatformBuffer$1(this, virtBufferByteOffset);\n            // @ts-ignore\n            if (buffer.ubo) {\n                return;\n            }\n            gl.bindBuffer(target, buffer);\n            // only WebGL2 support srcOffset & length\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bufferSubData\n            if (isWebGL2(gl)) {\n                gl.bufferSubData(target, physBufferByteOffset, data, srcByteOffset, Math.min(virtBufferByteOffsetEnd - virtBufferByteOffset, dstPageByteSize));\n            }\n            else {\n                gl.bufferSubData(target, physBufferByteOffset, data);\n            }\n            virtBufferByteOffset += dstPageByteSize;\n            physBufferByteOffset = 0;\n            srcByteOffset += dstPageByteSize;\n            this.device['debugGroupStatisticsBufferUpload']();\n        }\n    };\n    Buffer_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        for (var i = 0; i < this.gl_buffer_pages.length; i++) {\n            // no ubo in WebGL1\n            // @ts-ignore\n            if (!this.gl_buffer_pages[i].ubo) {\n                this.device.gl.deleteBuffer(this.gl_buffer_pages[i]);\n            }\n        }\n        this.gl_buffer_pages = [];\n    };\n    Buffer_GL.prototype.createBufferPage = function (byteSize, usage, hint) {\n        var gl = this.device.gl;\n        var isUBO = usage & BufferUsage.UNIFORM;\n        if (!isWebGL2(gl) && isUBO) {\n            return {\n                ubo: true,\n            };\n        }\n        else {\n            var gl_buffer = this.device.ensureResourceExists(gl.createBuffer());\n            var gl_target = translateBufferUsageToTarget(usage);\n            var gl_hint = translateBufferHint(hint);\n            gl.bindBuffer(gl_target, gl_buffer);\n            gl.bufferData(gl_target, byteSize, gl_hint);\n            return gl_buffer;\n        }\n    };\n    return Buffer_GL;\n}(ResourceBase_GL));\n\nvar InputLayout_GL = /** @class */ (function (_super) {\n    __extends(InputLayout_GL, _super);\n    function InputLayout_GL(_a) {\n        var e_1, _b, e_2, _c;\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _d;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.InputLayout;\n        var vertexBufferDescriptors = descriptor.vertexBufferDescriptors, indexBufferFormat = descriptor.indexBufferFormat, program = descriptor.program;\n        assert(indexBufferFormat === Format.U16_R ||\n            indexBufferFormat === Format.U32_R ||\n            indexBufferFormat === null);\n        var indexBufferType = indexBufferFormat !== null\n            ? translateIndexFormat$1(indexBufferFormat)\n            : null;\n        var indexBufferCompByteSize = indexBufferFormat !== null\n            ? getFormatCompByteSize(indexBufferFormat)\n            : null;\n        var gl = _this.device.gl;\n        var vao = _this.device.ensureResourceExists(isWebGL2(gl)\n            ? gl.createVertexArray()\n            : device.OES_vertex_array_object.createVertexArrayOES());\n        if (isWebGL2(gl)) {\n            gl.bindVertexArray(vao);\n        }\n        else {\n            device.OES_vertex_array_object.bindVertexArrayOES(vao);\n        }\n        gl.bindBuffer(gl.ARRAY_BUFFER, getPlatformBuffer$1(_this.device['fallbackVertexBuffer']));\n        try {\n            // const vertexBufferFormats = [];\n            for (var _e = __values(descriptor.vertexBufferDescriptors), _f = _e.next(); !_f.done; _f = _e.next()) {\n                var vertexBufferDescriptor = _f.value;\n                var stepMode = vertexBufferDescriptor.stepMode, attributes = vertexBufferDescriptor.attributes;\n                try {\n                    for (var attributes_1 = (e_2 = void 0, __values(attributes)), attributes_1_1 = attributes_1.next(); !attributes_1_1.done; attributes_1_1 = attributes_1.next()) {\n                        var attribute = attributes_1_1.value;\n                        var shaderLocation = attribute.shaderLocation, format = attribute.format, _g = attribute.divisor, divisor = _g === void 0 ? 1 : _g;\n                        // find location by name in WebGL1\n                        var location_1 = isWebGL2(gl)\n                            ? shaderLocation\n                            : (_d = program.attributes[shaderLocation]) === null || _d === void 0 ? void 0 : _d.location;\n                        var vertexFormat = translateVertexFormat$1(format);\n                        // @ts-ignore\n                        attribute.vertexFormat = vertexFormat;\n                        if (!isNil(location_1)) {\n                            if (isFormatSizedInteger(format)) {\n                                // See https://groups.google.com/d/msg/angleproject/yQb5DaCzcWg/Ova0E3wcAQAJ for more info.\n                                // console.warn(\"Vertex format uses sized integer types; this will cause a shader recompile on ANGLE platforms\");\n                                // debugger;\n                            }\n                            var size = vertexFormat.size, type = vertexFormat.type, normalized = vertexFormat.normalized;\n                            gl.vertexAttribPointer(location_1, size, type, normalized, 0, 0);\n                            if (stepMode === VertexStepMode.INSTANCE) {\n                                if (isWebGL2(gl)) {\n                                    // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/vertexAttribDivisor\n                                    gl.vertexAttribDivisor(location_1, divisor);\n                                }\n                                else {\n                                    device.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(location_1, divisor);\n                                }\n                            }\n                            gl.enableVertexAttribArray(location_1);\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (attributes_1_1 && !attributes_1_1.done && (_c = attributes_1.return)) _c.call(attributes_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        if (isWebGL2(gl)) {\n            gl.bindVertexArray(null);\n        }\n        else {\n            device.OES_vertex_array_object.bindVertexArrayOES(null);\n        }\n        _this.vertexBufferDescriptors = vertexBufferDescriptors;\n        _this.vao = vao;\n        _this.indexBufferFormat = indexBufferFormat;\n        _this.indexBufferType = indexBufferType;\n        _this.indexBufferCompByteSize = indexBufferCompByteSize;\n        _this.program = program;\n        return _this;\n    }\n    InputLayout_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        if (this.device['currentBoundVAO'] === this.vao) {\n            if (isWebGL2(this.device.gl)) {\n                this.device.gl.bindVertexArray(null);\n                this.device.gl.deleteVertexArray(this.vao);\n            }\n            else {\n                this.device.OES_vertex_array_object.bindVertexArrayOES(null);\n                this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao);\n            }\n            this.device['currentBoundVAO'] = null;\n        }\n    };\n    return InputLayout_GL;\n}(ResourceBase_GL));\n\nvar Texture_GL = /** @class */ (function (_super) {\n    __extends(Texture_GL, _super);\n    function Texture_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor, fake = _a.fake;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Texture;\n        // Default values.\n        descriptor = __assign({ dimension: TextureDimension.TEXTURE_2D, depthOrArrayLayers: 1, mipLevelCount: 1 }, descriptor);\n        var gl = _this.device.gl;\n        var gl_target;\n        var gl_texture;\n        var mipLevelCount = _this.clampmipLevelCount(descriptor);\n        _this.immutable = descriptor.usage === TextureUsage.RENDER_TARGET;\n        _this.pixelStore = descriptor.pixelStore;\n        _this.format = descriptor.format;\n        _this.dimension = descriptor.dimension;\n        _this.formatKind = getFormatSamplerKind(descriptor.format);\n        _this.width = descriptor.width;\n        _this.height = descriptor.height;\n        _this.depthOrArrayLayers = descriptor.depthOrArrayLayers;\n        _this.mipmaps = mipLevelCount >= 1;\n        if (!fake) {\n            gl_texture = _this.device.ensureResourceExists(gl.createTexture());\n            var gl_type = _this.device.translateTextureType(descriptor.format);\n            var internalformat = _this.device.translateTextureInternalFormat(descriptor.format);\n            _this.device.setActiveTexture(gl.TEXTURE0);\n            _this.device['currentTextures'][0] = null;\n            _this.preprocessImage();\n            if (descriptor.dimension === TextureDimension.TEXTURE_2D) {\n                gl_target = GL.TEXTURE_2D;\n                gl.bindTexture(gl_target, gl_texture);\n                if (_this.immutable) {\n                    if (isWebGL2(gl)) {\n                        // texStorage2D will create an immutable texture(fixed size)\n                        // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/texStorage2D\n                        // @see https://github.com/visgl/luma.gl/issues/193\n                        // @see https://github.com/WebGLSamples/WebGL2Samples/blob/master/samples/texture_immutable.html\n                        gl.texStorage2D(gl_target, mipLevelCount, internalformat, descriptor.width, descriptor.height);\n                    }\n                    else {\n                        // texImage2D: level must be 0 for DEPTH_COMPONENT format\n                        // const level = internalformat === GL.DEPTH_COMPONENT || this.isNPOT() ? 0 : mipLevelCount;\n                        var level = internalformat === GL.DEPTH_COMPONENT || _this.isNPOT() ? 0 : 0;\n                        if ((_this.format === Format.D32F || _this.format === Format.D24_S8) &&\n                            !isWebGL2(gl) &&\n                            !device.WEBGL_depth_texture) ;\n                        else {\n                            // if (!isWebGL2(gl)) {\n                            //   if (internalformat === GL.RGBA4) {\n                            //     internalformat = GL.RGBA;\n                            //   }\n                            // }\n                            // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n                            gl.texImage2D(gl_target, level, internalformat, descriptor.width, descriptor.height, 0, internalformat, gl_type, null);\n                            // @see https://stackoverflow.com/questions/21954036/dartweb-gl-render-warning-texture-bound-to-texture-unit-0-is-not-renderable\n                            // [.WebGL-0x106ad0400]RENDER WARNING: texture bound to texture unit 0 is not renderable. It might be non-power-of-2 or have incompatible texture filtering (maybe)?\n                            if (_this.mipmaps) {\n                                _this.mipmaps = false;\n                                gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_MIN_FILTER, GL.LINEAR);\n                                gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_WRAP_S, GL.CLAMP_TO_EDGE);\n                                gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_WRAP_T, GL.CLAMP_TO_EDGE);\n                            }\n                        }\n                    }\n                }\n                assert(descriptor.depthOrArrayLayers === 1);\n            }\n            else if (descriptor.dimension === TextureDimension.TEXTURE_2D_ARRAY) {\n                gl_target = GL.TEXTURE_2D_ARRAY;\n                gl.bindTexture(gl_target, gl_texture);\n                if (_this.immutable) {\n                    if (isWebGL2(gl)) {\n                        // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/texStorage3D\n                        gl.texStorage3D(gl_target, mipLevelCount, internalformat, descriptor.width, descriptor.height, descriptor.depthOrArrayLayers);\n                    }\n                }\n            }\n            else if (descriptor.dimension === TextureDimension.TEXTURE_3D) {\n                gl_target = GL.TEXTURE_3D;\n                gl.bindTexture(gl_target, gl_texture);\n                if (_this.immutable) {\n                    if (isWebGL2(gl)) {\n                        gl.texStorage3D(gl_target, mipLevelCount, internalformat, descriptor.width, descriptor.height, descriptor.depthOrArrayLayers);\n                    }\n                }\n            }\n            else if (descriptor.dimension === TextureDimension.TEXTURE_CUBE_MAP) {\n                gl_target = GL.TEXTURE_CUBE_MAP;\n                gl.bindTexture(gl_target, gl_texture);\n                if (_this.immutable) {\n                    if (isWebGL2(gl)) {\n                        gl.texStorage2D(gl_target, mipLevelCount, internalformat, descriptor.width, descriptor.height);\n                    }\n                }\n                assert(descriptor.depthOrArrayLayers === 6);\n            }\n            else {\n                throw new Error('whoops');\n            }\n        }\n        _this.gl_texture = gl_texture;\n        _this.gl_target = gl_target;\n        _this.mipLevelCount = mipLevelCount;\n        return _this;\n    }\n    Texture_GL.prototype.setImageData = function (levelDatas, lod) {\n        if (lod === void 0) { lod = 0; }\n        var gl = this.device.gl;\n        isTextureFormatCompressed(this.format);\n        // @see https://github.com/shrekshao/MoveWebGL1EngineToWebGL2/blob/master/Move-a-WebGL-1-Engine-To-WebGL-2-Blog-2.md#3d-texture\n        var is3D = this.gl_target === GL.TEXTURE_3D ||\n            this.gl_target === GL.TEXTURE_2D_ARRAY;\n        var isCube = this.gl_target === GL.TEXTURE_CUBE_MAP;\n        var isTA = isTypedArray(levelDatas[0]);\n        this.device.setActiveTexture(gl.TEXTURE0);\n        this.device['currentTextures'][0] = null;\n        var data = levelDatas[0];\n        var width;\n        var height;\n        if (isTA) {\n            width = this.width;\n            height = this.height;\n        }\n        else {\n            // FIXME: Property 'width' does not exist on type 'TexImageSource'.\n            // Property 'width' does not exist on type 'VideoFrame'.\n            // @ts-ignore\n            width = data.width;\n            // @ts-ignore\n            height = data.height;\n            // update size\n            this.width = width;\n            this.height = height;\n        }\n        gl.bindTexture(this.gl_target, this.gl_texture);\n        var gl_format = this.device.translateTextureFormat(this.format);\n        // In WebGL 1, this must be the same as internalformat\n        var gl_internal_format = isWebGL2(gl)\n            ? this.device.translateInternalTextureFormat(this.format)\n            : gl_format;\n        var gl_type = this.device.translateTextureType(this.format);\n        this.preprocessImage();\n        for (var z = 0; z < this.depthOrArrayLayers; z++) {\n            var levelData = levelDatas[z];\n            var gl_target = this.gl_target;\n            if (isCube) {\n                gl_target = GL.TEXTURE_CUBE_MAP_POSITIVE_X + (z % 6);\n            }\n            if (this.immutable) {\n                // must use texSubImage2D instead of texImage2D, since texture is immutable\n                // @see https://stackoverflow.com/questions/56123201/unity-plugin-texture-is-immutable?rq=1\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texSubImage2D\n                gl.texSubImage2D(gl_target, lod, 0, 0, width, height, gl_format, gl_type, levelData);\n            }\n            else {\n                if (isWebGL2(gl)) {\n                    if (is3D) {\n                        gl.texImage3D(gl_target, lod, gl_internal_format, width, height, this.depthOrArrayLayers, 0, // border must be 0\n                        gl_format, // TODO: can be different with gl_format\n                        gl_type, levelData);\n                    }\n                    else {\n                        // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n                        gl.texImage2D(gl_target, lod, gl_internal_format, width, height, 0, // border must be 0\n                        gl_format, // TODO: can be different with gl_format\n                        gl_type, levelData);\n                    }\n                }\n                else {\n                    // WebGL1: upload Array & Image separately\n                    if (isTA) {\n                        gl.texImage2D(gl_target, lod, gl_format, width, height, 0, gl_format, gl_type, levelData);\n                    }\n                    else {\n                        gl.texImage2D(gl_target, lod, gl_format, gl_format, gl_type, levelData);\n                    }\n                }\n            }\n        }\n        if (this.mipmaps) {\n            this.generateMipmap(is3D);\n        }\n    };\n    Texture_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.device.gl.deleteTexture(getPlatformTexture(this));\n    };\n    Texture_GL.prototype.clampmipLevelCount = function (descriptor) {\n        if (descriptor.dimension === TextureDimension.TEXTURE_2D_ARRAY &&\n            descriptor.depthOrArrayLayers > 1) {\n            var typeFlags = getFormatTypeFlags(descriptor.format);\n            if (typeFlags === FormatTypeFlags.BC1) {\n                // Chrome/ANGLE seems to have issues with compressed miplevels of size 1/2, so clamp before they arrive...\n                // https://bugs.chromium.org/p/angleproject/issues/detail?id=4056\n                var w = descriptor.width, h = descriptor.height;\n                for (var i = 0; i < descriptor.mipLevelCount; i++) {\n                    if (w <= 2 || h <= 2)\n                        return i - 1;\n                    w = Math.max((w / 2) | 0, 1);\n                    h = Math.max((h / 2) | 0, 1);\n                }\n            }\n        }\n        return descriptor.mipLevelCount;\n    };\n    Texture_GL.prototype.preprocessImage = function () {\n        var gl = this.device.gl;\n        if (this.pixelStore) {\n            if (this.pixelStore.unpackFlipY) {\n                gl.pixelStorei(GL.UNPACK_FLIP_Y_WEBGL, true);\n            }\n            if (this.pixelStore.packAlignment) {\n                gl.pixelStorei(GL.PACK_ALIGNMENT, this.pixelStore.packAlignment);\n            }\n            if (this.pixelStore.unpackAlignment) {\n                gl.pixelStorei(GL.UNPACK_ALIGNMENT, this.pixelStore.unpackAlignment);\n            }\n        }\n    };\n    Texture_GL.prototype.generateMipmap = function (is3D) {\n        if (is3D === void 0) { is3D = false; }\n        var gl = this.device.gl;\n        if (!isWebGL2(gl) && this.isNPOT()) {\n            return this;\n        }\n        if (this.gl_texture && this.gl_target) {\n            gl.bindTexture(this.gl_target, this.gl_texture);\n            if (is3D) {\n                gl.texParameteri(this.gl_target, GL.TEXTURE_BASE_LEVEL, 0);\n                gl.texParameteri(this.gl_target, GL.TEXTURE_MAX_LEVEL, Math.log2(this.width));\n                gl.texParameteri(this.gl_target, GL.TEXTURE_MIN_FILTER, GL.LINEAR_MIPMAP_LINEAR);\n                gl.texParameteri(this.gl_target, GL.TEXTURE_MAG_FILTER, GL.LINEAR);\n            }\n            else {\n                gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_MIN_FILTER, GL.NEAREST_MIPMAP_LINEAR);\n            }\n            gl.generateMipmap(this.gl_target);\n            gl.bindTexture(this.gl_target, null);\n        }\n        return this;\n    };\n    Texture_GL.prototype.isNPOT = function () {\n        var gl = this.device.gl;\n        if (isWebGL2(gl)) {\n            // NPOT restriction is only for WebGL1\n            return false;\n        }\n        return !isPowerOfTwo(this.width) || !isPowerOfTwo(this.height);\n    };\n    return Texture_GL;\n}(ResourceBase_GL));\n\nvar RenderTarget_GL = /** @class */ (function (_super) {\n    __extends(RenderTarget_GL, _super);\n    function RenderTarget_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.RenderTarget;\n        _this.gl_renderbuffer = null;\n        _this.texture = null;\n        var gl = _this.device.gl;\n        var format = descriptor.format, width = descriptor.width, height = descriptor.height, _b = descriptor.sampleCount, sampleCount = _b === void 0 ? 1 : _b, texture = descriptor.texture;\n        var useRenderbuffer = false;\n        // @see https://blog.tojicode.com/2012/07/using-webgldepthtexture.html\n        if ((format === Format.D32F || format === Format.D24_S8) &&\n            texture &&\n            !isWebGL2(gl) &&\n            !device.WEBGL_depth_texture) {\n            texture.destroy();\n            _this.texture = null;\n            useRenderbuffer = true;\n        }\n        if (!useRenderbuffer && texture) {\n            _this.texture = texture;\n        }\n        else {\n            _this.gl_renderbuffer = _this.device.ensureResourceExists(gl.createRenderbuffer());\n            gl.bindRenderbuffer(gl.RENDERBUFFER, _this.gl_renderbuffer);\n            var gl_format = _this.device.translateTextureInternalFormat(format, true);\n            if (isWebGL2(gl)) {\n                if (sampleCount > 1) {\n                    // @see https://github.com/shrekshao/MoveWebGL1EngineToWebGL2/blob/master/Move-a-WebGL-1-Engine-To-WebGL-2-Blog-2.md#multisampled-renderbuffers\n                    gl.renderbufferStorageMultisample(GL.RENDERBUFFER, sampleCount, gl_format, width, height);\n                }\n                else {\n                    gl.renderbufferStorage(GL.RENDERBUFFER, gl_format, width, height);\n                }\n            }\n            else {\n                // WebGL1 can only use FXAA or other post-processing methods\n                gl.renderbufferStorage(GL.RENDERBUFFER, gl_format, width, height);\n            }\n        }\n        _this.format = format;\n        _this.width = width;\n        _this.height = height;\n        _this.sampleCount = sampleCount;\n        return _this;\n    }\n    RenderTarget_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        if (this.gl_renderbuffer !== null) {\n            this.device.gl.deleteRenderbuffer(this.gl_renderbuffer);\n        }\n        if (this.texture) {\n            this.texture.destroy();\n        }\n    };\n    return RenderTarget_GL;\n}(ResourceBase_GL));\n\n// const quadVert = `\n// layout(location = 0) in vec2 a_Position;\n// out vec2 v_TexCoord;\n// void main() {\n//   v_TexCoord = 0.5 * (a_Position + 1.0);\n//   gl_Position = vec4(a_Position, 0., 1.);\n//   #ifdef VIEWPORT_ORIGIN_TL\n//     v_TexCoord.y = 1.0 - v_TexCoord.y;\n//   #endif\n// }\n// `;\nvar ProgramCompileState_GL;\n(function (ProgramCompileState_GL) {\n    ProgramCompileState_GL[ProgramCompileState_GL[\"NeedsCompile\"] = 0] = \"NeedsCompile\";\n    ProgramCompileState_GL[ProgramCompileState_GL[\"Compiling\"] = 1] = \"Compiling\";\n    ProgramCompileState_GL[ProgramCompileState_GL[\"NeedsBind\"] = 2] = \"NeedsBind\";\n    ProgramCompileState_GL[ProgramCompileState_GL[\"ReadyToUse\"] = 3] = \"ReadyToUse\";\n})(ProgramCompileState_GL || (ProgramCompileState_GL = {}));\nvar Program_GL = /** @class */ (function (_super) {\n    __extends(Program_GL, _super);\n    function Program_GL(_a, rawVertexGLSL) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.rawVertexGLSL = rawVertexGLSL;\n        _this.type = ResourceType.Program;\n        // eslint-disable-next-line\n        _this.uniformSetters = {};\n        _this.attributes = [];\n        var gl = _this.device.gl;\n        _this.descriptor = descriptor;\n        _this.gl_program = _this.device.ensureResourceExists(gl.createProgram());\n        _this.gl_shader_vert = null;\n        _this.gl_shader_frag = null;\n        _this.compileState = ProgramCompileState_GL.NeedsCompile;\n        _this.tryCompileProgram();\n        return _this;\n    }\n    Program_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.device.gl.deleteProgram(this.gl_program);\n        this.device.gl.deleteShader(this.gl_shader_vert);\n        this.device.gl.deleteShader(this.gl_shader_frag);\n    };\n    Program_GL.prototype.tryCompileProgram = function () {\n        assert(this.compileState === ProgramCompileState_GL.NeedsCompile);\n        var _a = this.descriptor, vertex = _a.vertex, fragment = _a.fragment;\n        var gl = this.device.gl;\n        // if (this.gl_shader_vert !== null) gl.deleteShader(this.gl_shader_vert);\n        // if (this.gl_shader_frag !== null) gl.deleteShader(this.gl_shader_frag);\n        if ((vertex === null || vertex === void 0 ? void 0 : vertex.glsl) && (fragment === null || fragment === void 0 ? void 0 : fragment.glsl)) {\n            this.gl_shader_vert = this.compileShader(vertex.postprocess ? vertex.postprocess(vertex.glsl) : vertex.glsl, gl.VERTEX_SHADER);\n            this.gl_shader_frag = this.compileShader(fragment.postprocess\n                ? fragment.postprocess(fragment.glsl)\n                : fragment.glsl, gl.FRAGMENT_SHADER);\n            gl.attachShader(this.gl_program, this.gl_shader_vert);\n            gl.attachShader(this.gl_program, this.gl_shader_frag);\n            gl.linkProgram(this.gl_program);\n            this.compileState = ProgramCompileState_GL.Compiling;\n            if (!isWebGL2(gl)) {\n                // extract uniforms\n                this.readUniformLocationsFromLinkedProgram();\n                // extract attributes\n                this.readAttributesFromLinkedProgram();\n            }\n        }\n    };\n    Program_GL.prototype.readAttributesFromLinkedProgram = function () {\n        var _a;\n        var gl = this.device.gl;\n        var count = gl.getProgramParameter(this.gl_program, gl.ACTIVE_ATTRIBUTES);\n        var defines = getDefines(this.descriptor.vertex.glsl);\n        var locations = getAttributeLocations(\n        // Use raw GLSL\n        this.rawVertexGLSL, defines);\n        var _loop_1 = function (index) {\n            var _b = gl.getActiveAttrib(this_1.gl_program, index), name_1 = _b.name, type = _b.type, size = _b.size;\n            var location_1 = gl.getAttribLocation(this_1.gl_program, name_1);\n            var definedLocation = (_a = locations.find(function (l) { return l.name === name_1; })) === null || _a === void 0 ? void 0 : _a.location;\n            // Add only user provided attributes, for built-in attributes like\n            // `gl_InstanceID` locaiton will be < 0\n            if (location_1 >= 0 && !isNil(definedLocation)) {\n                this_1.attributes[definedLocation] = {\n                    name: name_1,\n                    location: location_1,\n                    type: type,\n                    size: size,\n                };\n            }\n        };\n        var this_1 = this;\n        for (var index = 0; index < count; index++) {\n            _loop_1(index);\n        }\n    };\n    Program_GL.prototype.readUniformLocationsFromLinkedProgram = function () {\n        var gl = this.device.gl;\n        var numUniforms = gl.getProgramParameter(this.gl_program, gl.ACTIVE_UNIFORMS);\n        for (var i = 0; i < numUniforms; i++) {\n            var info = gl.getActiveUniform(this.gl_program, i);\n            var name_2 = parseUniformName(info.name).name;\n            var location_2 = gl.getUniformLocation(this.gl_program, name_2);\n            this.uniformSetters[name_2] = getUniformSetter(gl, location_2, info);\n            if (info && info.size > 1) {\n                for (var l = 0; l < info.size; l++) {\n                    location_2 = gl.getUniformLocation(this.gl_program, \"\".concat(name_2, \"[\").concat(l, \"]\"));\n                    this.uniformSetters[\"\".concat(name_2, \"[\").concat(l, \"]\")] = getUniformSetter(gl, location_2, info);\n                }\n            }\n        }\n    };\n    Program_GL.prototype.compileShader = function (contents, type) {\n        var gl = this.device.gl;\n        var shader = this.device.ensureResourceExists(gl.createShader(type));\n        gl.shaderSource(shader, contents);\n        gl.compileShader(shader);\n        return shader;\n    };\n    // eslint-disable-next-line\n    Program_GL.prototype.setUniformsLegacy = function (uniforms) {\n        if (uniforms === void 0) { uniforms = {}; }\n        var gl = this.device.gl;\n        if (!isWebGL2(gl)) {\n            var programUsed = false;\n            for (var uniformName in uniforms) {\n                if (!programUsed) {\n                    gl.useProgram(this.gl_program);\n                    programUsed = true;\n                }\n                var uniform = uniforms[uniformName];\n                var uniformSetter = this.uniformSetters[uniformName];\n                if (uniformSetter) {\n                    var value = uniform;\n                    if (value instanceof Texture_GL) {\n                        value = value.textureIndex;\n                    }\n                    uniformSetter(value);\n                }\n            }\n        }\n        return this;\n    };\n    return Program_GL;\n}(ResourceBase_GL));\n\nvar QueryPool_GL = /** @class */ (function (_super) {\n    __extends(QueryPool_GL, _super);\n    function QueryPool_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.QueryPool;\n        var gl = _this.device.gl;\n        if (isWebGL2(gl)) {\n            var elemCount = descriptor.elemCount, type = descriptor.type;\n            _this.gl_query = nArray(elemCount, function () {\n                return _this.device.ensureResourceExists(gl.createQuery());\n            });\n            _this.gl_query_type = translateQueryPoolType$1(type);\n        }\n        return _this;\n    }\n    QueryPool_GL.prototype.queryResultOcclusion = function (dstOffs) {\n        var gl = this.device.gl;\n        if (isWebGL2(gl)) {\n            var gl_query = this.gl_query[dstOffs];\n            if (!gl.getQueryParameter(gl_query, gl.QUERY_RESULT_AVAILABLE)) {\n                return null;\n            }\n            return !!gl.getQueryParameter(gl_query, gl.QUERY_RESULT);\n        }\n        return null;\n    };\n    QueryPool_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        var gl = this.device.gl;\n        if (isWebGL2(gl)) {\n            for (var i = 0; i < this.gl_query.length; i++) {\n                gl.deleteQuery(this.gl_query[i]);\n            }\n        }\n    };\n    return QueryPool_GL;\n}(ResourceBase_GL));\n\nvar Readback_GL = /** @class */ (function (_super) {\n    __extends(Readback_GL, _super);\n    function Readback_GL(_a) {\n        var id = _a.id, device = _a.device;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Readback;\n        _this.gl_pbo = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLSync\n        _this.gl_sync = null;\n        return _this;\n    }\n    Readback_GL.prototype.clientWaitAsync = function (sync, flags, interval_ms) {\n        if (flags === void 0) { flags = 0; }\n        if (interval_ms === void 0) { interval_ms = 10; }\n        var gl = this.device.gl;\n        return new Promise(function (resolve, reject) {\n            function test() {\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/clientWaitSync\n                var res = gl.clientWaitSync(sync, flags, 0);\n                if (res == gl.WAIT_FAILED) {\n                    reject();\n                    return;\n                }\n                if (res == gl.TIMEOUT_EXPIRED) {\n                    setTimeout(test, clamp(interval_ms, 0, gl.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));\n                    return;\n                }\n                resolve();\n            }\n            test();\n        });\n    };\n    Readback_GL.prototype.getBufferSubDataAsync = function (target, buffer, srcByteOffset, dstBuffer, dstOffset, length) {\n        return __awaiter(this, void 0, void 0, function () {\n            var gl;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        gl = this.device.gl;\n                        if (!isWebGL2(gl)) return [3 /*break*/, 2];\n                        // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/fenceSync\n                        this.gl_sync = gl.fenceSync(gl.SYNC_GPU_COMMANDS_COMPLETE, 0);\n                        gl.flush();\n                        return [4 /*yield*/, this.clientWaitAsync(this.gl_sync, 0, 10)];\n                    case 1:\n                        _a.sent();\n                        gl.bindBuffer(target, buffer);\n                        gl.getBufferSubData(target, srcByteOffset, dstBuffer, dstOffset, length);\n                        gl.bindBuffer(target, null);\n                        return [2 /*return*/, dstBuffer];\n                    case 2: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#use_non-blocking_async_data_readback\n     */\n    Readback_GL.prototype.readTexture = function (t, x, y, width, height, dstBuffer, dstOffset, length) {\n        if (dstOffset === void 0) { dstOffset = 0; }\n        if (length === void 0) { length = dstBuffer.byteLength || 0; }\n        return __awaiter(this, void 0, void 0, function () {\n            var gl, texture, gl_format, gl_type, formatByteSize;\n            return __generator(this, function (_a) {\n                gl = this.device.gl;\n                texture = t;\n                gl_format = this.device.translateTextureFormat(texture.format);\n                gl_type = this.device.translateTextureType(texture.format);\n                formatByteSize = getFormatByteSize(texture.format);\n                if (isWebGL2(gl)) {\n                    this.gl_pbo = this.device.ensureResourceExists(gl.createBuffer());\n                    // PIXEL_PACK_BUFFER: Buffer used for pixel transfer operations\n                    // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bindBuffer\n                    gl.bindBuffer(gl.PIXEL_PACK_BUFFER, this.gl_pbo);\n                    // STREAM_READ: The contents are intended to be specified once by reading data from WebGL, and queried at most a few times by the application\n                    // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bufferData\n                    gl.bufferData(gl.PIXEL_PACK_BUFFER, length, gl.STREAM_READ);\n                    gl.bindBuffer(gl.PIXEL_PACK_BUFFER, null);\n                    gl.bindFramebuffer(GL.READ_FRAMEBUFFER, this.device['readbackFramebuffer']);\n                    gl.framebufferTexture2D(GL.READ_FRAMEBUFFER, GL.COLOR_ATTACHMENT0, GL.TEXTURE_2D, texture.gl_texture, 0);\n                    gl.bindBuffer(gl.PIXEL_PACK_BUFFER, this.gl_pbo);\n                    gl.readPixels(x, y, width, height, gl_format, gl_type, dstOffset * formatByteSize);\n                    gl.bindBuffer(gl.PIXEL_PACK_BUFFER, null);\n                    return [2 /*return*/, this.getBufferSubDataAsync(gl.PIXEL_PACK_BUFFER, this.gl_pbo, 0, dstBuffer, dstOffset, 0)];\n                }\n                else {\n                    return [2 /*return*/, this.readTextureSync(t, x, y, width, height, dstBuffer, dstOffset, length)];\n                }\n            });\n        });\n    };\n    Readback_GL.prototype.readTextureSync = function (t, x, y, width, height, dstBuffer, dstOffset, length) {\n        if (length === void 0) { length = dstBuffer.byteLength || 0; }\n        var gl = this.device.gl;\n        var texture = t;\n        var gl_type = this.device.translateTextureType(texture.format);\n        gl.bindFramebuffer(GL.FRAMEBUFFER, this.device['readbackFramebuffer']);\n        gl.framebufferTexture2D(GL.FRAMEBUFFER, GL.COLOR_ATTACHMENT0, GL.TEXTURE_2D, texture.gl_texture, 0);\n        // slow requires roundtrip to GPU\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/pixelStorei\n        gl.pixelStorei(gl.PACK_ALIGNMENT, 4);\n        gl.readPixels(x, y, width, height, gl.RGBA, gl_type, dstBuffer);\n        return dstBuffer;\n    };\n    Readback_GL.prototype.readBuffer = function (b, srcByteOffset, dstBuffer, dstOffset, length) {\n        return __awaiter(this, void 0, void 0, function () {\n            var gl;\n            return __generator(this, function (_a) {\n                gl = this.device.gl;\n                if (isWebGL2(gl)) {\n                    return [2 /*return*/, this.getBufferSubDataAsync(gl.ARRAY_BUFFER, getPlatformBuffer$1(b, srcByteOffset), srcByteOffset, dstBuffer, dstOffset, length)];\n                }\n                // TODO: WebGL1\n                return [2 /*return*/, Promise.reject()];\n            });\n        });\n    };\n    Readback_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        if (isWebGL2(this.device.gl)) {\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/deleteSync\n            if (this.gl_sync !== null) {\n                this.device.gl.deleteSync(this.gl_sync);\n            }\n            if (this.gl_pbo !== null) {\n                this.device.gl.deleteBuffer(this.gl_pbo);\n            }\n        }\n    };\n    return Readback_GL;\n}(ResourceBase_GL));\n\nvar RenderPipeline_GL = /** @class */ (function (_super) {\n    __extends(RenderPipeline_GL, _super);\n    function RenderPipeline_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _b, _c;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.RenderPipeline;\n        _this.drawMode = translatePrimitiveTopology((_b = descriptor.topology) !== null && _b !== void 0 ? _b : PrimitiveTopology.TRIANGLES);\n        _this.program = descriptor.program;\n        _this.inputLayout = descriptor.inputLayout;\n        _this.megaState = __assign(__assign({}, copyMegaState(defaultMegaState)), descriptor.megaStateDescriptor);\n        _this.colorAttachmentFormats = descriptor.colorAttachmentFormats.slice();\n        _this.depthStencilAttachmentFormat = descriptor.depthStencilAttachmentFormat;\n        _this.sampleCount = (_c = descriptor.sampleCount) !== null && _c !== void 0 ? _c : 1;\n        return _this;\n    }\n    return RenderPipeline_GL;\n}(ResourceBase_GL));\n\nvar ComputePipeline_GL = /** @class */ (function (_super) {\n    __extends(ComputePipeline_GL, _super);\n    function ComputePipeline_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.ComputePipeline;\n        _this.descriptor = descriptor;\n        return _this;\n        // const program = descriptor.program as Program_GL;\n    }\n    return ComputePipeline_GL;\n}(ResourceBase_GL));\n\nvar ResourceCreationTracker = /** @class */ (function () {\n    function ResourceCreationTracker() {\n        this.liveObjects = new Set();\n        this.creationStacks = new Map();\n        this.deletionStacks = new Map();\n    }\n    ResourceCreationTracker.prototype.trackResourceCreated = function (o) {\n        this.creationStacks.set(o, new Error().stack);\n        this.liveObjects.add(o);\n    };\n    ResourceCreationTracker.prototype.trackResourceDestroyed = function (o) {\n        if (this.deletionStacks.has(o))\n            console.warn(\"Object double freed:\", o, \"\\n\\nCreation stack: \", this.creationStacks.get(o), \"\\n\\nDeletion stack: \", this.deletionStacks.get(o), \"\\n\\nThis stack: \", new Error().stack);\n        this.deletionStacks.set(o, new Error().stack);\n        this.liveObjects.delete(o);\n    };\n    ResourceCreationTracker.prototype.checkForLeaks = function () {\n        var e_1, _a;\n        try {\n            for (var _b = __values(this.liveObjects.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var o = _c.value;\n                console.warn('Object leaked:', o, 'Creation stack:', this.creationStacks.get(o));\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    };\n    ResourceCreationTracker.prototype.setResourceLeakCheck = function (o, v) {\n        if (v) {\n            this.liveObjects.add(o);\n        }\n        else {\n            this.liveObjects.delete(o);\n        }\n    };\n    return ResourceCreationTracker;\n}());\n\n/**\n * In WebGL 1 texture image data and sampling information are both stored in texture objects\n * @see https://github.com/shrekshao/MoveWebGL1EngineToWebGL2/blob/master/Move-a-WebGL-1-Engine-To-WebGL-2-Blog-2.md#sampler-objects\n */\nvar Sampler_GL = /** @class */ (function (_super) {\n    __extends(Sampler_GL, _super);\n    function Sampler_GL(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _b, _c;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Sampler;\n        var gl = _this.device.gl;\n        if (isWebGL2(gl)) {\n            var gl_sampler = _this.device.ensureResourceExists(gl.createSampler());\n            gl.samplerParameteri(gl_sampler, GL.TEXTURE_WRAP_S, translateAddressMode$1(descriptor.addressModeU));\n            gl.samplerParameteri(gl_sampler, GL.TEXTURE_WRAP_T, translateAddressMode$1(descriptor.addressModeV));\n            gl.samplerParameteri(gl_sampler, GL.TEXTURE_WRAP_R, translateAddressMode$1((_b = descriptor.addressModeW) !== null && _b !== void 0 ? _b : descriptor.addressModeU));\n            gl.samplerParameteri(gl_sampler, GL.TEXTURE_MIN_FILTER, translateFilterMode(descriptor.minFilter, descriptor.mipmapFilter));\n            gl.samplerParameteri(gl_sampler, GL.TEXTURE_MAG_FILTER, translateFilterMode(descriptor.magFilter, MipmapFilterMode.NO_MIP));\n            if (descriptor.lodMinClamp !== undefined) {\n                gl.samplerParameterf(gl_sampler, GL.TEXTURE_MIN_LOD, descriptor.lodMinClamp);\n            }\n            if (descriptor.lodMaxClamp !== undefined) {\n                gl.samplerParameterf(gl_sampler, GL.TEXTURE_MAX_LOD, descriptor.lodMaxClamp);\n            }\n            if (descriptor.compareFunction !== undefined) {\n                gl.samplerParameteri(gl_sampler, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE);\n                gl.samplerParameteri(gl_sampler, gl.TEXTURE_COMPARE_FUNC, descriptor.compareFunction);\n            }\n            var maxAnisotropy = (_c = descriptor.maxAnisotropy) !== null && _c !== void 0 ? _c : 1;\n            if (maxAnisotropy > 1 &&\n                _this.device.EXT_texture_filter_anisotropic !== null) {\n                assert(descriptor.minFilter === FilterMode.BILINEAR &&\n                    descriptor.magFilter === FilterMode.BILINEAR &&\n                    descriptor.mipmapFilter === MipmapFilterMode.LINEAR);\n                gl.samplerParameterf(gl_sampler, _this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT, maxAnisotropy);\n            }\n            _this.gl_sampler = gl_sampler;\n        }\n        else {\n            // use later in WebGL1\n            _this.descriptor = descriptor;\n        }\n        return _this;\n    }\n    Sampler_GL.prototype.setTextureParameters = function (gl_target, width, height) {\n        var _a;\n        var gl = this.device.gl;\n        var descriptor = this.descriptor;\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL#%E9%9D%9E2%E7%9A%84%E5%B9%82%E7%BA%B9%E7%90%86\n        if (this.isNPOT(width, height)) {\n            gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_MIN_FILTER, GL.LINEAR);\n        }\n        else {\n            gl.texParameteri(gl_target, GL.TEXTURE_MIN_FILTER, translateFilterMode(descriptor.minFilter, descriptor.mipmapFilter));\n        }\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_WRAP_S, translateAddressMode$1(descriptor.addressModeU));\n        gl.texParameteri(GL.TEXTURE_2D, GL.TEXTURE_WRAP_T, translateAddressMode$1(descriptor.addressModeV));\n        gl.texParameteri(gl_target, GL.TEXTURE_MAG_FILTER, translateFilterMode(descriptor.magFilter, MipmapFilterMode.NO_MIP));\n        // if (descriptor.lodMinClamp !== undefined) {\n        //   gl.texParameterf(gl_target, GL.TEXTURE_MIN_LOD, descriptor.lodMinClamp);\n        // }\n        // if (descriptor.lodMaxClamp !== undefined) {\n        //   gl.texParameterf(gl_target, GL.TEXTURE_MAX_LOD, descriptor.lodMaxClamp);\n        // }\n        var maxAnisotropy = (_a = descriptor.maxAnisotropy) !== null && _a !== void 0 ? _a : 1;\n        if (maxAnisotropy > 1 &&\n            this.device.EXT_texture_filter_anisotropic !== null) {\n            assert(descriptor.minFilter === FilterMode.BILINEAR &&\n                descriptor.magFilter === FilterMode.BILINEAR &&\n                descriptor.mipmapFilter === MipmapFilterMode.LINEAR);\n            gl.texParameteri(gl_target, this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT, maxAnisotropy);\n        }\n    };\n    Sampler_GL.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        if (isWebGL2(this.device.gl)) {\n            this.device.gl.deleteSampler(getPlatformSampler$1(this));\n        }\n    };\n    Sampler_GL.prototype.isNPOT = function (width, height) {\n        return !isPowerOfTwo(width) || !isPowerOfTwo(height);\n    };\n    return Sampler_GL;\n}(ResourceBase_GL));\n\n// import { assert, assertExists } from '../api';\n// import type { ComputePipeline_GL } from './ComputePipeline';\nvar ComputePass_GL = /** @class */ (function () {\n    function ComputePass_GL() {\n    }\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpucomputepassencoder-dispatch\n     */\n    ComputePass_GL.prototype.dispatchWorkgroups = function (workgroupCountX, workgroupCountY, workgroupCountZ) { };\n    ComputePass_GL.prototype.dispatchWorkgroupsIndirect = function (indirectBuffer, indirectOffset) { };\n    ComputePass_GL.prototype.setPipeline = function (pipeline_) {\n        // const pipeline = pipeline_ as ComputePipeline_WebGPU;\n        // const gpuComputePipeline = assertExists(pipeline.gpuComputePipeline);\n        // this.gpuComputePassEncoder.setPipeline(gpuComputePipeline);\n    };\n    ComputePass_GL.prototype.setBindings = function (bindings_) {\n        // const bindings = bindings_ as Bindings_WebGPU;\n        // this.gpuComputePassEncoder.setBindGroup(bindingLayoutIndex, bindings.gpuBindGroup[0]);\n    };\n    ComputePass_GL.prototype.pushDebugGroup = function (name) { };\n    ComputePass_GL.prototype.popDebugGroup = function () { };\n    ComputePass_GL.prototype.insertDebugMarker = function (markerLabel) { };\n    return ComputePass_GL;\n}());\n\nvar RenderBundle_GL = /** @class */ (function (_super) {\n    __extends(RenderBundle_GL, _super);\n    function RenderBundle_GL() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = ResourceType.RenderBundle;\n        _this.commands = [];\n        return _this;\n    }\n    RenderBundle_GL.prototype.push = function (f) {\n        this.commands.push(f);\n    };\n    RenderBundle_GL.prototype.replay = function () {\n        this.commands.forEach(function (f) { return f(); });\n    };\n    return RenderBundle_GL;\n}(ResourceBase_GL));\n\n// This is a workaround for ANGLE not supporting UBOs greater than 64kb (the limit of D3D).\n// https://bugs.chromium.org/p/angleproject/issues/detail?id=3388\nvar UBO_PAGE_MAX_BYTE_SIZE = 0x10000;\n/**\n * Extract uniform blocks from shader source.\n *\n * @example\n * ```glsl\n * layout(std140) uniform CommonUniforms {\n    float u_blur;\n  };\n * ```\n */\nvar UNIFROM_BLOCK_REGEXP = /uniform(?:\\s+)(\\w+)(?:\\s?){([^]*?)}/g;\nvar Device_GL = /** @class */ (function () {\n    function Device_GL(gl, configuration) {\n        if (configuration === void 0) { configuration = {}; }\n        // Configuration\n        this.shaderDebug = false;\n        // GL extensions\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/OES_vertex_array_object\n        this.OES_vertex_array_object = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/ANGLE_instanced_arrays\n        this.ANGLE_instanced_arrays = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/OES_texture_float\n        this.OES_texture_float = null;\n        // @see https://www.khronos.org/registry/webgl/extensions/OES_draw_buffers_indexed/\n        this.OES_draw_buffers_indexed = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_draw_buffers\n        this.WEBGL_draw_buffers = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_depth_texture\n        this.WEBGL_depth_texture = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_color_buffer_float\n        this.WEBGL_color_buffer_float = null;\n        this.EXT_color_buffer_half_float = null;\n        this.WEBGL_compressed_texture_s3tc = null;\n        this.WEBGL_compressed_texture_s3tc_srgb = null;\n        this.EXT_texture_compression_rgtc = null;\n        this.EXT_texture_filter_anisotropic = null;\n        this.KHR_parallel_shader_compile = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/EXT_texture_norm16\n        this.EXT_texture_norm16 = null;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/EXT_color_buffer_float\n        this.EXT_color_buffer_float = null;\n        this.OES_texture_float_linear = null;\n        this.OES_texture_half_float_linear = null;\n        // Swap Chain\n        this.scTexture = null;\n        this.scPlatformFramebuffer = null;\n        // Device\n        this.currentActiveTexture = null;\n        this.currentBoundVAO = null;\n        this.currentProgram = null;\n        this.resourceCreationTracker = null;\n        this.resourceUniqueId = 0;\n        // Cached GL driver state\n        this.currentColorAttachments = [];\n        this.currentColorAttachmentLevels = [];\n        this.currentColorResolveTos = [];\n        this.currentColorResolveToLevels = [];\n        this.currentSampleCount = -1;\n        this.currentIndexBufferByteOffset = null;\n        this.currentMegaState = copyMegaState(defaultMegaState);\n        this.currentSamplers = [];\n        this.currentTextures = [];\n        this.currentUniformBuffers = [];\n        this.currentUniformBufferByteOffsets = [];\n        this.currentUniformBufferByteSizes = [];\n        this.currentScissorEnabled = false;\n        this.currentStencilRef = null;\n        // Pass Execution\n        this.currentRenderPassDescriptor = null;\n        this.currentRenderPassDescriptorStack = [];\n        this.debugGroupStack = [];\n        this.resolveColorAttachmentsChanged = false;\n        this.resolveDepthStencilAttachmentsChanged = false;\n        this.explicitBindingLocations = false;\n        this.separateSamplerTextures = false;\n        this.viewportOrigin = ViewportOrigin.LOWER_LEFT;\n        this.clipSpaceNearZ = ClipSpaceNearZ.NEGATIVE_ONE;\n        this.supportMRT = false;\n        this.inBlitRenderPass = false;\n        this.supportedSampleCounts = [];\n        this.occlusionQueriesRecommended = false;\n        this.computeShadersSupported = false;\n        this.gl = gl;\n        this.contextAttributes = assertExists(gl.getContextAttributes());\n        if (!isWebGL2(gl)) {\n            this.OES_vertex_array_object = gl.getExtension('OES_vertex_array_object');\n            // TODO: when ANGLE_instanced_arrays unavailable...\n            this.ANGLE_instanced_arrays = gl.getExtension('ANGLE_instanced_arrays');\n            this.OES_texture_float = gl.getExtension('OES_texture_float');\n            this.WEBGL_draw_buffers = gl.getExtension('WEBGL_draw_buffers');\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_depth_texture\n            this.WEBGL_depth_texture = gl.getExtension('WEBGL_depth_texture');\n            this.WEBGL_color_buffer_float = gl.getExtension('WEBGL_color_buffer_float');\n            this.EXT_color_buffer_half_float = gl.getExtension('EXT_color_buffer_half_float');\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/EXT_frag_depth\n            gl.getExtension('EXT_frag_depth');\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/OES_element_index_uint\n            gl.getExtension('OES_element_index_uint');\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/OES_standard_derivatives\n            gl.getExtension('OES_standard_derivatives');\n        }\n        else {\n            this.EXT_texture_norm16 = gl.getExtension('EXT_texture_norm16');\n            this.EXT_color_buffer_float = gl.getExtension('EXT_color_buffer_float');\n        }\n        this.WEBGL_compressed_texture_s3tc = gl.getExtension('WEBGL_compressed_texture_s3tc');\n        this.WEBGL_compressed_texture_s3tc_srgb = gl.getExtension('WEBGL_compressed_texture_s3tc_srgb');\n        this.EXT_texture_compression_rgtc = gl.getExtension('EXT_texture_compression_rgtc');\n        this.EXT_texture_filter_anisotropic = gl.getExtension('EXT_texture_filter_anisotropic');\n        this.EXT_texture_norm16 = gl.getExtension('EXT_texture_norm16');\n        this.OES_texture_float_linear = gl.getExtension('OES_texture_float_linear');\n        this.OES_texture_half_float_linear = gl.getExtension('OES_texture_half_float_linear');\n        this.KHR_parallel_shader_compile = gl.getExtension('KHR_parallel_shader_compile');\n        // this.OES_draw_buffers_indexed = gl.getExtension('OES_draw_buffers_indexed');\n        if (isWebGL2(gl)) {\n            this.platformString = 'WebGL2';\n            this.glslVersion = '#version 300 es';\n        }\n        else {\n            this.platformString = 'WebGL1';\n            this.glslVersion = '#version 100'; // 100 es not supported\n        }\n        // Create our fake swap-chain texture.\n        this.scTexture = new Texture_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: {\n                width: 0,\n                height: 0,\n                depthOrArrayLayers: 1,\n                dimension: TextureDimension.TEXTURE_2D,\n                mipLevelCount: 1,\n                usage: TextureUsage.RENDER_TARGET,\n                format: this.contextAttributes.alpha === false\n                    ? Format.U8_RGB_RT\n                    : Format.U8_RGBA_RT,\n            },\n            fake: true,\n        });\n        this.scTexture.formatKind = SamplerFormatKind.Float;\n        this.scTexture.gl_target = null;\n        this.scTexture.gl_texture = null;\n        this.resolveColorReadFramebuffer = this.ensureResourceExists(gl.createFramebuffer());\n        this.resolveColorDrawFramebuffer = this.ensureResourceExists(gl.createFramebuffer());\n        this.resolveDepthStencilReadFramebuffer = this.ensureResourceExists(gl.createFramebuffer());\n        this.resolveDepthStencilDrawFramebuffer = this.ensureResourceExists(gl.createFramebuffer());\n        this.renderPassDrawFramebuffer = this.ensureResourceExists(gl.createFramebuffer());\n        this.readbackFramebuffer = this.ensureResourceExists(gl.createFramebuffer());\n        this.fallbackTexture2D = this.createFallbackTexture(TextureDimension.TEXTURE_2D, SamplerFormatKind.Float);\n        this.fallbackTexture2DDepth = this.createFallbackTexture(TextureDimension.TEXTURE_2D, SamplerFormatKind.Depth);\n        this.fallbackVertexBuffer = this.createBuffer({\n            viewOrSize: 1,\n            usage: BufferUsage.VERTEX,\n            hint: BufferFrequencyHint.STATIC,\n        });\n        if (isWebGL2(gl)) {\n            this.fallbackTexture2DArray = this.createFallbackTexture(TextureDimension.TEXTURE_2D_ARRAY, SamplerFormatKind.Float);\n            this.fallbackTexture3D = this.createFallbackTexture(TextureDimension.TEXTURE_3D, SamplerFormatKind.Float);\n            this.fallbackTextureCube = this.createFallbackTexture(TextureDimension.TEXTURE_CUBE_MAP, SamplerFormatKind.Float);\n        }\n        // Adjust for GL defaults.\n        this.currentMegaState.depthCompare = CompareFunction.LESS;\n        this.currentMegaState.depthWrite = false;\n        this.currentMegaState.attachmentsState[0].channelWriteMask =\n            ChannelWriteMask.ALL;\n        // always have depth test enabled.\n        gl.enable(gl.DEPTH_TEST);\n        gl.enable(gl.STENCIL_TEST);\n        this.checkLimits();\n        if (configuration.shaderDebug) {\n            this.shaderDebug = true;\n        }\n        if (configuration.trackResources) {\n            this.resourceCreationTracker = new ResourceCreationTracker();\n        }\n    }\n    Device_GL.prototype.destroy = function () {\n        if (this.blitBindings) {\n            this.blitBindings.destroy();\n        }\n        if (this.blitInputLayout) {\n            this.blitInputLayout.destroy();\n        }\n        if (this.blitRenderPipeline) {\n            this.blitRenderPipeline.destroy();\n        }\n        if (this.blitVertexBuffer) {\n            this.blitVertexBuffer.destroy();\n        }\n        if (this.blitProgram) {\n            this.blitProgram.destroy();\n        }\n    };\n    Device_GL.prototype.createFallbackTexture = function (dimension, formatKind) {\n        var depthOrArrayLayers = dimension === TextureDimension.TEXTURE_CUBE_MAP ? 6 : 1;\n        // const supportDepthTexture =\n        //   isWebGL2(this.gl) || (!isWebGL2(this.gl) && !!this.WEBGL_depth_texture);\n        var format = formatKind === SamplerFormatKind.Depth\n            ? Format.D32F\n            : Format.U8_RGBA_NORM;\n        var texture = this.createTexture({\n            dimension: dimension,\n            format: format,\n            usage: TextureUsage.SAMPLED,\n            width: 1,\n            height: 1,\n            depthOrArrayLayers: depthOrArrayLayers,\n            mipLevelCount: 1,\n        });\n        if (formatKind === SamplerFormatKind.Float) {\n            texture.setImageData([new Uint8Array(4 * depthOrArrayLayers)]);\n        }\n        return getPlatformTexture(texture);\n    };\n    Device_GL.prototype.getNextUniqueId = function () {\n        return ++this.resourceUniqueId;\n    };\n    Device_GL.prototype.checkLimits = function () {\n        var gl = this.gl;\n        this.maxVertexAttribs = gl.getParameter(GL.MAX_VERTEX_ATTRIBS);\n        if (isWebGL2(gl)) {\n            this.uniformBufferMaxPageByteSize = Math.min(gl.getParameter(GL.MAX_UNIFORM_BLOCK_SIZE), UBO_PAGE_MAX_BYTE_SIZE);\n            this.uniformBufferWordAlignment =\n                gl.getParameter(gl.UNIFORM_BUFFER_OFFSET_ALIGNMENT) / 4;\n            var supportedSampleCounts = gl.getInternalformatParameter(gl.RENDERBUFFER, gl.DEPTH32F_STENCIL8, gl.SAMPLES);\n            this.supportedSampleCounts = supportedSampleCounts\n                ? __spreadArray([], __read(supportedSampleCounts), false) : [];\n            this.occlusionQueriesRecommended = true;\n        }\n        else {\n            // mock ubo in WebGL1\n            this.uniformBufferWordAlignment = 64;\n            this.uniformBufferMaxPageByteSize = UBO_PAGE_MAX_BYTE_SIZE;\n        }\n        this.uniformBufferMaxPageWordSize = this.uniformBufferMaxPageByteSize / 4;\n        if (!this.supportedSampleCounts.includes(1)) {\n            this.supportedSampleCounts.push(1);\n        }\n        this.supportedSampleCounts.sort(function (a, b) { return a - b; });\n    };\n    //#region SwapChain\n    Device_GL.prototype.configureSwapChain = function (width, height, platformFramebuffer) {\n        var texture = this.scTexture;\n        texture.width = width;\n        texture.height = height;\n        this.scPlatformFramebuffer = nullify(platformFramebuffer);\n    };\n    Device_GL.prototype.getDevice = function () {\n        return this;\n    };\n    Device_GL.prototype.getCanvas = function () {\n        return this.gl.canvas;\n    };\n    Device_GL.prototype.getOnscreenTexture = function () {\n        return this.scTexture;\n    };\n    Device_GL.prototype.beginFrame = function () { };\n    Device_GL.prototype.endFrame = function () { };\n    //#endregion\n    //#region Device\n    // @see https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n    Device_GL.prototype.translateTextureInternalFormat = function (fmt, isRenderbufferStorage) {\n        if (isRenderbufferStorage === void 0) { isRenderbufferStorage = false; }\n        switch (fmt) {\n            case Format.ALPHA:\n                return GL.ALPHA;\n            case Format.U8_LUMINANCE:\n            case Format.F16_LUMINANCE:\n            case Format.F32_LUMINANCE:\n                return GL.LUMINANCE;\n            // case Format.LUMINANCE_ALPHA:\n            //   return GL.LUMINANCE_ALPHA;\n            case Format.F16_R:\n                return GL.R16F;\n            case Format.F16_RG:\n                return GL.RG16F;\n            case Format.F16_RGB:\n                return GL.RGB16F;\n            case Format.F16_RGBA:\n                return GL.RGBA16F;\n            case Format.F32_R:\n                return GL.R32F;\n            case Format.F32_RG:\n                return GL.RG32F;\n            case Format.F32_RGB:\n                return GL.RGB32F;\n            case Format.F32_RGBA:\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_color_buffer_float\n                return isWebGL2(this.gl)\n                    ? GL.RGBA32F\n                    : isRenderbufferStorage\n                        ? this.WEBGL_color_buffer_float.RGBA32F_EXT\n                        : GL.RGBA;\n            case Format.U8_R_NORM:\n                return GL.R8;\n            case Format.U8_RG_NORM:\n                return GL.RG8;\n            case Format.U8_RGB_NORM:\n            case Format.U8_RGB_RT:\n                return GL.RGB8;\n            case Format.U8_RGB_SRGB:\n                return GL.SRGB8;\n            case Format.U8_RGBA_NORM:\n            case Format.U8_RGBA_RT:\n                // WebGL1 renderbuffer only support RGBA4 RGB565 RGB5_A1\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/renderbufferStorage#parameters\n                // But texImage2D allows RGBA\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texImage2D\n                return isWebGL2(this.gl)\n                    ? GL.RGBA8\n                    : isRenderbufferStorage\n                        ? GL.RGBA4\n                        : GL.RGBA;\n            case Format.U8_RGBA:\n                return GL.RGBA;\n            case Format.U8_RGBA_SRGB:\n            case Format.U8_RGBA_RT_SRGB:\n                return GL.SRGB8_ALPHA8;\n            case Format.U16_R:\n                return GL.R16UI;\n            case Format.U16_R_NORM:\n                return this.EXT_texture_norm16.R16_EXT;\n            case Format.U16_RG_NORM:\n                return this.EXT_texture_norm16.RG16_EXT;\n            case Format.U16_RGBA_NORM:\n                return this.EXT_texture_norm16.RGBA16_EXT;\n            case Format.U16_RGBA_5551:\n                return GL.RGB5_A1;\n            case Format.U16_RGB_565:\n                return GL.RGB565;\n            case Format.U32_R:\n                return GL.R32UI;\n            case Format.S8_RGBA_NORM:\n                return GL.RGBA8_SNORM;\n            case Format.S8_RG_NORM:\n                return GL.RG8_SNORM;\n            case Format.BC1:\n                return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n            case Format.BC1_SRGB:\n                return this.WEBGL_compressed_texture_s3tc_srgb\n                    .COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n            case Format.BC2:\n                return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n            case Format.BC2_SRGB:\n                return this.WEBGL_compressed_texture_s3tc_srgb\n                    .COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;\n            case Format.BC3:\n                return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n            case Format.BC3_SRGB:\n                return this.WEBGL_compressed_texture_s3tc_srgb\n                    .COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n            case Format.BC4_UNORM:\n                return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;\n            case Format.BC4_SNORM:\n                return this.EXT_texture_compression_rgtc\n                    .COMPRESSED_SIGNED_RED_RGTC1_EXT;\n            case Format.BC5_UNORM:\n                return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;\n            case Format.BC5_SNORM:\n                return this.EXT_texture_compression_rgtc\n                    .COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;\n            case Format.D32F_S8:\n                return isWebGL2(this.gl)\n                    ? GL.DEPTH32F_STENCIL8\n                    : this.WEBGL_depth_texture\n                        ? GL.DEPTH_STENCIL\n                        : GL.DEPTH_COMPONENT16;\n            case Format.D24_S8:\n                return isWebGL2(this.gl)\n                    ? GL.DEPTH24_STENCIL8\n                    : this.WEBGL_depth_texture\n                        ? GL.DEPTH_STENCIL\n                        : GL.DEPTH_COMPONENT16;\n            case Format.D32F:\n                return isWebGL2(this.gl)\n                    ? GL.DEPTH_COMPONENT32F\n                    : this.WEBGL_depth_texture\n                        ? GL.DEPTH_COMPONENT\n                        : GL.DEPTH_COMPONENT16;\n            case Format.D24:\n                return isWebGL2(this.gl)\n                    ? GL.DEPTH_COMPONENT24\n                    : this.WEBGL_depth_texture\n                        ? GL.DEPTH_COMPONENT\n                        : GL.DEPTH_COMPONENT16;\n            default:\n                throw new Error('whoops');\n        }\n    };\n    Device_GL.prototype.translateTextureType = function (fmt) {\n        var typeFlags = getFormatTypeFlags(fmt);\n        switch (typeFlags) {\n            case FormatTypeFlags.U8:\n                return GL.UNSIGNED_BYTE;\n            case FormatTypeFlags.U16:\n                return GL.UNSIGNED_SHORT;\n            case FormatTypeFlags.U32:\n                return GL.UNSIGNED_INT;\n            case FormatTypeFlags.S8:\n                return GL.BYTE;\n            case FormatTypeFlags.F16:\n                return GL.HALF_FLOAT;\n            case FormatTypeFlags.F32:\n                return GL.FLOAT;\n            case FormatTypeFlags.U16_PACKED_5551:\n                return GL.UNSIGNED_SHORT_5_5_5_1;\n            case FormatTypeFlags.D32F:\n                return isWebGL2(this.gl)\n                    ? GL.FLOAT\n                    : this.WEBGL_depth_texture\n                        ? GL.UNSIGNED_INT\n                        : GL.UNSIGNED_BYTE;\n            case FormatTypeFlags.D24:\n                return isWebGL2(this.gl)\n                    ? GL.UNSIGNED_INT_24_8\n                    : this.WEBGL_depth_texture\n                        ? GL.UNSIGNED_SHORT\n                        : GL.UNSIGNED_BYTE;\n            case FormatTypeFlags.D24S8:\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_depth_texture\n                return isWebGL2(this.gl)\n                    ? GL.UNSIGNED_INT_24_8\n                    : this.WEBGL_depth_texture\n                        ? GL.UNSIGNED_INT_24_8_WEBGL\n                        : GL.UNSIGNED_BYTE;\n            case FormatTypeFlags.D32FS8:\n                return GL.FLOAT_32_UNSIGNED_INT_24_8_REV;\n            default:\n                throw new Error('whoops');\n        }\n    };\n    /**\n     * Only works in WebGL2\n     * @see https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n     */\n    Device_GL.prototype.translateInternalTextureFormat = function (fmt) {\n        switch (fmt) {\n            case Format.F32_R:\n                return GL.R32F;\n            case Format.F32_RG:\n                return GL.RG32F;\n            case Format.F32_RGB:\n                return GL.RGB32F;\n            case Format.F32_RGBA:\n                return GL.RGBA32F;\n            case Format.F16_R:\n                return GL.R16F;\n            case Format.F16_RG:\n                return GL.RG16F;\n            case Format.F16_RGB:\n                return GL.RGB16F;\n            case Format.F16_RGBA:\n                return GL.RGBA16F;\n        }\n        return this.translateTextureFormat(fmt);\n    };\n    Device_GL.prototype.translateTextureFormat = function (fmt) {\n        if (isTextureFormatCompressed(fmt) ||\n            fmt === Format.F32_LUMINANCE ||\n            fmt === Format.U8_LUMINANCE) {\n            return this.translateTextureInternalFormat(fmt);\n        }\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/WEBGL_depth_texture\n        var supportDepthTexture = isWebGL2(this.gl) || (!isWebGL2(this.gl) && !!this.WEBGL_depth_texture);\n        switch (fmt) {\n            case Format.D24_S8:\n            case Format.D32F_S8:\n                return supportDepthTexture ? GL.DEPTH_STENCIL : GL.RGBA;\n            case Format.D24:\n            case Format.D32F:\n                return supportDepthTexture ? GL.DEPTH_COMPONENT : GL.RGBA;\n        }\n        var isInteger = isFormatSizedInteger(fmt);\n        var compFlags = getFormatCompFlags(fmt);\n        switch (compFlags) {\n            case FormatCompFlags.A:\n                return GL.ALPHA;\n            case FormatCompFlags.R:\n                return isInteger ? GL.RED_INTEGER : GL.RED;\n            case FormatCompFlags.RG:\n                return isInteger ? GL.RG_INTEGER : GL.RG;\n            case FormatCompFlags.RGB:\n                return isInteger ? GL.RGB_INTEGER : GL.RGB;\n            case FormatCompFlags.RGBA:\n                // TODO: Chrome throw error when readPixels RGBA_INTEGER and UNSIGNED_BYTE\n                // @see https://github.com/KhronosGroup/WebGL/issues/2747\n                // return isInteger ? GL.RGBA_INTEGER : GL.RGBA;\n                return GL.RGBA;\n        }\n    };\n    Device_GL.prototype.setActiveTexture = function (texture) {\n        if (this.currentActiveTexture !== texture) {\n            this.gl.activeTexture(texture);\n            this.currentActiveTexture = texture;\n        }\n    };\n    Device_GL.prototype.bindVAO = function (vao) {\n        if (this.currentBoundVAO !== vao) {\n            if (isWebGL2(this.gl)) {\n                this.gl.bindVertexArray(vao);\n            }\n            else {\n                this.OES_vertex_array_object.bindVertexArrayOES(vao);\n            }\n            this.currentBoundVAO = vao;\n        }\n    };\n    Device_GL.prototype.programCompiled = function (program) {\n        assert(program.compileState !== ProgramCompileState_GL.NeedsCompile);\n        if (program.compileState === ProgramCompileState_GL.Compiling) {\n            program.compileState = ProgramCompileState_GL.NeedsBind;\n            if (this.shaderDebug) {\n                this.checkProgramCompilationForErrors(program);\n            }\n        }\n    };\n    Device_GL.prototype.useProgram = function (program) {\n        if (this.currentProgram === program)\n            return;\n        this.programCompiled(program);\n        this.gl.useProgram(program.gl_program);\n        this.currentProgram = program;\n    };\n    Device_GL.prototype.ensureResourceExists = function (resource) {\n        if (resource === null) {\n            var error = this.gl.getError();\n            throw new Error(\"Created resource is null; GL error encountered: \".concat(error));\n        }\n        else {\n            return resource;\n        }\n    };\n    Device_GL.prototype.createBuffer = function (descriptor) {\n        return new Buffer_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createTexture = function (descriptor) {\n        return new Texture_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createSampler = function (descriptor) {\n        return new Sampler_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createRenderTarget = function (descriptor) {\n        return new RenderTarget_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createRenderTargetFromTexture = function (texture) {\n        var _a = texture, format = _a.format, width = _a.width, height = _a.height, mipLevelCount = _a.mipLevelCount;\n        // Render targets cannot have a mip chain currently.\n        assert(mipLevelCount === 1);\n        return this.createRenderTarget({\n            format: format,\n            width: width,\n            height: height,\n            sampleCount: 1,\n            texture: texture,\n        });\n    };\n    Device_GL.prototype.createProgram = function (descriptor) {\n        var _a, _b, _c;\n        var rawVertexGLSL = (_a = descriptor.vertex) === null || _a === void 0 ? void 0 : _a.glsl;\n        // preprocess GLSL first\n        if ((_b = descriptor.vertex) === null || _b === void 0 ? void 0 : _b.glsl) {\n            descriptor.vertex.glsl = preprocessShader_GLSL(this.queryVendorInfo(), 'vert', descriptor.vertex.glsl);\n        }\n        if ((_c = descriptor.fragment) === null || _c === void 0 ? void 0 : _c.glsl) {\n            descriptor.fragment.glsl = preprocessShader_GLSL(this.queryVendorInfo(), 'frag', descriptor.fragment.glsl);\n        }\n        return this.createProgramSimple(descriptor, rawVertexGLSL);\n    };\n    Device_GL.prototype.createProgramSimple = function (descriptor, rawVertexGLSL) {\n        var program = new Program_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        }, rawVertexGLSL);\n        return program;\n    };\n    Device_GL.prototype.createBindings = function (descriptor) {\n        return new Bindings_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createInputLayout = function (descriptor) {\n        return new InputLayout_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createRenderPipeline = function (descriptor) {\n        return new RenderPipeline_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createComputePass = function () {\n        return new ComputePass_GL();\n    };\n    Device_GL.prototype.createComputePipeline = function (descriptor) {\n        return new ComputePipeline_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_GL.prototype.createReadback = function () {\n        return new Readback_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n        });\n    };\n    Device_GL.prototype.createQueryPool = function (type, elemCount) {\n        return new QueryPool_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: {\n                type: type,\n                elemCount: elemCount,\n            },\n        });\n    };\n    Device_GL.prototype.formatRenderPassDescriptor = function (descriptor) {\n        var _a, _b, _c, _d, _e, _f;\n        var colorAttachment = descriptor.colorAttachment;\n        descriptor.depthClearValue = (_a = descriptor.depthClearValue) !== null && _a !== void 0 ? _a : 'load';\n        descriptor.stencilClearValue = (_b = descriptor.stencilClearValue) !== null && _b !== void 0 ? _b : 'load';\n        for (var i = 0; i < colorAttachment.length; i++) {\n            if (!descriptor.colorAttachmentLevel) {\n                descriptor.colorAttachmentLevel = [];\n            }\n            descriptor.colorAttachmentLevel[i] =\n                (_c = descriptor.colorAttachmentLevel[i]) !== null && _c !== void 0 ? _c : 0;\n            if (!descriptor.colorResolveToLevel) {\n                descriptor.colorResolveToLevel = [];\n            }\n            descriptor.colorResolveToLevel[i] =\n                (_d = descriptor.colorResolveToLevel[i]) !== null && _d !== void 0 ? _d : 0;\n            if (!descriptor.colorClearColor) {\n                descriptor.colorClearColor = [];\n            }\n            descriptor.colorClearColor[i] = (_e = descriptor.colorClearColor[i]) !== null && _e !== void 0 ? _e : 'load';\n            if (!descriptor.colorStore) {\n                descriptor.colorStore = [];\n            }\n            descriptor.colorStore[i] = (_f = descriptor.colorStore[i]) !== null && _f !== void 0 ? _f : false;\n        }\n    };\n    Device_GL.prototype.createRenderBundle = function () {\n        return new RenderBundle_GL({\n            id: this.getNextUniqueId(),\n            device: this,\n        });\n    };\n    Device_GL.prototype.beginBundle = function (bundle) {\n        this.renderBundle = bundle;\n    };\n    Device_GL.prototype.endBundle = function () {\n        this.renderBundle = undefined;\n    };\n    Device_GL.prototype.executeBundles = function (renderBundles) {\n        renderBundles.forEach(function (renderBundle) {\n            renderBundle.replay();\n        });\n    };\n    Device_GL.prototype.createRenderPass = function (descriptor) {\n        if (this.currentRenderPassDescriptor !== null) {\n            // Save current renderpass descriptor.\n            this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor);\n        }\n        this.currentRenderPassDescriptor = descriptor;\n        // Format renderpass descriptor\n        this.formatRenderPassDescriptor(descriptor);\n        var colorAttachment = descriptor.colorAttachment, colorAttachmentLevel = descriptor.colorAttachmentLevel, colorClearColor = descriptor.colorClearColor, colorResolveTo = descriptor.colorResolveTo, colorResolveToLevel = descriptor.colorResolveToLevel, depthStencilAttachment = descriptor.depthStencilAttachment, depthClearValue = descriptor.depthClearValue, stencilClearValue = descriptor.stencilClearValue, depthStencilResolveTo = descriptor.depthStencilResolveTo;\n        var skipBlit = colorResolveTo &&\n            colorResolveTo.length === 1 &&\n            colorResolveTo[0] === this.scTexture;\n        this.setRenderPassParametersBegin(colorAttachment.length, skipBlit);\n        for (var i = 0; i < colorAttachment.length; i++) {\n            this.setRenderPassParametersColor(i, colorAttachment[i], colorAttachmentLevel[i], colorResolveTo[i], colorResolveToLevel[i], skipBlit);\n        }\n        this.setRenderPassParametersDepthStencil(depthStencilAttachment, depthStencilResolveTo, skipBlit);\n        this.validateCurrentAttachments();\n        for (var i = 0; i < colorAttachment.length; i++) {\n            var clearColor = colorClearColor[i];\n            if (clearColor === 'load')\n                continue;\n            this.setRenderPassParametersClearColor(i, clearColor.r, clearColor.g, clearColor.b, clearColor.a);\n        }\n        this.setRenderPassParametersClearDepthStencil(depthClearValue, stencilClearValue);\n        return this;\n    };\n    Device_GL.prototype.submitPass = function (pass) {\n        assert(this.currentRenderPassDescriptor !== null);\n        this.endPass();\n        if (this.currentRenderPassDescriptorStack.length) {\n            // Restore previous renderpass descriptor.\n            this.currentRenderPassDescriptor =\n                this.currentRenderPassDescriptorStack.pop();\n        }\n        else {\n            this.currentRenderPassDescriptor = null;\n        }\n    };\n    Device_GL.prototype.copySubTexture2D = function (dst_, dstX, dstY, src_, srcX, srcY) {\n        var gl = this.gl;\n        var dst = dst_;\n        var src = src_;\n        assert(src.mipLevelCount === 1);\n        assert(dst.mipLevelCount === 1);\n        if (isWebGL2(gl)) {\n            if (dst === this.scTexture) {\n                gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, this.scPlatformFramebuffer);\n            }\n            else {\n                gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, this.resolveColorDrawFramebuffer);\n                this.bindFramebufferAttachment(gl.DRAW_FRAMEBUFFER, gl.COLOR_ATTACHMENT0, dst, 0);\n            }\n            gl.bindFramebuffer(gl.READ_FRAMEBUFFER, this.resolveColorReadFramebuffer);\n            this.bindFramebufferAttachment(gl.READ_FRAMEBUFFER, gl.COLOR_ATTACHMENT0, src, 0);\n            gl.blitFramebuffer(srcX, srcY, srcX + src.width, srcY + src.height, dstX, dstY, dstX + src.width, dstY + src.height, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n            gl.bindFramebuffer(gl.READ_FRAMEBUFFER, null);\n            gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, null);\n        }\n        else {\n            if (dst === this.scTexture) {\n                var rt = this.createRenderTargetFromTexture(src_);\n                this.submitBlitRenderPass(rt, dst);\n            }\n        }\n    };\n    Device_GL.prototype.queryLimits = function () {\n        return this;\n    };\n    Device_GL.prototype.queryTextureFormatSupported = function (format, width, height) {\n        switch (format) {\n            case Format.BC1_SRGB:\n            case Format.BC2_SRGB:\n            case Format.BC3_SRGB:\n                if (this.WEBGL_compressed_texture_s3tc_srgb !== null)\n                    return isBlockCompressSized(width, height, 4, 4);\n                return false;\n            case Format.BC1:\n            case Format.BC2:\n            case Format.BC3:\n                if (this.WEBGL_compressed_texture_s3tc !== null)\n                    return isBlockCompressSized(width, height, 4, 4);\n                return false;\n            case Format.BC4_UNORM:\n            case Format.BC4_SNORM:\n            case Format.BC5_UNORM:\n            case Format.BC5_SNORM:\n                if (this.EXT_texture_compression_rgtc !== null)\n                    return isBlockCompressSized(width, height, 4, 4);\n                return false;\n            case Format.U16_R_NORM:\n            case Format.U16_RG_NORM:\n            case Format.U16_RGBA_NORM:\n                return this.EXT_texture_norm16 !== null;\n            case Format.F32_R:\n            case Format.F32_RG:\n            case Format.F32_RGB:\n            case Format.F32_RGBA:\n                return this.OES_texture_float_linear !== null;\n            case Format.F16_R:\n            case Format.F16_RG:\n            case Format.F16_RGB:\n            case Format.F16_RGBA:\n                return this.OES_texture_half_float_linear !== null;\n            default:\n                return true;\n        }\n    };\n    Device_GL.prototype.queryProgramReady = function (program) {\n        var gl = this.gl;\n        if (program.compileState === ProgramCompileState_GL.NeedsCompile) {\n            // This should not happen.\n            throw new Error('whoops');\n        }\n        if (program.compileState === ProgramCompileState_GL.Compiling) {\n            var complete = void 0;\n            if (this.KHR_parallel_shader_compile !== null) {\n                complete = gl.getProgramParameter(program.gl_program, this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR);\n            }\n            else {\n                // If we don't have async shader compilation, assume all compilation is done immediately :/\n                complete = true;\n            }\n            if (complete) {\n                this.programCompiled(program);\n            }\n            return complete;\n        }\n        return (program.compileState === ProgramCompileState_GL.NeedsBind ||\n            program.compileState === ProgramCompileState_GL.ReadyToUse);\n    };\n    Device_GL.prototype.queryPlatformAvailable = function () {\n        return this.gl.isContextLost();\n    };\n    Device_GL.prototype.queryVendorInfo = function () {\n        return this;\n    };\n    Device_GL.prototype.queryRenderPass = function (o) {\n        return this.currentRenderPassDescriptor;\n    };\n    Device_GL.prototype.queryRenderTarget = function (o) {\n        var renderTarget = o;\n        return renderTarget;\n    };\n    //#endregion\n    //#region Debugging\n    Device_GL.prototype.setResourceName = function (o, name) {\n        o.name = name;\n        if (o.type === ResourceType.Buffer) {\n            var gl_buffer_pages = o.gl_buffer_pages;\n            for (var i = 0; i < gl_buffer_pages.length; i++)\n                assignPlatformName(gl_buffer_pages[i], \"\".concat(name, \" Page \").concat(i));\n        }\n        else if (o.type === ResourceType.Texture) {\n            assignPlatformName(getPlatformTexture(o), name);\n        }\n        else if (o.type === ResourceType.Sampler) {\n            assignPlatformName(getPlatformSampler$1(o), name);\n        }\n        else if (o.type === ResourceType.RenderTarget) {\n            var gl_renderbuffer = o.gl_renderbuffer;\n            if (gl_renderbuffer !== null)\n                assignPlatformName(gl_renderbuffer, name);\n        }\n        else if (o.type === ResourceType.InputLayout) {\n            assignPlatformName(o.vao, name);\n        }\n    };\n    Device_GL.prototype.setResourceLeakCheck = function (o, v) {\n        if (this.resourceCreationTracker !== null)\n            this.resourceCreationTracker.setResourceLeakCheck(o, v);\n    };\n    Device_GL.prototype.checkForLeaks = function () {\n        if (this.resourceCreationTracker !== null)\n            this.resourceCreationTracker.checkForLeaks();\n    };\n    Device_GL.prototype.pushDebugGroup = function (name) { };\n    Device_GL.prototype.popDebugGroup = function () { };\n    Device_GL.prototype.insertDebugMarker = function (markerLabel) { };\n    // pushDebugGroup(debugGroup: DebugGroup): void {\n    //   this.debugGroupStack.push(debugGroup);\n    // }\n    // popDebugGroup(): void {\n    //   this.debugGroupStack.pop();\n    // }\n    Device_GL.prototype.programPatched = function (o, descriptor) {\n        assert(this.shaderDebug);\n        // const program = o as Program_GL;\n        // const gl = this.gl;\n        // gl.deleteProgram(program.gl_program);\n        // program.descriptor = descriptor;\n        // program.gl_program = this.ensureResourceExists(gl.createProgram());\n        // program.compileState = ProgramCompileState_GL.NeedsCompile;\n        // this.tryCompileProgram(program);\n        // this.checkProgramCompilationForErrors(program);\n    };\n    Device_GL.prototype.getBufferData = function (buffer, dstBuffer, wordOffset) {\n        if (wordOffset === void 0) { wordOffset = 0; }\n        var gl = this.gl;\n        if (isWebGL2(gl)) {\n            gl.bindBuffer(gl.COPY_READ_BUFFER, getPlatformBuffer$1(buffer, wordOffset * 4));\n            gl.getBufferSubData(gl.COPY_READ_BUFFER, wordOffset * 4, dstBuffer);\n        }\n    };\n    //#endregion\n    Device_GL.prototype.debugGroupStatisticsDrawCall = function (count) {\n        if (count === void 0) { count = 1; }\n        for (var i = this.debugGroupStack.length - 1; i >= 0; i--)\n            this.debugGroupStack[i].drawCallCount += count;\n    };\n    Device_GL.prototype.debugGroupStatisticsBufferUpload = function (count) {\n        if (count === void 0) { count = 1; }\n        for (var i = this.debugGroupStack.length - 1; i >= 0; i--)\n            this.debugGroupStack[i].bufferUploadCount += count;\n    };\n    Device_GL.prototype.debugGroupStatisticsTextureBind = function (count) {\n        if (count === void 0) { count = 1; }\n        for (var i = this.debugGroupStack.length - 1; i >= 0; i--)\n            this.debugGroupStack[i].textureBindCount += count;\n    };\n    Device_GL.prototype.debugGroupStatisticsTriangles = function (count) {\n        for (var i = this.debugGroupStack.length - 1; i >= 0; i--)\n            this.debugGroupStack[i].triangleCount += count;\n    };\n    Device_GL.prototype.reportShaderError = function (shader, str) {\n        var gl = this.gl;\n        var status = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n        if (!status) {\n            console.error(prependLineNo(str));\n            var debug_shaders = gl.getExtension('WEBGL_debug_shaders');\n            if (debug_shaders)\n                console.error(debug_shaders.getTranslatedShaderSource(shader));\n            console.error(gl.getShaderInfoLog(shader));\n        }\n        return status;\n    };\n    Device_GL.prototype.checkProgramCompilationForErrors = function (program) {\n        var gl = this.gl;\n        var prog = program.gl_program;\n        if (!gl.getProgramParameter(prog, gl.LINK_STATUS)) {\n            var descriptor = program.descriptor;\n            if (!this.reportShaderError(program.gl_shader_vert, descriptor.vertex.glsl))\n                return;\n            if (!this.reportShaderError(program.gl_shader_frag, descriptor.fragment.glsl))\n                return;\n            // Neither shader had an error, report the program info log.\n            console.error(gl.getProgramInfoLog(program.gl_program));\n        }\n    };\n    Device_GL.prototype.bindFramebufferAttachment = function (framebuffer, binding, attachment, level) {\n        var gl = this.gl;\n        if (isNil(attachment)) {\n            gl.framebufferRenderbuffer(framebuffer, binding, gl.RENDERBUFFER, null);\n        }\n        else if (attachment.type === ResourceType.RenderTarget) {\n            if (attachment.gl_renderbuffer !== null) {\n                gl.framebufferRenderbuffer(framebuffer, binding, gl.RENDERBUFFER, attachment.gl_renderbuffer);\n            }\n            else if (attachment.texture !== null) {\n                gl.framebufferTexture2D(framebuffer, binding, GL.TEXTURE_2D, getPlatformTexture(attachment.texture), level);\n            }\n        }\n        else if (attachment.type === ResourceType.Texture) {\n            var texture = getPlatformTexture(attachment);\n            if (attachment.dimension === TextureDimension.TEXTURE_2D) {\n                gl.framebufferTexture2D(framebuffer, binding, GL.TEXTURE_2D, texture, level);\n            }\n            else if (isWebGL2(gl) &&\n                attachment.dimension === TextureDimension.TEXTURE_2D_ARRAY) ;\n        }\n    };\n    Device_GL.prototype.bindFramebufferDepthStencilAttachment = function (framebuffer, attachment) {\n        var gl = this.gl;\n        var flags = !isNil(attachment)\n            ? getFormatFlags(attachment.format)\n            : FormatFlags.Depth | FormatFlags.Stencil;\n        var depth = !!(flags & FormatFlags.Depth);\n        var stencil = !!(flags & FormatFlags.Stencil);\n        if (depth && stencil) {\n            var supportDepthTexture = isWebGL2(this.gl) || (!isWebGL2(this.gl) && !!this.WEBGL_depth_texture);\n            if (supportDepthTexture) {\n                this.bindFramebufferAttachment(framebuffer, gl.DEPTH_STENCIL_ATTACHMENT, attachment, 0);\n            }\n            else {\n                this.bindFramebufferAttachment(framebuffer, gl.DEPTH_ATTACHMENT, attachment, 0);\n            }\n        }\n        else if (depth) {\n            this.bindFramebufferAttachment(framebuffer, gl.DEPTH_ATTACHMENT, attachment, 0);\n            this.bindFramebufferAttachment(framebuffer, gl.STENCIL_ATTACHMENT, null, 0);\n        }\n        else if (stencil) {\n            this.bindFramebufferAttachment(framebuffer, gl.STENCIL_ATTACHMENT, attachment, 0);\n            this.bindFramebufferAttachment(framebuffer, gl.DEPTH_ATTACHMENT, null, 0);\n        }\n    };\n    Device_GL.prototype.validateCurrentAttachments = function () {\n        var sampleCount = -1, width = -1, height = -1;\n        for (var i = 0; i < this.currentColorAttachments.length; i++) {\n            var attachment = this.currentColorAttachments[i];\n            if (attachment === null)\n                continue;\n            if (sampleCount === -1) {\n                sampleCount = attachment.sampleCount;\n                width = attachment.width;\n                height = attachment.height;\n            }\n            else {\n                assert(sampleCount === attachment.sampleCount);\n                assert(width === attachment.width);\n                assert(height === attachment.height);\n            }\n        }\n        if (this.currentDepthStencilAttachment) {\n            if (sampleCount === -1) {\n                sampleCount = this.currentDepthStencilAttachment.sampleCount;\n            }\n            else {\n                assert(sampleCount === this.currentDepthStencilAttachment.sampleCount);\n                assert(width === this.currentDepthStencilAttachment.width);\n                assert(height === this.currentDepthStencilAttachment.height);\n            }\n        }\n        this.currentSampleCount = sampleCount;\n    };\n    Device_GL.prototype.setRenderPassParametersBegin = function (numColorAttachments, toScreen) {\n        if (toScreen === void 0) { toScreen = false; }\n        var gl = this.gl;\n        if (!toScreen) {\n            if (isWebGL2(gl)) {\n                gl.bindFramebuffer(GL.DRAW_FRAMEBUFFER, this.renderPassDrawFramebuffer);\n            }\n            else {\n                if (!this.inBlitRenderPass) {\n                    gl.bindFramebuffer(GL.FRAMEBUFFER, this.renderPassDrawFramebuffer);\n                }\n            }\n            if (isWebGL2(gl)) {\n                gl.drawBuffers([\n                    GL.COLOR_ATTACHMENT0,\n                    GL.COLOR_ATTACHMENT1,\n                    GL.COLOR_ATTACHMENT2,\n                    GL.COLOR_ATTACHMENT3,\n                ]);\n            }\n            else {\n                if (!this.inBlitRenderPass && this.WEBGL_draw_buffers) {\n                    // MRT @see https://github.com/shrekshao/MoveWebGL1EngineToWebGL2/blob/master/Move-a-WebGL-1-Engine-To-WebGL-2-Blog-1.md#multiple-render-targets\n                    this.WEBGL_draw_buffers.drawBuffersWEBGL([\n                        GL.COLOR_ATTACHMENT0_WEBGL,\n                        GL.COLOR_ATTACHMENT1_WEBGL,\n                        GL.COLOR_ATTACHMENT2_WEBGL,\n                        GL.COLOR_ATTACHMENT3_WEBGL, // gl_FragData[3]\n                    ]);\n                }\n            }\n            if (!this.inBlitRenderPass) {\n                for (var i = numColorAttachments; i < this.currentColorAttachments.length; i++) {\n                    var target = isWebGL2(gl) ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER;\n                    var attachment = isWebGL2(gl)\n                        ? GL.COLOR_ATTACHMENT0\n                        : GL.COLOR_ATTACHMENT0_WEBGL;\n                    gl.framebufferRenderbuffer(target, attachment + i, GL.RENDERBUFFER, null);\n                    gl.framebufferTexture2D(target, attachment + i, GL.TEXTURE_2D, null, 0);\n                }\n            }\n        }\n        this.currentColorAttachments.length = numColorAttachments;\n    };\n    Device_GL.prototype.setRenderPassParametersColor = function (i, colorAttachment, attachmentLevel, colorResolveTo, resolveToLevel, skipBlit) {\n        if (skipBlit === void 0) { skipBlit = false; }\n        var gl = this.gl;\n        var gl2 = isWebGL2(gl);\n        if (this.currentColorAttachments[i] !== colorAttachment ||\n            this.currentColorAttachmentLevels[i] !== attachmentLevel) {\n            this.currentColorAttachments[i] = colorAttachment;\n            this.currentColorAttachmentLevels[i] = attachmentLevel;\n            if (!skipBlit && (gl2 || (!gl2 && this.WEBGL_draw_buffers))) {\n                this.bindFramebufferAttachment(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, (gl2 ? GL.COLOR_ATTACHMENT0 : GL.COLOR_ATTACHMENT0_WEBGL) + i, colorAttachment, attachmentLevel);\n            }\n            this.resolveColorAttachmentsChanged = true;\n        }\n        if (this.currentColorResolveTos[i] !== colorResolveTo ||\n            this.currentColorResolveToLevels[i] !== resolveToLevel) {\n            this.currentColorResolveTos[i] = colorResolveTo;\n            this.currentColorResolveToLevels[i] = resolveToLevel;\n            if (colorResolveTo !== null) {\n                this.resolveColorAttachmentsChanged = true;\n            }\n        }\n    };\n    Device_GL.prototype.setRenderPassParametersDepthStencil = function (depthStencilAttachment, depthStencilResolveTo, skipBlit) {\n        if (skipBlit === void 0) { skipBlit = false; }\n        var gl = this.gl;\n        if (this.currentDepthStencilAttachment !== depthStencilAttachment) {\n            this.currentDepthStencilAttachment =\n                depthStencilAttachment;\n            if (!skipBlit && !this.inBlitRenderPass) {\n                this.bindFramebufferDepthStencilAttachment(isWebGL2(gl) ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, this.currentDepthStencilAttachment);\n            }\n            this.resolveDepthStencilAttachmentsChanged = true;\n        }\n        if (this.currentDepthStencilResolveTo !== depthStencilResolveTo) {\n            this.currentDepthStencilResolveTo = depthStencilResolveTo;\n            if (depthStencilResolveTo) {\n                this.resolveDepthStencilAttachmentsChanged = true;\n            }\n        }\n    };\n    Device_GL.prototype.setRenderPassParametersClearColor = function (slot, r, g, b, a) {\n        var gl = this.gl;\n        if (this.OES_draw_buffers_indexed !== null) {\n            var attachment = this.currentMegaState.attachmentsState[slot];\n            if (attachment && attachment.channelWriteMask !== ChannelWriteMask.ALL) {\n                this.OES_draw_buffers_indexed.colorMaskiOES(slot, true, true, true, true);\n                attachment.channelWriteMask = ChannelWriteMask.ALL;\n            }\n        }\n        else {\n            var attachment = this.currentMegaState.attachmentsState[0];\n            if (attachment && attachment.channelWriteMask !== ChannelWriteMask.ALL) {\n                gl.colorMask(true, true, true, true);\n                attachment.channelWriteMask = ChannelWriteMask.ALL;\n            }\n        }\n        this.setScissorRectEnabled(false);\n        if (isWebGL2(gl)) {\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/clearBuffer\n            gl.clearBufferfv(gl.COLOR, slot, [r, g, b, a]);\n        }\n        else {\n            gl.clearColor(r, g, b, a);\n            gl.clear(gl.COLOR_BUFFER_BIT);\n        }\n    };\n    Device_GL.prototype.setRenderPassParametersClearDepthStencil = function (depthClearValue, stencilClearValue) {\n        if (depthClearValue === void 0) { depthClearValue = 'load'; }\n        if (stencilClearValue === void 0) { stencilClearValue = 'load'; }\n        var gl = this.gl;\n        if (depthClearValue !== 'load') {\n            assert(!!this.currentDepthStencilAttachment);\n            // GL clears obey the masks... bad API or worst API?\n            if (!this.currentMegaState.depthWrite) {\n                gl.depthMask(true);\n                this.currentMegaState.depthWrite = true;\n            }\n            if (isWebGL2(gl)) {\n                gl.clearBufferfv(gl.DEPTH, 0, [depthClearValue]);\n            }\n            else {\n                gl.clearDepth(depthClearValue);\n                gl.clear(gl.DEPTH_BUFFER_BIT);\n            }\n        }\n        if (stencilClearValue !== 'load') {\n            assert(!!this.currentDepthStencilAttachment);\n            if (!this.currentMegaState.stencilWrite) {\n                gl.enable(gl.STENCIL_TEST);\n                gl.stencilMask(0xff);\n                this.currentMegaState.stencilWrite = true;\n            }\n            if (isWebGL2(gl)) {\n                gl.clearBufferiv(gl.STENCIL, 0, [stencilClearValue]);\n            }\n            else {\n                gl.clearStencil(stencilClearValue);\n                gl.clear(gl.STENCIL_BUFFER_BIT);\n            }\n        }\n    };\n    Device_GL.prototype.setBindings = function (bindings_) {\n        var _this = this;\n        var _a;\n        if (this.renderBundle) {\n            this.renderBundle.push(function () { return _this.setBindings(bindings_); });\n            return;\n        }\n        var gl = this.gl;\n        var _b = bindings_, uniformBufferBindings = _b.uniformBufferBindings, samplerBindings = _b.samplerBindings, bindingLayouts = _b.bindingLayouts;\n        assert(0 < bindingLayouts.bindingLayoutTables.length);\n        var bindingLayoutTable = bindingLayouts.bindingLayoutTables[0];\n        // Ignore extra bindings.\n        assert(uniformBufferBindings.length >= bindingLayoutTable.numUniformBuffers);\n        assert(samplerBindings.length >= bindingLayoutTable.numSamplers);\n        for (var i = 0; i < uniformBufferBindings.length; i++) {\n            var binding = uniformBufferBindings[i];\n            if (binding.size === 0)\n                continue;\n            var index = bindingLayoutTable.firstUniformBuffer + i;\n            var buffer = binding.buffer;\n            var byteOffset = binding.offset || 0;\n            var byteSize = binding.size || buffer.byteSize;\n            if (buffer !== this.currentUniformBuffers[index] ||\n                byteOffset !== this.currentUniformBufferByteOffsets[index] ||\n                byteSize !== this.currentUniformBufferByteSizes[index]) {\n                var platformBufferByteOffset = byteOffset % buffer.pageByteSize;\n                var platformBuffer = buffer.gl_buffer_pages[(byteOffset / buffer.pageByteSize) | 0];\n                assert(platformBufferByteOffset + byteSize <= buffer.pageByteSize);\n                if (isWebGL2(gl)) {\n                    gl.bindBufferRange(gl.UNIFORM_BUFFER, index, platformBuffer, platformBufferByteOffset, byteSize);\n                }\n                this.currentUniformBuffers[index] = buffer;\n                this.currentUniformBufferByteOffsets[index] = byteOffset;\n                this.currentUniformBufferByteSizes[index] = byteSize;\n            }\n        }\n        for (var i = 0; i < bindingLayoutTable.numSamplers; i++) {\n            var binding = samplerBindings[i];\n            var samplerIndex = bindingLayoutTable.firstSampler + i;\n            var gl_sampler = binding !== null && binding.sampler !== null\n                ? getPlatformSampler$1(binding.sampler)\n                : null;\n            var gl_texture = binding !== null && binding.texture !== null\n                ? getPlatformTexture(binding.texture)\n                : null;\n            if (this.currentSamplers[samplerIndex] !== gl_sampler) {\n                if (isWebGL2(gl)) {\n                    gl.bindSampler(samplerIndex, gl_sampler);\n                }\n                this.currentSamplers[samplerIndex] = gl_sampler;\n            }\n            if (this.currentTextures[samplerIndex] !== gl_texture) {\n                this.setActiveTexture(gl.TEXTURE0 + samplerIndex);\n                if (gl_texture !== null) {\n                    var _c = assertExists(binding)\n                        .texture, gl_target = _c.gl_target, width = _c.width, height = _c.height;\n                    // update index\n                    binding.texture.textureIndex = samplerIndex;\n                    gl.bindTexture(gl_target, gl_texture);\n                    // In WebGL1 set tex's parameters @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/texParameter\n                    if (!isWebGL2(gl)) {\n                        (_a = binding.sampler) === null || _a === void 0 ? void 0 : _a.setTextureParameters(gl_target, width, height);\n                    }\n                    this.debugGroupStatisticsTextureBind();\n                }\n                else {\n                    var samplerEntry = __assign(__assign({}, binding), defaultBindingLayoutSamplerDescriptor);\n                    var dimension = samplerEntry.dimension, formatKind = samplerEntry.formatKind;\n                    var gl_target = translateTextureDimension$1(dimension);\n                    gl.bindTexture(gl_target, this.getFallbackTexture(__assign({ gl_target: gl_target, formatKind: formatKind }, samplerEntry)));\n                }\n                this.currentTextures[samplerIndex] = gl_texture;\n            }\n        }\n    };\n    Device_GL.prototype.setViewport = function (x, y, w, h) {\n        var gl = this.gl;\n        gl.viewport(x, y, w, h);\n    };\n    Device_GL.prototype.setScissorRect = function (x, y, w, h) {\n        var gl = this.gl;\n        this.setScissorRectEnabled(true);\n        gl.scissor(x, y, w, h);\n    };\n    Device_GL.prototype.applyAttachmentStateIndexed = function (i, currentAttachmentState, newAttachmentState) {\n        var gl = this.gl;\n        var dbi = this.OES_draw_buffers_indexed;\n        if (currentAttachmentState.channelWriteMask !==\n            newAttachmentState.channelWriteMask) {\n            dbi.colorMaskiOES(i, !!(newAttachmentState.channelWriteMask & ChannelWriteMask.RED), !!(newAttachmentState.channelWriteMask & ChannelWriteMask.GREEN), !!(newAttachmentState.channelWriteMask & ChannelWriteMask.BLUE), !!(newAttachmentState.channelWriteMask & ChannelWriteMask.ALPHA));\n            currentAttachmentState.channelWriteMask =\n                newAttachmentState.channelWriteMask;\n        }\n        var blendModeChanged = currentAttachmentState.rgbBlendState.blendMode !==\n            newAttachmentState.rgbBlendState.blendMode ||\n            currentAttachmentState.alphaBlendState.blendMode !==\n                newAttachmentState.alphaBlendState.blendMode;\n        var blendFuncChanged = currentAttachmentState.rgbBlendState.blendSrcFactor !==\n            newAttachmentState.rgbBlendState.blendSrcFactor ||\n            currentAttachmentState.alphaBlendState.blendSrcFactor !==\n                newAttachmentState.alphaBlendState.blendSrcFactor ||\n            currentAttachmentState.rgbBlendState.blendDstFactor !==\n                newAttachmentState.rgbBlendState.blendDstFactor ||\n            currentAttachmentState.alphaBlendState.blendDstFactor !==\n                newAttachmentState.alphaBlendState.blendDstFactor;\n        if (blendFuncChanged || blendModeChanged) {\n            if (isBlendStateNone(currentAttachmentState.rgbBlendState) &&\n                isBlendStateNone(currentAttachmentState.alphaBlendState))\n                dbi.enableiOES(i, gl.BLEND);\n            else if (isBlendStateNone(newAttachmentState.rgbBlendState) &&\n                isBlendStateNone(newAttachmentState.alphaBlendState))\n                dbi.disableiOES(i, gl.BLEND);\n        }\n        if (blendModeChanged) {\n            dbi.blendEquationSeparateiOES(i, newAttachmentState.rgbBlendState.blendMode, newAttachmentState.alphaBlendState.blendMode);\n            currentAttachmentState.rgbBlendState.blendMode =\n                newAttachmentState.rgbBlendState.blendMode;\n            currentAttachmentState.alphaBlendState.blendMode =\n                newAttachmentState.alphaBlendState.blendMode;\n        }\n        if (blendFuncChanged) {\n            dbi.blendFuncSeparateiOES(i, newAttachmentState.rgbBlendState.blendSrcFactor, newAttachmentState.rgbBlendState.blendDstFactor, newAttachmentState.alphaBlendState.blendSrcFactor, newAttachmentState.alphaBlendState.blendDstFactor);\n            currentAttachmentState.rgbBlendState.blendSrcFactor =\n                newAttachmentState.rgbBlendState.blendSrcFactor;\n            currentAttachmentState.alphaBlendState.blendSrcFactor =\n                newAttachmentState.alphaBlendState.blendSrcFactor;\n            currentAttachmentState.rgbBlendState.blendDstFactor =\n                newAttachmentState.rgbBlendState.blendDstFactor;\n            currentAttachmentState.alphaBlendState.blendDstFactor =\n                newAttachmentState.alphaBlendState.blendDstFactor;\n        }\n    };\n    Device_GL.prototype.applyAttachmentState = function (currentAttachmentState, newAttachmentState) {\n        var gl = this.gl;\n        if (currentAttachmentState.channelWriteMask !==\n            newAttachmentState.channelWriteMask) {\n            gl.colorMask(!!(newAttachmentState.channelWriteMask & ChannelWriteMask.RED), !!(newAttachmentState.channelWriteMask & ChannelWriteMask.GREEN), !!(newAttachmentState.channelWriteMask & ChannelWriteMask.BLUE), !!(newAttachmentState.channelWriteMask & ChannelWriteMask.ALPHA));\n            currentAttachmentState.channelWriteMask =\n                newAttachmentState.channelWriteMask;\n        }\n        var blendModeChanged = currentAttachmentState.rgbBlendState.blendMode !==\n            newAttachmentState.rgbBlendState.blendMode ||\n            currentAttachmentState.alphaBlendState.blendMode !==\n                newAttachmentState.alphaBlendState.blendMode;\n        var blendFuncChanged = currentAttachmentState.rgbBlendState.blendSrcFactor !==\n            newAttachmentState.rgbBlendState.blendSrcFactor ||\n            currentAttachmentState.alphaBlendState.blendSrcFactor !==\n                newAttachmentState.alphaBlendState.blendSrcFactor ||\n            currentAttachmentState.rgbBlendState.blendDstFactor !==\n                newAttachmentState.rgbBlendState.blendDstFactor ||\n            currentAttachmentState.alphaBlendState.blendDstFactor !==\n                newAttachmentState.alphaBlendState.blendDstFactor;\n        if (blendFuncChanged || blendModeChanged) {\n            if (isBlendStateNone(currentAttachmentState.rgbBlendState) &&\n                isBlendStateNone(currentAttachmentState.alphaBlendState)) {\n                gl.enable(gl.BLEND);\n            }\n            else if (isBlendStateNone(newAttachmentState.rgbBlendState) &&\n                isBlendStateNone(newAttachmentState.alphaBlendState)) {\n                gl.disable(gl.BLEND);\n            }\n        }\n        if (blendModeChanged) {\n            gl.blendEquationSeparate(newAttachmentState.rgbBlendState.blendMode, newAttachmentState.alphaBlendState.blendMode);\n            currentAttachmentState.rgbBlendState.blendMode =\n                newAttachmentState.rgbBlendState.blendMode;\n            currentAttachmentState.alphaBlendState.blendMode =\n                newAttachmentState.alphaBlendState.blendMode;\n        }\n        if (blendFuncChanged) {\n            gl.blendFuncSeparate(newAttachmentState.rgbBlendState.blendSrcFactor, newAttachmentState.rgbBlendState.blendDstFactor, newAttachmentState.alphaBlendState.blendSrcFactor, newAttachmentState.alphaBlendState.blendDstFactor);\n            currentAttachmentState.rgbBlendState.blendSrcFactor =\n                newAttachmentState.rgbBlendState.blendSrcFactor;\n            currentAttachmentState.alphaBlendState.blendSrcFactor =\n                newAttachmentState.alphaBlendState.blendSrcFactor;\n            currentAttachmentState.rgbBlendState.blendDstFactor =\n                newAttachmentState.rgbBlendState.blendDstFactor;\n            currentAttachmentState.alphaBlendState.blendDstFactor =\n                newAttachmentState.alphaBlendState.blendDstFactor;\n        }\n    };\n    Device_GL.prototype.setMegaState = function (newMegaState) {\n        var gl = this.gl;\n        var currentMegaState = this.currentMegaState;\n        if (this.OES_draw_buffers_indexed !== null) {\n            for (var i = 0; i < newMegaState.attachmentsState.length; i++)\n                this.applyAttachmentStateIndexed(i, currentMegaState.attachmentsState[0], newMegaState.attachmentsState[0]);\n        }\n        else {\n            assert(newMegaState.attachmentsState.length === 1);\n            this.applyAttachmentState(currentMegaState.attachmentsState[0], newMegaState.attachmentsState[0]);\n        }\n        if (!colorEqual(currentMegaState.blendConstant, newMegaState.blendConstant)) {\n            gl.blendColor(newMegaState.blendConstant.r, newMegaState.blendConstant.g, newMegaState.blendConstant.b, newMegaState.blendConstant.a);\n            colorCopy(currentMegaState.blendConstant, newMegaState.blendConstant);\n        }\n        if (currentMegaState.depthCompare !== newMegaState.depthCompare) {\n            gl.depthFunc(newMegaState.depthCompare);\n            currentMegaState.depthCompare = newMegaState.depthCompare;\n        }\n        if (!!currentMegaState.depthWrite !== !!newMegaState.depthWrite) {\n            gl.depthMask(newMegaState.depthWrite);\n            currentMegaState.depthWrite = newMegaState.depthWrite;\n        }\n        if (!!currentMegaState.stencilWrite !== !!newMegaState.stencilWrite) {\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilMask\n            gl.stencilMask(newMegaState.stencilWrite ? 0xff : 0x00);\n            currentMegaState.stencilWrite = newMegaState.stencilWrite;\n        }\n        var shouldApplyStencil = false;\n        if (!stencilFaceStateEquals(currentMegaState.stencilFront, newMegaState.stencilFront)) {\n            shouldApplyStencil = true;\n            var _a = newMegaState.stencilFront, passOp = _a.passOp, failOp = _a.failOp, depthFailOp = _a.depthFailOp, compare = _a.compare;\n            if (currentMegaState.stencilFront.passOp !== passOp ||\n                currentMegaState.stencilFront.failOp !== failOp ||\n                currentMegaState.stencilFront.depthFailOp !== depthFailOp) {\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOpSeparate\n                gl.stencilOpSeparate(gl.FRONT, failOp, depthFailOp, passOp);\n                currentMegaState.stencilFront.passOp = passOp;\n                currentMegaState.stencilFront.failOp = failOp;\n                currentMegaState.stencilFront.depthFailOp = depthFailOp;\n            }\n            if (currentMegaState.stencilFront.compare !== compare) {\n                this.setStencilReference(0);\n                currentMegaState.stencilFront.compare = compare;\n            }\n        }\n        if (!stencilFaceStateEquals(currentMegaState.stencilBack, newMegaState.stencilBack)) {\n            shouldApplyStencil = true;\n            var _b = newMegaState.stencilBack, passOp = _b.passOp, failOp = _b.failOp, depthFailOp = _b.depthFailOp, compare = _b.compare;\n            if (currentMegaState.stencilBack.passOp !== passOp ||\n                currentMegaState.stencilBack.failOp !== failOp ||\n                currentMegaState.stencilBack.depthFailOp !== depthFailOp) {\n                // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/stencilOpSeparate\n                gl.stencilOpSeparate(gl.BACK, failOp, depthFailOp, passOp);\n                currentMegaState.stencilBack.passOp = passOp;\n                currentMegaState.stencilBack.failOp = failOp;\n                currentMegaState.stencilBack.depthFailOp = depthFailOp;\n            }\n            if (currentMegaState.stencilBack.compare !== compare) {\n                this.setStencilReference(0);\n                currentMegaState.stencilBack.compare = compare;\n            }\n        }\n        if (currentMegaState.stencilFront.mask !== newMegaState.stencilFront.mask ||\n            currentMegaState.stencilBack.mask !== newMegaState.stencilBack.mask) {\n            shouldApplyStencil = true;\n            currentMegaState.stencilFront.mask = newMegaState.stencilFront.mask;\n            currentMegaState.stencilBack.mask = newMegaState.stencilBack.mask;\n        }\n        if (shouldApplyStencil) {\n            this.applyStencil();\n        }\n        if (currentMegaState.cullMode !== newMegaState.cullMode) {\n            if (currentMegaState.cullMode === CullMode.NONE) {\n                gl.enable(gl.CULL_FACE);\n            }\n            else if (newMegaState.cullMode === CullMode.NONE) {\n                gl.disable(gl.CULL_FACE);\n            }\n            if (newMegaState.cullMode === CullMode.BACK) {\n                gl.cullFace(gl.BACK);\n            }\n            else if (newMegaState.cullMode === CullMode.FRONT) {\n                gl.cullFace(gl.FRONT);\n            }\n            else if (newMegaState.cullMode === CullMode.FRONT_AND_BACK) {\n                gl.cullFace(gl.FRONT_AND_BACK);\n            }\n            currentMegaState.cullMode = newMegaState.cullMode;\n        }\n        if (currentMegaState.frontFace !== newMegaState.frontFace) {\n            gl.frontFace(newMegaState.frontFace);\n            currentMegaState.frontFace = newMegaState.frontFace;\n        }\n        if (currentMegaState.polygonOffset !== newMegaState.polygonOffset) {\n            if (newMegaState.polygonOffset) {\n                gl.polygonOffset(1, 1);\n                gl.enable(gl.POLYGON_OFFSET_FILL);\n            }\n            else {\n                gl.disable(gl.POLYGON_OFFSET_FILL);\n            }\n            currentMegaState.polygonOffset = newMegaState.polygonOffset;\n        }\n    };\n    Device_GL.prototype.validatePipelineFormats = function (pipeline) {\n        for (var i = 0; i < this.currentColorAttachments.length; i++) {\n            var attachment = this.currentColorAttachments[i];\n            if (attachment === null)\n                continue;\n            // assert(attachment.format === pipeline.colorAttachmentFormats[i]);\n        }\n        if (this.currentDepthStencilAttachment) {\n            assert(this.currentDepthStencilAttachment.format ===\n                pipeline.depthStencilAttachmentFormat);\n        }\n        if (this.currentSampleCount !== -1) {\n            assert(this.currentSampleCount === pipeline.sampleCount);\n        }\n    };\n    Device_GL.prototype.setPipeline = function (o) {\n        var _this = this;\n        if (this.renderBundle) {\n            this.renderBundle.push(function () { return _this.setPipeline(o); });\n            return;\n        }\n        this.currentPipeline = o;\n        this.validatePipelineFormats(this.currentPipeline);\n        // We allow users to use \"non-ready\" pipelines for emergencies. In this case, there can be a bit of stuttering.\n        // assert(this.queryPipelineReady(this.currentPipeline));\n        this.setMegaState(this.currentPipeline.megaState);\n        var program = this.currentPipeline.program;\n        this.useProgram(program);\n        if (program.compileState === ProgramCompileState_GL.NeedsBind) {\n            var gl = this.gl;\n            var prog = program.gl_program;\n            var deviceProgram = program.descriptor;\n            var uniformBlocks = findall(deviceProgram.vertex.glsl, UNIFROM_BLOCK_REGEXP);\n            if (isWebGL2(gl)) {\n                for (var i = 0; i < uniformBlocks.length; i++) {\n                    var _a = __read(uniformBlocks[i], 2), blockName = _a[1];\n                    // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/getUniformBlockIndex\n                    var blockIdx = gl.getUniformBlockIndex(prog, blockName);\n                    if (blockIdx !== -1 && blockIdx !== 0xffffffff) {\n                        // @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/uniformBlockBinding\n                        gl.uniformBlockBinding(prog, blockIdx, i);\n                    }\n                }\n            }\n            var samplers = findall(deviceProgram.fragment.glsl, /^uniform .*sampler\\S+ (\\w+);\\s* \\/\\/ BINDING=(\\d+)$/gm);\n            for (var i = 0; i < samplers.length; i++) {\n                var _b = __read(samplers[i], 3), name_1 = _b[1], location_1 = _b[2];\n                var samplerUniformLocation = gl.getUniformLocation(prog, name_1);\n                gl.uniform1i(samplerUniformLocation, parseInt(location_1));\n            }\n            program.compileState = ProgramCompileState_GL.ReadyToUse;\n        }\n    };\n    Device_GL.prototype.setVertexInput = function (inputLayout_, vertexBuffers, indexBuffer) {\n        var e_1, _a;\n        var _this = this;\n        var _b;\n        if (this.renderBundle) {\n            this.renderBundle.push(function () {\n                return _this.setVertexInput(inputLayout_, vertexBuffers, indexBuffer);\n            });\n            return;\n        }\n        if (inputLayout_ !== null) {\n            assert(this.currentPipeline.inputLayout === inputLayout_);\n            var inputLayout = inputLayout_;\n            this.bindVAO(inputLayout.vao);\n            var gl = this.gl;\n            for (var i = 0; i < inputLayout.vertexBufferDescriptors.length; i++) {\n                var vertexBufferDescriptor = inputLayout.vertexBufferDescriptors[i];\n                var arrayStride = vertexBufferDescriptor.arrayStride, attributes = vertexBufferDescriptor.attributes;\n                try {\n                    for (var attributes_1 = (e_1 = void 0, __values(attributes)), attributes_1_1 = attributes_1.next(); !attributes_1_1.done; attributes_1_1 = attributes_1.next()) {\n                        var attribute = attributes_1_1.value;\n                        var shaderLocation = attribute.shaderLocation, offset = attribute.offset;\n                        // find location by name in WebGL1\n                        var location_2 = isWebGL2(gl)\n                            ? shaderLocation\n                            : (_b = inputLayout.program.attributes[shaderLocation]) === null || _b === void 0 ? void 0 : _b.location;\n                        if (!isNil(location_2)) {\n                            var vertexBuffer = vertexBuffers[i];\n                            if (vertexBuffer === null)\n                                continue;\n                            // @ts-ignore\n                            var format = attribute.vertexFormat;\n                            gl.bindBuffer(gl.ARRAY_BUFFER, getPlatformBuffer$1(vertexBuffer.buffer));\n                            var bufferOffset = (vertexBuffer.offset || 0) + offset;\n                            gl.vertexAttribPointer(location_2, format.size, format.type, format.normalized, arrayStride, bufferOffset);\n                        }\n                    }\n                }\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                finally {\n                    try {\n                        if (attributes_1_1 && !attributes_1_1.done && (_a = attributes_1.return)) _a.call(attributes_1);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                }\n            }\n            assert((indexBuffer !== null) === (inputLayout.indexBufferFormat !== null));\n            if (indexBuffer !== null) {\n                var buffer = indexBuffer.buffer;\n                assert(buffer.usage === BufferUsage.INDEX);\n                gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, getPlatformBuffer$1(buffer));\n                this.currentIndexBufferByteOffset = indexBuffer.offset || 0;\n            }\n            else {\n                this.currentIndexBufferByteOffset = null;\n            }\n        }\n        else {\n            assert(this.currentPipeline.inputLayout === null);\n            assert(indexBuffer === null);\n            this.bindVAO(null);\n            this.currentIndexBufferByteOffset = 0;\n        }\n    };\n    Device_GL.prototype.setStencilReference = function (value) {\n        if (this.currentStencilRef === value) {\n            return;\n        }\n        this.currentStencilRef = value;\n        this.applyStencil();\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpurendercommandsmixin-draw\n     */\n    Device_GL.prototype.draw = function (vertexCount, instanceCount, firstVertex, firstInstance) {\n        var _a;\n        var _this = this;\n        if (this.renderBundle) {\n            this.renderBundle.push(function () {\n                return _this.draw(vertexCount, instanceCount, firstVertex, firstInstance);\n            });\n            return;\n        }\n        var gl = this.gl;\n        var pipeline = this.currentPipeline;\n        if (instanceCount) {\n            var params = [\n                pipeline.drawMode,\n                firstVertex || 0,\n                vertexCount,\n                instanceCount,\n            ];\n            if (isWebGL2(gl)) {\n                gl.drawArraysInstanced.apply(gl, __spreadArray([], __read(params), false));\n            }\n            else {\n                (_a = this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(_a, __spreadArray([], __read(params), false));\n            }\n        }\n        else {\n            gl.drawArrays(pipeline.drawMode, firstVertex, vertexCount);\n        }\n        this.debugGroupStatisticsDrawCall();\n        this.debugGroupStatisticsTriangles((vertexCount / 3) * Math.max(instanceCount, 1));\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpurendercommandsmixin-drawindexed\n     */\n    Device_GL.prototype.drawIndexed = function (indexCount, instanceCount, firstIndex, baseVertex, firstInstance) {\n        var _a;\n        var _this = this;\n        if (this.renderBundle) {\n            this.renderBundle.push(function () {\n                return _this.drawIndexed(indexCount, instanceCount, firstIndex, baseVertex, firstInstance);\n            });\n            return;\n        }\n        var gl = this.gl;\n        var pipeline = this.currentPipeline, inputLayout = assertExists(pipeline.inputLayout);\n        var byteOffset = assertExists(this.currentIndexBufferByteOffset) +\n            firstIndex * inputLayout.indexBufferCompByteSize;\n        if (instanceCount) {\n            var params = [\n                pipeline.drawMode,\n                indexCount,\n                inputLayout.indexBufferType,\n                byteOffset,\n                instanceCount,\n            ];\n            if (isWebGL2(gl)) {\n                gl.drawElementsInstanced.apply(gl, __spreadArray([], __read(params), false));\n            }\n            else {\n                (_a = this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(_a, __spreadArray([], __read(params), false));\n            }\n        }\n        else {\n            gl.drawElements(pipeline.drawMode, indexCount, inputLayout.indexBufferType, byteOffset);\n        }\n        this.debugGroupStatisticsDrawCall();\n        this.debugGroupStatisticsTriangles((indexCount / 3) * Math.max(instanceCount, 1));\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpurendercommandsmixin-drawindirect\n     */\n    Device_GL.prototype.drawIndirect = function (indirectBuffer, indirectOffset) { };\n    Device_GL.prototype.drawIndexedIndirect = function (indirectBuffer, indirectOffset) { };\n    Device_GL.prototype.beginOcclusionQuery = function (queryIndex) {\n        var gl = this.gl;\n        if (isWebGL2(gl)) {\n            var queryPool = this.currentRenderPassDescriptor\n                .occlusionQueryPool;\n            gl.beginQuery(queryPool.gl_query_type, queryPool.gl_query[queryIndex]);\n        }\n    };\n    Device_GL.prototype.endOcclusionQuery = function () {\n        var gl = this.gl;\n        if (isWebGL2(gl)) {\n            var queryPool = this.currentRenderPassDescriptor\n                .occlusionQueryPool;\n            gl.endQuery(queryPool.gl_query_type);\n        }\n    };\n    Device_GL.prototype.pipelineQueryReady = function (o) {\n        var pipeline = o;\n        return this.queryProgramReady(pipeline.program);\n    };\n    Device_GL.prototype.pipelineForceReady = function (o) {\n        // No need to do anything; it will be forced to compile when used naturally.\n    };\n    Device_GL.prototype.endPass = function () {\n        var gl = this.gl;\n        var gl2 = isWebGL2(gl);\n        var skipBlit = this.currentColorResolveTos.length === 1 &&\n            this.currentColorResolveTos[0] === this.scTexture;\n        var didUnbindDraw = false;\n        for (var i = 0; i < this.currentColorAttachments.length; i++) {\n            var colorResolveFrom = this.currentColorAttachments[i];\n            if (colorResolveFrom !== null) {\n                var colorResolveTo = this.currentColorResolveTos[i];\n                var didBindRead = false;\n                if (colorResolveTo !== null) {\n                    assert(colorResolveFrom.width === colorResolveTo.width &&\n                        colorResolveFrom.height === colorResolveTo.height);\n                    // assert(colorResolveFrom.format === colorResolveTo.format);\n                    this.setScissorRectEnabled(false);\n                    if (!skipBlit) {\n                        if (gl2) {\n                            gl.bindFramebuffer(gl.READ_FRAMEBUFFER, this.resolveColorReadFramebuffer);\n                        }\n                        if (this.resolveColorAttachmentsChanged) {\n                            if (gl2) {\n                                this.bindFramebufferAttachment(gl.READ_FRAMEBUFFER, gl.COLOR_ATTACHMENT0, colorResolveFrom, this.currentColorAttachmentLevels[i]);\n                            }\n                        }\n                    }\n                    didBindRead = true;\n                    if (!skipBlit) {\n                        // Special case: Blitting to the on-screen.\n                        if (colorResolveTo === this.scTexture) {\n                            gl.bindFramebuffer(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, this.scPlatformFramebuffer);\n                        }\n                        else {\n                            gl.bindFramebuffer(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, this.resolveColorDrawFramebuffer);\n                            if (this.resolveColorAttachmentsChanged)\n                                gl.framebufferTexture2D(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, colorResolveTo.gl_texture, this.currentColorResolveToLevels[i]);\n                        }\n                    }\n                    if (!skipBlit) {\n                        if (gl2) {\n                            gl.blitFramebuffer(0, 0, colorResolveFrom.width, colorResolveFrom.height, 0, 0, colorResolveTo.width, colorResolveTo.height, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n                            gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, null);\n                        }\n                        else {\n                            // need an extra render pass in WebGL1\n                            this.submitBlitRenderPass(colorResolveFrom, colorResolveTo);\n                        }\n                    }\n                    didUnbindDraw = true;\n                }\n                if (!this.currentRenderPassDescriptor.colorStore[i]) {\n                    if (!skipBlit && !didBindRead) {\n                        gl.bindFramebuffer(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, this.resolveColorReadFramebuffer);\n                        if (this.resolveColorAttachmentsChanged)\n                            this.bindFramebufferAttachment(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, colorResolveFrom, this.currentColorAttachmentLevels[i]);\n                    }\n                    // if (gl2) {\n                    //   gl.invalidateFramebuffer(gl.READ_FRAMEBUFFER, [\n                    //     gl.COLOR_ATTACHMENT0,\n                    //   ]);\n                    // }\n                }\n                if (!skipBlit) {\n                    gl.bindFramebuffer(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, null);\n                }\n            }\n        }\n        this.resolveColorAttachmentsChanged = false;\n        var depthStencilResolveFrom = this.currentDepthStencilAttachment;\n        if (depthStencilResolveFrom) {\n            var depthStencilResolveTo = this.currentDepthStencilResolveTo;\n            var didBindRead = false;\n            if (depthStencilResolveTo) {\n                assert(depthStencilResolveFrom.width === depthStencilResolveTo.width &&\n                    depthStencilResolveFrom.height === depthStencilResolveTo.height);\n                this.setScissorRectEnabled(false);\n                if (!skipBlit) {\n                    gl.bindFramebuffer(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, this.resolveDepthStencilReadFramebuffer);\n                    gl.bindFramebuffer(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, this.resolveDepthStencilDrawFramebuffer);\n                    if (this.resolveDepthStencilAttachmentsChanged) {\n                        this.bindFramebufferDepthStencilAttachment(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, depthStencilResolveFrom);\n                        this.bindFramebufferDepthStencilAttachment(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, depthStencilResolveTo);\n                    }\n                }\n                didBindRead = true;\n                if (!skipBlit) {\n                    if (gl2) {\n                        gl.blitFramebuffer(0, 0, depthStencilResolveFrom.width, depthStencilResolveFrom.height, 0, 0, depthStencilResolveTo.width, depthStencilResolveTo.height, gl.DEPTH_BUFFER_BIT, gl.NEAREST);\n                    }\n                    gl.bindFramebuffer(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, null);\n                }\n                didUnbindDraw = true;\n            }\n            if (!skipBlit && !this.currentRenderPassDescriptor.depthStencilStore) {\n                if (!didBindRead) {\n                    gl.bindFramebuffer(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, this.resolveDepthStencilReadFramebuffer);\n                    if (this.resolveDepthStencilAttachmentsChanged)\n                        this.bindFramebufferDepthStencilAttachment(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, depthStencilResolveFrom);\n                    didBindRead = true;\n                }\n                if (gl2) {\n                    gl.invalidateFramebuffer(gl.READ_FRAMEBUFFER, [\n                        gl.DEPTH_STENCIL_ATTACHMENT,\n                    ]);\n                }\n            }\n            if (!skipBlit && didBindRead)\n                gl.bindFramebuffer(gl2 ? GL.READ_FRAMEBUFFER : GL.FRAMEBUFFER, null);\n            this.resolveDepthStencilAttachmentsChanged = false;\n        }\n        if (!skipBlit && !didUnbindDraw) {\n            // If we did not unbind from a resolve, then we need to unbind our render pass draw FBO here.\n            gl.bindFramebuffer(gl2 ? GL.DRAW_FRAMEBUFFER : GL.FRAMEBUFFER, null);\n        }\n    };\n    Device_GL.prototype.setScissorRectEnabled = function (v) {\n        if (this.currentScissorEnabled === v) {\n            return;\n        }\n        var gl = this.gl;\n        if (v) {\n            gl.enable(gl.SCISSOR_TEST);\n        }\n        else {\n            gl.disable(gl.SCISSOR_TEST);\n        }\n        this.currentScissorEnabled = v;\n    };\n    Device_GL.prototype.applyStencil = function () {\n        if (isNil(this.currentStencilRef)) {\n            return;\n        }\n        this.gl.stencilFuncSeparate(GL.FRONT, this.currentMegaState.stencilFront.compare, this.currentStencilRef, this.currentMegaState.stencilFront.mask || 0xff);\n        this.gl.stencilFuncSeparate(GL.BACK, this.currentMegaState.stencilBack.compare, this.currentStencilRef, this.currentMegaState.stencilBack.mask || 0xff);\n    };\n    Device_GL.prototype.getFallbackTexture = function (samplerEntry) {\n        var gl_target = samplerEntry.gl_target, formatKind = samplerEntry.formatKind;\n        if (gl_target === GL.TEXTURE_2D)\n            return formatKind === SamplerFormatKind.Depth\n                ? this.fallbackTexture2DDepth\n                : this.fallbackTexture2D;\n        else if (gl_target === GL.TEXTURE_2D_ARRAY)\n            return this.fallbackTexture2DArray;\n        else if (gl_target === GL.TEXTURE_3D)\n            return this.fallbackTexture3D;\n        else if (gl_target === GL.TEXTURE_CUBE_MAP)\n            return this.fallbackTextureCube;\n        else\n            throw new Error('whoops');\n    };\n    Device_GL.prototype.submitBlitRenderPass = function (resolveFrom, resolveTo) {\n        if (!this.blitRenderPipeline) {\n            this.blitProgram = this.createProgram({\n                vertex: {\n                    glsl: \"layout(location = 0) in vec2 a_Position;\\nout vec2 v_TexCoord;\\nvoid main() {\\n  v_TexCoord = 0.5 * (a_Position + 1.0);\\n  gl_Position = vec4(a_Position, 0., 1.);\\n\\n  #ifdef VIEWPORT_ORIGIN_TL\\n    v_TexCoord.y = 1.0 - v_TexCoord.y;\\n  #endif\\n}\",\n                },\n                fragment: {\n                    glsl: \"uniform sampler2D u_Texture;\\nin vec2 v_TexCoord;\\nout vec4 outputColor;\\nvoid main() {\\n  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);\\n}\",\n                },\n            });\n            this.blitVertexBuffer = this.createBuffer({\n                usage: BufferUsage.VERTEX | BufferUsage.COPY_DST,\n                viewOrSize: new Float32Array([-4, -4, 4, -4, 0, 4]),\n            });\n            this.blitInputLayout = this.createInputLayout({\n                vertexBufferDescriptors: [\n                    {\n                        arrayStride: 4 * 2,\n                        stepMode: VertexStepMode.VERTEX,\n                        attributes: [\n                            {\n                                format: Format.F32_RG,\n                                offset: 4 * 0,\n                                shaderLocation: 0,\n                            },\n                        ],\n                    },\n                ],\n                indexBufferFormat: null,\n                program: this.blitProgram,\n            });\n            this.blitRenderPipeline = this.createRenderPipeline({\n                topology: PrimitiveTopology.TRIANGLES,\n                sampleCount: 1,\n                program: this.blitProgram,\n                colorAttachmentFormats: [Format.U8_RGBA_RT],\n                depthStencilAttachmentFormat: null,\n                inputLayout: this.blitInputLayout,\n                megaStateDescriptor: copyMegaState(defaultMegaState),\n            });\n            this.blitBindings = this.createBindings({\n                samplerBindings: [\n                    {\n                        sampler: null,\n                        texture: resolveFrom.texture,\n                    },\n                ],\n                uniformBufferBindings: [],\n            });\n            this.blitProgram.setUniformsLegacy({\n                u_Texture: resolveFrom,\n            });\n        }\n        // save currentRenderPassDescriptor since we're already in a render pass\n        var currentRenderPassDescriptor = this.currentRenderPassDescriptor;\n        this.currentRenderPassDescriptor = null;\n        this.inBlitRenderPass = true;\n        var blitRenderPass = this.createRenderPass({\n            colorAttachment: [resolveFrom],\n            colorResolveTo: [resolveTo],\n            colorClearColor: [TransparentWhite],\n        });\n        var _a = this.getCanvas(), width = _a.width, height = _a.height;\n        blitRenderPass.setPipeline(this.blitRenderPipeline);\n        blitRenderPass.setBindings(this.blitBindings);\n        blitRenderPass.setVertexInput(this.blitInputLayout, [{ buffer: this.blitVertexBuffer }], null);\n        blitRenderPass.setViewport(0, 0, width, height);\n        // disable blending for blit\n        this.gl.disable(this.gl.BLEND);\n        blitRenderPass.draw(3, 0);\n        this.gl.enable(this.gl.BLEND);\n        // restore\n        this.currentRenderPassDescriptor = currentRenderPassDescriptor;\n        this.inBlitRenderPass = false;\n    };\n    return Device_GL;\n}());\n\nvar WebGLDeviceContribution = /** @class */ (function () {\n    function WebGLDeviceContribution(pluginOptions) {\n        this.pluginOptions = pluginOptions;\n    }\n    WebGLDeviceContribution.prototype.createSwapChain = function ($canvas) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, targets, xrCompatible, _b, antialias, _c, preserveDrawingBuffer, _d, premultipliedAlpha, shaderDebug, trackResources, options, gl;\n            return __generator(this, function (_e) {\n                _a = this.pluginOptions, targets = _a.targets, xrCompatible = _a.xrCompatible, _b = _a.antialias, antialias = _b === void 0 ? false : _b, _c = _a.preserveDrawingBuffer, preserveDrawingBuffer = _c === void 0 ? false : _c, _d = _a.premultipliedAlpha, premultipliedAlpha = _d === void 0 ? true : _d, shaderDebug = _a.shaderDebug, trackResources = _a.trackResources;\n                options = {\n                    // alpha: true,\n                    antialias: antialias,\n                    // @see https://stackoverflow.com/questions/27746091/preservedrawingbuffer-false-is-it-worth-the-effort\n                    preserveDrawingBuffer: preserveDrawingBuffer,\n                    // @see https://webglfundamentals.org/webgl/lessons/webgl-qna-how-to-use-the-stencil-buffer.html\n                    stencil: true,\n                    // @see https://webglfundamentals.org/webgl/lessons/webgl-and-alpha.html\n                    premultipliedAlpha: premultipliedAlpha,\n                    xrCompatible: xrCompatible,\n                };\n                this.handleContextEvents($canvas);\n                if (targets.includes('webgl2')) {\n                    gl =\n                        $canvas.getContext('webgl2', options) ||\n                            $canvas.getContext('experimental-webgl2', options);\n                }\n                if (!gl && targets.includes('webgl1')) {\n                    gl =\n                        $canvas.getContext('webgl', options) ||\n                            $canvas.getContext('experimental-webgl', options);\n                }\n                return [2 /*return*/, new Device_GL(gl, {\n                        shaderDebug: shaderDebug,\n                        trackResources: trackResources,\n                    })];\n            });\n        });\n    };\n    WebGLDeviceContribution.prototype.handleContextEvents = function ($canvas) {\n        var _a = this.pluginOptions, onContextLost = _a.onContextLost, onContextRestored = _a.onContextRestored, onContextCreationError = _a.onContextCreationError;\n        // bind context event listeners\n        if (onContextCreationError) {\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/webglcontextcreationerror_event\n            $canvas.addEventListener('webglcontextcreationerror', onContextCreationError, false);\n        }\n        if (onContextLost) {\n            $canvas.addEventListener('webglcontextlost', onContextLost, false);\n        }\n        if (onContextRestored) {\n            $canvas.addEventListener('webglcontextrestored', onContextRestored, false);\n        }\n    };\n    return WebGLDeviceContribution;\n}());\n\nlet wasm;\n\nconst cachedTextDecoder =\n  typeof TextDecoder !== 'undefined'\n    ? new TextDecoder('utf-8', { ignoreBOM: true, fatal: true })\n    : {\n        decode: () => {\n          throw Error('TextDecoder not available');\n        },\n      };\n\nif (typeof TextDecoder !== 'undefined') {\n  cachedTextDecoder.decode();\n}\n\nlet cachedUint8Memory0 = null;\n\nfunction getUint8Memory0() {\n  if (cachedUint8Memory0 === null || cachedUint8Memory0.byteLength === 0) {\n    cachedUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n  }\n  return cachedUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n  ptr = ptr >>> 0;\n  return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nconst heap = new Array(128).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nlet heap_next = heap.length;\n\nfunction addHeapObject(obj) {\n  if (heap_next === heap.length) heap.push(heap.length + 1);\n  const idx = heap_next;\n  heap_next = heap[idx];\n\n  heap[idx] = obj;\n  return idx;\n}\n\nfunction getObject(idx) {\n  return heap[idx];\n}\n\nfunction dropObject(idx) {\n  if (idx < 132) return;\n  heap[idx] = heap_next;\n  heap_next = idx;\n}\n\nfunction takeObject(idx) {\n  const ret = getObject(idx);\n  dropObject(idx);\n  return ret;\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nconst cachedTextEncoder =\n  typeof TextEncoder !== 'undefined'\n    ? new TextEncoder('utf-8')\n    : {\n        encode: () => {\n          throw Error('TextEncoder not available');\n        },\n      };\n\nconst encodeString =\n  typeof cachedTextEncoder.encodeInto === 'function'\n    ? function (arg, view) {\n        return cachedTextEncoder.encodeInto(arg, view);\n      }\n    : function (arg, view) {\n        const buf = cachedTextEncoder.encode(arg);\n        view.set(buf);\n        return {\n          read: arg.length,\n          written: buf.length,\n        };\n      };\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n  if (realloc === undefined) {\n    const buf = cachedTextEncoder.encode(arg);\n    const ptr = malloc(buf.length, 1) >>> 0;\n    getUint8Memory0()\n      .subarray(ptr, ptr + buf.length)\n      .set(buf);\n    WASM_VECTOR_LEN = buf.length;\n    return ptr;\n  }\n\n  let len = arg.length;\n  let ptr = malloc(len, 1) >>> 0;\n\n  const mem = getUint8Memory0();\n\n  let offset = 0;\n\n  for (; offset < len; offset++) {\n    const code = arg.charCodeAt(offset);\n    if (code > 0x7f) break;\n    mem[ptr + offset] = code;\n  }\n\n  if (offset !== len) {\n    if (offset !== 0) {\n      arg = arg.slice(offset);\n    }\n    ptr = realloc(ptr, len, (len = offset + arg.length * 3), 1) >>> 0;\n    const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n    const ret = encodeString(arg, view);\n\n    offset += ret.written;\n  }\n\n  WASM_VECTOR_LEN = offset;\n  return ptr;\n}\n\nlet cachedInt32Memory0 = null;\n\nfunction getInt32Memory0() {\n  if (cachedInt32Memory0 === null || cachedInt32Memory0.byteLength === 0) {\n    cachedInt32Memory0 = new Int32Array(wasm.memory.buffer);\n  }\n  return cachedInt32Memory0;\n}\n/**\n * @param {string} source\n * @param {string} stage\n * @param {boolean} validation_enabled\n * @returns {string}\n */\nfunction glsl_compile(source, stage, validation_enabled) {\n  let deferred3_0;\n  let deferred3_1;\n  try {\n    const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n    const ptr0 = passStringToWasm0(\n      source,\n      wasm.__wbindgen_malloc,\n      wasm.__wbindgen_realloc,\n    );\n    const len0 = WASM_VECTOR_LEN;\n    const ptr1 = passStringToWasm0(\n      stage,\n      wasm.__wbindgen_malloc,\n      wasm.__wbindgen_realloc,\n    );\n    const len1 = WASM_VECTOR_LEN;\n    wasm.glsl_compile(retptr, ptr0, len0, ptr1, len1, validation_enabled);\n    var r0 = getInt32Memory0()[retptr / 4 + 0];\n    var r1 = getInt32Memory0()[retptr / 4 + 1];\n    deferred3_0 = r0;\n    deferred3_1 = r1;\n    return getStringFromWasm0(r0, r1);\n  } finally {\n    wasm.__wbindgen_add_to_stack_pointer(16);\n    wasm.__wbindgen_free(deferred3_0, deferred3_1, 1);\n  }\n}\n\n/**\n */\nclass WGSLComposer {\n  static __wrap(ptr) {\n    ptr = ptr >>> 0;\n    const obj = Object.create(WGSLComposer.prototype);\n    obj.__wbg_ptr = ptr;\n\n    return obj;\n  }\n\n  __destroy_into_raw() {\n    const ptr = this.__wbg_ptr;\n    this.__wbg_ptr = 0;\n\n    return ptr;\n  }\n\n  free() {\n    const ptr = this.__destroy_into_raw();\n    wasm.__wbg_wgslcomposer_free(ptr);\n  }\n  /**\n   */\n  constructor() {\n    const ret = wasm.wgslcomposer_new();\n    return WGSLComposer.__wrap(ret);\n  }\n  /**\n   * @param {string} source\n   */\n  load_composable(source) {\n    const ptr0 = passStringToWasm0(\n      source,\n      wasm.__wbindgen_malloc,\n      wasm.__wbindgen_realloc,\n    );\n    const len0 = WASM_VECTOR_LEN;\n    wasm.wgslcomposer_load_composable(this.__wbg_ptr, ptr0, len0);\n  }\n  /**\n   * @param {string} source\n   * @returns {string}\n   */\n  wgsl_compile(source) {\n    let deferred2_0;\n    let deferred2_1;\n    try {\n      const retptr = wasm.__wbindgen_add_to_stack_pointer(-16);\n      const ptr0 = passStringToWasm0(\n        source,\n        wasm.__wbindgen_malloc,\n        wasm.__wbindgen_realloc,\n      );\n      const len0 = WASM_VECTOR_LEN;\n      wasm.wgslcomposer_wgsl_compile(retptr, this.__wbg_ptr, ptr0, len0);\n      var r0 = getInt32Memory0()[retptr / 4 + 0];\n      var r1 = getInt32Memory0()[retptr / 4 + 1];\n      deferred2_0 = r0;\n      deferred2_1 = r1;\n      return getStringFromWasm0(r0, r1);\n    } finally {\n      wasm.__wbindgen_add_to_stack_pointer(16);\n      wasm.__wbindgen_free(deferred2_0, deferred2_1, 1);\n    }\n  }\n}\n\nasync function __wbg_load(module, imports) {\n  if (typeof Response === 'function' && module instanceof Response) {\n    if (typeof WebAssembly.instantiateStreaming === 'function') {\n      try {\n        return await WebAssembly.instantiateStreaming(module, imports);\n      } catch (e) {\n        if (module.headers.get('Content-Type') != 'application/wasm') {\n          console.warn(\n            '`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n',\n            e,\n          );\n        } else {\n          throw e;\n        }\n      }\n    }\n\n    const bytes = await module.arrayBuffer();\n    return await WebAssembly.instantiate(bytes, imports);\n  } else {\n    const instance = await WebAssembly.instantiate(module, imports);\n\n    if (instance instanceof WebAssembly.Instance) {\n      return { instance, module };\n    } else {\n      return instance;\n    }\n  }\n}\n\nfunction __wbg_get_imports() {\n  const imports = {};\n  imports.wbg = {};\n  imports.wbg.__wbindgen_string_new = function (arg0, arg1) {\n    const ret = getStringFromWasm0(arg0, arg1);\n    return addHeapObject(ret);\n  };\n  imports.wbg.__wbindgen_object_drop_ref = function (arg0) {\n    takeObject(arg0);\n  };\n  imports.wbg.__wbg_log_1d3ae0273d8f4f8a = function (arg0) {\n    console.log(getObject(arg0));\n  };\n  imports.wbg.__wbg_log_576ca876af0d4a77 = function (arg0, arg1) {\n    console.log(getObject(arg0), getObject(arg1));\n  };\n  imports.wbg.__wbindgen_throw = function (arg0, arg1) {\n    throw new Error(getStringFromWasm0(arg0, arg1));\n  };\n\n  return imports;\n}\n\nfunction __wbg_finalize_init(instance, module) {\n  wasm = instance.exports;\n  __wbg_init.__wbindgen_wasm_module = module;\n  cachedInt32Memory0 = null;\n  cachedUint8Memory0 = null;\n\n  return wasm;\n}\n\nasync function __wbg_init(input) {\n  if (wasm !== undefined) return wasm;\n  const imports = __wbg_get_imports();\n\n  if (\n    typeof input === 'string' ||\n    (typeof Request === 'function' && input instanceof Request) ||\n    (typeof URL === 'function' && input instanceof URL)\n  ) {\n    input = fetch(input);\n  }\n\n  const { instance, module } = await __wbg_load(await input, imports);\n\n  return __wbg_finalize_init(instance, module);\n}\n\n/**\n * @see https://github.com/gpuweb/cts/blob/main/src/webgpu/constants.ts\n */\nvar GPUTextureUsage$1;\n(function (GPUTextureUsage) {\n    GPUTextureUsage[GPUTextureUsage[\"COPY_SRC\"] = 1] = \"COPY_SRC\";\n    GPUTextureUsage[GPUTextureUsage[\"COPY_DST\"] = 2] = \"COPY_DST\";\n    GPUTextureUsage[GPUTextureUsage[\"TEXTURE_BINDING\"] = 4] = \"TEXTURE_BINDING\";\n    // SAMPLED= 0x04,\n    GPUTextureUsage[GPUTextureUsage[\"STORAGE_BINDING\"] = 8] = \"STORAGE_BINDING\";\n    GPUTextureUsage[GPUTextureUsage[\"STORAGE\"] = 8] = \"STORAGE\";\n    GPUTextureUsage[GPUTextureUsage[\"RENDER_ATTACHMENT\"] = 16] = \"RENDER_ATTACHMENT\";\n})(GPUTextureUsage$1 || (GPUTextureUsage$1 = {}));\n// @see https://www.w3.org/TR/webgpu/#typedefdef-gpumapmodeflags\nvar GPUMapMode;\n(function (GPUMapMode) {\n    GPUMapMode[GPUMapMode[\"READ\"] = 1] = \"READ\";\n    GPUMapMode[GPUMapMode[\"WRITE\"] = 2] = \"WRITE\";\n})(GPUMapMode || (GPUMapMode = {}));\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/GPUTexture/usage#value\n */\nfunction translateTextureUsage(usage) {\n    var gpuUsage = 0;\n    if (usage & TextureUsage.SAMPLED)\n        gpuUsage |=\n            GPUTextureUsage$1.TEXTURE_BINDING |\n                GPUTextureUsage$1.COPY_DST |\n                GPUTextureUsage$1.COPY_SRC;\n    if (usage & TextureUsage.STORAGE)\n        gpuUsage |=\n            GPUTextureUsage$1.TEXTURE_BINDING |\n                GPUTextureUsage$1.STORAGE_BINDING |\n                GPUTextureUsage$1.COPY_SRC |\n                GPUTextureUsage$1.COPY_DST;\n    if (usage & TextureUsage.RENDER_TARGET)\n        gpuUsage |=\n            GPUTextureUsage$1.RENDER_ATTACHMENT |\n                GPUTextureUsage$1.TEXTURE_BINDING |\n                GPUTextureUsage$1.COPY_SRC |\n                GPUTextureUsage$1.COPY_DST;\n    return gpuUsage;\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gputextureformat\n */\nfunction translateTextureFormat(format) {\n    // 8-bit formats\n    if (format === Format.U8_R_NORM)\n        return 'r8unorm';\n    else if (format === Format.S8_R_NORM)\n        return 'r8snorm';\n    // 16-bit formats\n    else if (format === Format.U8_RG_NORM)\n        return 'rg8unorm';\n    else if (format === Format.S8_RG_NORM)\n        return 'rg8snorm';\n    // 32-bit formats\n    else if (format === Format.U32_R)\n        return 'r32uint';\n    else if (format === Format.S32_R)\n        return 'r32sint';\n    else if (format === Format.F32_R)\n        return 'r32float';\n    else if (format === Format.U16_RG)\n        return 'rg16uint';\n    else if (format === Format.S16_RG)\n        return 'rg16sint';\n    else if (format === Format.F16_RG)\n        return 'rg16float';\n    else if (format === Format.U8_RGBA_RT)\n        return 'bgra8unorm';\n    else if (format === Format.U8_RGBA_RT_SRGB)\n        return 'bgra8unorm-srgb';\n    else if (format === Format.U8_RGBA_NORM)\n        return 'rgba8unorm';\n    else if (format === Format.U8_RGBA_SRGB)\n        return 'rgba8unorm-srgb';\n    else if (format === Format.S8_RGBA_NORM)\n        return 'rgba8snorm';\n    // 64-bit formats\n    else if (format === Format.U32_RG)\n        return 'rg32uint';\n    else if (format === Format.S32_RG)\n        return 'rg32sint';\n    else if (format === Format.F32_RG)\n        return 'rg32float';\n    else if (format === Format.U16_RGBA)\n        return 'rgba16uint';\n    else if (format === Format.S16_RGBA)\n        return 'rgba16sint';\n    else if (format === Format.F16_RGBA)\n        return 'rgba16float';\n    // 128-bit formats\n    else if (format === Format.F32_RGBA)\n        return 'rgba32float';\n    else if (format === Format.U32_RGBA)\n        return 'rgba32uint';\n    else if (format === Format.S32_RGBA)\n        return 'rgba32sint';\n    // depth stencil formats\n    else if (format === Format.D24)\n        return 'depth24plus';\n    else if (format === Format.D24_S8)\n        return 'depth24plus-stencil8';\n    else if (format === Format.D32F)\n        return 'depth32float';\n    else if (format === Format.D32F_S8)\n        return 'depth32float-stencil8';\n    // bc\n    else if (format === Format.BC1)\n        return 'bc1-rgba-unorm';\n    else if (format === Format.BC1_SRGB)\n        return 'bc1-rgba-unorm-srgb';\n    else if (format === Format.BC2)\n        return 'bc2-rgba-unorm';\n    else if (format === Format.BC2_SRGB)\n        return 'bc2-rgba-unorm-srgb';\n    else if (format === Format.BC3)\n        return 'bc3-rgba-unorm';\n    else if (format === Format.BC3_SRGB)\n        return 'bc3-rgba-unorm-srgb';\n    else if (format === Format.BC4_SNORM)\n        return 'bc4-r-snorm';\n    else if (format === Format.BC4_UNORM)\n        return 'bc4-r-unorm';\n    else if (format === Format.BC5_SNORM)\n        return 'bc5-rg-snorm';\n    else if (format === Format.BC5_UNORM)\n        return 'bc5-rg-unorm';\n    else\n        throw 'whoops';\n}\nfunction translateTextureDimension(dimension) {\n    if (dimension === TextureDimension.TEXTURE_2D)\n        return '2d';\n    else if (dimension === TextureDimension.TEXTURE_CUBE_MAP)\n        return '2d';\n    else if (dimension === TextureDimension.TEXTURE_2D_ARRAY)\n        return '2d';\n    else if (dimension === TextureDimension.TEXTURE_3D)\n        return '3d';\n    else\n        throw new Error('whoops');\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gputextureviewdimension\n */\nfunction translateTextureViewDimension(dimension) {\n    if (dimension === TextureDimension.TEXTURE_2D)\n        return '2d';\n    else if (dimension === TextureDimension.TEXTURE_CUBE_MAP)\n        return 'cube';\n    else if (dimension === TextureDimension.TEXTURE_2D_ARRAY)\n        return '2d-array';\n    else if (dimension === TextureDimension.TEXTURE_3D)\n        return '3d';\n    else\n        throw new Error('whoops');\n}\nfunction translateBufferUsage(usage_) {\n    var usage = 0;\n    if (usage_ & BufferUsage.INDEX)\n        usage |= GPUBufferUsage.INDEX;\n    if (usage_ & BufferUsage.VERTEX)\n        usage |= GPUBufferUsage.VERTEX;\n    if (usage_ & BufferUsage.UNIFORM)\n        usage |= GPUBufferUsage.UNIFORM;\n    if (usage_ & BufferUsage.STORAGE)\n        usage |= GPUBufferUsage.STORAGE;\n    if (usage_ & BufferUsage.COPY_SRC)\n        usage |= GPUBufferUsage.COPY_SRC;\n    if (usage_ & BufferUsage.INDIRECT)\n        usage |= GPUBufferUsage.INDIRECT;\n    usage |= GPUBufferUsage.COPY_DST;\n    return usage;\n}\nfunction translateAddressMode(wrapMode) {\n    if (wrapMode === AddressMode.CLAMP_TO_EDGE)\n        return 'clamp-to-edge';\n    else if (wrapMode === AddressMode.REPEAT)\n        return 'repeat';\n    else if (wrapMode === AddressMode.MIRRORED_REPEAT)\n        return 'mirror-repeat';\n    else\n        throw new Error('whoops');\n}\nfunction translateMinMagFilter(texFilter) {\n    if (texFilter === FilterMode.BILINEAR)\n        return 'linear';\n    else if (texFilter === FilterMode.POINT)\n        return 'nearest';\n    else\n        throw new Error('whoops');\n}\n// @see https://www.w3.org/TR/webgpu/#enumdef-gpumipmapfiltermode\nfunction translateMipFilter(mipmapFilter) {\n    if (mipmapFilter === MipmapFilterMode.LINEAR)\n        return 'linear';\n    else if (mipmapFilter === MipmapFilterMode.NEAREST)\n        return 'nearest';\n    else if (mipmapFilter === MipmapFilterMode.NO_MIP)\n        return 'nearest';\n    else\n        throw new Error('whoops');\n}\nfunction getPlatformBuffer(buffer_) {\n    var buffer = buffer_;\n    return buffer.gpuBuffer;\n}\nfunction getPlatformSampler(sampler_) {\n    var sampler = sampler_;\n    return sampler.gpuSampler;\n}\nfunction getPlatformQuerySet(queryPool_) {\n    var queryPool = queryPool_;\n    return queryPool.querySet;\n}\nfunction translateQueryPoolType(type) {\n    if (type === QueryPoolType.OcclusionConservative)\n        return 'occlusion';\n    else\n        throw new Error('whoops');\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#primitive-state\n */\nfunction translateTopology(topology) {\n    switch (topology) {\n        case PrimitiveTopology.TRIANGLES:\n            return 'triangle-list';\n        case PrimitiveTopology.POINTS:\n            return 'point-list';\n        case PrimitiveTopology.TRIANGLE_STRIP:\n            return 'triangle-strip';\n        case PrimitiveTopology.LINES:\n            return 'line-list';\n        case PrimitiveTopology.LINE_STRIP:\n            return 'line-strip';\n        default:\n            throw new Error('Unknown primitive topology mode');\n    }\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpucullmode\n */\nfunction translateCullMode(cullMode) {\n    if (cullMode === CullMode.NONE)\n        return 'none';\n    else if (cullMode === CullMode.FRONT)\n        return 'front';\n    else if (cullMode === CullMode.BACK)\n        return 'back';\n    else\n        throw new Error('whoops');\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpufrontface\n */\nfunction translateFrontFace(frontFaceMode) {\n    if (frontFaceMode === FrontFace.CCW)\n        return 'ccw';\n    else if (frontFaceMode === FrontFace.CW)\n        return 'cw';\n    else\n        throw new Error('whoops');\n}\nfunction translatePrimitiveState(topology, megaStateDescriptor) {\n    return {\n        topology: translateTopology(topology),\n        cullMode: translateCullMode(megaStateDescriptor.cullMode),\n        frontFace: translateFrontFace(megaStateDescriptor.frontFace),\n    };\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpublendfactor\n */\nfunction translateBlendFactor(factor) {\n    if (factor === BlendFactor.ZERO)\n        return 'zero';\n    else if (factor === BlendFactor.ONE)\n        return 'one';\n    else if (factor === BlendFactor.SRC)\n        return 'src';\n    else if (factor === BlendFactor.ONE_MINUS_SRC)\n        return 'one-minus-src';\n    else if (factor === BlendFactor.DST)\n        return 'dst';\n    else if (factor === BlendFactor.ONE_MINUS_DST)\n        return 'one-minus-dst';\n    else if (factor === BlendFactor.SRC_ALPHA)\n        return 'src-alpha';\n    else if (factor === BlendFactor.ONE_MINUS_SRC_ALPHA)\n        return 'one-minus-src-alpha';\n    else if (factor === BlendFactor.DST_ALPHA)\n        return 'dst-alpha';\n    else if (factor === BlendFactor.ONE_MINUS_DST_ALPHA)\n        return 'one-minus-dst-alpha';\n    else if (factor === BlendFactor.CONST)\n        return 'constant';\n    else if (factor === BlendFactor.ONE_MINUS_CONSTANT)\n        return 'one-minus-constant';\n    else if (factor === BlendFactor.SRC_ALPHA_SATURATE)\n        return 'src-alpha-saturated';\n    else\n        throw new Error('whoops');\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#enumdef-gpublendoperation\n */\nfunction translateBlendMode(mode) {\n    if (mode === BlendMode.ADD)\n        return 'add';\n    else if (mode === BlendMode.SUBSTRACT)\n        return 'subtract';\n    else if (mode === BlendMode.REVERSE_SUBSTRACT)\n        return 'reverse-subtract';\n    else if (mode === BlendMode.MIN)\n        return 'min';\n    else if (mode === BlendMode.MAX)\n        return 'max';\n    else\n        throw new Error('whoops');\n}\nfunction translateBlendComponent(ch) {\n    return {\n        operation: translateBlendMode(ch.blendMode),\n        srcFactor: translateBlendFactor(ch.blendSrcFactor),\n        dstFactor: translateBlendFactor(ch.blendDstFactor),\n    };\n}\nfunction blendComponentIsNil(ch) {\n    return (ch.blendMode === BlendMode.ADD &&\n        ch.blendSrcFactor === BlendFactor.ONE &&\n        ch.blendDstFactor === BlendFactor.ZERO);\n}\nfunction translateBlendState(attachmentState) {\n    if (blendComponentIsNil(attachmentState.rgbBlendState) &&\n        blendComponentIsNil(attachmentState.alphaBlendState)) {\n        return undefined;\n    }\n    else {\n        return {\n            color: translateBlendComponent(attachmentState.rgbBlendState),\n            alpha: translateBlendComponent(attachmentState.alphaBlendState),\n        };\n    }\n}\nfunction translateColorState(attachmentState, format) {\n    return {\n        format: translateTextureFormat(format),\n        blend: translateBlendState(attachmentState),\n        writeMask: attachmentState.channelWriteMask,\n    };\n}\nfunction translateTargets(colorAttachmentFormats, megaStateDescriptor) {\n    return megaStateDescriptor.attachmentsState.map(function (attachmentState, i) {\n        return translateColorState(attachmentState, colorAttachmentFormats[i]);\n    });\n}\n// @see https://www.w3.org/TR/webgpu/#enumdef-gpucomparefunction\nfunction translateCompareFunction(compareFunction) {\n    if (compareFunction === CompareFunction.NEVER)\n        return 'never';\n    else if (compareFunction === CompareFunction.LESS)\n        return 'less';\n    else if (compareFunction === CompareFunction.EQUAL)\n        return 'equal';\n    else if (compareFunction === CompareFunction.LEQUAL)\n        return 'less-equal';\n    else if (compareFunction === CompareFunction.GREATER)\n        return 'greater';\n    else if (compareFunction === CompareFunction.NOTEQUAL)\n        return 'not-equal';\n    else if (compareFunction === CompareFunction.GEQUAL)\n        return 'greater-equal';\n    else if (compareFunction === CompareFunction.ALWAYS)\n        return 'always';\n    else\n        throw new Error('whoops');\n}\nfunction translateStencilOperation(stencilOp) {\n    if (stencilOp === StencilOp.KEEP)\n        return 'keep';\n    else if (stencilOp === StencilOp.REPLACE)\n        return 'replace';\n    else if (stencilOp === StencilOp.ZERO)\n        return 'zero';\n    else if (stencilOp === StencilOp.DECREMENT_CLAMP)\n        return 'decrement-clamp';\n    else if (stencilOp === StencilOp.DECREMENT_WRAP)\n        return 'decrement-wrap';\n    else if (stencilOp === StencilOp.INCREMENT_CLAMP)\n        return 'increment-clamp';\n    else if (stencilOp === StencilOp.INCREMENT_WRAP)\n        return 'increment-wrap';\n    else if (stencilOp === StencilOp.INVERT)\n        return 'invert';\n    else\n        throw new Error('whoops');\n}\n/**\n * @see https://www.w3.org/TR/webgpu/#dictdef-gpudepthstencilstate\n */\nfunction translateDepthStencilState(format, megaStateDescriptor) {\n    if (isNil(format))\n        return undefined;\n    return {\n        /**\n         * @see https://www.w3.org/TR/webgpu/#dom-gpudepthstencilstate-format\n         */\n        format: translateTextureFormat(format),\n        depthWriteEnabled: !!megaStateDescriptor.depthWrite,\n        depthCompare: translateCompareFunction(megaStateDescriptor.depthCompare),\n        depthBias: megaStateDescriptor.polygonOffset ? 1 : 0,\n        depthBiasSlopeScale: megaStateDescriptor.polygonOffset ? 1 : 0,\n        stencilFront: {\n            compare: translateCompareFunction(megaStateDescriptor.stencilFront.compare),\n            passOp: translateStencilOperation(megaStateDescriptor.stencilFront.passOp),\n            failOp: translateStencilOperation(megaStateDescriptor.stencilFront.failOp),\n            depthFailOp: translateStencilOperation(megaStateDescriptor.stencilFront.depthFailOp),\n        },\n        stencilBack: {\n            compare: translateCompareFunction(megaStateDescriptor.stencilBack.compare),\n            passOp: translateStencilOperation(megaStateDescriptor.stencilBack.passOp),\n            failOp: translateStencilOperation(megaStateDescriptor.stencilBack.failOp),\n            depthFailOp: translateStencilOperation(megaStateDescriptor.stencilBack.depthFailOp),\n        },\n        stencilReadMask: 0xffffffff,\n        stencilWriteMask: 0xffffffff,\n        // stencilReadMask: 0xffffffff,\n        // stencilWriteMask: megaStateDescriptor.stencilWrite ? 0xff : 0x00,\n    };\n}\nfunction translateIndexFormat(format) {\n    if (format === null)\n        return undefined;\n    else if (format === Format.U16_R)\n        return 'uint16';\n    else if (format === Format.U32_R)\n        return 'uint32';\n    else\n        throw new Error('whoops');\n}\nfunction translateVertexStepMode(stepMode) {\n    if (stepMode === VertexStepMode.VERTEX)\n        return 'vertex';\n    else if (stepMode === VertexStepMode.INSTANCE)\n        return 'instance';\n    else\n        throw new Error('whoops');\n}\nfunction translateVertexFormat(format) {\n    if (format === Format.U8_R)\n        return 'uint8x2';\n    else if (format === Format.U8_RG)\n        return 'uint8x2';\n    else if (format === Format.U8_RGB)\n        return 'uint8x4';\n    else if (format === Format.U8_RGBA)\n        return 'uint8x4';\n    else if (format === Format.U8_RG_NORM)\n        return 'unorm8x2';\n    else if (format === Format.U8_RGBA_NORM)\n        return 'unorm8x4';\n    else if (format === Format.S8_RGB_NORM)\n        return 'snorm8x4';\n    else if (format === Format.S8_RGBA_NORM)\n        return 'snorm8x4';\n    else if (format === Format.U16_RG_NORM)\n        return 'unorm16x2';\n    else if (format === Format.U16_RGBA_NORM)\n        return 'unorm16x4';\n    else if (format === Format.S16_RG_NORM)\n        return 'snorm16x2';\n    else if (format === Format.S16_RGBA_NORM)\n        return 'snorm16x4';\n    else if (format === Format.S16_RG)\n        return 'uint16x2';\n    else if (format === Format.F16_RG)\n        return 'float16x2';\n    else if (format === Format.F16_RGBA)\n        return 'float16x4';\n    else if (format === Format.F32_R)\n        return 'float32';\n    else if (format === Format.F32_RG)\n        return 'float32x2';\n    else if (format === Format.F32_RGB)\n        return 'float32x3';\n    else if (format === Format.F32_RGBA)\n        return 'float32x4';\n    else\n        throw 'whoops';\n}\nfunction isFormatTextureCompressionBC(format) {\n    var formatTypeFlags = getFormatTypeFlags(format);\n    switch (formatTypeFlags) {\n        case FormatTypeFlags.BC1:\n        case FormatTypeFlags.BC2:\n        case FormatTypeFlags.BC3:\n        case FormatTypeFlags.BC4_SNORM:\n        case FormatTypeFlags.BC4_UNORM:\n        case FormatTypeFlags.BC5_SNORM:\n        case FormatTypeFlags.BC5_UNORM:\n            return true;\n        default:\n            return false;\n    }\n}\nfunction getFormatBlockSize(format) {\n    var formatTypeFlags = getFormatTypeFlags(format);\n    switch (formatTypeFlags) {\n        case FormatTypeFlags.BC1:\n        case FormatTypeFlags.BC2:\n        case FormatTypeFlags.BC3:\n        case FormatTypeFlags.BC4_SNORM:\n        case FormatTypeFlags.BC4_UNORM:\n        case FormatTypeFlags.BC5_SNORM:\n        case FormatTypeFlags.BC5_UNORM:\n            return 4;\n        default:\n            return 1;\n    }\n}\nfunction allocateAndCopyTypedBuffer(type, sizeOrDstBuffer, sizeInBytes, copyBuffer) {\n    if (sizeInBytes === void 0) { sizeInBytes = false; }\n    switch (type) {\n        case Format.S8_R:\n        case Format.S8_R_NORM:\n        case Format.S8_RG_NORM:\n        case Format.S8_RGB_NORM:\n        case Format.S8_RGBA_NORM: {\n            var buffer_1 = sizeOrDstBuffer instanceof ArrayBuffer\n                ? new Int8Array(sizeOrDstBuffer)\n                : new Int8Array(sizeOrDstBuffer);\n            if (copyBuffer) {\n                buffer_1.set(new Int8Array(copyBuffer));\n            }\n            return buffer_1;\n        }\n        case Format.U8_R:\n        case Format.U8_R_NORM:\n        case Format.U8_RG:\n        case Format.U8_RG_NORM:\n        case Format.U8_RGB:\n        case Format.U8_RGB_NORM:\n        case Format.U8_RGB_SRGB:\n        case Format.U8_RGBA:\n        case Format.U8_RGBA_NORM:\n        case Format.U8_RGBA_SRGB: {\n            var buffer_2 = sizeOrDstBuffer instanceof ArrayBuffer\n                ? new Uint8Array(sizeOrDstBuffer)\n                : new Uint8Array(sizeOrDstBuffer);\n            if (copyBuffer) {\n                buffer_2.set(new Uint8Array(copyBuffer));\n            }\n            return buffer_2;\n        }\n        case Format.S16_R:\n        case Format.S16_RG:\n        case Format.S16_RG_NORM:\n        case Format.S16_RGB_NORM:\n        case Format.S16_RGBA:\n        case Format.S16_RGBA_NORM: {\n            var buffer_3 = sizeOrDstBuffer instanceof ArrayBuffer\n                ? new Int16Array(sizeOrDstBuffer)\n                : new Int16Array(sizeInBytes ? sizeOrDstBuffer / 2 : sizeOrDstBuffer);\n            if (copyBuffer) {\n                buffer_3.set(new Int16Array(copyBuffer));\n            }\n            return buffer_3;\n        }\n        case Format.U16_R:\n        case Format.U16_RGB:\n        case Format.U16_RGBA_5551:\n        case Format.U16_RGBA_NORM:\n        case Format.U16_RG_NORM:\n        case Format.U16_R_NORM: {\n            var buffer_4 = sizeOrDstBuffer instanceof ArrayBuffer\n                ? new Uint16Array(sizeOrDstBuffer)\n                : new Uint16Array(sizeInBytes ? sizeOrDstBuffer / 2 : sizeOrDstBuffer);\n            if (copyBuffer) {\n                buffer_4.set(new Uint16Array(copyBuffer));\n            }\n            return buffer_4;\n        }\n        case Format.S32_R: {\n            var buffer_5 = sizeOrDstBuffer instanceof ArrayBuffer\n                ? new Int32Array(sizeOrDstBuffer)\n                : new Int32Array(sizeInBytes ? sizeOrDstBuffer / 4 : sizeOrDstBuffer);\n            if (copyBuffer) {\n                buffer_5.set(new Int32Array(copyBuffer));\n            }\n            return buffer_5;\n        }\n        case Format.U32_R:\n        case Format.U32_RG: {\n            var buffer_6 = sizeOrDstBuffer instanceof ArrayBuffer\n                ? new Uint32Array(sizeOrDstBuffer)\n                : new Uint32Array(sizeInBytes ? sizeOrDstBuffer / 4 : sizeOrDstBuffer);\n            if (copyBuffer) {\n                buffer_6.set(new Uint32Array(copyBuffer));\n            }\n            return buffer_6;\n        }\n        case Format.F32_R:\n        case Format.F32_RG:\n        case Format.F32_RGB:\n        case Format.F32_RGBA: {\n            var buffer_7 = sizeOrDstBuffer instanceof ArrayBuffer\n                ? new Float32Array(sizeOrDstBuffer)\n                : new Float32Array(sizeInBytes ? sizeOrDstBuffer / 4 : sizeOrDstBuffer);\n            if (copyBuffer) {\n                buffer_7.set(new Float32Array(copyBuffer));\n            }\n            return buffer_7;\n        }\n    }\n    var buffer = sizeOrDstBuffer instanceof ArrayBuffer\n        ? new Uint8Array(sizeOrDstBuffer)\n        : new Uint8Array(sizeOrDstBuffer);\n    if (copyBuffer) {\n        buffer.set(new Uint8Array(copyBuffer));\n    }\n    return buffer;\n}\n/**\n * Converts a half float to a number\n * @param value half float to convert\n * @returns converted half float\n */\nfunction halfFloat2Number(value) {\n    var s = (value & 0x8000) >> 15;\n    var e = (value & 0x7c00) >> 10;\n    var f = value & 0x03ff;\n    if (e === 0) {\n        return (s ? -1 : 1) * Math.pow(2, -14) * (f / Math.pow(2, 10));\n    }\n    else if (e == 0x1f) {\n        return f ? NaN : (s ? -1 : 1) * Infinity;\n    }\n    return (s ? -1 : 1) * Math.pow(2, e - 15) * (1 + f / Math.pow(2, 10));\n}\nfunction getBlockInformationFromFormat(format) {\n    switch (format) {\n        // 8 bits formats\n        case 'r8unorm':\n        case 'r8snorm':\n        case 'r8uint':\n        case 'r8sint':\n            return { width: 1, height: 1, length: 1 };\n        // 16 bits formats\n        case 'r16uint':\n        case 'r16sint':\n        case 'r16float':\n        case 'rg8unorm':\n        case 'rg8snorm':\n        case 'rg8uint':\n        case 'rg8sint':\n            return { width: 1, height: 1, length: 2 };\n        // 32 bits formats\n        case 'r32uint':\n        case 'r32sint':\n        case 'r32float':\n        case 'rg16uint':\n        case 'rg16sint':\n        case 'rg16float':\n        case 'rgba8unorm':\n        case 'rgba8unorm-srgb':\n        case 'rgba8snorm':\n        case 'rgba8uint':\n        case 'rgba8sint':\n        case 'bgra8unorm':\n        case 'bgra8unorm-srgb':\n        case 'rgb9e5ufloat':\n        case 'rgb10a2unorm':\n        case 'rg11b10ufloat':\n            return { width: 1, height: 1, length: 4 };\n        // 64 bits formats\n        case 'rg32uint':\n        case 'rg32sint':\n        case 'rg32float':\n        case 'rgba16uint':\n        case 'rgba16sint':\n        case 'rgba16float':\n            return { width: 1, height: 1, length: 8 };\n        // 128 bits formats\n        case 'rgba32uint':\n        case 'rgba32sint':\n        case 'rgba32float':\n            return { width: 1, height: 1, length: 16 };\n        // Depth and stencil formats\n        case 'stencil8':\n            throw new Error('No fixed size for Stencil8 format!');\n        case 'depth16unorm':\n            return { width: 1, height: 1, length: 2 };\n        case 'depth24plus':\n            throw new Error('No fixed size for Depth24Plus format!');\n        case 'depth24plus-stencil8':\n            throw new Error('No fixed size for Depth24PlusStencil8 format!');\n        case 'depth32float':\n            return { width: 1, height: 1, length: 4 };\n        // case 'depth24unorm-stencil8':\n        //   return { width: 1, height: 1, length: 4 };\n        case 'depth32float-stencil8':\n            return { width: 1, height: 1, length: 5 };\n        // BC compressed formats usable if \"texture-compression-bc\" is both\n        // supported by the device/user agent and enabled in requestDevice.\n        case 'bc7-rgba-unorm':\n        case 'bc7-rgba-unorm-srgb':\n        case 'bc6h-rgb-ufloat':\n        case 'bc6h-rgb-float':\n        case 'bc2-rgba-unorm':\n        case 'bc2-rgba-unorm-srgb':\n        case 'bc3-rgba-unorm':\n        case 'bc3-rgba-unorm-srgb':\n        case 'bc5-rg-unorm':\n        case 'bc5-rg-snorm':\n            return { width: 4, height: 4, length: 16 };\n        case 'bc4-r-unorm':\n        case 'bc4-r-snorm':\n        case 'bc1-rgba-unorm':\n        case 'bc1-rgba-unorm-srgb':\n            return { width: 4, height: 4, length: 8 };\n        default:\n            return { width: 1, height: 1, length: 4 };\n    }\n}\n\nvar ResourceBase_WebGPU = /** @class */ (function (_super) {\n    __extends(ResourceBase_WebGPU, _super);\n    function ResourceBase_WebGPU(_a) {\n        var id = _a.id, device = _a.device;\n        var _this = _super.call(this) || this;\n        _this.id = id;\n        _this.device = device;\n        return _this;\n    }\n    ResourceBase_WebGPU.prototype.destroy = function () { };\n    return ResourceBase_WebGPU;\n}(EventEmitter));\n\nvar Bindings_WebGPU = /** @class */ (function (_super) {\n    __extends(Bindings_WebGPU, _super);\n    function Bindings_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _b, _c;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Bindings;\n        var pipeline = descriptor.pipeline;\n        assert(!!pipeline);\n        var uniformBufferBindings = descriptor.uniformBufferBindings, storageBufferBindings = descriptor.storageBufferBindings, samplerBindings = descriptor.samplerBindings, storageTextureBindings = descriptor.storageTextureBindings;\n        _this.numUniformBuffers = (uniformBufferBindings === null || uniformBufferBindings === void 0 ? void 0 : uniformBufferBindings.length) || 0;\n        // entries orders: Uniform Sampler StorageBuffer StorageTexture\n        var gpuBindGroupEntries = [[], [], [], []];\n        var numBindings = 0;\n        if (uniformBufferBindings && uniformBufferBindings.length) {\n            for (var i = 0; i < uniformBufferBindings.length; i++) {\n                var _d = descriptor.uniformBufferBindings[i], binding = _d.binding, size = _d.size, offset = _d.offset, buffer = _d.buffer;\n                var gpuBufferBinding = {\n                    buffer: getPlatformBuffer(buffer),\n                    offset: offset !== null && offset !== void 0 ? offset : 0,\n                    size: size,\n                };\n                gpuBindGroupEntries[0].push({\n                    binding: binding !== null && binding !== void 0 ? binding : numBindings++,\n                    resource: gpuBufferBinding,\n                });\n            }\n        }\n        if (samplerBindings && samplerBindings.length) {\n            numBindings = 0;\n            for (var i = 0; i < samplerBindings.length; i++) {\n                var samplerEntry = __assign(__assign({}, samplerBindings[i]), defaultBindingLayoutSamplerDescriptor);\n                var binding = descriptor.samplerBindings[i];\n                var texture = binding.texture !== null\n                    ? binding.texture\n                    : _this.device['getFallbackTexture'](samplerEntry);\n                samplerEntry.dimension = texture.dimension;\n                samplerEntry.formatKind = getFormatSamplerKind(texture.format);\n                var gpuTextureView = texture.gpuTextureView;\n                gpuBindGroupEntries[1].push({\n                    binding: (_b = binding.textureBinding) !== null && _b !== void 0 ? _b : numBindings++,\n                    resource: gpuTextureView,\n                });\n                if (binding.samplerBinding !== -1) {\n                    var sampler = binding.sampler !== null\n                        ? binding.sampler\n                        : _this.device['getFallbackSampler'](samplerEntry);\n                    var gpuSampler = getPlatformSampler(sampler);\n                    gpuBindGroupEntries[1].push({\n                        binding: (_c = binding.samplerBinding) !== null && _c !== void 0 ? _c : numBindings++,\n                        resource: gpuSampler,\n                    });\n                }\n            }\n        }\n        if (storageBufferBindings && storageBufferBindings.length) {\n            numBindings = 0;\n            for (var i = 0; i < storageBufferBindings.length; i++) {\n                var _e = descriptor.storageBufferBindings[i], binding = _e.binding, size = _e.size, offset = _e.offset, buffer = _e.buffer;\n                var gpuBufferBinding = {\n                    buffer: getPlatformBuffer(buffer),\n                    offset: offset !== null && offset !== void 0 ? offset : 0,\n                    size: size,\n                };\n                gpuBindGroupEntries[2].push({\n                    binding: binding !== null && binding !== void 0 ? binding : numBindings++,\n                    resource: gpuBufferBinding,\n                });\n            }\n        }\n        if (storageTextureBindings && storageTextureBindings.length) {\n            numBindings = 0;\n            for (var i = 0; i < storageTextureBindings.length; i++) {\n                var _f = descriptor.storageTextureBindings[i], binding = _f.binding, texture = _f.texture;\n                var gpuTextureView = texture.gpuTextureView;\n                gpuBindGroupEntries[3].push({\n                    binding: binding !== null && binding !== void 0 ? binding : numBindings++,\n                    resource: gpuTextureView,\n                });\n            }\n        }\n        var lastGroupIndex = gpuBindGroupEntries.findLastIndex(function (group) { return !!group.length; });\n        _this.gpuBindGroup = gpuBindGroupEntries.map(function (gpuBindGroupEntries, i) {\n            return (i <= lastGroupIndex &&\n                _this.device.device.createBindGroup({\n                    layout: pipeline.getBindGroupLayout(i),\n                    entries: gpuBindGroupEntries,\n                }));\n        });\n        return _this;\n    }\n    return Bindings_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar Buffer_WebGPU = /** @class */ (function (_super) {\n    __extends(Buffer_WebGPU, _super);\n    function Buffer_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Buffer;\n        var usage = descriptor.usage, viewOrSize = descriptor.viewOrSize;\n        var useMapRead = !!(usage & BufferUsage.MAP_READ);\n        _this.usage = translateBufferUsage(usage);\n        // Buffer usages (BufferUsage::(MapRead|CopyDst|Storage)) is invalid. If a buffer usage contains BufferUsage::MapRead the only other allowed usage is BufferUsage::CopyDst.\n        // @see https://www.w3.org/TR/webgpu/#dom-gpubufferusage-copy_dst\n        if (useMapRead) {\n            _this.usage = BufferUsage.MAP_READ | BufferUsage.COPY_DST;\n        }\n        var mapBuffer = !isNumber(viewOrSize);\n        // this.size = isView(viewOrSize) ? viewOrSize.byteLength : viewOrSize * 4;\n        _this.view = !isNumber(viewOrSize) ? viewOrSize : null;\n        // 4 bytes alignments (because of the upload which requires this)\n        _this.size = isNumber(viewOrSize)\n            ? align(viewOrSize, 4)\n            : align(viewOrSize.byteLength, 4);\n        if (!isNumber(viewOrSize)) {\n            _this.gpuBuffer = _this.device.device.createBuffer({\n                usage: _this.usage,\n                size: _this.size,\n                mappedAtCreation: true,\n            });\n            var ctor = (viewOrSize && viewOrSize.constructor) || Float32Array;\n            // @ts-ignore\n            new ctor(_this.gpuBuffer.getMappedRange()).set(viewOrSize);\n            _this.gpuBuffer.unmap();\n        }\n        else {\n            _this.gpuBuffer = _this.device.device.createBuffer({\n                usage: _this.usage,\n                size: _this.size,\n                mappedAtCreation: useMapRead ? mapBuffer : false,\n            });\n        }\n        return _this;\n    }\n    Buffer_WebGPU.prototype.setSubData = function (dstByteOffset, src, srcByteOffset, byteLength) {\n        if (srcByteOffset === void 0) { srcByteOffset = 0; }\n        if (byteLength === void 0) { byteLength = 0; }\n        var buffer = this.gpuBuffer;\n        byteLength = byteLength || src.byteLength;\n        byteLength = Math.min(byteLength, this.size - dstByteOffset);\n        // After Migration to Canary\n        var chunkStart = src.byteOffset + srcByteOffset;\n        var chunkEnd = chunkStart + byteLength;\n        // 4 bytes alignments for upload\n        var alignedLength = (byteLength + 3) & ~3;\n        if (alignedLength !== byteLength) {\n            var tempView = new Uint8Array(src.buffer.slice(chunkStart, chunkEnd));\n            src = new Uint8Array(alignedLength);\n            src.set(tempView);\n            srcByteOffset = 0;\n            chunkStart = 0;\n            chunkEnd = alignedLength;\n            byteLength = alignedLength;\n        }\n        // Chunk\n        var maxChunk = 1024 * 1024 * 15;\n        var offset = 0;\n        while (chunkEnd - (chunkStart + offset) > maxChunk) {\n            this.device.device.queue.writeBuffer(buffer, dstByteOffset + offset, src.buffer, chunkStart + offset, maxChunk);\n            offset += maxChunk;\n        }\n        this.device.device.queue.writeBuffer(buffer, dstByteOffset + offset, src.buffer, chunkStart + offset, byteLength - offset);\n    };\n    Buffer_WebGPU.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        // @see https://www.w3.org/TR/webgpu/#dom-gpubuffer-destroy\n        this.gpuBuffer.destroy();\n    };\n    return Buffer_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar ComputePass_WebGPU = /** @class */ (function () {\n    function ComputePass_WebGPU() {\n        this.gpuComputePassEncoder = null;\n    }\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpucomputepassencoder-dispatchworkgroups\n     */\n    ComputePass_WebGPU.prototype.dispatchWorkgroups = function (workgroupCountX, workgroupCountY, workgroupCountZ) {\n        this.gpuComputePassEncoder.dispatchWorkgroups(workgroupCountX, workgroupCountY, workgroupCountZ);\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpucomputepassencoder-dispatchworkgroupsindirect\n     */\n    ComputePass_WebGPU.prototype.dispatchWorkgroupsIndirect = function (indirectBuffer, indirectOffset) {\n        this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(indirectBuffer.gpuBuffer, indirectOffset);\n    };\n    ComputePass_WebGPU.prototype.finish = function () {\n        this.gpuComputePassEncoder.end();\n        this.gpuComputePassEncoder = null;\n        this.frameCommandEncoder = null;\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpucommandencoder-begincomputepass\n     */\n    ComputePass_WebGPU.prototype.beginComputePass = function (commandEncoder) {\n        assert(this.gpuComputePassEncoder === null);\n        this.frameCommandEncoder = commandEncoder;\n        this.gpuComputePassEncoder = this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor);\n    };\n    ComputePass_WebGPU.prototype.setPipeline = function (pipeline_) {\n        var pipeline = pipeline_;\n        var gpuComputePipeline = assertExists(pipeline.gpuComputePipeline);\n        this.gpuComputePassEncoder.setPipeline(gpuComputePipeline);\n    };\n    ComputePass_WebGPU.prototype.setBindings = function (bindings_) {\n        var _this = this;\n        var bindings = bindings_;\n        bindings.gpuBindGroup.forEach(function (gpuBindGroup, i) {\n            if (gpuBindGroup) {\n                _this.gpuComputePassEncoder.setBindGroup(i, bindings.gpuBindGroup[i]);\n            }\n        });\n    };\n    ComputePass_WebGPU.prototype.pushDebugGroup = function (name) {\n        this.gpuComputePassEncoder.pushDebugGroup(name);\n    };\n    ComputePass_WebGPU.prototype.popDebugGroup = function () {\n        this.gpuComputePassEncoder.popDebugGroup();\n    };\n    ComputePass_WebGPU.prototype.insertDebugMarker = function (markerLabel) {\n        this.gpuComputePassEncoder.insertDebugMarker(markerLabel);\n    };\n    return ComputePass_WebGPU;\n}());\n\nvar ComputePipeline_WebGPU = /** @class */ (function (_super) {\n    __extends(ComputePipeline_WebGPU, _super);\n    function ComputePipeline_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.ComputePipeline;\n        _this.gpuComputePipeline = null;\n        _this.descriptor = descriptor;\n        var program = descriptor.program;\n        var computeStage = program.computeStage;\n        if (computeStage === null)\n            return _this;\n        var gpuComputePipeline = {\n            layout: 'auto',\n            compute: __assign({}, computeStage),\n        };\n        // @see https://www.w3.org/TR/webgpu/#dom-gpudevice-createrenderpipeline\n        _this.gpuComputePipeline =\n            _this.device.device.createComputePipeline(gpuComputePipeline);\n        if (_this.name !== undefined) {\n            _this.gpuComputePipeline.label = _this.name;\n        }\n        return _this;\n    }\n    ComputePipeline_WebGPU.prototype.getBindGroupLayout = function (index) {\n        return this.gpuComputePipeline.getBindGroupLayout(index);\n    };\n    return ComputePipeline_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar InputLayout_WebGPU = /** @class */ (function (_super) {\n    __extends(InputLayout_WebGPU, _super);\n    function InputLayout_WebGPU(_a) {\n        var e_1, _b, e_2, _c;\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.InputLayout;\n        var buffers = [];\n        try {\n            for (var _d = __values(descriptor.vertexBufferDescriptors), _e = _d.next(); !_e.done; _e = _d.next()) {\n                var vertexBufferDescriptor = _e.value;\n                var arrayStride = vertexBufferDescriptor.arrayStride, stepMode = vertexBufferDescriptor.stepMode, attributes = vertexBufferDescriptor.attributes;\n                buffers.push({\n                    arrayStride: arrayStride,\n                    stepMode: translateVertexStepMode(stepMode),\n                    attributes: [],\n                });\n                try {\n                    for (var attributes_1 = (e_2 = void 0, __values(attributes)), attributes_1_1 = attributes_1.next(); !attributes_1_1.done; attributes_1_1 = attributes_1.next()) {\n                        var attribute = attributes_1_1.value;\n                        // TODO: divisor\n                        var shaderLocation = attribute.shaderLocation, format = attribute.format, offset = attribute.offset;\n                        buffers[buffers.length - 1].attributes.push({\n                            shaderLocation: shaderLocation,\n                            format: translateVertexFormat(format),\n                            offset: offset,\n                        });\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (attributes_1_1 && !attributes_1_1.done && (_c = attributes_1.return)) _c.call(attributes_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_e && !_e.done && (_b = _d.return)) _b.call(_d);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        _this.indexFormat = translateIndexFormat(descriptor.indexBufferFormat);\n        _this.buffers = buffers;\n        return _this;\n    }\n    return InputLayout_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar Program_WebGPU = /** @class */ (function (_super) {\n    __extends(Program_WebGPU, _super);\n    function Program_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Program;\n        _this.vertexStage = null;\n        _this.fragmentStage = null;\n        _this.computeStage = null;\n        _this.descriptor = descriptor;\n        if (descriptor.vertex) {\n            _this.vertexStage = _this.createShaderStage(descriptor.vertex, 'vertex');\n        }\n        if (descriptor.fragment) {\n            _this.fragmentStage = _this.createShaderStage(descriptor.fragment, 'fragment');\n        }\n        if (descriptor.compute) {\n            // Only support WGSL now\n            _this.computeStage = _this.createShaderStage(descriptor.compute, 'compute');\n        }\n        return _this;\n    }\n    // eslint-disable-next-line\n    Program_WebGPU.prototype.setUniformsLegacy = function (uniforms) {\n    };\n    Program_WebGPU.prototype.createShaderStage = function (_a, shaderStage) {\n        var e_1, _b;\n        var glsl = _a.glsl, wgsl = _a.wgsl, entryPoint = _a.entryPoint, postprocess = _a.postprocess;\n        var validationEnabled = false;\n        // Use user-defined WGSL first.\n        var code = wgsl;\n        if (!code) {\n            try {\n                code = this.device['glsl_compile'](glsl, shaderStage, validationEnabled);\n            }\n            catch (e) {\n                console.error(e, glsl);\n                throw new Error('whoops');\n            }\n        }\n        var _loop_1 = function (depthTextureName) {\n            if (!code.includes(depthTextureName))\n                return \"continue\";\n            code = code.replace(\"var T_\".concat(depthTextureName, \": texture_2d<f32>;\"), \"var T_\".concat(depthTextureName, \": texture_depth_2d;\"));\n            code = code.replace(new RegExp(\"textureSample\\\\(T_\".concat(depthTextureName, \"(.*)\\\\);$\"), 'gm'), function (sub, cap) {\n                return \"vec4<f32>(textureSample(T_\".concat(depthTextureName).concat(cap, \"), 0.0, 0.0, 0.0);\");\n            });\n        };\n        try {\n            // Workaround for https://github.com/gfx-rs/naga/issues/1355\n            for (var _c = __values(['u_TextureFramebufferDepth']), _d = _c.next(); !_d.done; _d = _c.next()) {\n                var depthTextureName = _d.value;\n                _loop_1(depthTextureName);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_d && !_d.done && (_b = _c.return)) _b.call(_c);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        if (postprocess) {\n            code = postprocess(code);\n        }\n        // @see https://www.w3.org/TR/webgpu/#dom-gpudevice-createshadermodule\n        var shaderModule = this.device.device.createShaderModule({ code: code });\n        return { module: shaderModule, entryPoint: entryPoint || 'main' };\n    };\n    return Program_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar QueryPool_WebGPU = /** @class */ (function (_super) {\n    __extends(QueryPool_WebGPU, _super);\n    function QueryPool_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.QueryPool;\n        var elemCount = descriptor.elemCount, type = descriptor.type;\n        _this.querySet = _this.device.device.createQuerySet({\n            type: translateQueryPoolType(type),\n            count: elemCount,\n        });\n        _this.resolveBuffer = _this.device.device.createBuffer({\n            size: elemCount * 8,\n            usage: GPUBufferUsage.QUERY_RESOLVE | GPUBufferUsage.COPY_SRC,\n        });\n        _this.cpuBuffer = _this.device.device.createBuffer({\n            size: elemCount * 8,\n            usage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ,\n        });\n        _this.results = null;\n        return _this;\n    }\n    QueryPool_WebGPU.prototype.queryResultOcclusion = function (dstOffs) {\n        if (this.results === null)\n            return null;\n        return this.results[dstOffs] !== BigInt(0);\n    };\n    QueryPool_WebGPU.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.querySet.destroy();\n        this.resolveBuffer.destroy();\n        this.cpuBuffer.destroy();\n    };\n    return QueryPool_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar Readback_WebGPU = /** @class */ (function (_super) {\n    __extends(Readback_WebGPU, _super);\n    function Readback_WebGPU(_a) {\n        var id = _a.id, device = _a.device;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Readback;\n        return _this;\n    }\n    Readback_WebGPU.prototype.readTexture = function (t, x, y, width, height, dst, dstOffset, length) {\n        if (dstOffset === void 0) { dstOffset = 0; }\n        return __awaiter(this, void 0, void 0, function () {\n            var texture, faceIndex, blockInformation, bytesPerRow, bytesPerRowAligned, size, buffer, commandEncoder;\n            return __generator(this, function (_a) {\n                texture = t;\n                faceIndex = 0;\n                blockInformation = getBlockInformationFromFormat(texture.gpuTextureformat);\n                bytesPerRow = Math.ceil(width / blockInformation.width) * blockInformation.length;\n                bytesPerRowAligned = Math.ceil(bytesPerRow / 256) * 256;\n                size = bytesPerRowAligned * height;\n                buffer = this.device.createBuffer({\n                    usage: BufferUsage.STORAGE | BufferUsage.MAP_READ | BufferUsage.COPY_DST,\n                    hint: BufferFrequencyHint.STATIC,\n                    viewOrSize: size,\n                });\n                commandEncoder = this.device.device.createCommandEncoder();\n                // @see https://www.w3.org/TR/webgpu/#dom-gpucommandencoder-copytexturetobuffer\n                commandEncoder.copyTextureToBuffer({\n                    texture: texture.gpuTexture,\n                    mipLevel: 0,\n                    origin: {\n                        x: x,\n                        y: y,\n                        z: Math.max(faceIndex, 0),\n                    },\n                }, {\n                    buffer: buffer.gpuBuffer,\n                    offset: 0,\n                    bytesPerRow: bytesPerRowAligned,\n                }, {\n                    width: width,\n                    height: height,\n                    depthOrArrayLayers: 1,\n                });\n                this.device.device.queue.submit([commandEncoder.finish()]);\n                return [2 /*return*/, this.readBuffer(buffer, 0, dst.byteLength === size ? dst : null, dstOffset, size, texture.format, true, false, bytesPerRow, bytesPerRowAligned, height)];\n            });\n        });\n    };\n    Readback_WebGPU.prototype.readTextureSync = function (t, x, y, width, height, dst, dstOffset, length) {\n        throw new Error('ERROR_MSG_METHOD_NOT_IMPLEMENTED');\n    };\n    Readback_WebGPU.prototype.readBuffer = function (b, srcByteOffset, dstArrayBufferView, dstOffset, _size, type, noDataConversion, destroy, bytesPerRow, bytesPerRowAligned, height) {\n        var _this = this;\n        if (srcByteOffset === void 0) { srcByteOffset = 0; }\n        if (dstArrayBufferView === void 0) { dstArrayBufferView = null; }\n        if (_size === void 0) { _size = 0; }\n        if (type === void 0) { type = Format.U8_RGB; }\n        if (noDataConversion === void 0) { noDataConversion = false; }\n        if (bytesPerRow === void 0) { bytesPerRow = 0; }\n        if (bytesPerRowAligned === void 0) { bytesPerRowAligned = 0; }\n        if (height === void 0) { height = 0; }\n        var buffer = b;\n        var size = _size || buffer.size;\n        var dst = dstArrayBufferView || buffer.view;\n        var floatFormat = \n        // @ts-ignore\n        (dst && dst.constructor && dst.constructor.BYTES_PER_ELEMENT) ||\n            getFormatCompByteSize(type);\n        var gpuReadBuffer = buffer;\n        // can read buffer directly?\n        if (!(buffer.usage & BufferUsage.MAP_READ &&\n            buffer.usage & BufferUsage.COPY_DST)) {\n            var commandEncoder = this.device.device.createCommandEncoder();\n            gpuReadBuffer = this.device.createBuffer({\n                usage: BufferUsage.STORAGE | BufferUsage.MAP_READ | BufferUsage.COPY_DST,\n                hint: BufferFrequencyHint.STATIC,\n                viewOrSize: size,\n            });\n            // Encode commands for copying buffer to buffer.\n            commandEncoder.copyBufferToBuffer(buffer.gpuBuffer /* source buffer */, srcByteOffset /* source offset */, gpuReadBuffer.gpuBuffer /* destination buffer */, 0 /* destination offset */, size /* size */);\n            this.device.device.queue.submit([commandEncoder.finish()]);\n        }\n        return new Promise(function (resolve, reject) {\n            gpuReadBuffer.gpuBuffer\n                .mapAsync(GPUMapMode.READ, srcByteOffset, size)\n                .then(function () {\n                var copyArrayBuffer = gpuReadBuffer.gpuBuffer.getMappedRange(srcByteOffset, size);\n                var data = dst;\n                if (noDataConversion) {\n                    if (data === null) {\n                        data = allocateAndCopyTypedBuffer(type, size, true, copyArrayBuffer);\n                    }\n                    else {\n                        // @ts-ignore\n                        data = allocateAndCopyTypedBuffer(type, data.buffer, undefined, copyArrayBuffer);\n                    }\n                }\n                else {\n                    if (data === null) {\n                        switch (floatFormat) {\n                            case 1: // byte format\n                                data = new Uint8Array(size);\n                                data.set(new Uint8Array(copyArrayBuffer));\n                                break;\n                            case 2: // half float\n                                // TODO WEBGPU use computer shaders (or render pass) to make the conversion?\n                                data = _this.getHalfFloatAsFloatRGBAArrayBuffer(size / 2, copyArrayBuffer);\n                                break;\n                            case 4: // float\n                                data = new Float32Array(size / 4);\n                                data.set(new Float32Array(copyArrayBuffer));\n                                break;\n                        }\n                    }\n                    else {\n                        switch (floatFormat) {\n                            case 1: // byte format\n                                data = new Uint8Array(data.buffer);\n                                data.set(new Uint8Array(copyArrayBuffer));\n                                break;\n                            case 2: // half float\n                                // TODO WEBGPU use computer shaders (or render pass) to make the conversion?\n                                data = _this.getHalfFloatAsFloatRGBAArrayBuffer(size / 2, copyArrayBuffer, dst);\n                                break;\n                            case 4: // float\n                                var ctor = (dst && dst.constructor) || Float32Array;\n                                // @ts-ignore\n                                data = new ctor(data.buffer);\n                                // @ts-ignore\n                                data.set(new ctor(copyArrayBuffer));\n                                break;\n                        }\n                    }\n                }\n                if (bytesPerRow !== bytesPerRowAligned) {\n                    // TODO WEBGPU use computer shaders (or render pass) to build the final buffer data?\n                    if (floatFormat === 1 && !noDataConversion) {\n                        // half float have been converted to float above\n                        bytesPerRow *= 2;\n                        bytesPerRowAligned *= 2;\n                    }\n                    var data2 = new Uint8Array(data.buffer);\n                    var offset = bytesPerRow, offset2 = 0;\n                    for (var y = 1; y < height; ++y) {\n                        offset2 = y * bytesPerRowAligned;\n                        for (var x = 0; x < bytesPerRow; ++x) {\n                            data2[offset++] = data2[offset2++];\n                        }\n                    }\n                    if (floatFormat !== 0 && !noDataConversion) {\n                        data = new Float32Array(data2.buffer, 0, offset / 4);\n                    }\n                    else {\n                        data = new Uint8Array(data2.buffer, 0, offset);\n                    }\n                }\n                gpuReadBuffer.gpuBuffer.unmap();\n                resolve(data);\n            }, function (reason) { return reject(reason); });\n        });\n    };\n    Readback_WebGPU.prototype.getHalfFloatAsFloatRGBAArrayBuffer = function (dataLength, arrayBuffer, destArray) {\n        if (!destArray) {\n            destArray = new Float32Array(dataLength);\n        }\n        var srcData = new Uint16Array(arrayBuffer);\n        while (dataLength--) {\n            destArray[dataLength] = halfFloat2Number(srcData[dataLength]);\n        }\n        return destArray;\n    };\n    return Readback_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar RenderPass_WebGPU = /** @class */ (function () {\n    function RenderPass_WebGPU(device) {\n        this.device = device;\n        this.gpuRenderPassEncoder = null;\n        this.gfxColorAttachment = [];\n        this.gfxColorAttachmentLevel = [];\n        this.gfxColorResolveTo = [];\n        this.gfxColorResolveToLevel = [];\n        this.gfxDepthStencilAttachment = null;\n        this.gfxDepthStencilResolveTo = null;\n        this.gpuColorAttachments = [];\n        this.gpuDepthStencilAttachment = {\n            view: null,\n            depthLoadOp: 'load',\n            depthStoreOp: 'store',\n            stencilLoadOp: 'load',\n            stencilStoreOp: 'store',\n        };\n        this.gpuRenderPassDescriptor = {\n            colorAttachments: this.gpuColorAttachments,\n            depthStencilAttachment: this.gpuDepthStencilAttachment,\n        };\n    }\n    RenderPass_WebGPU.prototype.getEncoder = function () {\n        var _a;\n        return (((_a = this.renderBundle) === null || _a === void 0 ? void 0 : _a['renderBundleEncoder']) || this.gpuRenderPassEncoder);\n    };\n    RenderPass_WebGPU.prototype.getTextureView = function (target, level) {\n        assert(level < target.mipLevelCount);\n        if (target.mipLevelCount === 1)\n            return target.gpuTextureView;\n        else\n            return target.gpuTexture.createView({\n                baseMipLevel: level,\n                mipLevelCount: 1,\n            });\n    };\n    RenderPass_WebGPU.prototype.setRenderPassDescriptor = function (descriptor) {\n        var _a, _b, _c, _d, _e, _f;\n        this.descriptor = descriptor;\n        this.gpuRenderPassDescriptor.colorAttachments = this.gpuColorAttachments;\n        var numColorAttachments = descriptor.colorAttachment.length;\n        this.gfxColorAttachment.length = numColorAttachments;\n        this.gfxColorResolveTo.length = numColorAttachments;\n        for (var i = 0; i < descriptor.colorAttachment.length; i++) {\n            var colorAttachment = descriptor\n                .colorAttachment[i];\n            var colorResolveTo = descriptor\n                .colorResolveTo[i];\n            // Do some dumb juggling...\n            if (colorAttachment === null && colorResolveTo !== null) {\n                colorAttachment = colorResolveTo;\n                colorResolveTo = null;\n            }\n            this.gfxColorAttachment[i] = colorAttachment;\n            this.gfxColorResolveTo[i] = colorResolveTo;\n            this.gfxColorAttachmentLevel[i] =\n                ((_a = descriptor.colorAttachmentLevel) === null || _a === void 0 ? void 0 : _a[i]) || 0;\n            this.gfxColorResolveToLevel[i] = ((_b = descriptor.colorResolveToLevel) === null || _b === void 0 ? void 0 : _b[i]) || 0;\n            if (colorAttachment !== null) {\n                if (this.gpuColorAttachments[i] === undefined) {\n                    this.gpuColorAttachments[i] = {};\n                }\n                var dstAttachment = this.gpuColorAttachments[i];\n                dstAttachment.view = this.getTextureView(colorAttachment, ((_c = this.gfxColorAttachmentLevel) === null || _c === void 0 ? void 0 : _c[i]) || 0);\n                var clearColor = (_e = (_d = descriptor.colorClearColor) === null || _d === void 0 ? void 0 : _d[i]) !== null && _e !== void 0 ? _e : 'load';\n                if (clearColor === 'load') {\n                    dstAttachment.loadOp = 'load';\n                }\n                else {\n                    dstAttachment.loadOp = 'clear';\n                    dstAttachment.clearValue = clearColor;\n                }\n                dstAttachment.storeOp = ((_f = descriptor.colorStore) === null || _f === void 0 ? void 0 : _f[i])\n                    ? 'store'\n                    : 'discard';\n                dstAttachment.resolveTarget = undefined;\n                if (colorResolveTo !== null) {\n                    if (colorAttachment.sampleCount > 1) {\n                        dstAttachment.resolveTarget = this.getTextureView(colorResolveTo, this.gfxColorResolveToLevel[i]);\n                    }\n                    else {\n                        dstAttachment.storeOp = 'store';\n                    }\n                }\n            }\n            else {\n                // https://github.com/gpuweb/gpuweb/issues/1250\n                this.gpuColorAttachments.length = i;\n                this.gfxColorAttachment.length = i;\n                this.gfxColorResolveTo.length = i;\n                break;\n            }\n        }\n        this.gfxDepthStencilAttachment =\n            descriptor.depthStencilAttachment;\n        this.gfxDepthStencilResolveTo =\n            descriptor.depthStencilResolveTo;\n        if (descriptor.depthStencilAttachment) {\n            var dsAttachment = descriptor.depthStencilAttachment;\n            var dstAttachment = this.gpuDepthStencilAttachment;\n            dstAttachment.view = dsAttachment.gpuTextureView;\n            var hasDepth = !!(getFormatFlags(dsAttachment.format) & FormatFlags.Depth);\n            if (hasDepth) {\n                if (descriptor.depthClearValue === 'load') {\n                    dstAttachment.depthLoadOp = 'load';\n                }\n                else {\n                    dstAttachment.depthLoadOp = 'clear';\n                    dstAttachment.depthClearValue = descriptor.depthClearValue;\n                }\n                if (descriptor.depthStencilStore ||\n                    this.gfxDepthStencilResolveTo !== null)\n                    dstAttachment.depthStoreOp = 'store';\n                else\n                    dstAttachment.depthStoreOp = 'discard';\n            }\n            else {\n                dstAttachment.depthLoadOp = undefined;\n                dstAttachment.depthStoreOp = undefined;\n            }\n            var hasStencil = !!(getFormatFlags(dsAttachment.format) & FormatFlags.Stencil);\n            if (hasStencil) {\n                if (descriptor.stencilClearValue === 'load') {\n                    dstAttachment.stencilLoadOp = 'load';\n                }\n                else {\n                    dstAttachment.stencilLoadOp = 'clear';\n                    dstAttachment.stencilClearValue = descriptor.stencilClearValue;\n                }\n                if (descriptor.depthStencilStore ||\n                    this.gfxDepthStencilResolveTo !== null)\n                    dstAttachment.stencilStoreOp = 'store';\n                else\n                    dstAttachment.stencilStoreOp = 'discard';\n            }\n            else {\n                dstAttachment.stencilLoadOp = undefined;\n                dstAttachment.stencilStoreOp = undefined;\n            }\n            this.gpuRenderPassDescriptor.depthStencilAttachment =\n                this.gpuDepthStencilAttachment;\n        }\n        else {\n            this.gpuRenderPassDescriptor.depthStencilAttachment = undefined;\n        }\n        this.gpuRenderPassDescriptor.occlusionQuerySet = !isNil(descriptor.occlusionQueryPool)\n            ? getPlatformQuerySet(descriptor.occlusionQueryPool)\n            : undefined;\n    };\n    RenderPass_WebGPU.prototype.beginRenderPass = function (commandEncoder, renderPassDescriptor) {\n        assert(this.gpuRenderPassEncoder === null);\n        this.setRenderPassDescriptor(renderPassDescriptor);\n        this.frameCommandEncoder = commandEncoder;\n        this.gpuRenderPassEncoder = this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor);\n    };\n    RenderPass_WebGPU.prototype.flipY = function (y, h) {\n        var height = this.device['swapChainHeight'];\n        return height - y - h;\n    };\n    RenderPass_WebGPU.prototype.setViewport = function (x, y, w, h, minDepth, maxDepth) {\n        if (minDepth === void 0) { minDepth = 0; }\n        if (maxDepth === void 0) { maxDepth = 1; }\n        this.gpuRenderPassEncoder.setViewport(x, this.flipY(y, h), w, h, minDepth, maxDepth);\n    };\n    RenderPass_WebGPU.prototype.setScissorRect = function (x, y, w, h) {\n        this.gpuRenderPassEncoder.setScissorRect(x, this.flipY(y, h), w, h);\n    };\n    RenderPass_WebGPU.prototype.setPipeline = function (pipeline_) {\n        var pipeline = pipeline_;\n        var gpuRenderPipeline = assertExists(pipeline.gpuRenderPipeline);\n        this.getEncoder().setPipeline(gpuRenderPipeline);\n    };\n    RenderPass_WebGPU.prototype.setVertexInput = function (inputLayout_, vertexBuffers, indexBuffer) {\n        if (inputLayout_ === null)\n            return;\n        var encoder = this.getEncoder();\n        var inputLayout = inputLayout_;\n        if (indexBuffer !== null)\n            encoder.setIndexBuffer(getPlatformBuffer(indexBuffer.buffer), assertExists(inputLayout.indexFormat), indexBuffer.offset);\n        for (var i = 0; i < vertexBuffers.length; i++) {\n            var b = vertexBuffers[i];\n            if (b === null)\n                continue;\n            encoder.setVertexBuffer(i, getPlatformBuffer(b.buffer), b.offset);\n        }\n    };\n    RenderPass_WebGPU.prototype.setBindings = function (bindings_) {\n        var bindings = bindings_;\n        var encoder = this.getEncoder();\n        bindings.gpuBindGroup.forEach(function (gpuBindGroup, i) {\n            if (gpuBindGroup) {\n                encoder.setBindGroup(i, bindings.gpuBindGroup[i]);\n            }\n        });\n    };\n    RenderPass_WebGPU.prototype.setStencilReference = function (ref) {\n        this.gpuRenderPassEncoder.setStencilReference(ref);\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpurendercommandsmixin-draw\n     */\n    RenderPass_WebGPU.prototype.draw = function (vertexCount, instanceCount, firstVertex, firstInstance) {\n        this.getEncoder().draw(vertexCount, instanceCount, firstVertex, firstInstance);\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpurendercommandsmixin-drawindexed\n     */\n    RenderPass_WebGPU.prototype.drawIndexed = function (indexCount, instanceCount, firstIndex, baseVertex, firstInstance) {\n        this.getEncoder().drawIndexed(indexCount, instanceCount, firstIndex, baseVertex, firstInstance);\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpurendercommandsmixin-drawindirect\n     */\n    RenderPass_WebGPU.prototype.drawIndirect = function (indirectBuffer, indirectOffset) {\n        this.getEncoder().drawIndirect(getPlatformBuffer(indirectBuffer), indirectOffset);\n    };\n    RenderPass_WebGPU.prototype.drawIndexedIndirect = function (indirectBuffer, indirectOffset) {\n        this.getEncoder().drawIndexedIndirect(getPlatformBuffer(indirectBuffer), indirectOffset);\n    };\n    RenderPass_WebGPU.prototype.beginOcclusionQuery = function (queryIndex) {\n        this.gpuRenderPassEncoder.beginOcclusionQuery(queryIndex);\n    };\n    RenderPass_WebGPU.prototype.endOcclusionQuery = function () {\n        this.gpuRenderPassEncoder.endOcclusionQuery();\n    };\n    RenderPass_WebGPU.prototype.pushDebugGroup = function (name) {\n        this.gpuRenderPassEncoder.pushDebugGroup(name);\n    };\n    RenderPass_WebGPU.prototype.popDebugGroup = function () {\n        this.gpuRenderPassEncoder.popDebugGroup();\n    };\n    RenderPass_WebGPU.prototype.insertDebugMarker = function (markerLabel) {\n        this.gpuRenderPassEncoder.insertDebugMarker(markerLabel);\n    };\n    RenderPass_WebGPU.prototype.beginBundle = function (renderBundle) {\n        this.renderBundle = renderBundle;\n    };\n    RenderPass_WebGPU.prototype.endBundle = function () {\n        this.renderBundle.finish();\n    };\n    RenderPass_WebGPU.prototype.executeBundles = function (renderBundles) {\n        this.gpuRenderPassEncoder.executeBundles(renderBundles.map(function (bundle) { return bundle.renderBundle; }));\n    };\n    RenderPass_WebGPU.prototype.finish = function () {\n        var _a;\n        (_a = this.gpuRenderPassEncoder) === null || _a === void 0 ? void 0 : _a.end();\n        this.gpuRenderPassEncoder = null;\n        // Fake a resolve with a copy for non-MSAA.\n        for (var i = 0; i < this.gfxColorAttachment.length; i++) {\n            var colorAttachment = this.gfxColorAttachment[i];\n            var colorResolveTo = this.gfxColorResolveTo[i];\n            if (colorAttachment !== null &&\n                colorResolveTo !== null &&\n                colorAttachment.sampleCount === 1) {\n                this.copyAttachment(colorResolveTo, this.gfxColorAttachmentLevel[i], colorAttachment, this.gfxColorResolveToLevel[i]);\n            }\n        }\n        if (this.gfxDepthStencilAttachment && this.gfxDepthStencilResolveTo) {\n            if (this.gfxDepthStencilAttachment.sampleCount > 1) ;\n            else {\n                this.copyAttachment(this.gfxDepthStencilResolveTo, 0, this.gfxDepthStencilAttachment, 0);\n            }\n        }\n        this.frameCommandEncoder = null;\n    };\n    RenderPass_WebGPU.prototype.copyAttachment = function (dst, dstLevel, src, srcLevel) {\n        assert(src.sampleCount === 1);\n        var srcCopy = {\n            texture: src.gpuTexture,\n            mipLevel: srcLevel,\n        };\n        var dstCopy = {\n            texture: dst.gpuTexture,\n            mipLevel: dstLevel,\n        };\n        assert(src.width >>> srcLevel === dst.width >>> dstLevel);\n        assert(src.height >>> srcLevel === dst.height >>> dstLevel);\n        assert(!!(src.usage & GPUTextureUsage$1.COPY_SRC));\n        assert(!!(dst.usage & GPUTextureUsage$1.COPY_DST));\n        this.frameCommandEncoder.copyTextureToTexture(srcCopy, dstCopy, [\n            dst.width,\n            dst.height,\n            1,\n        ]);\n    };\n    return RenderPass_WebGPU;\n}());\n\nvar RenderPipeline_WebGPU = /** @class */ (function (_super) {\n    __extends(RenderPipeline_WebGPU, _super);\n    function RenderPipeline_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.RenderPipeline;\n        _this.isCreatingAsync = false;\n        _this.gpuRenderPipeline = null;\n        _this.descriptor = descriptor;\n        _this.device['createRenderPipelineInternal'](_this, false);\n        return _this;\n    }\n    RenderPipeline_WebGPU.prototype.getBindGroupLayout = function (index) {\n        return this.gpuRenderPipeline.getBindGroupLayout(index);\n    };\n    return RenderPipeline_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar Sampler_WebGPU = /** @class */ (function (_super) {\n    __extends(Sampler_WebGPU, _super);\n    function Sampler_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor;\n        var _b, _c;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Sampler;\n        var lodMinClamp = descriptor.lodMinClamp;\n        var lodMaxClamp = descriptor.mipmapFilter === MipmapFilterMode.NO_MIP\n            ? descriptor.lodMinClamp\n            : descriptor.lodMaxClamp;\n        var maxAnisotropy = (_b = descriptor.maxAnisotropy) !== null && _b !== void 0 ? _b : 1;\n        if (maxAnisotropy > 1)\n            assert(descriptor.minFilter === FilterMode.BILINEAR &&\n                descriptor.magFilter === FilterMode.BILINEAR &&\n                descriptor.mipmapFilter === MipmapFilterMode.LINEAR);\n        _this.gpuSampler = _this.device.device.createSampler({\n            addressModeU: translateAddressMode(descriptor.addressModeU),\n            addressModeV: translateAddressMode(descriptor.addressModeV),\n            addressModeW: translateAddressMode((_c = descriptor.addressModeW) !== null && _c !== void 0 ? _c : descriptor.addressModeU),\n            lodMinClamp: lodMinClamp,\n            lodMaxClamp: lodMaxClamp,\n            minFilter: translateMinMagFilter(descriptor.minFilter),\n            magFilter: translateMinMagFilter(descriptor.magFilter),\n            mipmapFilter: translateMipFilter(descriptor.mipmapFilter),\n            compare: descriptor.compareFunction !== undefined\n                ? translateCompareFunction(descriptor.compareFunction)\n                : undefined,\n            maxAnisotropy: maxAnisotropy,\n        });\n        return _this;\n    }\n    return Sampler_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar Texture_WebGPU = /** @class */ (function (_super) {\n    __extends(Texture_WebGPU, _super);\n    function Texture_WebGPU(_a) {\n        var id = _a.id, device = _a.device, descriptor = _a.descriptor, skipCreate = _a.skipCreate, sampleCount = _a.sampleCount;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.Texture;\n        _this.flipY = false;\n        var format = descriptor.format, dimension = descriptor.dimension, width = descriptor.width, height = descriptor.height, depthOrArrayLayers = descriptor.depthOrArrayLayers, mipLevelCount = descriptor.mipLevelCount, usage = descriptor.usage, pixelStore = descriptor.pixelStore;\n        _this.flipY = !!(pixelStore === null || pixelStore === void 0 ? void 0 : pixelStore.unpackFlipY);\n        _this.device.createTextureShared({\n            format: format,\n            dimension: dimension !== null && dimension !== void 0 ? dimension : TextureDimension.TEXTURE_2D,\n            width: width,\n            height: height,\n            depthOrArrayLayers: depthOrArrayLayers !== null && depthOrArrayLayers !== void 0 ? depthOrArrayLayers : 1,\n            mipLevelCount: mipLevelCount !== null && mipLevelCount !== void 0 ? mipLevelCount : 1,\n            usage: usage,\n            sampleCount: sampleCount !== null && sampleCount !== void 0 ? sampleCount : 1,\n        }, _this, skipCreate);\n        return _this;\n    }\n    Texture_WebGPU.prototype.textureFromImageBitmapOrCanvas = function (device, sources, depthOrArrayLayers) {\n        var width = sources[0].width;\n        var height = sources[0].height;\n        var textureDescriptor = {\n            // Unlike in WebGL, the size of our texture must be set at texture creation time.\n            // This means we have to wait until the image is loaded to create the texture, since we won't\n            // know the size until then.\n            size: { width: width, height: height, depthOrArrayLayers: depthOrArrayLayers },\n            format: 'rgba8unorm',\n            usage: GPUTextureUsage.TEXTURE_BINDING |\n                GPUTextureUsage.COPY_DST |\n                GPUTextureUsage.RENDER_ATTACHMENT,\n        };\n        var texture = device.createTexture(textureDescriptor);\n        for (var i = 0; i < sources.length; i++) {\n            device.queue.copyExternalImageToTexture({ source: sources[i], flipY: this.flipY }, { texture: texture, origin: [0, 0, i] }, [width, height]);\n        }\n        return [texture, width, height];\n    };\n    Texture_WebGPU.prototype.isImageBitmapOrCanvases = function (datas) {\n        var data = datas[0];\n        return (data instanceof ImageBitmap ||\n            data instanceof HTMLCanvasElement ||\n            data instanceof OffscreenCanvas);\n    };\n    Texture_WebGPU.prototype.isVideo = function (datas) {\n        var data = datas[0];\n        return data instanceof HTMLVideoElement;\n    };\n    /**\n     * @see https://toji.dev/webgpu-best-practices/img-textures\n     */\n    Texture_WebGPU.prototype.setImageData = function (datas, lod) {\n        var _a;\n        var _this = this;\n        var device = this.device.device;\n        var texture;\n        var width;\n        var height;\n        if (this.isImageBitmapOrCanvases(datas)) {\n            _a = __read(this.textureFromImageBitmapOrCanvas(device, datas, this.depthOrArrayLayers), 3), texture = _a[0], width = _a[1], height = _a[2];\n        }\n        else if (this.isVideo(datas)) {\n            // @see https://toji.dev/webgpu-best-practices/img-textures#creating-a-texture-from-an-htmlvideoelement-video-tag\n            texture = device.importExternalTexture({\n                source: datas[0],\n            });\n        }\n        else {\n            var blockInformation = getBlockInformationFromFormat(this.gpuTextureformat);\n            var bytesPerRow_1 = Math.ceil(this.width / blockInformation.width) *\n                blockInformation.length;\n            // TODO: support ArrayBufferView[]\n            datas.forEach(function (data) {\n                device.queue.writeTexture({ texture: _this.gpuTexture }, data, {\n                    bytesPerRow: bytesPerRow_1,\n                }, {\n                    width: _this.width,\n                    height: _this.height,\n                });\n            });\n        }\n        this.width = width;\n        this.height = height;\n        if (texture) {\n            this.gpuTexture = texture;\n        }\n        this.gpuTextureView = this.gpuTexture.createView({\n            dimension: translateTextureViewDimension(this.dimension),\n        });\n    };\n    Texture_WebGPU.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        // @see https://www.w3.org/TR/webgpu/#dom-gputexture-destroy\n        this.gpuTexture.destroy();\n    };\n    return Texture_WebGPU;\n}(ResourceBase_WebGPU));\n\n/**\n * It works by recording the draw calls during one frame and by replaying this recording for all subsequent frames.\n * So, the scene should be mostly static for this mode to work as expected.\n * @see https://doc.babylonjs.com/setup/support/webGPU/webGPUOptimization/webGPUSnapshotRendering\n */\nvar RenderBundle_WebGPU = /** @class */ (function (_super) {\n    __extends(RenderBundle_WebGPU, _super);\n    function RenderBundle_WebGPU(_a) {\n        var id = _a.id, device = _a.device;\n        var _this = _super.call(this, { id: id, device: device }) || this;\n        _this.type = ResourceType.RenderBundle;\n        _this.renderBundleEncoder = _this.device.device.createRenderBundleEncoder({\n            colorFormats: [_this.device['swapChainFormat']],\n        });\n        return _this;\n    }\n    RenderBundle_WebGPU.prototype.finish = function () {\n        this.renderBundle = this.renderBundleEncoder.finish();\n    };\n    return RenderBundle_WebGPU;\n}(ResourceBase_WebGPU));\n\nvar Device_WebGPU = /** @class */ (function () {\n    function Device_WebGPU(adapter, device, canvas, canvasContext, glsl_compile, wGSLComposer) {\n        this.swapChainWidth = 0;\n        this.swapChainHeight = 0;\n        this.swapChainTextureUsage = GPUTextureUsage$1.RENDER_ATTACHMENT | GPUTextureUsage$1.COPY_DST;\n        this._resourceUniqueId = 0;\n        this.renderPassPool = [];\n        this.computePassPool = [];\n        this.frameCommandEncoderPool = [];\n        this.featureTextureCompressionBC = false;\n        // VendorInfo\n        this.platformString = 'WebGPU';\n        this.glslVersion = \"#version 440\";\n        this.explicitBindingLocations = true;\n        this.separateSamplerTextures = true;\n        this.viewportOrigin = ViewportOrigin.UPPER_LEFT;\n        this.clipSpaceNearZ = ClipSpaceNearZ.ZERO;\n        this.supportsSyncPipelineCompilation = false;\n        this.supportMRT = true;\n        this.device = device;\n        this.canvas = canvas;\n        this.canvasContext = canvasContext;\n        this.glsl_compile = glsl_compile;\n        this.WGSLComposer = wGSLComposer;\n        this.fallbackTexture2D = this.createFallbackTexture(TextureDimension.TEXTURE_2D, SamplerFormatKind.Float);\n        this.setResourceName(this.fallbackTexture2D, 'Fallback Texture2D');\n        this.fallbackTexture2DDepth = this.createFallbackTexture(TextureDimension.TEXTURE_2D, SamplerFormatKind.Depth);\n        this.setResourceName(this.fallbackTexture2DDepth, 'Fallback Depth Texture2D');\n        this.fallbackTexture2DArray = this.createFallbackTexture(TextureDimension.TEXTURE_2D_ARRAY, SamplerFormatKind.Float);\n        this.setResourceName(this.fallbackTexture2DArray, 'Fallback Texture2DArray');\n        this.fallbackTexture3D = this.createFallbackTexture(TextureDimension.TEXTURE_3D, SamplerFormatKind.Float);\n        this.setResourceName(this.fallbackTexture3D, 'Fallback Texture3D');\n        this.fallbackTextureCube = this.createFallbackTexture(TextureDimension.TEXTURE_CUBE_MAP, SamplerFormatKind.Float);\n        this.setResourceName(this.fallbackTextureCube, 'Fallback TextureCube');\n        this.fallbackSamplerFiltering = this.createSampler({\n            addressModeU: AddressMode.REPEAT,\n            addressModeV: AddressMode.REPEAT,\n            minFilter: FilterMode.POINT,\n            magFilter: FilterMode.POINT,\n            mipmapFilter: MipmapFilterMode.NEAREST,\n        });\n        this.setResourceName(this.fallbackSamplerFiltering, 'Fallback Sampler Filtering');\n        this.fallbackSamplerComparison = this.createSampler({\n            addressModeU: AddressMode.REPEAT,\n            addressModeV: AddressMode.REPEAT,\n            minFilter: FilterMode.POINT,\n            magFilter: FilterMode.POINT,\n            mipmapFilter: MipmapFilterMode.NEAREST,\n            compareFunction: CompareFunction.ALWAYS,\n        });\n        this.setResourceName(this.fallbackSamplerComparison, 'Fallback Sampler Comparison Filtering');\n        // Firefox doesn't support GPUDevice.features yet...\n        if (this.device.features) {\n            this.featureTextureCompressionBC = this.device.features.has('texture-compression-bc');\n        }\n        this.device.onuncapturederror = function (event) {\n            console.error(event.error);\n        };\n        this.swapChainFormat = navigator.gpu.getPreferredCanvasFormat();\n        // @see https://www.w3.org/TR/webgpu/#canvas-configuration\n        this.canvasContext.configure({\n            device: this.device,\n            format: this.swapChainFormat,\n            usage: this.swapChainTextureUsage,\n            // @see https://www.w3.org/TR/webgpu/#gpucanvasalphamode\n            // alphaMode: 'opaque',\n            alphaMode: 'premultiplied',\n        });\n    }\n    Device_WebGPU.prototype.destroy = function () { };\n    // SwapChain\n    Device_WebGPU.prototype.configureSwapChain = function (width, height) {\n        if (this.swapChainWidth === width && this.swapChainHeight === height)\n            return;\n        this.swapChainWidth = width;\n        this.swapChainHeight = height;\n    };\n    Device_WebGPU.prototype.getOnscreenTexture = function () {\n        // @see https://www.w3.org/TR/webgpu/#dom-gpucanvascontext-getcurrenttexture\n        var gpuTexture = this.canvasContext.getCurrentTexture();\n        var gpuTextureView = gpuTexture.createView();\n        var texture = new Texture_WebGPU({\n            id: 0,\n            device: this,\n            descriptor: {\n                format: Format.U8_RGBA_RT,\n                width: this.swapChainWidth,\n                height: this.swapChainHeight,\n                depthOrArrayLayers: 0,\n                dimension: TextureDimension.TEXTURE_2D,\n                mipLevelCount: 1,\n                usage: this.swapChainTextureUsage,\n            },\n            skipCreate: true,\n        });\n        texture.depthOrArrayLayers = 1;\n        texture.sampleCount = 1;\n        texture.gpuTexture = gpuTexture;\n        texture.gpuTextureView = gpuTextureView;\n        texture.name = 'Onscreen';\n        this.setResourceName(texture, 'Onscreen Texture');\n        return texture;\n    };\n    Device_WebGPU.prototype.getDevice = function () {\n        return this;\n    };\n    Device_WebGPU.prototype.getCanvas = function () {\n        return this.canvas;\n    };\n    Device_WebGPU.prototype.beginFrame = function () {\n        assert(this.frameCommandEncoderPool.length === 0);\n    };\n    Device_WebGPU.prototype.endFrame = function () {\n        assert(this.frameCommandEncoderPool.every(function (frameCommandEncoder) { return frameCommandEncoder !== null; }));\n        this.device.queue.submit(this.frameCommandEncoderPool.map(function (frameCommandEncoder) {\n            return frameCommandEncoder.finish();\n        }));\n        this.frameCommandEncoderPool = [];\n        // for (let i = 0; i < this.queryPoolsSubmitted.length; i++) {\n        //   const queryPool = this.queryPoolsSubmitted[i];\n        //   queryPool.cpuBuffer.mapAsync(GPUMapMode.READ).then(() => {\n        //     queryPool.results = new BigUint64Array(\n        //       queryPool.cpuBuffer.getMappedRange(),\n        //     );\n        //   });\n        // }\n        // this.queryPoolsSubmitted.length = 0;\n    };\n    Device_WebGPU.prototype.getNextUniqueId = function () {\n        return ++this._resourceUniqueId;\n    };\n    Device_WebGPU.prototype.createBuffer = function (descriptor) {\n        return new Buffer_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_WebGPU.prototype.createTexture = function (descriptor) {\n        return new Texture_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    /**\n     * @see https://www.w3.org/TR/webgpu/#dom-gpudevice-createsampler\n     * @see https://www.w3.org/TR/webgpu/#GPUSamplerDescriptor\n     */\n    Device_WebGPU.prototype.createSampler = function (descriptor) {\n        return new Sampler_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_WebGPU.prototype.createRenderTarget = function (descriptor) {\n        var texture = new Texture_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: __assign(__assign({}, descriptor), { dimension: TextureDimension.TEXTURE_2D, mipLevelCount: 1, depthOrArrayLayers: 1, usage: TextureUsage.RENDER_TARGET }),\n            sampleCount: descriptor.sampleCount,\n        });\n        texture.depthOrArrayLayers = 1;\n        // @ts-ignore\n        texture.type = ResourceType.RenderTarget;\n        return texture;\n    };\n    Device_WebGPU.prototype.createRenderTargetFromTexture = function (texture) {\n        var _a = texture, format = _a.format, width = _a.width, height = _a.height, depthOrArrayLayers = _a.depthOrArrayLayers, sampleCount = _a.sampleCount, mipLevelCount = _a.mipLevelCount, gpuTexture = _a.gpuTexture, gpuTextureView = _a.gpuTextureView, usage = _a.usage;\n        assert(!!(usage & GPUTextureUsage$1.RENDER_ATTACHMENT));\n        var attachment = new Texture_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: {\n                format: format,\n                width: width,\n                height: height,\n                depthOrArrayLayers: depthOrArrayLayers,\n                dimension: TextureDimension.TEXTURE_2D,\n                mipLevelCount: mipLevelCount,\n                usage: usage,\n            },\n            skipCreate: true,\n        });\n        attachment.depthOrArrayLayers = depthOrArrayLayers;\n        attachment.sampleCount = sampleCount;\n        attachment.gpuTexture = gpuTexture;\n        attachment.gpuTextureView = gpuTextureView;\n        return attachment;\n    };\n    Device_WebGPU.prototype.createProgram = function (descriptor) {\n        var _a, _b;\n        // preprocess GLSL first\n        if ((_a = descriptor.vertex) === null || _a === void 0 ? void 0 : _a.glsl) {\n            descriptor.vertex.glsl = preprocessShader_GLSL(this.queryVendorInfo(), 'vert', descriptor.vertex.glsl);\n        }\n        if ((_b = descriptor.fragment) === null || _b === void 0 ? void 0 : _b.glsl) {\n            descriptor.fragment.glsl = preprocessShader_GLSL(this.queryVendorInfo(), 'frag', descriptor.fragment.glsl);\n        }\n        return new Program_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_WebGPU.prototype.createProgramSimple = function (descriptor) {\n        return new Program_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_WebGPU.prototype.createTextureShared = function (descriptor, texture, skipCreate) {\n        var size = {\n            width: descriptor.width,\n            height: descriptor.height,\n            depthOrArrayLayers: descriptor.depthOrArrayLayers,\n        };\n        var mipLevelCount = descriptor.mipLevelCount;\n        var format = translateTextureFormat(descriptor.format);\n        var dimension = translateTextureDimension(descriptor.dimension);\n        var usage = translateTextureUsage(descriptor.usage);\n        texture.gpuTextureformat = format;\n        texture.dimension = descriptor.dimension;\n        texture.format = descriptor.format;\n        texture.width = descriptor.width;\n        texture.height = descriptor.height;\n        texture.depthOrArrayLayers = descriptor.depthOrArrayLayers;\n        texture.mipLevelCount = mipLevelCount;\n        texture.usage = usage;\n        texture.sampleCount = descriptor.sampleCount;\n        if (!skipCreate) {\n            var gpuTexture = this.device.createTexture({\n                size: size,\n                mipLevelCount: mipLevelCount,\n                format: format,\n                dimension: dimension,\n                sampleCount: descriptor.sampleCount,\n                usage: usage,\n            });\n            var gpuTextureView = gpuTexture.createView();\n            texture.gpuTexture = gpuTexture;\n            texture.gpuTextureView = gpuTextureView;\n        }\n    };\n    Device_WebGPU.prototype.getFallbackSampler = function (samplerEntry) {\n        var formatKind = samplerEntry.formatKind;\n        if (formatKind === SamplerFormatKind.Depth && samplerEntry.comparison) {\n            return this.fallbackSamplerComparison;\n        }\n        else {\n            return this.fallbackSamplerFiltering;\n        }\n    };\n    Device_WebGPU.prototype.getFallbackTexture = function (samplerEntry) {\n        var dimension = samplerEntry.dimension, formatKind = samplerEntry.formatKind;\n        if (dimension === TextureDimension.TEXTURE_2D)\n            return formatKind === SamplerFormatKind.Depth\n                ? this.fallbackTexture2DDepth\n                : this.fallbackTexture2D;\n        else if (dimension === TextureDimension.TEXTURE_2D_ARRAY)\n            return this.fallbackTexture2DArray;\n        else if (dimension === TextureDimension.TEXTURE_3D)\n            return this.fallbackTexture3D;\n        else if (dimension === TextureDimension.TEXTURE_CUBE_MAP)\n            return this.fallbackTextureCube;\n        else\n            throw new Error('whoops');\n    };\n    Device_WebGPU.prototype.createFallbackTexture = function (dimension, formatKind) {\n        var depthOrArrayLayers = dimension === TextureDimension.TEXTURE_CUBE_MAP ? 6 : 1;\n        var format = formatKind === SamplerFormatKind.Float ? Format.U8_RGBA_NORM : Format.D24;\n        return this.createTexture({\n            dimension: dimension,\n            format: format,\n            usage: TextureUsage.SAMPLED,\n            width: 1,\n            height: 1,\n            depthOrArrayLayers: depthOrArrayLayers,\n            mipLevelCount: 1,\n        });\n    };\n    Device_WebGPU.prototype.createBindings = function (descriptor) {\n        return new Bindings_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_WebGPU.prototype.createInputLayout = function (descriptor) {\n        return new InputLayout_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_WebGPU.prototype.createComputePipeline = function (descriptor) {\n        return new ComputePipeline_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: descriptor,\n        });\n    };\n    Device_WebGPU.prototype.createRenderPipeline = function (descriptor) {\n        return new RenderPipeline_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: __assign({}, descriptor),\n        });\n    };\n    Device_WebGPU.prototype.createQueryPool = function (type, elemCount) {\n        return new QueryPool_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n            descriptor: {\n                type: type,\n                elemCount: elemCount,\n            },\n        });\n    };\n    Device_WebGPU.prototype.createRenderPipelineInternal = function (renderPipeline, async) {\n        // if (this.device.createRenderPipelineAsync === undefined) {\n        //   async = false;\n        // }\n        var _a;\n        // // If we're already in the process of creating a the pipeline async, no need to kick the process off again...\n        // if (async && renderPipeline.isCreatingAsync) {\n        //   return;\n        // }\n        if (renderPipeline.gpuRenderPipeline !== null) {\n            return;\n        }\n        var descriptor = renderPipeline.descriptor;\n        var program = descriptor.program;\n        var vertexStage = program.vertexStage, fragmentStage = program.fragmentStage;\n        if (vertexStage === null || fragmentStage === null)\n            return;\n        var _b = descriptor.megaStateDescriptor || {}, stencilBack = _b.stencilBack, stencilFront = _b.stencilFront, rest = __rest(_b, [\"stencilBack\", \"stencilFront\"]);\n        var copied = copyMegaState(defaultMegaState);\n        descriptor.megaStateDescriptor = __assign(__assign(__assign({}, copied), { stencilBack: __assign(__assign({}, copied.stencilBack), stencilBack), stencilFront: __assign(__assign({}, copied.stencilFront), stencilFront) }), rest);\n        var defaultAttachmentState = descriptor.megaStateDescriptor.attachmentsState[0];\n        descriptor.colorAttachmentFormats.forEach(function (format, i) {\n            if (!descriptor.megaStateDescriptor.attachmentsState[i]) {\n                descriptor.megaStateDescriptor.attachmentsState[i] =\n                    copyAttachmentState(undefined, defaultAttachmentState);\n            }\n        });\n        var primitive = translatePrimitiveState((_a = descriptor.topology) !== null && _a !== void 0 ? _a : PrimitiveTopology.TRIANGLES, descriptor.megaStateDescriptor);\n        var targets = translateTargets(descriptor.colorAttachmentFormats, descriptor.megaStateDescriptor);\n        var depthStencil = translateDepthStencilState(descriptor.depthStencilAttachmentFormat, descriptor.megaStateDescriptor);\n        var buffers = undefined;\n        if (descriptor.inputLayout !== null)\n            buffers = descriptor.inputLayout.buffers;\n        var sampleCount = descriptor.sampleCount;\n        // renderPipeline.isCreatingAsync = true;\n        var gpuRenderPipelineDescriptor = {\n            // layout,\n            layout: 'auto',\n            vertex: __assign(__assign({}, vertexStage), { buffers: buffers }),\n            primitive: primitive,\n            depthStencil: depthStencil,\n            multisample: {\n                count: sampleCount,\n            },\n            fragment: __assign(__assign({}, fragmentStage), { targets: targets }),\n        };\n        // TODO: async creation\n        // @see https://www.w3.org/TR/webgpu/#dom-gpudevice-createrenderpipeline\n        // renderPipeline.gpuRenderPipeline =\n        //   this.device.createRenderPipeline(gpuRenderPipeline);\n        // if (renderPipeline.name !== undefined)\n        //   renderPipeline.gpuRenderPipeline.label = renderPipeline.name;\n        // if (async) {\n        //   const gpuRenderPipeline = await this.device.createRenderPipelineAsync(\n        //     gpuRenderPipelineDescriptor,\n        //   );\n        //   // We might have created a sync pipeline while we were async building; no way to cancel the async\n        //   // pipeline build at this point, so just chuck it out :/\n        //   if (renderPipeline.gpuRenderPipeline === null)\n        //     renderPipeline.gpuRenderPipeline = gpuRenderPipeline;\n        // } else {\n        renderPipeline.gpuRenderPipeline = this.device.createRenderPipeline(gpuRenderPipelineDescriptor);\n        // }\n        // // if (renderPipeline.ResourceName !== undefined)\n        // //     renderPipeline.gpuRenderPipeline.label = renderPipeline.ResourceName;\n        // renderPipeline.isCreatingAsync = false;\n    };\n    Device_WebGPU.prototype.createReadback = function () {\n        return new Readback_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n        });\n    };\n    Device_WebGPU.prototype.createRenderBundle = function () {\n        return new RenderBundle_WebGPU({\n            id: this.getNextUniqueId(),\n            device: this,\n        });\n    };\n    Device_WebGPU.prototype.createRenderPass = function (renderPassDescriptor) {\n        var pass = this.renderPassPool.pop();\n        if (pass === undefined) {\n            pass = new RenderPass_WebGPU(this);\n        }\n        var frameCommandEncoder = this.frameCommandEncoderPool.pop();\n        if (frameCommandEncoder === undefined) {\n            frameCommandEncoder = this.device.createCommandEncoder();\n        }\n        pass.beginRenderPass(frameCommandEncoder, renderPassDescriptor);\n        return pass;\n    };\n    Device_WebGPU.prototype.createComputePass = function () {\n        var pass = this.computePassPool.pop();\n        if (pass === undefined)\n            pass = new ComputePass_WebGPU();\n        var frameCommandEncoder = this.frameCommandEncoderPool.pop();\n        if (frameCommandEncoder === undefined) {\n            frameCommandEncoder = this.device.createCommandEncoder();\n        }\n        pass.beginComputePass(frameCommandEncoder);\n        return pass;\n    };\n    Device_WebGPU.prototype.submitPass = function (_pass) {\n        var pass = _pass;\n        if (pass instanceof RenderPass_WebGPU) {\n            // release encoder\n            this.frameCommandEncoderPool.push(pass.frameCommandEncoder);\n            pass.finish();\n            this.renderPassPool.push(pass);\n            // if (pass.occlusionQueryPool !== null) {\n            //   this.queryPoolsSubmitted.push(pass.occlusionQueryPool);\n            // }\n        }\n        else if (pass instanceof ComputePass_WebGPU) {\n            this.frameCommandEncoderPool.push(pass.frameCommandEncoder);\n            pass.finish();\n            this.computePassPool.push(pass);\n        }\n    };\n    Device_WebGPU.prototype.copySubTexture2D = function (dst_, dstX, dstY, src_, srcX, srcY, depthOrArrayLayers) {\n        var cmd = this.device.createCommandEncoder();\n        var dst = dst_;\n        var src = src_;\n        var srcCopy = {\n            texture: src.gpuTexture,\n            origin: [srcX, srcY, 0],\n            mipLevel: 0,\n            aspect: 'all',\n        };\n        var dstCopy = {\n            texture: dst.gpuTexture,\n            origin: [dstX, dstY, 0],\n            mipLevel: 0,\n            aspect: 'all',\n        };\n        assert(!!(src.usage & GPUTextureUsage$1.COPY_SRC));\n        assert(!!(dst.usage & GPUTextureUsage$1.COPY_DST));\n        cmd.copyTextureToTexture(srcCopy, dstCopy, [\n            src.width,\n            src.height,\n            depthOrArrayLayers || 1,\n        ]);\n        this.device.queue.submit([cmd.finish()]);\n    };\n    Device_WebGPU.prototype.queryLimits = function () {\n        // GPUAdapter.limits\n        // @see https://www.w3.org/TR/webgpu/#gpu-supportedlimits\n        return {\n            uniformBufferMaxPageWordSize: this.device.limits.maxUniformBufferBindingSize >>> 2,\n            uniformBufferWordAlignment: this.device.limits.minUniformBufferOffsetAlignment >>> 2,\n            supportedSampleCounts: [1],\n            occlusionQueriesRecommended: true,\n            computeShadersSupported: true,\n        };\n    };\n    Device_WebGPU.prototype.queryTextureFormatSupported = function (format, width, height) {\n        if (isFormatTextureCompressionBC(format)) {\n            if (!this.featureTextureCompressionBC)\n                return false;\n            var bb = getFormatBlockSize(format);\n            if (width % bb !== 0 || height % bb !== 0)\n                return false;\n            return this.featureTextureCompressionBC;\n        }\n        switch (format) {\n            case Format.U16_RGBA_NORM:\n                return false;\n            case Format.F32_RGBA:\n                return false; // unfilterable\n        }\n        return true;\n    };\n    Device_WebGPU.prototype.queryPlatformAvailable = function () {\n        // TODO: should listen to lost event\n        return true;\n    };\n    Device_WebGPU.prototype.queryVendorInfo = function () {\n        return this;\n    };\n    Device_WebGPU.prototype.queryRenderPass = function (o) {\n        var pass = o;\n        return pass.descriptor;\n    };\n    Device_WebGPU.prototype.queryRenderTarget = function (o) {\n        var attachment = o;\n        return attachment;\n    };\n    Device_WebGPU.prototype.setResourceName = function (o, s) {\n        o.name = s;\n        if (o.type === ResourceType.Buffer) {\n            var r = o;\n            r.gpuBuffer.label = s;\n        }\n        else if (o.type === ResourceType.Texture) {\n            var r = o;\n            r.gpuTexture.label = s;\n            r.gpuTextureView.label = s;\n        }\n        else if (o.type === ResourceType.RenderTarget) {\n            var r = o;\n            r.gpuTexture.label = s;\n            r.gpuTextureView.label = s;\n        }\n        else if (o.type === ResourceType.Sampler) {\n            var r = o;\n            r.gpuSampler.label = s;\n        }\n        else if (o.type === ResourceType.RenderPipeline) {\n            var r = o;\n            if (r.gpuRenderPipeline !== null)\n                r.gpuRenderPipeline.label = s;\n        }\n    };\n    Device_WebGPU.prototype.setResourceLeakCheck = function (o, v) { };\n    Device_WebGPU.prototype.checkForLeaks = function () { };\n    Device_WebGPU.prototype.programPatched = function (o) { };\n    Device_WebGPU.prototype.pipelineQueryReady = function (o) {\n        var renderPipeline = o;\n        return renderPipeline.gpuRenderPipeline !== null;\n    };\n    Device_WebGPU.prototype.pipelineForceReady = function (o) {\n        var renderPipeline = o;\n        this.createRenderPipelineInternal(renderPipeline, false);\n    };\n    return Device_WebGPU;\n}());\n\nvar WebGPUDeviceContribution = /** @class */ (function () {\n    function WebGPUDeviceContribution(pluginOptions) {\n        this.pluginOptions = pluginOptions;\n    }\n    WebGPUDeviceContribution.prototype.createSwapChain = function ($canvas) {\n        return __awaiter(this, void 0, void 0, function () {\n            var adapter, xrCompatible, e_1, optionalFeatures, requiredFeatures, device, onContextLost_1, context;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // eslint-disable-next-line\n                        if (globalThis.navigator.gpu === undefined)\n                            return [2 /*return*/, null];\n                        adapter = null;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        xrCompatible = this.pluginOptions.xrCompatible;\n                        return [4 /*yield*/, globalThis.navigator.gpu.requestAdapter({\n                                xrCompatible: xrCompatible,\n                            })];\n                    case 2:\n                        // eslint-disable-next-line\n                        adapter = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        e_1 = _a.sent();\n                        console.log(e_1);\n                        return [3 /*break*/, 4];\n                    case 4:\n                        if (adapter === null)\n                            return [2 /*return*/, null];\n                        optionalFeatures = [\n                            // 'depth24unorm-stencil8',\n                            'depth32float-stencil8',\n                            'texture-compression-bc',\n                            'float32-filterable',\n                        ];\n                        requiredFeatures = optionalFeatures.filter(function (feature) {\n                            return adapter.features.has(feature);\n                        });\n                        return [4 /*yield*/, adapter.requestDevice({ requiredFeatures: requiredFeatures })];\n                    case 5:\n                        device = _a.sent();\n                        if (device) {\n                            onContextLost_1 = this.pluginOptions.onContextLost;\n                            device.lost.then(function () {\n                                if (onContextLost_1) {\n                                    onContextLost_1();\n                                }\n                            });\n                        }\n                        if (device === null)\n                            return [2 /*return*/, null];\n                        context = $canvas.getContext('webgpu');\n                        if (!context)\n                            return [2 /*return*/, null];\n                        _a.label = 6;\n                    case 6:\n                        _a.trys.push([6, 8, , 9]);\n                        return [4 /*yield*/, __wbg_init(this.pluginOptions.shaderCompilerPath)];\n                    case 7:\n                        _a.sent();\n                        return [3 /*break*/, 9];\n                    case 8:\n                        _a.sent();\n                        return [3 /*break*/, 9];\n                    case 9: return [2 /*return*/, new Device_WebGPU(adapter, device, $canvas, context, glsl_compile, WGSLComposer && new WGSLComposer())];\n                }\n            });\n        });\n    };\n    return WebGPUDeviceContribution;\n}());\n\nexport { AddressMode, BlendFactor, BlendMode, BufferFrequencyHint, BufferUsage, ChannelWriteMask, ClipSpaceNearZ, CompareFunction, CullMode, FilterMode, Format, FormatCompFlags, FormatFlags, FormatTypeFlags, FrontFace, GL, IsDepthReversed, MipmapFilterMode, OpaqueBlack, OpaqueWhite, PrimitiveTopology, QueryPoolType, ResourceType, SamplerFormatKind, StencilOp, TextureDimension, TextureEvent, TextureUsage, TransparentBlack, TransparentWhite, UNIFORM_SETTERS, VertexStepMode, ViewportOrigin, WebGLDeviceContribution, WebGPUDeviceContribution, align, alignNonPowerOfTwo, arrayCopy, arrayEqual, assert, assertExists, bindingsDescriptorCopy, bindingsDescriptorEquals, bisectRight, bufferBindingCopy, colorCopy, colorEqual, colorNewCopy, colorNewFromRGBA, compareDepthValues, copyAttachmentState, copyAttachmentStateFromSimple, copyMegaState, copyStencilFaceState, defaultBindingLayoutSamplerDescriptor, defaultMegaState, fallbackUndefined, fillArray, fullscreenMegaState, getAttributeLocations, getDefines, getFormatByteSize, getFormatCompByteSize, getFormatCompFlags, getFormatCompFlagsComponentCount, getFormatComponentCount, getFormatFlags, getFormatSamplerKind, getFormatTypeFlags, getFormatTypeFlagsByteSize, getUniformSetter, getUniforms, inputLayoutBufferDescriptorCopy, inputLayoutBufferDescriptorEquals, inputLayoutDescriptorCopy, inputLayoutDescriptorEquals, isPowerOfTwo, isTypedArray, leftPad, makeFormat, makeMegaState, makeTextureDescriptor2D, nArray, nullify, parseUniformName, prependLineNo, preprocessProgram_GLSL, preprocessShader_GLSL, range, renderPipelineDescriptorCopy, renderPipelineDescriptorEquals, reverseDepthForClearValue, reverseDepthForCompareFunction, reverseDepthForDepthOffset, reverseDepthForOrthographicProjectionMatrix, reverseDepthForPerspectiveProjectionMatrix, samplerBindingCopy, samplerDescriptorEquals, setAttachmentStateSimple, setBitFlagEnabled, setFormatComponentCount, setFormatFlags, setMegaStateFlags, spliceBisectRight, stencilFaceStateEquals, textureBindingCopy, vertexAttributeDescriptorCopy, vertexAttributeDescriptorEquals };\n//# sourceMappingURL=index.js.map\n","'use strict';\n\nmodule.exports = earcut;\nmodule.exports.default = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 1 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim);\n            triangles.push(ear.i / dim);\n            triangles.push(next.i / dim);\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var p = ear.next.next;\n\n    while (p !== ear.prev) {\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // triangle bbox; min & max are calculated like this for speed\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(minTX, minTY, minX, minY, invSize),\n        maxZ = zOrder(maxTX, maxTY, minX, minY, invSize);\n\n    var p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim);\n            triangles.push(p.i / dim);\n            triangles.push(b.i / dim);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize);\n                earcutLinked(c, triangles, dim, minX, minY, invSize);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        outerNode = eliminateHole(queue[i], outerNode);\n        outerNode = filterPoints(outerNode, outerNode.next);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    var bridge = findHoleBridge(hole, outerNode);\n    if (!bridge) {\n        return outerNode;\n    }\n\n    var bridgeReverse = splitPolygon(bridge, hole);\n\n    // filter collinear points around the cuts\n    var filteredBridge = filterPoints(bridge, bridge.next);\n    filterPoints(bridgeReverse, bridgeReverse.next);\n\n    // Check if input node was removed by the filtering\n    return outerNode === bridge ? filteredBridge : outerNode;\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                if (x === hx) {\n                    if (hy === p.y) return p;\n                    if (hy === p.next.y) return p.next;\n                }\n                m = p.x < p.next.x ? p : p.next;\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    if (hx === qx) return m; // hole touches outer segment; pick leftmost endpoint\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    var p = start;\n    do {\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = 32767 * (x - minX) * invSize;\n    y = 32767 * (y - minY) * invSize;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // dones't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    var o1 = sign(area(p1, q1, p2));\n    var o2 = sign(area(p1, q1, q2));\n    var o3 = sign(area(p2, q2, p1));\n    var o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertex index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertex nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = null;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n","import { __spreadArray, __read } from 'tslib';\nimport { isNumberEqual } from '@antv/util';\nimport { vec2 } from 'gl-matrix';\n\nfunction distance(x1, y1, x2, y2) {\n    var dx = x1 - x2;\n    var dy = y1 - y2;\n    return Math.sqrt(dx * dx + dy * dy);\n}\nfunction getBBoxByArray(xArr, yArr) {\n    var minX = Math.min.apply(Math, __spreadArray([], __read(xArr), false));\n    var minY = Math.min.apply(Math, __spreadArray([], __read(yArr), false));\n    var maxX = Math.max.apply(Math, __spreadArray([], __read(xArr), false));\n    var maxY = Math.max.apply(Math, __spreadArray([], __read(yArr), false));\n    return {\n        x: minX,\n        y: minY,\n        width: maxX - minX,\n        height: maxY - minY,\n    };\n}\nfunction piMod(angle) {\n    return (angle + Math.PI * 2) % (Math.PI * 2);\n}\n\nfunction copysign(v1, v2) {\n    var absv = Math.abs(v1);\n    return v2 > 0 ? absv : absv * -1;\n}\nfunction nearestPoint$4(x, y, rx, ry, x0, y0) {\n    var a = rx;\n    var b = ry;\n    // 假如椭圆半径为0则返回圆心\n    if (a === 0 || b === 0) {\n        return {\n            x: x,\n            y: y,\n        };\n    }\n    // 转换成 0， 0 为中心的椭圆计算\n    var relativeX = x0 - x;\n    var relativeY = y0 - y;\n    var px = Math.abs(relativeX);\n    var py = Math.abs(relativeY);\n    var squareA = a * a;\n    var squareB = b * b;\n    // const angle0 = Math.atan2(relativeY, relativeX);\n    var t = Math.PI / 4;\n    var nearestX = 0; // 椭圆上的任一点\n    var nearestY = 0;\n    // 迭代 4 次\n    for (var i = 0; i < 4; i++) {\n        nearestX = a * Math.cos(t);\n        nearestY = b * Math.sin(t);\n        var ex = ((squareA - squareB) * Math.pow(Math.cos(t), 3)) / a;\n        var ey = ((squareB - squareA) * Math.pow(Math.sin(t), 3)) / b;\n        var rx1 = nearestX - ex;\n        var ry1 = nearestY - ey;\n        var qx = px - ex;\n        var qy = py - ey;\n        var r = Math.hypot(ry1, rx1);\n        var q = Math.hypot(qy, qx);\n        var delta_c = r * Math.asin((rx1 * qy - ry1 * qx) / (r * q));\n        var delta_t = delta_c /\n            Math.sqrt(squareA + squareB - nearestX * nearestX - nearestY * nearestY);\n        t += delta_t;\n        t = Math.min(Math.PI / 2, Math.max(0, t));\n    }\n    return {\n        x: x + copysign(nearestX, relativeX),\n        y: y + copysign(nearestY, relativeY),\n    };\n}\n\n// 偏导数 x\nfunction derivativeXAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle) {\n    return (-1 * rx * Math.cos(xRotation) * Math.sin(angle) -\n        ry * Math.sin(xRotation) * Math.cos(angle));\n}\n// 偏导数 y\nfunction derivativeYAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle) {\n    return (-1 * rx * Math.sin(xRotation) * Math.sin(angle) +\n        ry * Math.cos(xRotation) * Math.cos(angle));\n}\n// x 的极值\nfunction xExtrema(rx, ry, xRotation) {\n    return Math.atan((-ry / rx) * Math.tan(xRotation));\n}\n// y 的极值\nfunction yExtrema(rx, ry, xRotation) {\n    return Math.atan(ry / (rx * Math.tan(xRotation)));\n}\n// 根据角度求 x 坐标\nfunction xAt(cx, cy, rx, ry, xRotation, angle) {\n    return (rx * Math.cos(xRotation) * Math.cos(angle) -\n        ry * Math.sin(xRotation) * Math.sin(angle) +\n        cx);\n}\n// 根据角度求 y 坐标\nfunction yAt(cx, cy, rx, ry, xRotation, angle) {\n    return (rx * Math.sin(xRotation) * Math.cos(angle) +\n        ry * Math.cos(xRotation) * Math.sin(angle) +\n        cy);\n}\n// 获取点在椭圆上的角度\nfunction getAngle(rx, ry, x0, y0) {\n    var angle = Math.atan2(y0 * rx, x0 * ry);\n    // 转换到 0 - 2PI 内\n    return (angle + Math.PI * 2) % (Math.PI * 2);\n}\n// 根据角度获取，x,y\nfunction getPoint(rx, ry, angle) {\n    return {\n        x: rx * Math.cos(angle),\n        y: ry * Math.sin(angle),\n    };\n}\n// 旋转\nfunction rotate(x, y, angle) {\n    var cos = Math.cos(angle);\n    var sin = Math.sin(angle);\n    return [x * cos - y * sin, x * sin + y * cos];\n}\nfunction box$5(cx, cy, rx, ry, xRotation, startAngle, endAngle) {\n    var xDim = xExtrema(rx, ry, xRotation);\n    var minX = Infinity;\n    var maxX = -Infinity;\n    var xs = [startAngle, endAngle];\n    for (var i = -Math.PI * 2; i <= Math.PI * 2; i += Math.PI) {\n        var xAngle = xDim + i;\n        if (startAngle < endAngle) {\n            if (startAngle < xAngle && xAngle < endAngle) {\n                xs.push(xAngle);\n            }\n        }\n        else {\n            if (endAngle < xAngle && xAngle < startAngle) {\n                xs.push(xAngle);\n            }\n        }\n    }\n    for (var i = 0; i < xs.length; i++) {\n        var x = xAt(cx, cy, rx, ry, xRotation, xs[i]);\n        if (x < minX) {\n            minX = x;\n        }\n        if (x > maxX) {\n            maxX = x;\n        }\n    }\n    var yDim = yExtrema(rx, ry, xRotation);\n    var minY = Infinity;\n    var maxY = -Infinity;\n    var ys = [startAngle, endAngle];\n    for (var i = -Math.PI * 2; i <= Math.PI * 2; i += Math.PI) {\n        var yAngle = yDim + i;\n        if (startAngle < endAngle) {\n            if (startAngle < yAngle && yAngle < endAngle) {\n                ys.push(yAngle);\n            }\n        }\n        else {\n            if (endAngle < yAngle && yAngle < startAngle) {\n                ys.push(yAngle);\n            }\n        }\n    }\n    for (var i = 0; i < ys.length; i++) {\n        var y = yAt(cx, cy, rx, ry, xRotation, ys[i]);\n        if (y < minY) {\n            minY = y;\n        }\n        if (y > maxY) {\n            maxY = y;\n        }\n    }\n    return {\n        x: minX,\n        y: minY,\n        width: maxX - minX,\n        height: maxY - minY,\n    };\n}\nfunction nearestPoint$3(cx, cy, rx, ry, xRotation, startAngle, endAngle, x0, y0) {\n    // 将最近距离问题转换成到椭圆中心 0,0 没有旋转的椭圆问题\n    var relativeVector = rotate(x0 - cx, y0 - cy, -xRotation);\n    var _a = __read(relativeVector, 2), x1 = _a[0], y1 = _a[1];\n    // 计算点到椭圆的最近的点\n    var relativePoint = nearestPoint$4(0, 0, rx, ry, x1, y1);\n    // 获取点在椭圆上的角度\n    var angle = getAngle(rx, ry, relativePoint.x, relativePoint.y);\n    // 点没有在圆弧上\n    if (angle < startAngle) {\n        // 小于起始圆弧\n        relativePoint = getPoint(rx, ry, startAngle);\n    }\n    else if (angle > endAngle) {\n        // 大于结束圆弧\n        relativePoint = getPoint(rx, ry, endAngle);\n    }\n    // 旋转到 xRotation 的角度\n    var vector = rotate(relativePoint.x, relativePoint.y, xRotation);\n    return {\n        x: vector[0] + cx,\n        y: vector[1] + cy,\n    };\n}\nfunction tangentAngle$4(cx, cy, rx, ry, xRotation, startAngle, endAngle, t) {\n    var angle = (endAngle - startAngle) * t + startAngle;\n    var dx = derivativeXAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle);\n    var dy = derivativeYAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle);\n    return piMod(Math.atan2(dy, dx));\n}\n\nvar EPSILON = 0.0001;\n/**\n * 使用牛顿切割法求最近的点\n * @param {number[]} xArr      点的 x 数组\n * @param {number[]} yArr      点的 y 数组\n * @param {number}   x         指定的点 x\n * @param {number}   y         指定的点 y\n * @param {Function} tCallback 差值函数\n */\nfunction nearestPoint$2(xArr, yArr, x, y, tCallback, length) {\n    var t = -1;\n    var d = Infinity;\n    var v0 = [x, y];\n    var segNum = 20;\n    if (length && length > 200) {\n        segNum = length / 10;\n    }\n    var increaseRate = 1 / segNum;\n    var interval = increaseRate / 10;\n    for (var i = 0; i <= segNum; i++) {\n        var _t = i * increaseRate;\n        var v1 = [\n            tCallback.apply(void 0, __spreadArray([], __read(xArr.concat([_t])), false)),\n            tCallback.apply(void 0, __spreadArray([], __read(yArr.concat([_t])), false)),\n        ];\n        var d1 = distance(v0[0], v0[1], v1[0], v1[1]);\n        if (d1 < d) {\n            t = _t;\n            d = d1;\n        }\n    }\n    // 提前终止\n    if (t === 0) {\n        return {\n            x: xArr[0],\n            y: yArr[0],\n        };\n    }\n    if (t === 1) {\n        var count = xArr.length;\n        return {\n            x: xArr[count - 1],\n            y: yArr[count - 1],\n        };\n    }\n    d = Infinity;\n    for (var i = 0; i < 32; i++) {\n        if (interval < EPSILON) {\n            break;\n        }\n        var prev = t - interval;\n        var next = t + interval;\n        var v1 = [\n            tCallback.apply(void 0, __spreadArray([], __read(xArr.concat([prev])), false)),\n            tCallback.apply(void 0, __spreadArray([], __read(yArr.concat([prev])), false)),\n        ];\n        var d1 = distance(v0[0], v0[1], v1[0], v1[1]);\n        if (prev >= 0 && d1 < d) {\n            t = prev;\n            d = d1;\n        }\n        else {\n            var v2 = [\n                tCallback.apply(void 0, __spreadArray([], __read(xArr.concat([next])), false)),\n                tCallback.apply(void 0, __spreadArray([], __read(yArr.concat([next])), false)),\n            ];\n            var d2 = distance(v0[0], v0[1], v2[0], v2[1]);\n            if (next <= 1 && d2 < d) {\n                t = next;\n                d = d2;\n            }\n            else {\n                interval *= 0.5;\n            }\n        }\n    }\n    return {\n        x: tCallback.apply(void 0, __spreadArray([], __read(xArr.concat([t])), false)),\n        y: tCallback.apply(void 0, __spreadArray([], __read(yArr.concat([t])), false)),\n    };\n}\n// 近似求解 https://community.khronos.org/t/3d-cubic-bezier-segment-length/62363/2\nfunction snapLength(xArr, yArr) {\n    var totalLength = 0;\n    var count = xArr.length;\n    for (var i = 0; i < count; i++) {\n        var x = xArr[i];\n        var y = yArr[i];\n        var nextX = xArr[(i + 1) % count];\n        var nextY = yArr[(i + 1) % count];\n        totalLength += distance(x, y, nextX, nextY);\n    }\n    return totalLength / 2;\n}\n\nfunction box$4(x1, y1, x2, y2) {\n    return getBBoxByArray([x1, x2], [y1, y2]);\n}\nfunction length$4(x1, y1, x2, y2) {\n    return distance(x1, y1, x2, y2);\n}\nfunction pointAt$3(x1, y1, x2, y2, t) {\n    return {\n        x: (1 - t) * x1 + t * x2,\n        y: (1 - t) * y1 + t * y2,\n    };\n}\nfunction pointDistance$4(x1, y1, x2, y2, x, y) {\n    // 投影距离 x1, y1 的向量，假设 p, p1, p2 三个点，投影点为 a\n    // p1a = p1p.p1p2/|p1p2| * (p1p 的单位向量)\n    var cross = (x2 - x1) * (x - x1) + (y2 - y1) * (y - y1);\n    if (cross < 0) {\n        return distance(x1, y1, x, y);\n    }\n    var lengthSquare = (x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1);\n    if (cross > lengthSquare) {\n        return distance(x2, y2, x, y);\n    }\n    return pointToLine(x1, y1, x2, y2, x, y);\n}\nfunction pointToLine(x1, y1, x2, y2, x, y) {\n    var d = [x2 - x1, y2 - y1];\n    // 如果端点相等，则判定点到点的距离\n    if (vec2.exactEquals(d, [0, 0])) {\n        return Math.sqrt((x - x1) * (x - x1) + (y - y1) * (y - y1));\n    }\n    var u = [-d[1], d[0]];\n    vec2.normalize(u, u);\n    var a = [x - x1, y - y1];\n    return Math.abs(vec2.dot(a, u));\n}\nfunction tangentAngle$3(x1, y1, x2, y2) {\n    return Math.atan2(y2 - y1, x2 - x1);\n}\n\nfunction cubicAt(p0, p1, p2, p3, t) {\n    var onet = 1 - t; // t * t * t 的性能大概是 Math.pow(t, 3) 的三倍\n    return (onet * onet * onet * p0 +\n        3 * p1 * t * onet * onet +\n        3 * p2 * t * t * onet +\n        p3 * t * t * t);\n}\nfunction derivativeAt(p0, p1, p2, p3, t) {\n    var onet = 1 - t;\n    return (3 * (onet * onet * (p1 - p0) + 2 * onet * t * (p2 - p1) + t * t * (p3 - p2)));\n}\nfunction extrema$1(p0, p1, p2, p3) {\n    var a = -3 * p0 + 9 * p1 - 9 * p2 + 3 * p3;\n    var b = 6 * p0 - 12 * p1 + 6 * p2;\n    var c = 3 * p1 - 3 * p0;\n    var extremas = [];\n    var t1;\n    var t2;\n    var discSqrt;\n    if (isNumberEqual(a, 0)) {\n        if (!isNumberEqual(b, 0)) {\n            t1 = -c / b;\n            if (t1 >= 0 && t1 <= 1) {\n                extremas.push(t1);\n            }\n        }\n    }\n    else {\n        var disc = b * b - 4 * a * c;\n        if (isNumberEqual(disc, 0)) {\n            extremas.push(-b / (2 * a));\n        }\n        else if (disc > 0) {\n            discSqrt = Math.sqrt(disc);\n            t1 = (-b + discSqrt) / (2 * a);\n            t2 = (-b - discSqrt) / (2 * a);\n            if (t1 >= 0 && t1 <= 1) {\n                extremas.push(t1);\n            }\n            if (t2 >= 0 && t2 <= 1) {\n                extremas.push(t2);\n            }\n        }\n    }\n    return extremas;\n}\n// 分割贝塞尔曲线\nfunction divideCubic(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n    // 划分点\n    var xt = cubicAt(x1, x2, x3, x4, t);\n    var yt = cubicAt(y1, y2, y3, y4, t);\n    // 计算两点之间的差值点\n    var c1 = pointAt$3(x1, y1, x2, y2, t);\n    var c2 = pointAt$3(x2, y2, x3, y3, t);\n    var c3 = pointAt$3(x3, y3, x4, y4, t);\n    var c12 = pointAt$3(c1.x, c1.y, c2.x, c2.y, t);\n    var c23 = pointAt$3(c2.x, c2.y, c3.x, c3.y, t);\n    return [\n        [x1, y1, c1.x, c1.y, c12.x, c12.y, xt, yt],\n        [xt, yt, c23.x, c23.y, c3.x, c3.y, x4, y4],\n    ];\n}\n// 使用迭代法取贝塞尔曲线的长度，二阶和三阶分开写，更清晰和便于调试\nfunction cubicLength(x1, y1, x2, y2, x3, y3, x4, y4, iterationCount) {\n    if (iterationCount === 0) {\n        return snapLength([x1, x2, x3, x4], [y1, y2, y3, y4]);\n    }\n    var cubics = divideCubic(x1, y1, x2, y2, x3, y3, x4, y4, 0.5);\n    var left = __spreadArray(__spreadArray([], __read(cubics[0]), false), [iterationCount - 1], false);\n    var right = __spreadArray(__spreadArray([], __read(cubics[1]), false), [iterationCount - 1], false);\n    return cubicLength.apply(void 0, __spreadArray([], __read(left), false)) + cubicLength.apply(void 0, __spreadArray([], __read(right), false));\n}\nfunction box$3(x1, y1, x2, y2, x3, y3, x4, y4) {\n    var xArr = [x1, x4];\n    var yArr = [y1, y4];\n    var xExtrema = extrema$1(x1, x2, x3, x4);\n    var yExtrema = extrema$1(y1, y2, y3, y4);\n    for (var i = 0; i < xExtrema.length; i++) {\n        xArr.push(cubicAt(x1, x2, x3, x4, xExtrema[i]));\n    }\n    for (var i = 0; i < yExtrema.length; i++) {\n        yArr.push(cubicAt(y1, y2, y3, y4, yExtrema[i]));\n    }\n    return getBBoxByArray(xArr, yArr);\n}\nfunction length$3(x1, y1, x2, y2, x3, y3, x4, y4) {\n    // 迭代三次，划分成 8 段求长度\n    return cubicLength(x1, y1, x2, y2, x3, y3, x4, y4, 3);\n}\nfunction nearestPoint$1(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length) {\n    return nearestPoint$2([x1, x2, x3, x4], [y1, y2, y3, y4], x0, y0, cubicAt, length);\n}\nfunction pointDistance$3(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length) {\n    var point = nearestPoint$1(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length);\n    return distance(point.x, point.y, x0, y0);\n}\nfunction pointAt$2(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n    return {\n        x: cubicAt(x1, x2, x3, x4, t),\n        y: cubicAt(y1, y2, y3, y4, t),\n    };\n}\nfunction tangentAngle$2(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n    var dx = derivativeAt(x1, x2, x3, x4, t);\n    var dy = derivativeAt(y1, y2, y3, y4, t);\n    return piMod(Math.atan2(dy, dx));\n}\n\nfunction analyzePoints(points) {\n    // 计算每段的长度和总的长度\n    var totalLength = 0;\n    var segments = [];\n    for (var i = 0; i < points.length - 1; i++) {\n        var from = points[i];\n        var to = points[i + 1];\n        var length_1 = distance(from[0], from[1], to[0], to[1]);\n        var seg = {\n            from: from,\n            to: to,\n            length: length_1,\n        };\n        segments.push(seg);\n        totalLength += length_1;\n    }\n    return { segments: segments, totalLength: totalLength };\n}\nfunction lengthOfSegment(points) {\n    if (points.length < 2) {\n        return 0;\n    }\n    var totalLength = 0;\n    for (var i = 0; i < points.length - 1; i++) {\n        var from = points[i];\n        var to = points[i + 1];\n        totalLength += distance(from[0], from[1], to[0], to[1]);\n    }\n    return totalLength;\n}\n/**\n * 按照比例在数据片段中获取点\n * @param {array} points 点的集合\n * @param {number} t 百分比 0-1\n * @return {object} 点的坐标\n */\nfunction pointAtSegments(points, t) {\n    // 边界判断\n    if (t > 1 || t < 0 || points.length < 2) {\n        return null;\n    }\n    var _a = analyzePoints(points), segments = _a.segments, totalLength = _a.totalLength;\n    // 多个点有可能重合\n    if (totalLength === 0) {\n        return {\n            x: points[0][0],\n            y: points[0][1],\n        };\n    }\n    // 计算比例\n    var startRatio = 0;\n    var point = null;\n    for (var i = 0; i < segments.length; i++) {\n        var seg = segments[i];\n        var from = seg.from, to = seg.to;\n        var currentRatio = seg.length / totalLength;\n        if (t >= startRatio && t <= startRatio + currentRatio) {\n            var localRatio = (t - startRatio) / currentRatio;\n            point = pointAt$3(from[0], from[1], to[0], to[1], localRatio);\n            break;\n        }\n        startRatio += currentRatio;\n    }\n    return point;\n}\n/**\n * 按照比例在数据片段中获取切线的角度\n * @param {array} points 点的集合\n * @param {number} t 百分比 0-1\n */\nfunction angleAtSegments(points, t) {\n    // 边界判断\n    if (t > 1 || t < 0 || points.length < 2) {\n        return 0;\n    }\n    var _a = analyzePoints(points), segments = _a.segments, totalLength = _a.totalLength;\n    // 计算比例\n    var startRatio = 0;\n    var angle = 0;\n    for (var i = 0; i < segments.length; i++) {\n        var seg = segments[i];\n        var from = seg.from, to = seg.to;\n        var currentRatio = seg.length / totalLength;\n        if (t >= startRatio && t <= startRatio + currentRatio) {\n            angle = Math.atan2(to[1] - from[1], to[0] - from[0]);\n            break;\n        }\n        startRatio += currentRatio;\n    }\n    return angle;\n}\nfunction distanceAtSegment(points, x, y) {\n    var minDistance = Infinity;\n    for (var i = 0; i < points.length - 1; i++) {\n        var point = points[i];\n        var nextPoint = points[i + 1];\n        var distance_1 = pointDistance$4(point[0], point[1], nextPoint[0], nextPoint[1], x, y);\n        if (distance_1 < minDistance) {\n            minDistance = distance_1;\n        }\n    }\n    return minDistance;\n}\n\nfunction box$2(points) {\n    var xArr = [];\n    var yArr = [];\n    for (var i = 0; i < points.length; i++) {\n        var point = points[i];\n        xArr.push(point[0]);\n        yArr.push(point[1]);\n    }\n    return getBBoxByArray(xArr, yArr);\n}\nfunction length$2(points) {\n    return lengthOfSegment(points);\n}\nfunction pointAt$1(points, t) {\n    return pointAtSegments(points, t);\n}\nfunction pointDistance$2(points, x, y) {\n    return distanceAtSegment(points, x, y);\n}\nfunction tangentAngle$1(points, t) {\n    return angleAtSegments(points, t);\n}\n\nfunction getAllPoints(points) {\n    var tmp = points.slice(0);\n    if (points.length) {\n        tmp.push(points[0]);\n    }\n    return tmp;\n}\nfunction box$1(points) {\n    return box$2(points);\n}\nfunction length$1(points) {\n    return lengthOfSegment(getAllPoints(points));\n}\nfunction pointAt(points, t) {\n    return pointAtSegments(getAllPoints(points), t);\n}\nfunction pointDistance$1(points, x, y) {\n    return distanceAtSegment(getAllPoints(points), x, y);\n}\nfunction tangentAngle(points, t) {\n    return angleAtSegments(getAllPoints(points), t);\n}\n\n// 差值公式\nfunction quadraticAt(p0, p1, p2, t) {\n    var onet = 1 - t;\n    return onet * onet * p0 + 2 * t * onet * p1 + t * t * p2;\n}\n// 求极值\nfunction extrema(p0, p1, p2) {\n    var a = p0 + p2 - 2 * p1;\n    if (isNumberEqual(a, 0)) {\n        return [0.5];\n    }\n    var rst = (p0 - p1) / a;\n    if (rst <= 1 && rst >= 0) {\n        return [rst];\n    }\n    return [];\n}\n// 分割贝塞尔曲线\nfunction divideQuadratic(x1, y1, x2, y2, x3, y3, t) {\n    // 划分点\n    var xt = quadraticAt(x1, x2, x3, t);\n    var yt = quadraticAt(y1, y2, y3, t);\n    // 分割的第一条曲线的控制点\n    var controlPoint1 = pointAt$3(x1, y1, x2, y2, t);\n    // 分割的第二条曲线的控制点\n    var controlPoint2 = pointAt$3(x2, y2, x3, y3, t);\n    return [\n        [x1, y1, controlPoint1.x, controlPoint1.y, xt, yt],\n        [xt, yt, controlPoint2.x, controlPoint2.y, x3, y3],\n    ];\n}\n// 使用迭代法取贝塞尔曲线的长度\nfunction quadraticLength(x1, y1, x2, y2, x3, y3, iterationCount) {\n    if (iterationCount === 0) {\n        return ((distance(x1, y1, x2, y2) +\n            distance(x2, y2, x3, y3) +\n            distance(x1, y1, x3, y3)) /\n            2);\n    }\n    var quadratics = divideQuadratic(x1, y1, x2, y2, x3, y3, 0.5);\n    var left = quadratics[0];\n    var right = quadratics[1];\n    left.push(iterationCount - 1);\n    right.push(iterationCount - 1);\n    return quadraticLength.apply(void 0, __spreadArray([], __read(left), false)) + quadraticLength.apply(void 0, __spreadArray([], __read(right), false));\n}\nfunction box(x1, y1, x2, y2, x3, y3) {\n    var xExtrema = extrema(x1, x2, x3)[0];\n    var yExtrema = extrema(y1, y2, y3)[0];\n    // 控制点不加入 box 的计算\n    var xArr = [x1, x3];\n    var yArr = [y1, y3];\n    if (xExtrema !== undefined) {\n        xArr.push(quadraticAt(x1, x2, x3, xExtrema));\n    }\n    if (yExtrema !== undefined) {\n        yArr.push(quadraticAt(y1, y2, y3, yExtrema));\n    }\n    return getBBoxByArray(xArr, yArr);\n}\nfunction length(x1, y1, x2, y2, x3, y3) {\n    return quadraticLength(x1, y1, x2, y2, x3, y3, 3);\n}\nfunction nearestPoint(x1, y1, x2, y2, x3, y3, x0, y0) {\n    return nearestPoint$2([x1, x2, x3], [y1, y2, y3], x0, y0, quadraticAt);\n}\nfunction pointDistance(x1, y1, x2, y2, x3, y3, x0, y0) {\n    var point = nearestPoint(x1, y1, x2, y2, x3, y3, x0, y0);\n    return distance(point.x, point.y, x0, y0);\n}\n\nexport { box$5 as arcBox, nearestPoint$3 as arcNearestPoint, tangentAngle$4 as arcTangentAngle, box$3 as cubicBox, length$3 as cubicLength, nearestPoint$1 as cubicNearestPoint, pointAt$2 as cubicPointAt, pointDistance$3 as cubicPointDistance, tangentAngle$2 as cubicTangentAngle, distance, box$4 as lineBox, length$4 as lineLength, pointAt$3 as linePointAt, pointDistance$4 as linePointDistance, pointToLine as linePointToLine, tangentAngle$3 as lineTangentAngle, box$1 as polygonBox, length$1 as polygonLength, pointAt as polygonPointAt, pointDistance$1 as polygonPointDistance, tangentAngle as polygonTangentAngle, box$2 as polylineBox, length$2 as polylineLength, pointAt$1 as polylinePointAt, pointDistance$2 as polylinePointDistance, tangentAngle$1 as polylineTangentAngle, box as quadBox, length as quadLength, nearestPoint as quadNearestPoint, pointDistance as quadPointDistance };\n//# sourceMappingURL=index.esm.js.map\n","import { __extends, __rest, __assign, __read, __values, __generator, __spreadArray, __awaiter } from 'tslib';\nimport { Shape, DisplayObject, AABB, CanvasEvent, ElementEvent, parseColor, Rectangle, isCSSRGB, isPattern, isDisplayObject, parsePath, convertToPath, isBrowser, parsedTransformToMat4, parseTransform, AbstractRendererPlugin } from '@antv/g-lite';\nimport { isNil, clamp, isNumber, arcToCubic, isString } from '@antv/util';\nimport { nullify, assert, alignNonPowerOfTwo, assertExists, BufferUsage, BufferFrequencyHint, bindingsDescriptorCopy, renderPipelineDescriptorCopy, inputLayoutDescriptorCopy, preprocessProgram_GLSL, bindingsDescriptorEquals, renderPipelineDescriptorEquals, inputLayoutDescriptorEquals, samplerDescriptorEquals, TextureDimension, TextureUsage, fillArray, ClipSpaceNearZ, setMegaStateFlags, setBitFlagEnabled, nArray, copyMegaState, defaultMegaState, PrimitiveTopology, spliceBisectRight, colorNewFromRGBA, OpaqueBlack, OpaqueWhite, Format, fullscreenMegaState, VertexStepMode, TransparentWhite, setAttachmentStateSimple, TransparentBlack, BlendMode, BlendFactor, getUniforms, TextureEvent, CompareFunction, StencilOp, AddressMode, FilterMode, MipmapFilterMode, ChannelWriteMask, makeTextureDescriptor2D, CullMode } from '@antv/g-device-api';\nimport { mat4, vec3 } from 'gl-matrix';\nimport EventEmitter from 'eventemitter3';\nimport earcut from 'earcut';\nimport { quadLength, cubicLength } from '@antv/g-math';\n\nvar Renderable3D = /** @class */ (function () {\n    function Renderable3D() {\n        this.drawcalls = [];\n    }\n    Renderable3D.tag = 'c-renderable-3d';\n    return Renderable3D;\n}());\n\nvar LightPool = /** @class */ (function () {\n    function LightPool() {\n        /**\n         * lights\n         */\n        this.lights = [];\n    }\n    LightPool.prototype.addLight = function (light) {\n        this.lights.push(light);\n        this.sortLights();\n    };\n    LightPool.prototype.removeLight = function (light) {\n        var i = this.lights.indexOf(light);\n        this.lights.splice(i, 1);\n        this.sortLights();\n    };\n    LightPool.prototype.addFog = function (fog) {\n        this.fog = fog;\n    };\n    LightPool.prototype.removeFog = function (fog) {\n        this.fog = null;\n    };\n    LightPool.prototype.getFog = function () {\n        return this.fog;\n    };\n    LightPool.prototype.getAllLights = function () {\n        return this.lights;\n    };\n    /**\n     * USE_LIGHT\n     * NUM_AMBIENT_LIGHTS\n     * NUM_DIR_LIGHTS\n     */\n    LightPool.prototype.getDefines = function () {\n        var defines = {\n            USE_LIGHT: !!this.lights.length,\n        };\n        this.lights.forEach(function (light) {\n            if (!defines[light.define]) {\n                defines[light.define] = 0;\n            }\n            defines[light.define]++;\n        });\n        return defines;\n    };\n    LightPool.prototype.sortLights = function () {\n        this.lights.sort(function (a, b) { return a.order - b.order; });\n    };\n    return LightPool;\n}());\n\nvar Mesh = /** @class */ (function (_super) {\n    __extends(Mesh, _super);\n    function Mesh(_a) {\n        var _this = this;\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        _this = _super.call(this, __assign({ type: Shape.MESH, style: __assign({ x: '', y: '', z: '', lineWidth: 0 }, style) }, rest)) || this;\n        _this.cullable.enable = false;\n        _this.style.geometry.meshes.push(_this);\n        _this.style.material.meshes.push(_this);\n        return _this;\n    }\n    // getVertexBufferData(bufferIndex: number) {\n    //   return this.style.geometry.vertexBuffers[bufferIndex];\n    // }\n    // setVertexBufferData(descriptor: {\n    //   bufferIndex: number;\n    //   byteOffset: number;\n    //   data: ArrayBufferView;\n    // }) {}\n    Mesh.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        // detach from geometry\n        var meshes = this.style.geometry.meshes;\n        var index = meshes.indexOf(this);\n        meshes.splice(index, 1);\n        // detach from material\n        meshes = this.style.material.meshes;\n        index = meshes.indexOf(this);\n        meshes.splice(index, 1);\n    };\n    return Mesh;\n}(DisplayObject));\n\nvar MeshUpdater = /** @class */ (function () {\n    function MeshUpdater() {\n    }\n    MeshUpdater.prototype.update = function (parsedStyle) {\n        var _a = parsedStyle.x, x = _a === void 0 ? 0 : _a, _b = parsedStyle.y, y = _b === void 0 ? 0 : _b, _c = parsedStyle.z, z = _c === void 0 ? 0 : _c, geometry = parsedStyle.geometry;\n        var aabb = geometry.computeBoundingBox();\n        return {\n            cx: x,\n            cy: y,\n            cz: z,\n            hwidth: aabb.halfExtents[0],\n            hheight: aabb.halfExtents[1],\n            hdepth: aabb.halfExtents[2],\n        };\n    };\n    return MeshUpdater;\n}());\n\nvar PickingIdGenerator = /** @class */ (function () {\n    function PickingIdGenerator() {\n        this.counter = 0;\n        this.id2DisplayObjectMap = {};\n    }\n    PickingIdGenerator.prototype.getId = function (displayObject) {\n        var id = this.counter++;\n        this.id2DisplayObjectMap[id] = displayObject;\n        return id;\n    };\n    PickingIdGenerator.prototype.getById = function (id) {\n        return this.id2DisplayObjectMap[id];\n    };\n    PickingIdGenerator.prototype.deleteById = function (id) {\n        delete this.id2DisplayObjectMap[id];\n    };\n    PickingIdGenerator.prototype.reset = function () {\n        this.counter = 0;\n        this.id2DisplayObjectMap = {};\n    };\n    PickingIdGenerator.prototype.decodePickingColor = function (color) {\n        var _a = __read(color, 3), i1 = _a[0], i2 = _a[1], i3 = _a[2];\n        var index = i1 + i2 * 256 + i3 * 65536 - 1;\n        return index;\n    };\n    PickingIdGenerator.prototype.encodePickingColor = function (featureIdx) {\n        return [\n            (featureIdx + 1) & 255,\n            ((featureIdx + 1) >> 8) & 255,\n            (((featureIdx + 1) >> 8) >> 8) & 255,\n        ];\n    };\n    return PickingIdGenerator;\n}());\n\nvar DeviceProgram = /** @class */ (function () {\n    function DeviceProgram() {\n        this.name = '(unnamed)';\n        // Compiled program.\n        this.preprocessedVert = '';\n        this.preprocessedFrag = '';\n        // Inputs.\n        this.both = '';\n        this.vert = '';\n        this.frag = '';\n        this.defines = {};\n    }\n    DeviceProgram.prototype.definesChanged = function () {\n        this.preprocessedVert = '';\n        this.preprocessedFrag = '';\n    };\n    DeviceProgram.prototype.setDefineString = function (name, v) {\n        if (v !== null) {\n            if (this.defines[name] === v)\n                return false;\n            this.defines[name] = v;\n        }\n        else {\n            if (isNil(this.defines[name]))\n                return false;\n            delete this.defines[name];\n        }\n        this.definesChanged();\n        return true;\n    };\n    DeviceProgram.prototype.setDefineBool = function (name, v) {\n        return this.setDefineString(name, v ? '1' : null);\n    };\n    DeviceProgram.prototype.getDefineString = function (name) {\n        return nullify(this.defines[name]);\n    };\n    DeviceProgram.prototype.getDefineBool = function (name) {\n        var str = this.getDefineString(name);\n        if (str !== null)\n            assert(str === '1');\n        return str !== null;\n    };\n    return DeviceProgram;\n}());\n\n// This is a very basic linear allocator. We allocate offsets in-order.\nvar DynamicUniformBuffer = /** @class */ (function () {\n    function DynamicUniformBuffer(device) {\n        /**\n         * Word count, 4 bytes per word\n         */\n        this.currentBufferWordSize = -1;\n        this.currentWordOffset = 0;\n        this.buffer = null;\n        this.shadowBufferF32 = null;\n        this.shadowBufferU8 = null;\n        this.device = device;\n        var limits = device.queryLimits();\n        this.uniformBufferWordAlignment = limits.uniformBufferWordAlignment;\n        this.uniformBufferMaxPageWordSize = limits.uniformBufferMaxPageWordSize;\n    }\n    DynamicUniformBuffer.prototype.isSupportedUBO = function () {\n        // UBO not supported in WebGL1\n        return this.device.queryVendorInfo().platformString !== 'WebGL1';\n    };\n    DynamicUniformBuffer.prototype.findPageIndex = function (wordOffset) {\n        return (wordOffset / this.uniformBufferMaxPageWordSize) | 0;\n    };\n    DynamicUniformBuffer.prototype.allocateChunk = function (wordCount) {\n        wordCount = alignNonPowerOfTwo(wordCount, this.uniformBufferWordAlignment);\n        assert(wordCount < this.uniformBufferMaxPageWordSize);\n        var wordOffset = this.currentWordOffset;\n        // If we straddle the page, then put it at the start of the next one.\n        if (this.findPageIndex(wordOffset) !==\n            this.findPageIndex(wordOffset + wordCount - 1))\n            wordOffset = alignNonPowerOfTwo(wordOffset, this.uniformBufferMaxPageWordSize);\n        this.currentWordOffset = wordOffset + wordCount;\n        this.ensureShadowBuffer(wordOffset, wordCount);\n        return wordOffset;\n    };\n    DynamicUniformBuffer.prototype.ensureShadowBuffer = function (wordOffset, wordCount) {\n        if (this.shadowBufferU8 === null || this.shadowBufferF32 === null) {\n            var newWordCount = alignNonPowerOfTwo(this.currentWordOffset, this.uniformBufferMaxPageWordSize);\n            this.shadowBufferU8 = new Uint8Array(newWordCount * 4);\n            this.shadowBufferF32 = new Float32Array(this.shadowBufferU8.buffer);\n        }\n        else if (wordOffset + wordCount >= this.shadowBufferF32.length) {\n            assert(wordOffset < this.currentWordOffset &&\n                wordOffset + wordCount <= this.currentWordOffset);\n            // Grow logarithmically, aligned to page size.\n            var newWordCount = alignNonPowerOfTwo(Math.max(this.currentWordOffset, this.shadowBufferF32.length * 2), this.uniformBufferMaxPageWordSize);\n            var newBuffer = new Uint8Array(newWordCount * 4);\n            newBuffer.set(this.shadowBufferU8, 0);\n            this.shadowBufferU8 = newBuffer;\n            this.shadowBufferF32 = new Float32Array(this.shadowBufferU8.buffer);\n            if (!(this.currentWordOffset <= newWordCount))\n                throw new Error(\"Assert fail: this.currentWordOffset [\".concat(this.currentWordOffset, \"] <= newWordCount [\").concat(newWordCount, \"]\"));\n        }\n    };\n    /**\n     * Return the CPU data buffer used internally. Fill this in to submit data to the CPU. Write to\n     * it with the offset that was returned from {@see allocateChunk}.\n     */\n    DynamicUniformBuffer.prototype.mapBufferF32 = function () {\n        return assertExists(this.shadowBufferF32);\n    };\n    DynamicUniformBuffer.prototype.prepareToRender = function () {\n        if (this.shadowBufferF32 === null) {\n            return;\n        }\n        var shadowBufferF32 = assertExists(this.shadowBufferF32);\n        if (shadowBufferF32.length !== this.currentBufferWordSize) {\n            this.currentBufferWordSize = shadowBufferF32.length;\n            if (this.buffer !== null) {\n                this.buffer.destroy();\n            }\n            this.buffer = this.device.createBuffer({\n                // in bytes length\n                viewOrSize: this.currentBufferWordSize * 4,\n                usage: BufferUsage.UNIFORM,\n                hint: BufferFrequencyHint.DYNAMIC,\n            });\n        }\n        var wordCount = alignNonPowerOfTwo(this.currentWordOffset, this.uniformBufferMaxPageWordSize);\n        if (!(wordCount <= this.currentBufferWordSize))\n            throw new Error(\"Assert fail: wordCount [\".concat(wordCount, \"] (\").concat(this.currentWordOffset, \" aligned \").concat(this.uniformBufferMaxPageWordSize, \") <= this.currentBufferWordSize [\").concat(this.currentBufferWordSize, \"]\"));\n        if (this.isSupportedUBO()) {\n            var buffer = assertExists(this.buffer);\n            buffer.setSubData(0, this.shadowBufferU8, 0, wordCount * 4);\n        }\n        // Reset the offset for next frame.\n        this.currentWordOffset = 0;\n    };\n    DynamicUniformBuffer.prototype.destroy = function () {\n        if (this.buffer !== null)\n            this.buffer.destroy();\n        this.shadowBufferF32 = null;\n        this.shadowBufferU8 = null;\n    };\n    return DynamicUniformBuffer;\n}());\n\n// Jenkins One-at-a-Time hash from http://www.burtleburtle.net/bob/hash/doobs.html\nfunction hashCodeNumberUpdate(hash, v) {\n    hash += v;\n    hash += hash << 10;\n    hash += hash >>> 6;\n    return hash >>> 0;\n}\nfunction hashCodeNumberFinish(hash) {\n    hash += hash << 3;\n    hash ^= hash >>> 11;\n    hash += hash << 15;\n    return hash >>> 0;\n}\n// Pass this as a hash function to use a one-bucket HashMap (equivalent to linear search in an array),\n// which can be efficient for small numbers of items.\nfunction nullHashFunc(k) {\n    return 0;\n}\nvar HashBucket = /** @class */ (function () {\n    function HashBucket() {\n        this.keys = [];\n        this.values = [];\n    }\n    return HashBucket;\n}());\nvar HashMap = /** @class */ (function () {\n    function HashMap(keyEqualFunc, keyHashFunc) {\n        this.keyEqualFunc = keyEqualFunc;\n        this.keyHashFunc = keyHashFunc;\n        this.buckets = new Map();\n    }\n    HashMap.prototype.findBucketIndex = function (bucket, k) {\n        for (var i = 0; i < bucket.keys.length; i++)\n            if (this.keyEqualFunc(k, bucket.keys[i]))\n                return i;\n        return -1;\n    };\n    HashMap.prototype.findBucket = function (k) {\n        var bw = this.keyHashFunc(k);\n        return this.buckets.get(bw);\n    };\n    HashMap.prototype.get = function (k) {\n        var bucket = this.findBucket(k);\n        if (bucket === undefined)\n            return null;\n        var bi = this.findBucketIndex(bucket, k);\n        if (bi < 0)\n            return null;\n        return bucket.values[bi];\n    };\n    HashMap.prototype.add = function (k, v) {\n        var bw = this.keyHashFunc(k);\n        if (this.buckets.get(bw) === undefined)\n            this.buckets.set(bw, new HashBucket());\n        var bucket = this.buckets.get(bw);\n        bucket.keys.push(k);\n        bucket.values.push(v);\n    };\n    HashMap.prototype.delete = function (k) {\n        var bucket = this.findBucket(k);\n        if (bucket === undefined)\n            return;\n        var bi = this.findBucketIndex(bucket, k);\n        if (bi === -1)\n            return;\n        bucket.keys.splice(bi, 1);\n        bucket.values.splice(bi, 1);\n    };\n    HashMap.prototype.clear = function () {\n        this.buckets.clear();\n    };\n    HashMap.prototype.size = function () {\n        var e_1, _a;\n        var acc = 0;\n        try {\n            for (var _b = __values(this.buckets.values()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var bucket = _c.value;\n                acc += bucket.values.length;\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        return acc;\n    };\n    HashMap.prototype.values = function () {\n        var _a, _b, bucket, j, e_2_1;\n        var e_2, _c;\n        return __generator(this, function (_d) {\n            switch (_d.label) {\n                case 0:\n                    _d.trys.push([0, 7, 8, 9]);\n                    _a = __values(this.buckets.values()), _b = _a.next();\n                    _d.label = 1;\n                case 1:\n                    if (!!_b.done) return [3 /*break*/, 6];\n                    bucket = _b.value;\n                    j = bucket.values.length - 1;\n                    _d.label = 2;\n                case 2:\n                    if (!(j >= 0)) return [3 /*break*/, 5];\n                    return [4 /*yield*/, bucket.values[j]];\n                case 3:\n                    _d.sent();\n                    _d.label = 4;\n                case 4:\n                    j--;\n                    return [3 /*break*/, 2];\n                case 5:\n                    _b = _a.next();\n                    return [3 /*break*/, 1];\n                case 6: return [3 /*break*/, 9];\n                case 7:\n                    e_2_1 = _d.sent();\n                    e_2 = { error: e_2_1 };\n                    return [3 /*break*/, 9];\n                case 8:\n                    try {\n                        if (_b && !_b.done && (_c = _a.return)) _c.call(_a);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                    return [7 /*endfinally*/];\n                case 9: return [2 /*return*/];\n            }\n        });\n    };\n    return HashMap;\n}());\n\nfunction preprocessProgramObj_GLSL(device, obj) {\n    var defines = obj.defines !== undefined ? obj.defines : null;\n    var vert = obj.both !== undefined ? obj.both + obj.vert : obj.vert;\n    var frag = obj.both !== undefined ? obj.both + obj.frag : obj.frag;\n    return preprocessProgram_GLSL(device.queryVendorInfo(), vert, frag, defines);\n}\nfunction programDescriptorSimpleEquals(a, b) {\n    assert(a.preprocessedVert !== '' && b.preprocessedVert !== '');\n    assert(a.preprocessedFrag !== '' && b.preprocessedFrag !== '');\n    return (a.preprocessedVert === b.preprocessedVert &&\n        a.preprocessedFrag === b.preprocessedFrag);\n}\nfunction programDescriptorSimpleCopy(a) {\n    var preprocessedVert = a.preprocessedVert;\n    var preprocessedFrag = a.preprocessedFrag;\n    var vert = a.vert;\n    var frag = a.frag;\n    return { preprocessedVert: preprocessedVert, preprocessedFrag: preprocessedFrag, vert: vert, frag: frag };\n}\nfunction blendStateHash(hash, a) {\n    hash = hashCodeNumberUpdate(hash, a.blendMode);\n    hash = hashCodeNumberUpdate(hash, a.blendSrcFactor);\n    hash = hashCodeNumberUpdate(hash, a.blendDstFactor);\n    return hash;\n}\nfunction attachmentStateHash(hash, a) {\n    hash = blendStateHash(hash, a.rgbBlendState);\n    hash = blendStateHash(hash, a.alphaBlendState);\n    hash = hashCodeNumberUpdate(hash, a.channelWriteMask);\n    return hash;\n}\nfunction colorHash(hash, a) {\n    hash = hashCodeNumberUpdate(hash, (a.r << 24) | (a.g << 16) | (a.b << 8) | a.a);\n    return hash;\n}\nfunction megaStateDescriptorHash(hash, a) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    for (var i = 0; i < a.attachmentsState.length; i++)\n        hash = attachmentStateHash(hash, a.attachmentsState[i]);\n    hash = colorHash(hash, a.blendConstant);\n    hash = hashCodeNumberUpdate(hash, a.depthCompare);\n    hash = hashCodeNumberUpdate(hash, a.depthWrite ? 1 : 0);\n    hash = hashCodeNumberUpdate(hash, (_a = a.stencilFront) === null || _a === void 0 ? void 0 : _a.compare);\n    hash = hashCodeNumberUpdate(hash, (_b = a.stencilFront) === null || _b === void 0 ? void 0 : _b.passOp);\n    hash = hashCodeNumberUpdate(hash, (_c = a.stencilFront) === null || _c === void 0 ? void 0 : _c.failOp);\n    hash = hashCodeNumberUpdate(hash, (_d = a.stencilFront) === null || _d === void 0 ? void 0 : _d.depthFailOp);\n    hash = hashCodeNumberUpdate(hash, (_e = a.stencilBack) === null || _e === void 0 ? void 0 : _e.compare);\n    hash = hashCodeNumberUpdate(hash, (_f = a.stencilBack) === null || _f === void 0 ? void 0 : _f.passOp);\n    hash = hashCodeNumberUpdate(hash, (_g = a.stencilBack) === null || _g === void 0 ? void 0 : _g.failOp);\n    hash = hashCodeNumberUpdate(hash, (_h = a.stencilBack) === null || _h === void 0 ? void 0 : _h.depthFailOp);\n    hash = hashCodeNumberUpdate(hash, a.stencilWrite ? 1 : 0);\n    hash = hashCodeNumberUpdate(hash, a.cullMode);\n    hash = hashCodeNumberUpdate(hash, a.frontFace ? 1 : 0);\n    hash = hashCodeNumberUpdate(hash, a.polygonOffset ? 1 : 0);\n    return hash;\n}\nfunction renderPipelineDescriptorHash(a) {\n    var hash = 0;\n    hash = hashCodeNumberUpdate(hash, a.program.id);\n    if (a.inputLayout !== null)\n        hash = hashCodeNumberUpdate(hash, a.inputLayout.id);\n    hash = megaStateDescriptorHash(hash, a.megaStateDescriptor);\n    for (var i = 0; i < a.colorAttachmentFormats.length; i++)\n        hash = hashCodeNumberUpdate(hash, a.colorAttachmentFormats[i] || 0);\n    hash = hashCodeNumberUpdate(hash, a.depthStencilAttachmentFormat || 0);\n    return hashCodeNumberFinish(hash);\n}\nfunction bindingsDescriptorHash(a) {\n    var hash = 0;\n    for (var i = 0; i < a.samplerBindings.length; i++) {\n        var binding = a.samplerBindings[i];\n        if (binding !== null && binding.texture !== null)\n            hash = hashCodeNumberUpdate(hash, binding.texture.id);\n    }\n    for (var i = 0; i < a.uniformBufferBindings.length; i++) {\n        var binding = a.uniformBufferBindings[i];\n        if (binding !== null && binding.buffer !== null) {\n            hash = hashCodeNumberUpdate(hash, binding.buffer.id);\n            hash = hashCodeNumberUpdate(hash, binding.binding);\n            hash = hashCodeNumberUpdate(hash, binding.offset);\n            hash = hashCodeNumberUpdate(hash, binding.size);\n        }\n    }\n    return hashCodeNumberFinish(hash);\n}\nvar RenderCache = /** @class */ (function () {\n    function RenderCache(device) {\n        this.bindingsCache = new HashMap(bindingsDescriptorEquals, bindingsDescriptorHash);\n        this.renderPipelinesCache = new HashMap(renderPipelineDescriptorEquals, renderPipelineDescriptorHash);\n        this.inputLayoutsCache = new HashMap(inputLayoutDescriptorEquals, nullHashFunc);\n        this.programCache = new HashMap(programDescriptorSimpleEquals, nullHashFunc);\n        this.samplerCache = new HashMap(samplerDescriptorEquals, nullHashFunc);\n        this.device = device;\n    }\n    RenderCache.prototype.createBindings = function (descriptor) {\n        var bindings = this.bindingsCache.get(descriptor);\n        if (bindings === null) {\n            var descriptorCopy = bindingsDescriptorCopy(descriptor);\n            descriptorCopy.uniformBufferBindings =\n                descriptorCopy.uniformBufferBindings.filter(function (_a) {\n                    var size = _a.size;\n                    return size > 0;\n                });\n            bindings = this.device.createBindings(descriptorCopy);\n            this.bindingsCache.add(descriptorCopy, bindings);\n        }\n        return bindings;\n    };\n    RenderCache.prototype.createRenderPipeline = function (descriptor) {\n        var renderPipeline = this.renderPipelinesCache.get(descriptor);\n        if (renderPipeline === null) {\n            var descriptorCopy = renderPipelineDescriptorCopy(descriptor);\n            descriptorCopy.colorAttachmentFormats =\n                descriptorCopy.colorAttachmentFormats.filter(function (f) { return f; });\n            renderPipeline = this.device.createRenderPipeline(descriptorCopy);\n            this.renderPipelinesCache.add(descriptorCopy, renderPipeline);\n        }\n        return renderPipeline;\n    };\n    RenderCache.prototype.createInputLayout = function (descriptor) {\n        // remove hollows\n        descriptor.vertexBufferDescriptors =\n            descriptor.vertexBufferDescriptors.filter(function (d) { return !!d; });\n        var inputLayout = this.inputLayoutsCache.get(descriptor);\n        if (inputLayout === null) {\n            var descriptorCopy = inputLayoutDescriptorCopy(descriptor);\n            inputLayout = this.device.createInputLayout(descriptorCopy);\n            this.inputLayoutsCache.add(descriptorCopy, inputLayout);\n        }\n        return inputLayout;\n    };\n    RenderCache.prototype.createProgramSimple = function (deviceProgram) {\n        var vert = deviceProgram.vert, frag = deviceProgram.frag, preprocessedFrag = deviceProgram.preprocessedFrag, preprocessedVert = deviceProgram.preprocessedVert;\n        var program = null;\n        if (preprocessedVert && preprocessedFrag) {\n            program = this.programCache.get({\n                vert: vert,\n                frag: frag,\n                preprocessedFrag: preprocessedFrag,\n                preprocessedVert: preprocessedVert,\n            });\n        }\n        if (program === null) {\n            var _a = preprocessProgramObj_GLSL(this.device, deviceProgram), preprocessedVert_1 = _a.preprocessedVert, preprocessedFrag_1 = _a.preprocessedFrag;\n            deviceProgram.preprocessedVert = preprocessedVert_1;\n            deviceProgram.preprocessedFrag = preprocessedFrag_1;\n            var descriptorCopy = programDescriptorSimpleCopy(deviceProgram);\n            program = this.device['createProgramSimple']({\n                vertex: {\n                    glsl: preprocessedVert_1,\n                },\n                fragment: {\n                    glsl: preprocessedFrag_1,\n                },\n            }, vert);\n            this.programCache.add(descriptorCopy, program);\n        }\n        return program;\n    };\n    RenderCache.prototype.createSampler = function (descriptor) {\n        var sampler = this.samplerCache.get(descriptor);\n        if (sampler === null) {\n            sampler = this.device.createSampler(descriptor);\n            this.samplerCache.add(descriptor, sampler);\n        }\n        return sampler;\n    };\n    RenderCache.prototype.destroy = function () {\n        var e_1, _a, e_2, _b, e_3, _c, e_4, _d, e_5, _e;\n        try {\n            for (var _f = __values(this.bindingsCache.values()), _g = _f.next(); !_g.done; _g = _f.next()) {\n                var bindings = _g.value;\n                bindings.destroy();\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_g && !_g.done && (_a = _f.return)) _a.call(_f);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        try {\n            for (var _h = __values(this.renderPipelinesCache.values()), _j = _h.next(); !_j.done; _j = _h.next()) {\n                var renderPipeline = _j.value;\n                renderPipeline.destroy();\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n        try {\n            for (var _k = __values(this.inputLayoutsCache.values()), _l = _k.next(); !_l.done; _l = _k.next()) {\n                var inputLayout = _l.value;\n                inputLayout.destroy();\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n        try {\n            for (var _m = __values(this.programCache.values()), _o = _m.next(); !_o.done; _o = _m.next()) {\n                var program = _o.value;\n                program.destroy();\n            }\n        }\n        catch (e_4_1) { e_4 = { error: e_4_1 }; }\n        finally {\n            try {\n                if (_o && !_o.done && (_d = _m.return)) _d.call(_m);\n            }\n            finally { if (e_4) throw e_4.error; }\n        }\n        try {\n            for (var _p = __values(this.samplerCache.values()), _q = _p.next(); !_q.done; _q = _p.next()) {\n                var sampler = _q.value;\n                sampler.destroy();\n            }\n        }\n        catch (e_5_1) { e_5 = { error: e_5_1 }; }\n        finally {\n            try {\n                if (_q && !_q.done && (_e = _p.return)) _e.call(_p);\n            }\n            finally { if (e_5) throw e_5.error; }\n        }\n        this.bindingsCache.clear();\n        this.renderPipelinesCache.clear();\n        this.inputLayoutsCache.clear();\n        this.programCache.clear();\n        this.samplerCache.clear();\n    };\n    return RenderCache;\n}());\n\nvar ToneMapping;\n(function (ToneMapping) {\n    ToneMapping[\"NONE\"] = \"none\";\n    ToneMapping[\"LINEAR\"] = \"LinearToneMapping\";\n    ToneMapping[\"REINHARD\"] = \"ReinhardToneMapping\";\n    ToneMapping[\"CINEON\"] = \"OptimizedCineonToneMapping\";\n    ToneMapping[\"ACES_FILMIC\"] = \"ACESFilmicToneMapping\";\n    ToneMapping[\"CUSTOM\"] = \"CustomToneMapping\";\n})(ToneMapping || (ToneMapping = {}));\n\nvar RGAttachmentSlot;\n(function (RGAttachmentSlot) {\n    RGAttachmentSlot[RGAttachmentSlot[\"Color0\"] = 0] = \"Color0\";\n    RGAttachmentSlot[RGAttachmentSlot[\"Color1\"] = 1] = \"Color1\";\n    RGAttachmentSlot[RGAttachmentSlot[\"Color2\"] = 2] = \"Color2\";\n    RGAttachmentSlot[RGAttachmentSlot[\"Color3\"] = 3] = \"Color3\";\n    RGAttachmentSlot[RGAttachmentSlot[\"ColorMax\"] = 3] = \"ColorMax\";\n    RGAttachmentSlot[RGAttachmentSlot[\"DepthStencil\"] = 4] = \"DepthStencil\";\n})(RGAttachmentSlot || (RGAttachmentSlot = {}));\n\nvar RenderGraphPass = /** @class */ (function () {\n    function RenderGraphPass() {\n        // RenderTargetAttachmentSlot => renderTargetID\n        this.renderTargetIDs = [];\n        this.renderTargetLevels = [];\n        // RenderTargetAttachmentSlot => resolveTextureID\n        this.resolveTextureOutputIDs = [];\n        // RenderTargetAttachmentSlot => Texture\n        this.resolveTextureOutputExternalTextures = [];\n        this.resolveTextureOutputExternalTextureLevel = [];\n        // List of resolveTextureIDs that we have a reference to.\n        this.resolveTextureInputIDs = [];\n        // RGAttachmentSlot => refcount.\n        this.renderTargetExtraRefs = [];\n        this.resolveTextureInputTextures = [];\n        this.renderTargets = [];\n        // Execution state computed by scheduling.\n        this.descriptor = {\n            colorAttachment: [],\n            colorAttachmentLevel: [],\n            colorResolveTo: [],\n            colorResolveToLevel: [],\n            colorStore: [],\n            depthStencilAttachment: null,\n            depthStencilResolveTo: null,\n            depthStencilStore: true,\n            colorClearColor: ['load'],\n            depthClearValue: 'load',\n            stencilClearValue: 'load',\n            occlusionQueryPool: null,\n        };\n        this.viewportX = 0;\n        this.viewportY = 0;\n        this.viewportW = 1;\n        this.viewportH = 1;\n        // Execution callback from user.\n        this.execFunc = null;\n        this.postFunc = null;\n        this.debugThumbnails = [];\n    }\n    RenderGraphPass.prototype.setDebugName = function (debugName) {\n        this.debugName = debugName;\n    };\n    RenderGraphPass.prototype.pushDebugThumbnail = function (attachmentSlot) {\n        this.debugThumbnails[attachmentSlot] = true;\n    };\n    RenderGraphPass.prototype.setViewport = function (x, y, w, h) {\n        this.viewportX = x;\n        this.viewportY = y;\n        this.viewportW = w;\n        this.viewportH = h;\n    };\n    RenderGraphPass.prototype.attachRenderTargetID = function (attachmentSlot, renderTargetID, level) {\n        if (level === void 0) { level = 0; }\n        assert(this.renderTargetIDs[attachmentSlot] === undefined);\n        this.renderTargetIDs[attachmentSlot] = renderTargetID;\n        this.renderTargetLevels[attachmentSlot] = level;\n    };\n    RenderGraphPass.prototype.attachResolveTexture = function (resolveTextureID) {\n        this.resolveTextureInputIDs.push(resolveTextureID);\n    };\n    RenderGraphPass.prototype.attachOcclusionQueryPool = function (queryPool) {\n        this.descriptor.occlusionQueryPool = queryPool;\n    };\n    RenderGraphPass.prototype.exec = function (func) {\n        assert(this.execFunc === null);\n        this.execFunc = func;\n    };\n    RenderGraphPass.prototype.post = function (func) {\n        assert(this.postFunc === null);\n        this.postFunc = func;\n    };\n    RenderGraphPass.prototype.addExtraRef = function (slot) {\n        this.renderTargetExtraRefs[slot] = true;\n    };\n    return RenderGraphPass;\n}());\n\nvar RGRenderTarget = /** @class */ (function () {\n    function RGRenderTarget(device, desc) {\n        this.dimension = TextureDimension.TEXTURE_2D;\n        this.depthOrArrayLayers = 1;\n        this.mipLevelCount = 1;\n        this.width = 0;\n        this.height = 0;\n        this.sampleCount = 0;\n        this.usage = TextureUsage.RENDER_TARGET;\n        this.needsClear = true;\n        this.texture = null;\n        this.age = 0;\n        this.format = desc.format;\n        this.width = desc.width;\n        this.height = desc.height;\n        this.sampleCount = desc.sampleCount;\n        assert(this.sampleCount >= 1);\n        if (this.sampleCount > 1) {\n            // MSAA render targets must be backed by attachments.\n            this.attachment = device.createRenderTarget(this);\n        }\n        else {\n            // Single-sampled textures can be backed by regular textures.\n            this.texture = device.createTexture(this);\n            this.attachment = device.createRenderTargetFromTexture(this.texture);\n        }\n    }\n    RGRenderTarget.prototype.setDebugName = function (device, debugName) {\n        this.debugName = debugName;\n        if (this.texture !== null) {\n            device.setResourceName(this.texture, this.debugName);\n        }\n        device.setResourceName(this.attachment, this.debugName);\n    };\n    RGRenderTarget.prototype.matchesDescription = function (desc) {\n        return (this.format === desc.format &&\n            this.width === desc.width &&\n            this.height === desc.height &&\n            this.sampleCount === desc.sampleCount);\n    };\n    RGRenderTarget.prototype.reset = function (desc) {\n        assert(this.matchesDescription(desc));\n        this.age = 0;\n    };\n    RGRenderTarget.prototype.destroy = function () {\n        this.attachment.destroy();\n    };\n    return RGRenderTarget;\n}());\n\n// Whenever we need to resolve a multi-sampled render target to a single-sampled texture,\n// we record an extra single-sampled texture here.\nvar SingleSampledTexture = /** @class */ (function () {\n    function SingleSampledTexture(device, desc) {\n        this.dimension = TextureDimension.TEXTURE_2D;\n        this.depthOrArrayLayers = 1;\n        this.mipLevelCount = 1;\n        this.usage = TextureUsage.RENDER_TARGET;\n        this.width = 0;\n        this.height = 0;\n        this.age = 0;\n        this.format = desc.format;\n        this.width = desc.width;\n        this.height = desc.height;\n        this.texture = device.createTexture(this);\n    }\n    SingleSampledTexture.prototype.matchesDescription = function (desc) {\n        return (this.format === desc.format &&\n            this.width === desc.width &&\n            this.height === desc.height);\n    };\n    SingleSampledTexture.prototype.reset = function (desc) {\n        assert(this.matchesDescription(desc));\n        this.age = 0;\n    };\n    SingleSampledTexture.prototype.destroy = function () {\n        this.texture.destroy();\n    };\n    return SingleSampledTexture;\n}());\n\nvar GraphImpl = /** @class */ (function () {\n    function GraphImpl() {\n        // [Symbol.species]?: 'RGGraph';\n        // Used for determining scheduling.\n        this.renderTargetDescriptions = [];\n        this.resolveTextureRenderTargetIDs = [];\n        this.passes = [];\n        // Debugging.\n        this.renderTargetDebugNames = [];\n    }\n    return GraphImpl;\n}());\nvar RenderGraph = /** @class */ (function () {\n    function RenderGraph(device) {\n        // For scope callbacks.\n        this.currentPass = null;\n        //#region Resource Creation & Caching\n        this.renderTargetDeadPool = [];\n        this.singleSampledTextureDeadPool = [];\n        //#endregion\n        //#region Graph Builder\n        this.currentGraph = null;\n        //#endregion\n        //#region Scheduling\n        this.renderTargetOutputCount = [];\n        this.renderTargetResolveCount = [];\n        this.resolveTextureUseCount = [];\n        this.renderTargetAliveForID = [];\n        this.singleSampledTextureForResolveTextureID = [];\n        this.device = device;\n    }\n    RenderGraph.prototype.acquireRenderTargetForDescription = function (desc) {\n        for (var i = 0; i < this.renderTargetDeadPool.length; i++) {\n            var freeRenderTarget = this.renderTargetDeadPool[i];\n            if (freeRenderTarget.matchesDescription(desc)) {\n                // Pop it off the list.\n                freeRenderTarget.reset(desc);\n                this.renderTargetDeadPool.splice(i--, 1);\n                return freeRenderTarget;\n            }\n        }\n        // Allocate a new render target.\n        return new RGRenderTarget(this.device, desc);\n    };\n    RenderGraph.prototype.acquireSingleSampledTextureForDescription = function (desc) {\n        for (var i = 0; i < this.singleSampledTextureDeadPool.length; i++) {\n            var freeSingleSampledTexture = this.singleSampledTextureDeadPool[i];\n            if (freeSingleSampledTexture.matchesDescription(desc)) {\n                // Pop it off the list.\n                freeSingleSampledTexture.reset(desc);\n                this.singleSampledTextureDeadPool.splice(i--, 1);\n                return freeSingleSampledTexture;\n            }\n        }\n        // Allocate a new resolve texture.\n        return new SingleSampledTexture(this.device, desc);\n    };\n    RenderGraph.prototype.beginGraphBuilder = function () {\n        assert(this.currentGraph === null);\n        this.currentGraph = new GraphImpl();\n    };\n    RenderGraph.prototype.pushPass = function (setupFunc) {\n        var pass = new RenderGraphPass();\n        setupFunc(pass);\n        this.currentGraph.passes.push(pass);\n    };\n    RenderGraph.prototype.createRenderTargetID = function (desc, debugName) {\n        this.currentGraph.renderTargetDebugNames.push(debugName);\n        return this.currentGraph.renderTargetDescriptions.push(desc) - 1;\n    };\n    RenderGraph.prototype.createResolveTextureID = function (renderTargetID) {\n        return (this.currentGraph.resolveTextureRenderTargetIDs.push(renderTargetID) - 1);\n    };\n    /**\n     * 查找最靠近输出的一个关联目标 RT 的 RGPass\n     */\n    RenderGraph.prototype.findMostRecentPassThatAttachedRenderTarget = function (renderTargetID) {\n        for (var i = this.currentGraph.passes.length - 1; i >= 0; i--) {\n            var pass = this.currentGraph.passes[i];\n            if (pass.renderTargetIDs.includes(renderTargetID))\n                return pass;\n        }\n        return null;\n    };\n    RenderGraph.prototype.resolveRenderTargetPassAttachmentSlot = function (pass, attachmentSlot) {\n        var renderPass = pass;\n        if (renderPass.resolveTextureOutputIDs[attachmentSlot] === undefined) {\n            var renderTargetID = renderPass.renderTargetIDs[attachmentSlot];\n            var resolveTextureID = this.createResolveTextureID(renderTargetID);\n            renderPass.resolveTextureOutputIDs[attachmentSlot] = resolveTextureID;\n        }\n        return renderPass.resolveTextureOutputIDs[attachmentSlot];\n    };\n    RenderGraph.prototype.findPassForResolveRenderTarget = function (renderTargetID) {\n        // Find the last pass that rendered to this render target, and resolve it now.\n        // If you wanted a previous snapshot copy of it, you should have created a separate,\n        // intermediate pass to copy that out. Perhaps we should have a helper for that use case?\n        // If there was no pass that wrote to this RT, well there's no point in resolving it, is there?\n        var renderPass = assertExists(this.findMostRecentPassThatAttachedRenderTarget(renderTargetID));\n        // Check which attachment we're in. This could possibly be explicit from the user, but it's\n        // easy enough to find...\n        var attachmentSlot = renderPass.renderTargetIDs.indexOf(renderTargetID);\n        // Check that the pass isn't resolving its attachment to another texture. Can't do both!\n        assert(renderPass.resolveTextureOutputExternalTextures[attachmentSlot] ===\n            undefined);\n        return renderPass;\n    };\n    RenderGraph.prototype.resolveRenderTarget = function (renderTargetID) {\n        var renderPass = this.findPassForResolveRenderTarget(renderTargetID);\n        var attachmentSlot = renderPass.renderTargetIDs.indexOf(renderTargetID);\n        return this.resolveRenderTargetPassAttachmentSlot(renderPass, attachmentSlot);\n    };\n    RenderGraph.prototype.resolveRenderTargetToExternalTexture = function (renderTargetID, texture, level) {\n        if (level === void 0) { level = 0; }\n        var renderPass = this.findPassForResolveRenderTarget(renderTargetID);\n        var attachmentSlot = renderPass.renderTargetIDs.indexOf(renderTargetID);\n        // We shouldn't be resolving to a resolve texture ID in this case.\n        assert(renderPass.resolveTextureOutputIDs[attachmentSlot] === undefined);\n        renderPass.resolveTextureOutputExternalTextures[attachmentSlot] = texture;\n        renderPass.resolveTextureOutputExternalTextureLevel[attachmentSlot] = level;\n    };\n    RenderGraph.prototype.getRenderTargetDescription = function (renderTargetID) {\n        return assertExists(this.currentGraph.renderTargetDescriptions[renderTargetID]);\n    };\n    RenderGraph.prototype.scheduleAddUseCount = function (graph, pass) {\n        for (var slot = 0; slot < pass.renderTargetIDs.length; slot++) {\n            var renderTargetID = pass.renderTargetIDs[slot];\n            if (renderTargetID === undefined)\n                continue;\n            this.renderTargetOutputCount[renderTargetID]++;\n            if (pass.renderTargetExtraRefs[slot])\n                this.renderTargetOutputCount[renderTargetID]++;\n        }\n        for (var i = 0; i < pass.resolveTextureInputIDs.length; i++) {\n            var resolveTextureID = pass.resolveTextureInputIDs[i];\n            if (resolveTextureID === undefined)\n                continue;\n            this.resolveTextureUseCount[resolveTextureID]++;\n            var renderTargetID = graph.resolveTextureRenderTargetIDs[resolveTextureID];\n            this.renderTargetResolveCount[renderTargetID]++;\n        }\n    };\n    RenderGraph.prototype.acquireRenderTargetForID = function (graph, renderTargetID) {\n        if (renderTargetID === undefined)\n            return null;\n        assert(this.renderTargetOutputCount[renderTargetID] > 0);\n        if (!this.renderTargetAliveForID[renderTargetID]) {\n            var desc = graph.renderTargetDescriptions[renderTargetID];\n            var newRenderTarget = this.acquireRenderTargetForDescription(desc);\n            newRenderTarget.setDebugName(this.device, graph.renderTargetDebugNames[renderTargetID]);\n            this.renderTargetAliveForID[renderTargetID] = newRenderTarget;\n        }\n        return this.renderTargetAliveForID[renderTargetID];\n    };\n    RenderGraph.prototype.releaseRenderTargetForID = function (renderTargetID, forOutput) {\n        if (renderTargetID === undefined)\n            return null;\n        var renderTarget = assertExists(this.renderTargetAliveForID[renderTargetID]);\n        if (forOutput) {\n            assert(this.renderTargetOutputCount[renderTargetID] > 0);\n            this.renderTargetOutputCount[renderTargetID]--;\n        }\n        else {\n            assert(this.renderTargetResolveCount[renderTargetID] > 0);\n            this.renderTargetResolveCount[renderTargetID]--;\n        }\n        if (this.renderTargetOutputCount[renderTargetID] === 0 &&\n            this.renderTargetResolveCount[renderTargetID] === 0) {\n            // This was the last reference to this RT -- steal it from the alive list, and put it back into the pool.\n            renderTarget.needsClear = true;\n            delete this.renderTargetAliveForID[renderTargetID];\n            this.renderTargetDeadPool.push(renderTarget);\n        }\n        return renderTarget;\n    };\n    RenderGraph.prototype.acquireResolveTextureInputTextureForID = function (graph, resolveTextureID) {\n        var renderTargetID = graph.resolveTextureRenderTargetIDs[resolveTextureID];\n        assert(this.resolveTextureUseCount[resolveTextureID] > 0);\n        this.resolveTextureUseCount[resolveTextureID]--;\n        var renderTarget = assertExists(this.releaseRenderTargetForID(renderTargetID, false));\n        if (this.singleSampledTextureForResolveTextureID[resolveTextureID] !==\n            undefined) {\n            // The resolved texture belonging to this RT is backed by our own single-sampled texture.\n            var singleSampledTexture = this.singleSampledTextureForResolveTextureID[resolveTextureID];\n            if (this.resolveTextureUseCount[resolveTextureID] === 0) {\n                // Release this single-sampled texture back to the pool, if this is the last use of it.\n                this.singleSampledTextureDeadPool.push(singleSampledTexture);\n            }\n            return singleSampledTexture.texture;\n        }\n        else {\n            // The resolved texture belonging to this RT is backed by our render target.\n            return assertExists(renderTarget.texture);\n        }\n    };\n    RenderGraph.prototype.determineResolveParam = function (graph, pass, slot) {\n        var renderTargetID = pass.renderTargetIDs[slot];\n        var resolveTextureOutputID = pass.resolveTextureOutputIDs[slot];\n        var externalTexture = pass.resolveTextureOutputExternalTextures[slot];\n        // We should have either an output ID or an external texture, not both.\n        var hasResolveTextureOutputID = resolveTextureOutputID !== undefined;\n        var hasExternalTexture = externalTexture !== undefined;\n        assert(!(hasResolveTextureOutputID && hasExternalTexture));\n        var resolveTo = null;\n        var store = false;\n        var level = 0;\n        if (this.renderTargetOutputCount[renderTargetID] > 1) {\n            // A future pass is going to render to this RT, we need to store the results.\n            store = true;\n        }\n        if (hasResolveTextureOutputID) {\n            assert(graph.resolveTextureRenderTargetIDs[resolveTextureOutputID] ===\n                renderTargetID);\n            assert(this.resolveTextureUseCount[resolveTextureOutputID] > 0);\n            assert(this.renderTargetOutputCount[renderTargetID] > 0);\n            var renderTarget = assertExists(this.renderTargetAliveForID[renderTargetID]);\n            // If we're the last user of this RT, then we don't need to resolve -- the texture itself will be enough.\n            // Note that this isn't exactly an exactly correct algorithm. If we have pass A writing to RenderTargetA,\n            // pass B resolving RenderTargetA to ResolveTextureA, and pass C writing to RenderTargetA, then we don't\n            // strictly need to copy, but in order to determine that at the time of pass A, we'd need a much fancier\n            // schedule than just tracking refcounts...\n            if (renderTarget.texture !== null &&\n                this.renderTargetOutputCount[renderTargetID] === 1) {\n                resolveTo = null;\n                store = true;\n            }\n            else {\n                if (!this.singleSampledTextureForResolveTextureID[resolveTextureOutputID]) {\n                    var desc = assertExists(graph.renderTargetDescriptions[renderTargetID]);\n                    this.singleSampledTextureForResolveTextureID[resolveTextureOutputID] =\n                        this.acquireSingleSampledTextureForDescription(desc);\n                    this.device.setResourceName(this.singleSampledTextureForResolveTextureID[resolveTextureOutputID]\n                        .texture, renderTarget.debugName + \" (Resolve \".concat(resolveTextureOutputID, \")\"));\n                }\n                resolveTo =\n                    this.singleSampledTextureForResolveTextureID[resolveTextureOutputID]\n                        .texture;\n            }\n        }\n        else if (hasExternalTexture) {\n            resolveTo = externalTexture;\n            level = pass.resolveTextureOutputExternalTextureLevel[slot];\n        }\n        else {\n            resolveTo = null;\n        }\n        return { resolveTo: resolveTo, store: store, level: level };\n    };\n    RenderGraph.prototype.schedulePass = function (graph, pass) {\n        var depthStencilRenderTargetID = pass.renderTargetIDs[RGAttachmentSlot.DepthStencil];\n        for (var slot = RGAttachmentSlot.Color0; slot <= RGAttachmentSlot.ColorMax; slot++) {\n            var colorRenderTargetID = pass.renderTargetIDs[slot];\n            var colorRenderTarget = this.acquireRenderTargetForID(graph, colorRenderTargetID);\n            pass.renderTargets[slot] = colorRenderTarget;\n            pass.descriptor.colorAttachment[slot] =\n                colorRenderTarget !== null ? colorRenderTarget.attachment : null;\n            pass.descriptor.colorAttachmentLevel[slot] =\n                pass.renderTargetLevels[slot];\n            var _a = this.determineResolveParam(graph, pass, slot), resolveTo_1 = _a.resolveTo, store_1 = _a.store, level = _a.level;\n            pass.descriptor.colorResolveTo[slot] = resolveTo_1;\n            pass.descriptor.colorResolveToLevel[slot] = level;\n            pass.descriptor.colorStore[slot] = store_1;\n            pass.descriptor.colorClearColor[slot] =\n                colorRenderTarget !== null && colorRenderTarget.needsClear\n                    ? graph.renderTargetDescriptions[colorRenderTargetID].colorClearColor\n                    : 'load';\n        }\n        var depthStencilRenderTarget = this.acquireRenderTargetForID(graph, depthStencilRenderTargetID);\n        pass.renderTargets[RGAttachmentSlot.DepthStencil] =\n            depthStencilRenderTarget;\n        pass.descriptor.depthStencilAttachment =\n            depthStencilRenderTarget !== null\n                ? depthStencilRenderTarget.attachment\n                : null;\n        var _b = this.determineResolveParam(graph, pass, RGAttachmentSlot.DepthStencil), resolveTo = _b.resolveTo, store = _b.store;\n        pass.descriptor.depthStencilResolveTo = resolveTo;\n        pass.descriptor.depthStencilStore = store;\n        pass.descriptor.depthClearValue =\n            depthStencilRenderTarget !== null && depthStencilRenderTarget.needsClear\n                ? graph.renderTargetDescriptions[depthStencilRenderTargetID]\n                    .depthClearValue\n                : 'load';\n        pass.descriptor.stencilClearValue =\n            depthStencilRenderTarget !== null && depthStencilRenderTarget.needsClear\n                ? graph.renderTargetDescriptions[depthStencilRenderTargetID]\n                    .stencilClearValue\n                : 'load';\n        var rtWidth = 0;\n        var rtHeight = 0;\n        var rtSampleCount = 0;\n        for (var i = 0; i < pass.renderTargets.length; i++) {\n            var renderTarget = pass.renderTargets[i];\n            if (!renderTarget)\n                continue;\n            var width = renderTarget.width >>> pass.renderTargetLevels[i];\n            var height = renderTarget.height >>> pass.renderTargetLevels[i];\n            if (rtWidth === 0) {\n                rtWidth = width;\n                rtHeight = height;\n                rtSampleCount = renderTarget.sampleCount;\n            }\n            assert(width === rtWidth);\n            assert(height === rtHeight);\n            assert(renderTarget.sampleCount === rtSampleCount);\n            renderTarget.needsClear = false;\n        }\n        if (rtWidth > 0 && rtHeight > 0) {\n            pass.viewportX *= rtWidth;\n            pass.viewportY *= rtHeight;\n            pass.viewportW *= rtWidth;\n            pass.viewportH *= rtHeight;\n        }\n        for (var i = 0; i < pass.resolveTextureInputIDs.length; i++) {\n            var resolveTextureID = pass.resolveTextureInputIDs[i];\n            pass.resolveTextureInputTextures[i] =\n                this.acquireResolveTextureInputTextureForID(graph, resolveTextureID);\n        }\n        for (var i = 0; i < pass.renderTargetIDs.length; i++)\n            this.releaseRenderTargetForID(pass.renderTargetIDs[i], true);\n        for (var slot = 0; slot < pass.renderTargetExtraRefs.length; slot++)\n            if (pass.renderTargetExtraRefs[slot])\n                this.releaseRenderTargetForID(pass.renderTargetIDs[slot], true);\n    };\n    RenderGraph.prototype.scheduleGraph = function (graph) {\n        assert(this.renderTargetOutputCount.length === 0);\n        assert(this.renderTargetResolveCount.length === 0);\n        assert(this.resolveTextureUseCount.length === 0);\n        // Go through and increment the age of everything in our dead pools to mark that it's old.\n        for (var i = 0; i < this.renderTargetDeadPool.length; i++)\n            this.renderTargetDeadPool[i].age++;\n        for (var i = 0; i < this.singleSampledTextureDeadPool.length; i++)\n            this.singleSampledTextureDeadPool[i].age++;\n        // Schedule our resources -- first, count up all uses of resources, then hand them out.\n        // Initialize our accumulators.\n        fillArray(this.renderTargetOutputCount, graph.renderTargetDescriptions.length, 0);\n        fillArray(this.renderTargetResolveCount, graph.renderTargetDescriptions.length, 0);\n        fillArray(this.resolveTextureUseCount, graph.resolveTextureRenderTargetIDs.length, 0);\n        // Count.\n        for (var i = 0; i < graph.passes.length; i++)\n            this.scheduleAddUseCount(graph, graph.passes[i]);\n        // Now hand out resources.\n        for (var i = 0; i < graph.passes.length; i++)\n            this.schedulePass(graph, graph.passes[i]);\n        // Double-check that all resources were handed out.\n        for (var i = 0; i < this.renderTargetOutputCount.length; i++)\n            assert(this.renderTargetOutputCount[i] === 0);\n        for (var i = 0; i < this.renderTargetResolveCount.length; i++)\n            assert(this.renderTargetResolveCount[i] === 0);\n        for (var i = 0; i < this.resolveTextureUseCount.length; i++)\n            assert(this.resolveTextureUseCount[i] === 0);\n        for (var i = 0; i < this.renderTargetAliveForID.length; i++)\n            assert(this.renderTargetAliveForID[i] === undefined);\n        // Now go through and kill anything that's over our age threshold (hasn't been used in a bit)\n        var ageThreshold = 1;\n        for (var i = 0; i < this.renderTargetDeadPool.length; i++) {\n            if (this.renderTargetDeadPool[i].age >= ageThreshold) {\n                this.renderTargetDeadPool[i].destroy();\n                this.renderTargetDeadPool.splice(i--, 1);\n            }\n        }\n        for (var i = 0; i < this.singleSampledTextureDeadPool.length; i++) {\n            if (this.singleSampledTextureDeadPool[i].age >= ageThreshold) {\n                this.singleSampledTextureDeadPool[i].destroy();\n                this.singleSampledTextureDeadPool.splice(i--, 1);\n            }\n        }\n        // Clear out our transient scheduling state.\n        this.renderTargetResolveCount.length = 0;\n        this.renderTargetOutputCount.length = 0;\n        this.resolveTextureUseCount.length = 0;\n    };\n    //#endregion\n    //#region Execution\n    RenderGraph.prototype.execPass = function (pass) {\n        assert(this.currentPass === null);\n        this.currentPass = pass;\n        var renderPass = this.device.createRenderPass(pass.descriptor);\n        renderPass.pushDebugGroup(pass.debugName);\n        renderPass.setViewport(pass.viewportX, pass.viewportY, pass.viewportW, pass.viewportH);\n        if (pass.execFunc !== null)\n            pass.execFunc(renderPass, this);\n        renderPass.popDebugGroup();\n        this.device.submitPass(renderPass);\n        if (pass.postFunc !== null)\n            pass.postFunc(this);\n        this.currentPass = null;\n    };\n    RenderGraph.prototype.execGraph = function (graph) {\n        var _this = this;\n        this.scheduleGraph(graph);\n        this.device.beginFrame();\n        graph.passes.forEach(function (pass) {\n            _this.execPass(pass);\n        });\n        this.device.endFrame();\n        // Clear our transient scope state.\n        this.singleSampledTextureForResolveTextureID.length = 0;\n    };\n    RenderGraph.prototype.execute = function () {\n        var graph = assertExists(this.currentGraph);\n        this.execGraph(graph);\n        this.currentGraph = null;\n    };\n    RenderGraph.prototype.getDebug = function () {\n        return this;\n    };\n    //#endregion\n    //#region GfxrGraphBuilderDebug\n    RenderGraph.prototype.getPasses = function () {\n        return this.currentGraph.passes;\n    };\n    RenderGraph.prototype.getPassDebugThumbnails = function (pass) {\n        return pass.debugThumbnails;\n    };\n    RenderGraph.prototype.getPassRenderTargetID = function (pass, slot) {\n        return pass.renderTargetIDs[slot];\n    };\n    RenderGraph.prototype.getRenderTargetIDDebugName = function (renderTargetID) {\n        return this.currentGraph.renderTargetDebugNames[renderTargetID];\n    };\n    //#endregion\n    //#region GfxrPassScope\n    RenderGraph.prototype.getResolveTextureForID = function (resolveTextureID) {\n        var currentGraphPass = this.currentPass;\n        var i = currentGraphPass.resolveTextureInputIDs.indexOf(resolveTextureID);\n        assert(i >= 0);\n        return assertExists(currentGraphPass.resolveTextureInputTextures[i]);\n    };\n    RenderGraph.prototype.getRenderTargetAttachment = function (slot) {\n        var currentGraphPass = this.currentPass;\n        var renderTarget = currentGraphPass.renderTargets[slot];\n        if (!renderTarget)\n            return null;\n        return renderTarget.attachment;\n    };\n    RenderGraph.prototype.getRenderTargetTexture = function (slot) {\n        var currentGraphPass = this.currentPass;\n        var renderTarget = currentGraphPass.renderTargets[slot];\n        if (!renderTarget)\n            return null;\n        return renderTarget.texture;\n    };\n    //#endregion\n    RenderGraph.prototype.newGraphBuilder = function () {\n        this.beginGraphBuilder();\n        return this;\n    };\n    RenderGraph.prototype.destroy = function () {\n        // At the time this is called, we shouldn't have anything alive.\n        for (var i = 0; i < this.renderTargetAliveForID.length; i++)\n            assert(this.renderTargetAliveForID[i] === undefined);\n        for (var i = 0; i < this.singleSampledTextureForResolveTextureID.length; i++)\n            assert(this.singleSampledTextureForResolveTextureID[i] === undefined);\n        for (var i = 0; i < this.renderTargetDeadPool.length; i++)\n            this.renderTargetDeadPool[i].destroy();\n        for (var i = 0; i < this.singleSampledTextureDeadPool.length; i++)\n            this.singleSampledTextureDeadPool[i].destroy();\n    };\n    return RenderGraph;\n}());\n\n// Suggested values for the \"layer\" of makeSortKey. These are rough groups, and you can define your own\n// ordering within the rough groups (e.g. you might use BACKGROUND + 1, or BACKGROUND + 2).\n// TRANSLUCENT is meant to be used as a bitflag. It's special as it changes the behavior of the generic sort key\n// functions like makeSortKey and setSortKeyDepth.\nvar RendererLayer;\n(function (RendererLayer) {\n    RendererLayer[RendererLayer[\"BACKGROUND\"] = 0] = \"BACKGROUND\";\n    RendererLayer[RendererLayer[\"ALPHA_TEST\"] = 16] = \"ALPHA_TEST\";\n    RendererLayer[RendererLayer[\"OPAQUE\"] = 32] = \"OPAQUE\";\n    RendererLayer[RendererLayer[\"TRANSLUCENT\"] = 128] = \"TRANSLUCENT\";\n})(RendererLayer || (RendererLayer = {}));\nvar MAX_DEPTH = 0x10000;\nvar DEPTH_BITS = 16;\nfunction makeDepthKey(depth, flipDepth, maxDepth) {\n    if (maxDepth === void 0) { maxDepth = MAX_DEPTH; }\n    // Input depth here is: 0 is the closest to the camera, positive values are further away. Negative values (behind camera) are clamped to 0.\n    // normalizedDepth: 0.0 is closest to camera, 1.0 is farthest from camera.\n    // These values are flipped if flipDepth is set.\n    var normalizedDepth = clamp(depth, 0, maxDepth) / maxDepth;\n    if (flipDepth)\n        normalizedDepth = 1.0 - normalizedDepth;\n    var depthKey = normalizedDepth * ((1 << DEPTH_BITS) - 1);\n    return depthKey & 0xffff;\n}\n// Common sort key kinds.\n// Indexed:     TLLLLLLL IIIIIIII IIIIIIII IIIIIIII\n// Opaque:      0LLLLLLL PPPPPPPP PPPPPPPP DDDDDDDD\n// Translucent: 1LLLLLLL DDDDDDDD DDDDDDDD BBBBBBBB\nfunction getSortKeyLayer(sortKey) {\n    return (sortKey >>> 24) & 0xff;\n}\nfunction setSortKeyLayer(sortKey, layer) {\n    return ((sortKey & 0x00ffffff) | ((layer & 0xff) << 24)) >>> 0;\n}\nfunction setSortKeyProgramKey(sortKey, programKey) {\n    var isTransparent = !!((sortKey >>> 31) & 1);\n    if (isTransparent)\n        return sortKey;\n    else\n        return ((sortKey & 0xff0000ff) | ((programKey & 0xffff) << 8)) >>> 0;\n}\nfunction setSortKeyBias(sortKey, bias) {\n    var isTransparent = !!((sortKey >>> 31) & 1);\n    if (isTransparent)\n        return ((sortKey & 0xffffff00) | (bias & 0xff)) >>> 0;\n    else\n        return sortKey;\n}\nfunction makeSortKeyOpaque(layer, programKey) {\n    return setSortKeyLayer(setSortKeyProgramKey(0, programKey), layer);\n}\nfunction setSortKeyOpaqueDepth(sortKey, depthKey) {\n    assert(depthKey >= 0);\n    return ((sortKey & 0xffffff00) | ((depthKey >>> 8) & 0xff)) >>> 0;\n}\nfunction makeSortKeyTranslucent(layer) {\n    return setSortKeyLayer(0, layer);\n}\nfunction setSortKeyTranslucentDepth(sortKey, depthKey) {\n    assert(depthKey >= 0);\n    return ((sortKey & 0xff0000ff) | (depthKey << 8)) >>> 0;\n}\nfunction makeSortKey(layer, programKey) {\n    if (programKey === void 0) { programKey = 0; }\n    if (layer & RendererLayer.TRANSLUCENT)\n        return makeSortKeyTranslucent(layer);\n    else\n        return makeSortKeyOpaque(layer, programKey);\n}\nfunction setSortKeyDepthKey(sortKey, depthKey) {\n    var isTranslucent = !!((sortKey >>> 31) & 1);\n    return isTranslucent\n        ? setSortKeyTranslucentDepth(sortKey, depthKey)\n        : setSortKeyOpaqueDepth(sortKey, depthKey);\n}\nfunction setSortKeyDepth(sortKey, depth, maxDepth) {\n    if (maxDepth === void 0) { maxDepth = MAX_DEPTH; }\n    var isTranslucent = !!((sortKey >>> 31) & 1);\n    var depthKey = makeDepthKey(depth, isTranslucent, maxDepth);\n    return isTranslucent\n        ? setSortKeyTranslucentDepth(sortKey, depthKey)\n        : setSortKeyOpaqueDepth(sortKey, depthKey);\n}\nfunction getSortKeyDepth(sortKey) {\n    var isTranslucent = !!((sortKey >>> 31) & 1);\n    if (isTranslucent)\n        return (sortKey >>> 8) & 0xffff;\n    else {\n        return ((sortKey >>> 8) & 0xfffc) | (sortKey & 0x03);\n    }\n}\n\nvar mtxOpenGLFromD3D = mat4.fromValues(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 0, 0, -1, 1);\n// Converts a projection matrix from D3D-style Z range [0, 1] to OpenGL-style Z range [-1, 1]\nfunction projectionMatrixOpenGLFromD3D(m) {\n    mat4.mul(m, mtxOpenGLFromD3D, m);\n}\nvar mtxD3DFromOpenGL = mat4.fromValues(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 1);\n// Converts a projection matrix from OpenGL-style Z range [-1, 1] to D3D-style Z range [0, 1]\nfunction projectionMatrixD3DFromOpenGL(m) {\n    mat4.mul(m, mtxD3DFromOpenGL, m);\n}\n/**\n * Convert a projection matrix {@param m} between differing clip spaces.\n *\n * There are two kinds of clip-space conventions in active use in graphics APIs, differing in the\n * range of the Z axis: OpenGL (and thus GL ES and WebGL) use a Z range of [-1, 1] which matches\n * the X and Y axis ranges. Direct3D, Vulkan, Metal, and WebGPU all use a Z range of [0, 1], which\n * differs from the X and Y axis ranges, but makes sense from the perspective of a camera: a camera\n * can see to the left and right of it, above and below it, but only in front and not behind it.\n *\n * The [0, 1] convention for Z range also has better characteristics for \"reversed depth\". Since\n * floating point numbers have higher precision around 0 than around 1. We then get to choose where\n * to put the extra precise bits: close to the near plane, or close to the far plane.\n *\n * With OpenGL's [-1, 1] convention, both -1 and 1 have similar amounts of precision, so we don't\n * get to make the same choice, and our higher precision around 0 is stuck in the middle of the\n * scene, which doesn't particularly help.\n *\n * The gl-matrix library has two different kinds of entry points: {@method mat4.perpsective} will\n * generate a matrix with a [-1, 1] clip space, corresponding to {@see ClipSpaceNearZ.NegativeOne},\n * but {@method mat4.perspectiveZO} will generate a matrix with a [0, 1] clip space, corresponding\n * to {@see ClipSpaceNearZ.Zero}.\n *\n * This function does nothing if {@param dst} and {@param src} are the same.\n */\nfunction projectionMatrixConvertClipSpaceNearZ(m, dst, src) {\n    if (dst === src)\n        return;\n    if (dst === ClipSpaceNearZ.NEGATIVE_ONE)\n        projectionMatrixOpenGLFromD3D(m);\n    else if (dst === ClipSpaceNearZ.ZERO)\n        projectionMatrixD3DFromOpenGL(m);\n}\n\nfunction fillVec3v(d, offs, v, v3) {\n    if (v3 === void 0) { v3 = 0; }\n    d[offs + 0] = v[0];\n    d[offs + 1] = v[1];\n    d[offs + 2] = v[2];\n    d[offs + 3] = v3;\n    return 4;\n}\nfunction fillVec4(d, offs, v0, v1, v2, v3) {\n    if (v1 === void 0) { v1 = 0; }\n    if (v2 === void 0) { v2 = 0; }\n    if (v3 === void 0) { v3 = 0; }\n    d[offs + 0] = v0;\n    d[offs + 1] = v1;\n    d[offs + 2] = v2;\n    d[offs + 3] = v3;\n    return 4;\n}\nfunction fillVec4v(d, offs, v) {\n    d[offs + 0] = v[0];\n    d[offs + 1] = v[1];\n    d[offs + 2] = v[2];\n    d[offs + 3] = v[3];\n    return 4;\n}\nfunction fillColor(d, offs, c, a) {\n    if (a === void 0) { a = c.a; }\n    d[offs + 0] = c.r;\n    d[offs + 1] = c.g;\n    d[offs + 2] = c.b;\n    d[offs + 3] = a;\n    return 4;\n}\n// All of our matrices are row-major.\nfunction fillMatrix4x4(d, offs, m) {\n    // d[offs + 0] = m[0];\n    // d[offs + 1] = m[4];\n    // d[offs + 2] = m[8];\n    // d[offs + 3] = m[12];\n    // d[offs + 4] = m[1];\n    // d[offs + 5] = m[5];\n    // d[offs + 6] = m[9];\n    // d[offs + 7] = m[13];\n    // d[offs + 8] = m[2];\n    // d[offs + 9] = m[6];\n    // d[offs + 10] = m[10];\n    // d[offs + 11] = m[14];\n    // d[offs + 12] = m[3];\n    // d[offs + 13] = m[7];\n    // d[offs + 14] = m[11];\n    // d[offs + 15] = m[15];\n    d[offs + 0] = m[0];\n    d[offs + 1] = m[1];\n    d[offs + 2] = m[2];\n    d[offs + 3] = m[3];\n    d[offs + 4] = m[4];\n    d[offs + 5] = m[5];\n    d[offs + 6] = m[6];\n    d[offs + 7] = m[7];\n    d[offs + 8] = m[8];\n    d[offs + 9] = m[9];\n    d[offs + 10] = m[10];\n    d[offs + 11] = m[11];\n    d[offs + 12] = m[12];\n    d[offs + 13] = m[13];\n    d[offs + 14] = m[14];\n    d[offs + 15] = m[15];\n    return 4 * 4;\n}\n// export function fillMatrix4x3(d: Float32Array, offs: number, m: ReadonlyMat4): number {\n//   d[offs + 0] = m[0];\n//   d[offs + 1] = m[4];\n//   d[offs + 2] = m[8];\n//   d[offs + 3] = m[12];\n//   d[offs + 4] = m[1];\n//   d[offs + 5] = m[5];\n//   d[offs + 6] = m[9];\n//   d[offs + 7] = m[13];\n//   d[offs + 8] = m[2];\n//   d[offs + 9] = m[6];\n//   d[offs + 10] = m[10];\n//   d[offs + 11] = m[14];\n//   return 4 * 3;\n// }\n// export function fillMatrix3x2(d: Float32Array, offs: number, m: ReadonlyMat2d): number {\n//   // 3x2 matrices are actually sent across as 4x2.\n//   const ma = m[0],\n//     mb = m[1];\n//   const mc = m[2],\n//     md = m[3];\n//   const mx = m[4],\n//     my = m[5];\n//   d[offs + 0] = ma;\n//   d[offs + 1] = mc;\n//   d[offs + 2] = mx;\n//   d[offs + 3] = 0;\n//   d[offs + 4] = mb;\n//   d[offs + 5] = md;\n//   d[offs + 6] = my;\n//   d[offs + 7] = 0;\n//   return 4 * 2;\n// }\n// export function fillMatrix4x2(d: Float32Array, offs: number, m: ReadonlyMat4): number {\n//   // The bottom two rows are basically just ignored in a 4x2.\n//   d[offs + 0] = m[0];\n//   d[offs + 1] = m[4];\n//   d[offs + 2] = m[8];\n//   d[offs + 3] = m[12];\n//   d[offs + 4] = m[1];\n//   d[offs + 5] = m[5];\n//   d[offs + 6] = m[9];\n//   d[offs + 7] = m[13];\n//   return 4 * 2;\n// }\n\nvar RenderInstFlags;\n(function (RenderInstFlags) {\n    RenderInstFlags[RenderInstFlags[\"None\"] = 0] = \"None\";\n    RenderInstFlags[RenderInstFlags[\"Indexed\"] = 1] = \"Indexed\";\n    RenderInstFlags[RenderInstFlags[\"AllowSkippingIfPipelineNotReady\"] = 2] = \"AllowSkippingIfPipelineNotReady\";\n    // Mostly for error checking.\n    RenderInstFlags[RenderInstFlags[\"Template\"] = 4] = \"Template\";\n    RenderInstFlags[RenderInstFlags[\"Draw\"] = 8] = \"Draw\";\n    // Which flags are inherited from templates...\n    RenderInstFlags[RenderInstFlags[\"InheritedFlags\"] = 3] = \"InheritedFlags\";\n})(RenderInstFlags || (RenderInstFlags = {}));\nvar RenderInst = /** @class */ (function () {\n    function RenderInst() {\n        this.sortKey = 0;\n        // Debugging pointer for whomever wants it...\n        this.debug = null;\n        this.uniforms = [];\n        this.bindingDescriptors = nArray(1, function () { return ({\n            bindingLayout: null,\n            samplerBindings: [],\n            uniformBufferBindings: [],\n        }); });\n        this.dynamicUniformBufferByteOffsets = nArray(4, function () { return 0; });\n        this.flags = 0;\n        this.vertexBuffers = null;\n        this.indexBuffer = null;\n        this.drawStart = 0;\n        this.drawCount = 0;\n        this.drawInstanceCount = 0;\n        this.renderPipelineDescriptor = {\n            inputLayout: null,\n            megaStateDescriptor: copyMegaState(defaultMegaState),\n            program: null,\n            topology: PrimitiveTopology.TRIANGLES,\n            colorAttachmentFormats: [],\n            depthStencilAttachmentFormat: null,\n            sampleCount: 1,\n        };\n        this.reset();\n    }\n    /**\n     * Resets a render inst to be boring, so it can re-enter the pool.\n     * Normally, you should not need to call this.\n     */\n    RenderInst.prototype.reset = function () {\n        this.sortKey = 0;\n        this.flags = RenderInstFlags.AllowSkippingIfPipelineNotReady;\n        this.vertexBuffers = null;\n        this.indexBuffer = null;\n        this.renderPipelineDescriptor.inputLayout = null;\n    };\n    /**\n     * Copies the fields from another render inst {@param o} to this render inst.\n     * Normally, you should not need to call this.\n     */\n    RenderInst.prototype.setFromTemplate = function (o) {\n        var _a, _b;\n        setMegaStateFlags(this.renderPipelineDescriptor.megaStateDescriptor, o.renderPipelineDescriptor.megaStateDescriptor);\n        this.renderPipelineDescriptor.program = o.renderPipelineDescriptor.program;\n        this.renderPipelineDescriptor.inputLayout =\n            o.renderPipelineDescriptor.inputLayout;\n        this.renderPipelineDescriptor.topology =\n            o.renderPipelineDescriptor.topology;\n        this.renderPipelineDescriptor.colorAttachmentFormats.length = Math.max(this.renderPipelineDescriptor.colorAttachmentFormats.length, o.renderPipelineDescriptor.colorAttachmentFormats.length);\n        for (var i = 0; i < o.renderPipelineDescriptor.colorAttachmentFormats.length; i++)\n            this.renderPipelineDescriptor.colorAttachmentFormats[i] =\n                o.renderPipelineDescriptor.colorAttachmentFormats[i];\n        this.renderPipelineDescriptor.depthStencilAttachmentFormat =\n            o.renderPipelineDescriptor.depthStencilAttachmentFormat;\n        this.renderPipelineDescriptor.sampleCount =\n            o.renderPipelineDescriptor.sampleCount;\n        this.uniformBuffer = o.uniformBuffer;\n        this.uniforms = __spreadArray([], __read(o.uniforms), false);\n        this.drawCount = o.drawCount;\n        this.drawStart = o.drawStart;\n        this.drawInstanceCount = o.drawInstanceCount;\n        this.vertexBuffers = o.vertexBuffers;\n        this.indexBuffer = o.indexBuffer;\n        this.flags =\n            (this.flags & ~RenderInstFlags.InheritedFlags) |\n                (o.flags & RenderInstFlags.InheritedFlags);\n        this.sortKey = o.sortKey;\n        var tbd = this.bindingDescriptors[0], obd = o.bindingDescriptors[0];\n        this.setBindingLayout({\n            numSamplers: (_a = obd.samplerBindings) === null || _a === void 0 ? void 0 : _a.length,\n            numUniformBuffers: (_b = obd.uniformBufferBindings) === null || _b === void 0 ? void 0 : _b.length,\n        });\n        for (var i = 0; i <\n            Math.min(tbd.uniformBufferBindings.length, obd.uniformBufferBindings.length); i++)\n            tbd.uniformBufferBindings[i].size =\n                o.bindingDescriptors[0].uniformBufferBindings[i].size;\n        this.setSamplerBindingsFromTextureMappings(obd.samplerBindings);\n        for (var i = 0; i < o.dynamicUniformBufferByteOffsets.length; i++)\n            this.dynamicUniformBufferByteOffsets[i] =\n                o.dynamicUniformBufferByteOffsets[i];\n    };\n    RenderInst.prototype.validate = function () {\n        var _a;\n        // Validate uniform buffer bindings.\n        for (var i = 0; i < this.bindingDescriptors.length; i++) {\n            var bd = this.bindingDescriptors[i];\n            for (var j = 0; j < ((_a = bd.uniformBufferBindings) === null || _a === void 0 ? void 0 : _a.length); j++)\n                assert(bd.uniformBufferBindings[j].size > 0);\n        }\n        assert(this.drawCount > 0);\n    };\n    /**\n     * Set the {@see Program} that this render inst will render with. This is part of the automatic\n     * pipeline building facilities. At render time, a pipeline will be automatically and constructed from\n     * the pipeline parameters.\n     */\n    RenderInst.prototype.setProgram = function (program) {\n        this.renderPipelineDescriptor.program = program;\n    };\n    /**\n     * Set the {@see MegaStateDescriptor} that this render inst will render with. This is part of the automatic\n     * pipeline building facilities. At render time, a pipeline will be automatically and constructed from\n     * the pipeline parameters.\n     */\n    RenderInst.prototype.setMegaStateFlags = function (r) {\n        setMegaStateFlags(this.renderPipelineDescriptor.megaStateDescriptor, r);\n        return this.renderPipelineDescriptor.megaStateDescriptor;\n    };\n    /**\n     * Retrieve the {@see MegaStateDescriptor} property bag that this will render with. This is similar to\n     * {@see setMegaStateFlags} but allows you to set fields directly on the internal property bag, rather than\n     * merge them. This can be slightly more efficient.\n     */\n    RenderInst.prototype.getMegaStateFlags = function () {\n        return this.renderPipelineDescriptor.megaStateDescriptor;\n    };\n    /**\n     * Sets the vertex input configuration to be used by this render instance.\n     * The {@see InputLayout} is used to construct the pipeline as part of the automatic pipeline building\n     * facilities, while the {@see VertexBufferDescriptor} and {@see IndexBufferDescriptor} is used for the render.\n     */\n    RenderInst.prototype.setVertexInput = function (inputLayout, vertexBuffers, indexBuffer) {\n        this.vertexBuffers = vertexBuffers;\n        this.indexBuffer = indexBuffer;\n        this.renderPipelineDescriptor.inputLayout = inputLayout;\n    };\n    RenderInst.prototype.setBindingLayout = function (bindingLayout) {\n        assert(bindingLayout.numUniformBuffers <\n            this.dynamicUniformBufferByteOffsets.length);\n        for (var i = this.bindingDescriptors[0].uniformBufferBindings.length; i < bindingLayout.numUniformBuffers; i++)\n            this.bindingDescriptors[0].uniformBufferBindings.push({\n                binding: i,\n                buffer: null,\n                size: 0,\n            });\n        for (var i = this.bindingDescriptors[0].samplerBindings.length; i < bindingLayout.numSamplers; i++)\n            this.bindingDescriptors[0].samplerBindings.push({\n                sampler: null,\n                texture: null,\n            });\n    };\n    RenderInst.prototype.drawIndexes = function (indexCount, indexStart) {\n        if (indexStart === void 0) { indexStart = 0; }\n        this.flags = setBitFlagEnabled(this.flags, RenderInstFlags.Indexed, true);\n        this.drawCount = indexCount;\n        this.drawStart = indexStart;\n        this.drawInstanceCount = 1;\n    };\n    RenderInst.prototype.drawIndexesInstanced = function (indexCount, instanceCount, indexStart) {\n        if (indexStart === void 0) { indexStart = 0; }\n        this.flags = setBitFlagEnabled(this.flags, RenderInstFlags.Indexed, true);\n        this.drawCount = indexCount;\n        this.drawStart = indexStart;\n        this.drawInstanceCount = instanceCount;\n    };\n    RenderInst.prototype.drawPrimitives = function (primitiveCount, primitiveStart) {\n        if (primitiveStart === void 0) { primitiveStart = 0; }\n        this.flags = setBitFlagEnabled(this.flags, RenderInstFlags.Indexed, false);\n        this.drawCount = primitiveCount;\n        this.drawStart = primitiveStart;\n        this.drawInstanceCount = 1;\n    };\n    /**\n     * account for WebGL1\n     */\n    RenderInst.prototype.setUniforms = function (bufferIndex, uniforms) {\n        if (uniforms.length === 0) {\n            return;\n        }\n        // use later in WebGL1\n        this.uniforms[bufferIndex] = uniforms;\n        // calc buffer size\n        var offset = 0;\n        var uboBuffer = [];\n        uniforms.forEach(function (uniform) {\n            var value = uniform.value;\n            // number | number[] | Float32Array\n            if (isNumber(value) ||\n                Array.isArray(value) ||\n                value instanceof Float32Array) {\n                var array = isNumber(value) ? [value] : value;\n                var formatByteSize = array.length > 4 ? 4 : array.length;\n                // std140 UBO layout\n                var emptySpace_1 = 4 - (offset % 4);\n                if (emptySpace_1 !== 4) {\n                    if (emptySpace_1 >= formatByteSize) ;\n                    else {\n                        offset += emptySpace_1;\n                        for (var j = 0; j < emptySpace_1; j++) {\n                            uboBuffer.push(0); // padding\n                        }\n                    }\n                }\n                offset += array.length;\n                uboBuffer.push.apply(uboBuffer, __spreadArray([], __read(array), false));\n            }\n        });\n        // padding\n        var emptySpace = 4 - (uboBuffer.length % 4);\n        if (emptySpace !== 4) {\n            for (var j = 0; j < emptySpace; j++) {\n                uboBuffer.push(0);\n            }\n        }\n        // upload UBO\n        var offs = this.allocateUniformBuffer(bufferIndex, uboBuffer.length);\n        var d = this.mapUniformBufferF32(bufferIndex);\n        for (var i = 0; i < uboBuffer.length; i += 4) {\n            offs += fillVec4(d, offs, uboBuffer[i], uboBuffer[i + 1], uboBuffer[i + 2], uboBuffer[i + 3]);\n        }\n    };\n    RenderInst.prototype.setUniformBuffer = function (uniformBuffer) {\n        this.uniformBuffer = uniformBuffer;\n    };\n    /**\n     * Allocates {@param wordCount} words from the uniform buffer and assigns it to the buffer\n     * slot at index {@param bufferIndex}. As a convenience, this also directly returns the same\n     * offset into the uniform buffer, in words, that would be returned by a subsequent call to\n     * {@see getUniformBufferOffset}.\n     */\n    RenderInst.prototype.allocateUniformBuffer = function (bufferIndex, wordCount) {\n        var _a;\n        assert(((_a = this.bindingDescriptors[0].uniformBufferBindings) === null || _a === void 0 ? void 0 : _a.length) <\n            this.dynamicUniformBufferByteOffsets.length);\n        this.dynamicUniformBufferByteOffsets[bufferIndex] =\n            this.uniformBuffer.allocateChunk(wordCount) << 2;\n        var dst = this.bindingDescriptors[0].uniformBufferBindings[bufferIndex];\n        dst.size = wordCount << 2;\n        return this.getUniformBufferOffset(bufferIndex);\n    };\n    /**\n     * Returns the offset into the uniform buffer, in words, that is assigned to the buffer slot\n     * at index {@param bufferIndex}, to be used with e.g. {@see mapUniformBufferF32}.\n     */\n    RenderInst.prototype.getUniformBufferOffset = function (bufferIndex) {\n        var wordOffset = this.dynamicUniformBufferByteOffsets[bufferIndex] >>> 2;\n        return wordOffset;\n    };\n    /**\n     * This is a convenience wrapper for {@see RenderDynamicUniformBuffer.mapBufferF32}, but uses\n     * the values previously assigned for the uniform buffer slot at index {@param bufferIndex}.\n     * Like {@see RenderDynamicUniformBuffer.mapBufferF32}, this does not return a slice for the\n     * buffer; you need to write to it with the correct uniform buffer offset; this will usually be\n     * returned by {@see allocateUniformBuffer}.\n     */\n    RenderInst.prototype.mapUniformBufferF32 = function (bufferIndex) {\n        return this.uniformBuffer.mapBufferF32();\n    };\n    /**\n     * Retrieve the {@see RenderDynamicUniformBuffer} that this render inst will use to allocate.\n     */\n    RenderInst.prototype.getUniformBuffer = function () {\n        return this.uniformBuffer;\n    };\n    /**\n     * Sets the {@param SamplerBinding}s in use by this render instance.\n     *\n     * Note that {@see RenderInst} has a method of doing late binding, intended to solve cases where live render\n     * targets are used, which can have difficult control flow consequences for users. Pass a string instead of a\n     * SamplerBinding to record that it can be resolved later, and use {@see RenderInst.resolveLateSamplerBinding}\n     * or equivalent to fill it in later.\n     */\n    RenderInst.prototype.setSamplerBindingsFromTextureMappings = function (mappings) {\n        mappings = mappings.filter(function (m) { return m; });\n        for (var i = 0; i < this.bindingDescriptors[0].samplerBindings.length; i++) {\n            var dst = this.bindingDescriptors[0].samplerBindings[i];\n            var binding = mappings[i];\n            if (binding === undefined || binding === null) {\n                dst.texture = null;\n                dst.sampler = null;\n                continue;\n            }\n            dst.texture = binding.texture;\n            dst.sampler = binding.sampler;\n        }\n    };\n    /**\n     * Sets whether this render inst should be skipped if the render pipeline isn't ready.\n     *\n     * Some draws of objects can be skipped if the pipelines aren't ready. Others are more\n     * crucial to draw, and so this can be set to force for the pipeline to become available.\n     *\n     * By default, this is true.\n     */\n    RenderInst.prototype.setAllowSkippingIfPipelineNotReady = function (v) {\n        this.flags = setBitFlagEnabled(this.flags, RenderInstFlags.AllowSkippingIfPipelineNotReady, v);\n    };\n    RenderInst.prototype.setAttachmentFormatsFromRenderPass = function (device, passRenderer) {\n        var passDescriptor = device.queryRenderPass(passRenderer);\n        var sampleCount = -1;\n        for (var i = 0; i < passDescriptor.colorAttachment.length; i++) {\n            var colorAttachmentDescriptor = passDescriptor.colorAttachment[i] !== null\n                ? device.queryRenderTarget(passDescriptor.colorAttachment[i])\n                : null;\n            this.renderPipelineDescriptor.colorAttachmentFormats[i] =\n                colorAttachmentDescriptor !== null\n                    ? colorAttachmentDescriptor.format\n                    : null;\n            if (colorAttachmentDescriptor !== null) {\n                if (sampleCount === -1)\n                    sampleCount = colorAttachmentDescriptor.sampleCount;\n                else\n                    assert(sampleCount === colorAttachmentDescriptor.sampleCount);\n            }\n        }\n        var depthStencilAttachmentDescriptor = passDescriptor.depthStencilAttachment !== null\n            ? device.queryRenderTarget(passDescriptor.depthStencilAttachment)\n            : null;\n        this.renderPipelineDescriptor.depthStencilAttachmentFormat =\n            depthStencilAttachmentDescriptor !== null\n                ? depthStencilAttachmentDescriptor.format\n                : null;\n        if (depthStencilAttachmentDescriptor !== null) {\n            if (sampleCount === -1)\n                sampleCount = depthStencilAttachmentDescriptor.sampleCount;\n            else\n                assert(sampleCount == depthStencilAttachmentDescriptor.sampleCount);\n        }\n        assert(sampleCount > 0);\n        this.renderPipelineDescriptor.sampleCount = sampleCount;\n    };\n    RenderInst.prototype.drawOnPass = function (cache, passRenderer) {\n        var _this = this;\n        var device = cache.device;\n        this.setAttachmentFormatsFromRenderPass(device, passRenderer);\n        var gfxPipeline = cache.createRenderPipeline(this.renderPipelineDescriptor);\n        var pipelineReady = device.pipelineQueryReady(gfxPipeline);\n        if (!pipelineReady) {\n            if (this.flags & RenderInstFlags.AllowSkippingIfPipelineNotReady) {\n                return false;\n            }\n            device.pipelineForceReady(gfxPipeline);\n        }\n        passRenderer.setPipeline(gfxPipeline);\n        passRenderer.setVertexInput(this.renderPipelineDescriptor.inputLayout, this.vertexBuffers, this.indexBuffer);\n        // upload uniforms\n        for (var i = 0; i < this.bindingDescriptors[0].uniformBufferBindings.length; i++) {\n            this.bindingDescriptors[0].uniformBufferBindings[i].buffer = assertExists(this.uniformBuffer.buffer);\n            this.bindingDescriptors[0].uniformBufferBindings[i].offset =\n                this.dynamicUniformBufferByteOffsets[i];\n        }\n        if (this.renderPipelineDescriptor.program.gl_program) {\n            this.uniforms.forEach(function (uniforms) {\n                var uniformsMap = {};\n                uniforms.forEach(function (_a) {\n                    var name = _a.name, value = _a.value;\n                    uniformsMap[name] = value;\n                });\n                _this.renderPipelineDescriptor.program.setUniformsLegacy(uniformsMap);\n            });\n        }\n        // TODO: Support multiple binding descriptors.\n        var gfxBindings = cache.createBindings(__assign(__assign({}, this.bindingDescriptors[0]), { pipeline: gfxPipeline }));\n        passRenderer.setBindings(gfxBindings);\n        if (this.flags & RenderInstFlags.Indexed) {\n            passRenderer.drawIndexed(this.drawCount, this.drawInstanceCount, this.drawStart, 0, 0);\n        }\n        else {\n            passRenderer.draw(this.drawCount, this.drawInstanceCount, this.drawStart, 0);\n        }\n        return true;\n    };\n    return RenderInst;\n}());\n\nvar renderInstCompareNone = null;\nfunction renderInstCompareSortKey(a, b) {\n    return a.sortKey - b.sortKey;\n}\nvar RenderInstExecutionOrder;\n(function (RenderInstExecutionOrder) {\n    RenderInstExecutionOrder[RenderInstExecutionOrder[\"Forwards\"] = 0] = \"Forwards\";\n    RenderInstExecutionOrder[RenderInstExecutionOrder[\"Backwards\"] = 1] = \"Backwards\";\n})(RenderInstExecutionOrder || (RenderInstExecutionOrder = {}));\nvar RenderInstList = /** @class */ (function () {\n    function RenderInstList(compareFunction, executionOrder) {\n        if (compareFunction === void 0) { compareFunction = renderInstCompareSortKey; }\n        if (executionOrder === void 0) { executionOrder = RenderInstExecutionOrder.Forwards; }\n        this.renderInsts = [];\n        this.usePostSort = false;\n        this.compareFunction = compareFunction;\n        this.executionOrder = executionOrder;\n    }\n    /**\n     * Determine whether to use post-sorting, based on some heuristics.\n     */\n    RenderInstList.prototype.checkUsePostSort = function () {\n        // Over a certain threshold, it's faster to push and then sort than insort directly...\n        this.usePostSort =\n            this.compareFunction !== null && this.renderInsts.length >= 500;\n    };\n    /**\n     * Insert a render inst to the list. This directly inserts the render inst to\n     * the position specified by the compare function, so the render inst must be\n     * fully constructed at this point.\n     */\n    RenderInstList.prototype.insertSorted = function (renderInst) {\n        if (this.compareFunction === null) {\n            this.renderInsts.push(renderInst);\n        }\n        else if (this.usePostSort) {\n            this.renderInsts.push(renderInst);\n        }\n        else {\n            spliceBisectRight(this.renderInsts, renderInst, this.compareFunction);\n        }\n        this.checkUsePostSort();\n    };\n    RenderInstList.prototype.submitRenderInst = function (renderInst) {\n        // TODO: drawCount = 0\n        // renderInst.validate();\n        renderInst.flags |= RenderInstFlags.Draw;\n        this.insertSorted(renderInst);\n    };\n    RenderInstList.prototype.ensureSorted = function () {\n        if (this.usePostSort) {\n            if (this.renderInsts.length !== 0)\n                this.renderInsts.sort(this.compareFunction);\n            this.usePostSort = false;\n        }\n    };\n    RenderInstList.prototype.drawOnPassRendererNoReset = function (cache, passRenderer) {\n        this.ensureSorted();\n        if (this.executionOrder === RenderInstExecutionOrder.Forwards) {\n            for (var i = 0; i < this.renderInsts.length; i++)\n                this.renderInsts[i].drawOnPass(cache, passRenderer);\n        }\n        else {\n            for (var i = this.renderInsts.length - 1; i >= 0; i--)\n                this.renderInsts[i].drawOnPass(cache, passRenderer);\n        }\n    };\n    RenderInstList.prototype.reset = function () {\n        this.renderInsts.length = 0;\n    };\n    RenderInstList.prototype.drawOnPassRenderer = function (cache, passRenderer) {\n        this.drawOnPassRendererNoReset(cache, passRenderer);\n        this.reset();\n    };\n    return RenderInstList;\n}());\n\nvar RenderInstPool = /** @class */ (function () {\n    function RenderInstPool() {\n        // The pool contains all render insts that we've ever created.\n        this.pool = [];\n        // The number of render insts currently allocated out to the user.\n        this.allocCount = 0;\n    }\n    RenderInstPool.prototype.allocRenderInstIndex = function () {\n        this.allocCount++;\n        if (this.allocCount > this.pool.length) {\n            this.pool.push(new RenderInst());\n        }\n        return this.allocCount - 1;\n    };\n    RenderInstPool.prototype.popRenderInst = function () {\n        this.allocCount--;\n    };\n    RenderInstPool.prototype.reset = function () {\n        for (var i = 0; i < this.pool.length; i++) {\n            this.pool[i].reset();\n        }\n        this.allocCount = 0;\n    };\n    RenderInstPool.prototype.destroy = function () {\n        this.pool.length = 0;\n        this.allocCount = 0;\n    };\n    return RenderInstPool;\n}());\n\nvar RenderInstManager = /** @class */ (function () {\n    function RenderInstManager(renderCache) {\n        this.renderCache = renderCache;\n        this.instPool = new RenderInstPool();\n        this.templatePool = new RenderInstPool();\n        this.simpleRenderInstList = new RenderInstList();\n        this.currentRenderInstList = this.simpleRenderInstList;\n    }\n    /**\n     * Creates a new RenderInst object and returns it. If there is a template\n     * pushed onto the template stack, then its values will be used as a base for this\n     * render inst.\n     */\n    RenderInstManager.prototype.newRenderInst = function () {\n        var templateIndex = this.templatePool.allocCount - 1;\n        var renderInstIndex = this.instPool.allocRenderInstIndex();\n        var renderInst = this.instPool.pool[renderInstIndex];\n        renderInst.debug = null;\n        if (templateIndex >= 0)\n            renderInst.setFromTemplate(this.templatePool.pool[templateIndex]);\n        return renderInst;\n    };\n    /**\n     * Submits RenderInst to the current render inst list. Note that\n     * this assumes the render inst was fully filled in, so do not modify it\n     * after submitting it.\n     */\n    RenderInstManager.prototype.submitRenderInst = function (renderInst, list) {\n        if (list === void 0) { list = this.currentRenderInstList; }\n        list.submitRenderInst(renderInst);\n    };\n    /**\n     * Sets the currently active render inst list. This is the list that will\n     * be used by @param submitRenderInst}. If you use this function, please\n     * make sure to call {@see disableSimpleMode} when the RenderInstManager\n     * is created, to ensure that nobody uses the \"legacy\" APIs. Failure to do\n     * so might cause memory leaks or other problems.\n     */\n    RenderInstManager.prototype.setCurrentRenderInstList = function (list) {\n        assert(this.simpleRenderInstList === null);\n        this.currentRenderInstList = list;\n    };\n    /**\n     * Pushes a new template render inst to the template stack. All properties set\n     * on the topmost template on the template stack will be the defaults for both\n     * for any future render insts created. Once done with a template, call\n     * {@param popTemplateRenderInst} to pop it off the template stack.\n     */\n    RenderInstManager.prototype.pushTemplateRenderInst = function () {\n        var templateIndex = this.templatePool.allocCount - 1;\n        var newTemplateIndex = this.templatePool.allocRenderInstIndex();\n        var newTemplate = this.templatePool.pool[newTemplateIndex];\n        if (templateIndex >= 0)\n            newTemplate.setFromTemplate(this.templatePool.pool[templateIndex]);\n        newTemplate.flags |= RenderInstFlags.Template;\n        return newTemplate;\n    };\n    RenderInstManager.prototype.popTemplateRenderInst = function () {\n        this.templatePool.popRenderInst();\n    };\n    /**\n     * Retrieves the current template render inst on the top of the template stack.\n     */\n    RenderInstManager.prototype.getTemplateRenderInst = function () {\n        var templateIndex = this.templatePool.allocCount - 1;\n        return this.templatePool.pool[templateIndex];\n    };\n    /**\n     * Reset all allocated render insts. This should be called at the end of the frame,\n     * once done with all of the allocated render insts and render inst lists.\n     */\n    RenderInstManager.prototype.resetRenderInsts = function () {\n        // Retire the existing render insts.\n        this.instPool.reset();\n        if (this.simpleRenderInstList !== null)\n            this.simpleRenderInstList.reset();\n        // Ensure we aren't leaking templates.\n        assert(this.templatePool.allocCount === 0);\n    };\n    RenderInstManager.prototype.destroy = function () {\n        this.instPool.destroy();\n        this.renderCache.destroy();\n    };\n    /**\n     * Disables the \"simple\" render inst list management API.\n     */\n    RenderInstManager.prototype.disableSimpleMode = function () {\n        // This is a one-way street!\n        this.simpleRenderInstList = null;\n    };\n    // /**\n    //  * Execute all scheduled render insts in {@param list} onto the {@param RenderPass},\n    //  * using {@param device} and {@param cache} to create any device-specific resources\n    //  * necessary to complete the draws.\n    //  */\n    // drawListOnPassRenderer(list: RenderInstList, passRenderer: RenderPass): void {\n    //   list.drawOnPassRenderer(this.renderCache, passRenderer);\n    // }\n    RenderInstManager.prototype.drawOnPassRenderer = function (passRenderer) {\n        var list = assertExists(this.simpleRenderInstList);\n        list.drawOnPassRenderer(this.renderCache, passRenderer);\n    };\n    RenderInstManager.prototype.drawOnPassRendererNoReset = function (passRenderer) {\n        var list = assertExists(this.simpleRenderInstList);\n        list.drawOnPassRendererNoReset(this.renderCache, passRenderer);\n    };\n    return RenderInstManager;\n}());\n\nvar RenderHelper = /** @class */ (function () {\n    function RenderHelper(parameters) {\n        this.parameters = parameters;\n    }\n    RenderHelper.prototype.getDevice = function () {\n        return this.device;\n    };\n    RenderHelper.prototype.setDevice = function (device) {\n        this.device = device;\n        this.renderCache = new RenderCache(device);\n        this.renderGraph = new RenderGraph(this.device);\n        this.renderInstManager = new RenderInstManager(this.renderCache);\n        this.uniformBuffer = new DynamicUniformBuffer(this.device);\n        // this.debugThumbnails = new DebugThumbnailDrawer(this);\n    };\n    RenderHelper.prototype.pushTemplateRenderInst = function () {\n        var template = this.renderInstManager.pushTemplateRenderInst();\n        template.setUniformBuffer(this.uniformBuffer);\n        return template;\n    };\n    RenderHelper.prototype.prepareToRender = function () {\n        this.uniformBuffer.prepareToRender();\n    };\n    RenderHelper.prototype.destroy = function () {\n        if (this.uniformBuffer) {\n            this.uniformBuffer.destroy();\n        }\n        if (this.renderInstManager) {\n            this.renderInstManager.destroy();\n        }\n        if (this.renderCache) {\n            this.renderCache.destroy();\n        }\n        if (this.renderGraph) {\n            this.renderGraph.destroy();\n        }\n    };\n    // getDebugTextDrawer(): TextDrawer | null {\n    //   return null;\n    // }\n    RenderHelper.prototype.getCache = function () {\n        return this.renderCache;\n    };\n    RenderHelper.prototype.getDefines = function () {\n        var _a, _b, _c;\n        return {\n            USE_TONEMAPPING: ((_a = this.parameters) === null || _a === void 0 ? void 0 : _a.toneMapping) &&\n                ((_b = this.parameters) === null || _b === void 0 ? void 0 : _b.toneMapping) !== ToneMapping.NONE,\n            toneMapping: (_c = this.parameters) === null || _c === void 0 ? void 0 : _c.toneMapping,\n        };\n    };\n    return RenderHelper;\n}());\n\nvar RGRenderTargetDescription = /** @class */ (function () {\n    function RGRenderTargetDescription(format) {\n        this.format = format;\n        this.width = 0;\n        this.height = 0;\n        this.sampleCount = 0;\n        this.colorClearColor = 'load';\n        this.depthClearValue = 'load';\n        this.stencilClearValue = 'load';\n    }\n    /**\n     * Set the dimensions of a render target description.\n     */\n    RGRenderTargetDescription.prototype.setDimensions = function (width, height, sampleCount) {\n        this.width = width;\n        this.height = height;\n        this.sampleCount = sampleCount;\n    };\n    RGRenderTargetDescription.prototype.copyDimensions = function (desc) {\n        this.width = desc.width;\n        this.height = desc.height;\n        this.sampleCount = desc.sampleCount;\n    };\n    return RGRenderTargetDescription;\n}());\n\nfunction makeAttachmentClearDescriptor(clearColor) {\n    return {\n        colorClearColor: clearColor,\n        // depthClearValue: reverseDepthForClearValue(1.0),\n        depthClearValue: 1,\n        stencilClearValue: 0.0,\n    };\n}\nvar standardFullClearRenderPassDescriptor = makeAttachmentClearDescriptor(colorNewFromRGBA(0.88, 0.88, 0.88, 1.0));\nvar opaqueBlackFullClearRenderPassDescriptor = makeAttachmentClearDescriptor(OpaqueBlack);\nvar opaqueWhiteFullClearRenderPassDescriptor = makeAttachmentClearDescriptor(OpaqueWhite);\nvar AntialiasingMode;\n(function (AntialiasingMode) {\n    AntialiasingMode[AntialiasingMode[\"None\"] = 0] = \"None\";\n    AntialiasingMode[AntialiasingMode[\"FXAA\"] = 1] = \"FXAA\";\n    AntialiasingMode[AntialiasingMode[\"MSAAx4\"] = 2] = \"MSAAx4\";\n})(AntialiasingMode || (AntialiasingMode = {}));\nfunction selectFormatSimple(slot) {\n    if (slot === RGAttachmentSlot.Color0) {\n        return Format.U8_RGBA_RT;\n    }\n    else if (slot === RGAttachmentSlot.DepthStencil) {\n        return Format.D24_S8;\n    }\n    else {\n        throw new Error('whoops');\n    }\n}\nfunction selectSampleCount(renderInput) {\n    if (renderInput.antialiasingMode === AntialiasingMode.MSAAx4) {\n        return 4;\n    }\n    else {\n        return 1;\n    }\n}\nfunction setBackbufferDescSimple(desc, renderInput) {\n    var sampleCount = selectSampleCount(renderInput);\n    desc.setDimensions(renderInput.backbufferWidth, renderInput.backbufferHeight, sampleCount);\n}\nfunction makeBackbufferDescSimple(slot, renderInput, clearDescriptor) {\n    var pixelFormat = selectFormatSimple(slot);\n    var desc = new RGRenderTargetDescription(pixelFormat);\n    setBackbufferDescSimple(desc, renderInput);\n    if (clearDescriptor !== null) {\n        desc.colorClearColor = clearDescriptor.colorClearColor;\n        desc.depthClearValue = clearDescriptor.depthClearValue;\n        desc.stencilClearValue = clearDescriptor.stencilClearValue;\n    }\n    return desc;\n}\n\nvar TextureMapping = /** @class */ (function () {\n    function TextureMapping() {\n        this.texture = null;\n        this.sampler = null;\n        this.width = 0;\n        this.height = 0;\n        this.lodBias = 0;\n    }\n    // GL sucks. This is a convenience when building texture matrices.\n    // The core renderer does not use this code at all.\n    // flipY: boolean = false;\n    TextureMapping.prototype.reset = function () {\n        this.texture = null;\n        this.sampler = null;\n        this.width = 0;\n        this.height = 0;\n        this.lodBias = 0;\n        // this.flipY = false;\n    };\n    TextureMapping.prototype.copy = function (other) {\n        this.texture = other.texture;\n        this.sampler = other.sampler;\n        this.width = other.width;\n        this.height = other.height;\n        this.lodBias = other.lodBias;\n        // this.flipY = other.flipY;\n    };\n    return TextureMapping;\n}());\n\n// Public API for saving off copies of images for temporal-style effects.\nvar TemporalTexture = /** @class */ (function () {\n    function TemporalTexture() {\n        // These names might be a bit confusing, but they're named relative to the graph.\n        // outputTexture is the target of a resolve, inputTexture is the source for sampling.\n        this.inputTexture = null;\n        this.outputTexture = null;\n    }\n    TemporalTexture.prototype.setDescription = function (device, desc) {\n        // Updating the description will happen at the start of the frame,\n        // so we need to keep the inputTexture alive (the previous frame's texture),\n        // and create a new outputTexture.\n        if (this.inputTexture !== this.outputTexture) {\n            if (this.inputTexture !== null)\n                this.inputTexture.destroy();\n            // Set the input texture to our old output texture.\n            this.inputTexture = this.outputTexture;\n        }\n        assert(this.inputTexture === this.outputTexture);\n        if (this.outputTexture !== null &&\n            this.outputTexture.matchesDescription(desc))\n            return;\n        this.outputTexture = new SingleSampledTexture(device, desc);\n        if (this.inputTexture === null)\n            this.inputTexture = this.outputTexture;\n    };\n    TemporalTexture.prototype.getTextureForSampling = function () {\n        return this.inputTexture !== null ? this.inputTexture.texture : null;\n    };\n    TemporalTexture.prototype.getTextureForResolving = function () {\n        var _a;\n        return (_a = this.outputTexture) === null || _a === void 0 ? void 0 : _a.texture;\n    };\n    TemporalTexture.prototype.destroy = function () {\n        if (this.outputTexture !== null &&\n            this.outputTexture !== this.inputTexture) {\n            this.outputTexture.destroy();\n            this.outputTexture = null;\n        }\n        if (this.inputTexture !== null) {\n            this.inputTexture.destroy();\n            this.inputTexture = null;\n        }\n    };\n    return TemporalTexture;\n}());\n\nvar Light = /** @class */ (function (_super) {\n    __extends(Light, _super);\n    function Light(_a) {\n        if (_a === void 0) { _a = {}; }\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        return _super.call(this, __assign({ type: Light.tag, style: __assign({ intensity: Math.PI }, style) }, rest)) || this;\n    }\n    Light.tag = 'light';\n    return Light;\n}(DisplayObject));\n\nvar FogType;\n(function (FogType) {\n    FogType[FogType[\"NONE\"] = 0] = \"NONE\";\n    FogType[FogType[\"EXP\"] = 1] = \"EXP\";\n    FogType[FogType[\"EXP2\"] = 2] = \"EXP2\";\n    FogType[FogType[\"LINEAR\"] = 3] = \"LINEAR\";\n})(FogType || (FogType = {}));\nvar Fog = /** @class */ (function (_super) {\n    __extends(Fog, _super);\n    function Fog(_a) {\n        if (_a === void 0) { _a = {}; }\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        return _super.call(this, __assign({ type: Fog.tag, style: __assign({ type: FogType.NONE, fill: 'black', start: 1, end: 1000, density: 0 }, style) }, rest)) || this;\n    }\n    Fog.tag = 'fog';\n    return Fog;\n}(DisplayObject));\n\nfunction makeDataBuffer(device, usage, data, hint) {\n    if (hint === void 0) { hint = BufferFrequencyHint.STATIC; }\n    var buffer = device.createBuffer({\n        viewOrSize: data.byteLength,\n        usage: usage,\n        hint: hint,\n    });\n    buffer.setSubData(0, new Uint8Array(data));\n    return buffer;\n}\nvar GeometryEvent;\n(function (GeometryEvent) {\n    GeometryEvent[\"CHANGED\"] = \"changed\";\n})(GeometryEvent || (GeometryEvent = {}));\n/**\n * just hold descriptors of buffers & indices, won't use underlying GPU resources\n */\nvar BufferGeometry = /** @class */ (function (_super) {\n    __extends(BufferGeometry, _super);\n    function BufferGeometry(device, props) {\n        if (props === void 0) { props = {}; }\n        var _this = _super.call(this) || this;\n        _this.device = device;\n        _this.props = props;\n        _this.drawMode = PrimitiveTopology.TRIANGLES;\n        _this.vertexBuffers = [];\n        _this.vertices = [];\n        _this.inputLayoutDescriptor = {\n            vertexBufferDescriptors: [],\n            indexBufferFormat: null,\n            program: null,\n        };\n        _this.vertexCount = 0;\n        _this.instancedCount = 0;\n        _this.indexStart = 0;\n        _this.primitiveStart = 0;\n        _this.dirty = true;\n        _this.meshes = [];\n        return _this;\n    }\n    BufferGeometry.prototype.validate = function (mesh) {\n        return true;\n    };\n    BufferGeometry.prototype.build = function (meshes) { };\n    BufferGeometry.prototype.computeBoundingBox = function () {\n        return new AABB();\n    };\n    BufferGeometry.prototype.setIndexBuffer = function (indices) {\n        if (this.indexBuffer) {\n            this.indexBuffer.destroy();\n        }\n        this.indexBuffer = makeDataBuffer(this.device, BufferUsage.INDEX, new Uint32Array(ArrayBuffer.isView(indices) ? indices.buffer : indices)\n            .buffer);\n        this.indices = indices;\n        this.inputLayoutDescriptor.indexBufferFormat = Format.U32_R;\n        return this;\n    };\n    BufferGeometry.prototype.setVertexBuffer = function (descriptor) {\n        var _this = this;\n        var bufferIndex = descriptor.bufferIndex, byteStride = descriptor.byteStride, stepMode = descriptor.stepMode, attributes = descriptor.attributes, data = descriptor.data;\n        this.inputLayoutDescriptor.vertexBufferDescriptors[bufferIndex] = {\n            arrayStride: byteStride,\n            stepMode: stepMode,\n            attributes: [],\n        };\n        this.vertices[bufferIndex] = data;\n        attributes.forEach(function (_a) {\n            var format = _a.format, bufferByteOffset = _a.bufferByteOffset, location = _a.location, divisor = _a.divisor; _a.byteStride;\n            var existed = _this.inputLayoutDescriptor.vertexBufferDescriptors[bufferIndex].attributes.find(function (e) { return e.shaderLocation === location; });\n            if (existed) {\n                existed.format = format;\n                existed.offset = bufferByteOffset;\n                existed.divisor = divisor;\n            }\n            else {\n                _this.inputLayoutDescriptor.vertexBufferDescriptors[bufferIndex].attributes.push({\n                    format: format,\n                    offset: bufferByteOffset,\n                    shaderLocation: location,\n                    divisor: divisor,\n                });\n            }\n        });\n        // create GPUBuffer\n        if (this.vertexBuffers[bufferIndex]) {\n            this.vertexBuffers[bufferIndex].destroy();\n        }\n        var buffer = makeDataBuffer(this.device, BufferUsage.VERTEX, data.buffer, BufferFrequencyHint.DYNAMIC);\n        this.vertexBuffers[bufferIndex] = buffer;\n        return this;\n    };\n    BufferGeometry.prototype.getVertexBuffer = function (bufferIndex) {\n        return this.vertexBuffers[bufferIndex];\n    };\n    BufferGeometry.prototype.updateVertexBuffer = function (bufferIndex, location, index, data) {\n        var bufferDescriptor = this.inputLayoutDescriptor.vertexBufferDescriptors[bufferIndex];\n        if (!bufferDescriptor) {\n            return;\n        }\n        var arrayStride = bufferDescriptor.arrayStride;\n        var descriptor = this.inputLayoutDescriptor.vertexBufferDescriptors[bufferIndex].attributes.find(function (d) { return d.shaderLocation === location; });\n        if (descriptor) {\n            var vertexBuffer = this.getVertexBuffer(bufferIndex);\n            var offset = index * arrayStride;\n            vertexBuffer.setSubData(descriptor.offset + offset, data);\n            // TODO: update vertices\n            // this.vertices[bufferIndex] = data;\n        }\n        this.emit(GeometryEvent.CHANGED);\n    };\n    BufferGeometry.prototype.updateIndices = function (indices, offset) {\n        if (offset === void 0) { offset = 0; }\n        if (this.indexBuffer) {\n            this.indexBuffer.setSubData(offset, new Uint8Array(ArrayBuffer.isView(indices) ? indices : new Uint32Array(indices)));\n        }\n        return this;\n    };\n    BufferGeometry.prototype.destroy = function () {\n        this.vertexBuffers.forEach(function (buffer) {\n            if (buffer) {\n                buffer.destroy();\n            }\n        });\n        if (this.indexBuffer) {\n            this.indexBuffer.destroy();\n        }\n        this.inputLayoutDescriptor.vertexBufferDescriptors = [];\n        this.indexBuffer = undefined;\n        this.vertexBuffers = [];\n        this.indices = undefined;\n        this.vertices = [];\n        this.vertexCount = 0;\n        this.instancedCount = 0;\n    };\n    return BufferGeometry;\n}(EventEmitter));\n\nvar vert$5 = \"#define GLSLIFY 1\\nlayout(location = 0) in vec2 a_Position;\\n\\nout vec2 v_TexCoord;\\n\\nvoid main() {\\n  v_TexCoord = 0.5 * (a_Position + 1.0);\\n  gl_Position = vec4(a_Position, 0., 1.);\\n\\n  #ifdef VIEWPORT_ORIGIN_TL\\n    v_TexCoord.y = 1.0 - v_TexCoord.y;\\n  #endif\\n}\"; // eslint-disable-line\n\nvar frag$5 = \"#define GLSLIFY 1\\nuniform sampler2D u_Texture;\\nin vec2 v_TexCoord;\\n\\nout vec4 outputColor;\\n\\nfloat MonochromeNTSC(vec3 t_Color) {\\n  // NTSC primaries.\\n  return dot(t_Color.rgb, vec3(0.299, 0.587, 0.114));\\n}\\n\\nvec4 FXAA(PD_SAMPLER_2D(t_Texture), in vec2 t_PixelCenter, in vec2 t_InvResolution) {\\n  // FXAA v2, based on implementations:\\n  // http://www.geeks3d.com/20110405/fxaa-fast-approximate-anti-aliasing-demo-glsl-opengl-test-radeon-geforce/\\n  // https://github.com/mitsuhiko/webgl-meincraft\\n\\n  float lumaMM = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy).rgb);\\n\\n  #if 1\\n    vec2 t_PixelTopLeft = t_PixelCenter.xy - t_InvResolution.xy * 0.5;\\n    float lumaNW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy)             .rgb);\\n    float lumaNE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy + vec2(1.0, 0.0)).rgb);\\n    float lumaSW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy + vec2(0.0, 1.0)).rgb);\\n    float lumaSE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelTopLeft.xy + vec2(1.0, 1.0)).rgb);\\n  #else\\n    // We're at the pixel center -- pixel edges are 0.5 units away.\\n    // NOTE(jstpierre): mitsuhiko's port seems to get this wrong?\\n    vec2 t_PixelSize = t_InvResolution.xy * 0.5;\\n\\n    float lumaNW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2(-1.0, -1.0)).rgb);\\n    float lumaNE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2( 1.0, -1.0)).rgb);\\n    float lumaSW = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2(-1.0,  1.0)).rgb);\\n    float lumaSE = MonochromeNTSC(texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + t_PixelSize * vec2( 1.0,  1.0)).rgb);\\n  #endif\\n\\n  vec2 dir; \\n  dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\\n  dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\\n\\n  const float FXAA_REDUCE_MIN = 1.0/128.0;\\n  const float FXAA_REDUCE_MUL = 1.0/8.0;\\n  const float FXAA_SPAN_MAX = 8.0;\\n\\n  float dirReduce = max(\\n      (lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL),\\n      FXAA_REDUCE_MIN);\\n\\n  float rcpDirMin = 1.0/(min(abs(dir.x), abs(dir.y)) + dirReduce);\\n  dir = min(vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * u_InvResolution.xy;\\n\\n  float lumaMin = min(lumaMM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\\n  float lumaMax = max(lumaMM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\\n\\n  vec4 rgbA = (1.0/2.0) * (\\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (1.0/3.0 - 0.5)) +\\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (2.0/3.0 - 0.5)));\\n  vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (0.0/3.0 - 0.5)) +\\n      texture(PU_SAMPLER_2D(t_Texture), t_PixelCenter.xy + dir * (3.0/3.0 - 0.5)));\\n  float lumaB = MonochromeNTSC(rgbB.rgb);\\n\\n  vec4 rgbOutput = ((lumaB < lumaMin) || (lumaB > lumaMax)) ? rgbA : rgbB;\\n  return rgbOutput;\\n}\\n\\nvoid main() {\\n  outputColor = FXAA(PP_SAMPLER_2D(u_Texture), v_TexCoord.xy, u_InvResolution.xy);\\n}\"; // eslint-disable-line\n\nvar FXAAProgram = /** @class */ (function (_super) {\n    __extends(FXAAProgram, _super);\n    function FXAAProgram() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.features = {};\n        _this.both = \"\\nlayout(std140) uniform ub_Params {\\n    vec4 u_Misc[1];\\n};\\n#define u_InvResolution (u_Misc[0].xy)\\n\";\n        _this.vert = vert$5;\n        _this.frag = frag$5;\n        return _this;\n    }\n    return FXAAProgram;\n}(DeviceProgram));\nvar textureMapping = nArray(1, function () { return new TextureMapping(); });\nvar geometry;\nvar inputLayout;\nfunction pushFXAAPass(builder, renderHelper, renderInput, mainColorTargetID) {\n    builder.pushPass(function (pass) {\n        pass.setDebugName('FXAA');\n        pass.attachRenderTargetID(RGAttachmentSlot.Color0, mainColorTargetID);\n        var mainColorResolveTextureID = builder.resolveRenderTarget(mainColorTargetID);\n        pass.attachResolveTexture(mainColorResolveTextureID);\n        var renderInst = renderHelper.renderInstManager.newRenderInst();\n        renderInst.setUniformBuffer(renderHelper.uniformBuffer);\n        renderInst.setAllowSkippingIfPipelineNotReady(false);\n        renderInst.setMegaStateFlags(fullscreenMegaState);\n        renderInst.setBindingLayout({ numUniformBuffers: 1, numSamplers: 1 });\n        renderInst.drawPrimitives(3);\n        // since gl_VertexID is not available in GLSL 100, we need to use a geometry\n        var offs = renderInst.allocateUniformBuffer(0, 4);\n        var d = renderInst.mapUniformBufferF32(0);\n        fillVec4(d, offs, 1.0 / renderInput.backbufferWidth, 1.0 / renderInput.backbufferHeight);\n        var fxaaProgram = new FXAAProgram();\n        var program = renderHelper.renderCache.createProgramSimple(fxaaProgram);\n        renderInst.setProgram(program);\n        if (!geometry) {\n            geometry = new BufferGeometry(renderHelper.getDevice());\n            geometry.setVertexBuffer({\n                bufferIndex: 0,\n                byteStride: 4 * 2,\n                stepMode: VertexStepMode.VERTEX,\n                attributes: [\n                    {\n                        format: Format.F32_RG,\n                        bufferByteOffset: 4 * 0,\n                        location: 0,\n                    },\n                ],\n                // rendering a fullscreen triangle instead of quad\n                // @see https://www.saschawillems.de/blog/2016/08/13/vulkan-tutorial-on-rendering-a-fullscreen-quad-without-buffers/\n                data: new Float32Array([1, 3, -3, -1, 1, -1]),\n            });\n            geometry.vertexCount = 3;\n            inputLayout = renderHelper\n                .getCache()\n                .createInputLayout(geometry.inputLayoutDescriptor);\n        }\n        pass.exec(function (passRenderer, scope) {\n            textureMapping[0].texture = scope.getResolveTextureForID(mainColorResolveTextureID);\n            renderInst.setSamplerBindingsFromTextureMappings(textureMapping);\n            renderInst.setVertexInput(inputLayout, geometry.vertexBuffers.map(function (buffer) { return ({\n                buffer: buffer,\n                byteOffset: 0,\n            }); }), null);\n            renderInst.drawOnPass(renderHelper.renderCache, passRenderer);\n        });\n    });\n}\n\n// scene uniform block index\nvar SceneUniformBufferIndex = 0;\n// uniforms in scene level\nvar SceneUniform;\n(function (SceneUniform) {\n    SceneUniform[\"PROJECTION_MATRIX\"] = \"u_ProjectionMatrix\";\n    SceneUniform[\"VIEW_MATRIX\"] = \"u_ViewMatrix\";\n    SceneUniform[\"CAMERA_POSITION\"] = \"u_CameraPosition\";\n    SceneUniform[\"DEVICE_PIXEL_RATIO\"] = \"u_DevicePixelRatio\";\n    SceneUniform[\"VIEWPORT\"] = \"u_Viewport\";\n    SceneUniform[\"IS_ORTHO\"] = \"u_IsOrtho\";\n    SceneUniform[\"IS_PICKING\"] = \"u_IsPicking\";\n})(SceneUniform || (SceneUniform = {}));\nvar RenderGraphPlugin = /** @class */ (function () {\n    function RenderGraphPlugin(renderHelper, lightPool, texturePool, batchManager, options) {\n        this.renderHelper = renderHelper;\n        this.lightPool = lightPool;\n        this.texturePool = texturePool;\n        this.batchManager = batchManager;\n        this.options = options;\n        this.renderLists = {\n            /**\n             * used in main forward rendering pass\n             */\n            leftEye: new RenderInstList(),\n            /**\n             * right eye in VR session.\n             */\n            rightEye: new RenderInstList(),\n            /**\n             * used in picking pass, should disable blending\n             */\n            picking: new RenderInstList(),\n        };\n        /**\n         * An array of sub cameras used in VR scenes.\n         * @see https://threejs.org/docs/#api/en/cameras/ArrayCamera\n         */\n        this.cameras = [];\n    }\n    RenderGraphPlugin.prototype.getDevice = function () {\n        return this.device;\n    };\n    RenderGraphPlugin.prototype.getSwapChain = function () {\n        return this.swapChain;\n    };\n    RenderGraphPlugin.prototype.getRenderLists = function () {\n        return this.renderLists;\n    };\n    RenderGraphPlugin.prototype.apply = function (context) {\n        var _this = this;\n        this.context = context;\n        var renderingService = context.renderingService, renderingContext = context.renderingContext, config = context.config;\n        var canvas = renderingContext.root.ownerDocument.defaultView;\n        config.disableRenderHooks = true;\n        var handleMounted = function (e) {\n            var object = e.target;\n            // collect lights\n            if (object.nodeName === Light.tag) {\n                _this.lightPool.addLight(object);\n                return;\n            }\n            else if (object.nodeName === Fog.tag) {\n                _this.lightPool.addFog(object);\n                return;\n            }\n            // @ts-ignore\n            if (!object.renderable3D) {\n                // @ts-ignore\n                object.renderable3D = new Renderable3D();\n            }\n            _this.batchManager.add(object);\n        };\n        var handleUnmounted = function (e) {\n            var _a, _b;\n            var object = e.target;\n            if (object.nodeName === Light.tag) {\n                _this.lightPool.removeLight(object);\n                return;\n            }\n            else if (object.nodeName === Fog.tag) {\n                _this.lightPool.removeFog(object);\n                return;\n            }\n            else if (object.nodeName === Shape.MESH) {\n                if ((_a = object.style.geometry) === null || _a === void 0 ? void 0 : _a.meshes) {\n                    var index = object.style.geometry.meshes.indexOf(object);\n                    if (index > -1) {\n                        object.style.geometry.meshes.splice(index, 1);\n                    }\n                }\n                if ((_b = object.style.material) === null || _b === void 0 ? void 0 : _b.meshes) {\n                    var index = object.style.material.meshes.indexOf(object);\n                    if (index > -1) {\n                        object.style.material.meshes.splice(index, 1);\n                    }\n                }\n            }\n            if (_this.swapChain) {\n                _this.batchManager.remove(object);\n            }\n            // @ts-ignore\n            delete object.renderable3D;\n            // entity.removeComponent(Geometry3D, true);\n            // entity.removeComponent(Material3D, true);\n            // entity.removeComponent(Renderable3D, true);\n        };\n        var handleAttributeChanged = function (e) {\n            if (_this.swapChain) {\n                var object = e.target;\n                var attrName = e.attrName, newValue = e.newValue;\n                if (attrName === 'zIndex') {\n                    object.parentNode.forEach(function (child) {\n                        _this.batchManager.changeRenderOrder(child, child.sortable.renderOrder);\n                    });\n                }\n                else {\n                    _this.batchManager.updateAttribute(object, attrName, newValue);\n                }\n            }\n        };\n        var handleBoundsChanged = function (e) {\n            if (_this.swapChain) {\n                var object = e.target;\n                _this.batchManager.updateAttribute(object, 'modelMatrix', null);\n            }\n        };\n        renderingService.hooks.initAsync.tapPromise(RenderGraphPlugin.tag, function () { return __awaiter(_this, void 0, void 0, function () {\n            var $canvas, _a, width, height, _b;\n            var _this = this;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n                        canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n                        canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n                        canvas.addEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n                        this.context.config.renderer.getConfig().enableDirtyRectangleRendering =\n                            false;\n                        $canvas = this.context.contextService.getDomElement();\n                        _a = this.context.config, width = _a.width, height = _a.height;\n                        this.context.contextService.resize(width, height);\n                        // create swap chain and get device\n                        // @ts-ignore\n                        _b = this;\n                        return [4 /*yield*/, this.context.deviceContribution.createSwapChain($canvas)];\n                    case 1:\n                        // create swap chain and get device\n                        // @ts-ignore\n                        _b.swapChain = _c.sent();\n                        this.device = this.swapChain.getDevice();\n                        this.renderHelper.setDevice(this.device);\n                        this.renderHelper.renderInstManager.disableSimpleMode();\n                        this.swapChain.configureSwapChain($canvas.width, $canvas.height);\n                        canvas.addEventListener(CanvasEvent.RESIZE, function () {\n                            _this.swapChain.configureSwapChain($canvas.width, $canvas.height);\n                        });\n                        this.batchManager.attach(__assign({ device: this.device }, context));\n                        return [2 /*return*/];\n                }\n            });\n        }); });\n        renderingService.hooks.destroy.tap(RenderGraphPlugin.tag, function () {\n            _this.renderHelper.destroy();\n            _this.batchManager.destroy();\n            _this.texturePool.destroy();\n            canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n            canvas.removeEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n            _this.device.destroy();\n            _this.device.checkForLeaks();\n            config.disableRenderHooks = false;\n        });\n        /**\n         * build frame graph at the beginning of each frame\n         */\n        renderingService.hooks.beginFrame.tap(RenderGraphPlugin.tag, function (frame) {\n            var _a;\n            var session = frame === null || frame === void 0 ? void 0 : frame.session;\n            var _b = _this.context.config, width = _b.width, height = _b.height;\n            if (session) {\n                // Assumed to be a XRWebGLLayer for now.\n                var layer_1 = session.renderState.baseLayer;\n                if (!layer_1) {\n                    layer_1 = session.renderState.layers[0];\n                }\n                _this.swapChain.configureSwapChain(layer_1.framebufferWidth, layer_1.framebufferHeight, layer_1.framebuffer);\n                // @ts-ignore\n                var referenceSpace = session.referenceSpace;\n                // Retrieve the pose of the device.\n                // XRFrame.getViewerPose can return null while the session attempts to establish tracking.\n                var pose = frame.getViewerPose(referenceSpace);\n                if (pose) {\n                    // In mobile AR, we only have one view.\n                    pose.views.forEach(function (view, i) {\n                        var viewport = session.renderState.baseLayer.getViewport(view);\n                        // @ts-ignore\n                        var cameraMatrix = mat4.fromValues.apply(mat4, __spreadArray([], __read(view.transform.matrix), false));\n                        cameraMatrix[12] *= width;\n                        cameraMatrix[13] *= height;\n                        cameraMatrix[14] *= 500;\n                        cameraMatrix[12] += width / 2;\n                        cameraMatrix[13] -= height / 2;\n                        cameraMatrix[14] += 500 / 2;\n                        // Use this matrix without modification or decomposition\n                        // @see https://immersive-web.github.io/webxr/#dom-xrview-projectionmatrix\n                        var projectionMatrix = mat4.fromValues.apply(mat4, __spreadArray([], __read(view.projectionMatrix), false));\n                        var viewMatrix = mat4.invert(mat4.create(), cameraMatrix);\n                        mat4.scale(viewMatrix, viewMatrix, vec3.fromValues(1, -1, 1));\n                        // @see https://github.com/immersive-web/webxr-samples/blob/main/js/render/core/renderer.js#L651\n                        var _a = view.transform.position, x = _a.x, y = _a.y, z = _a.z;\n                        _this.cameras[i] = {\n                            viewport: {\n                                x: viewport.x / layer_1.framebufferWidth,\n                                y: viewport.y / layer_1.framebufferHeight,\n                                width: viewport.width / layer_1.framebufferWidth,\n                                height: viewport.height / layer_1.framebufferHeight,\n                            },\n                            projectionMatrix: projectionMatrix,\n                            viewMatrix: viewMatrix,\n                            cameraPosition: [x, y, z],\n                            isOrtho: false,\n                        };\n                    });\n                }\n            }\n            else {\n                var camera = _this.context.camera;\n                _this.cameras = [\n                    {\n                        viewport: {\n                            x: 0,\n                            y: 0,\n                            width: 1,\n                            height: 1,\n                        },\n                        projectionMatrix: camera.getPerspective(),\n                        viewMatrix: camera.getViewTransform(),\n                        cameraPosition: camera.getPosition(),\n                        isOrtho: camera.isOrtho(),\n                    },\n                ];\n            }\n            var canvas = _this.swapChain.getCanvas();\n            var renderInstManager = _this.renderHelper.renderInstManager;\n            _this.builder = _this.renderHelper.renderGraph.newGraphBuilder();\n            var clearColor;\n            if (_this.context.config.background === 'transparent') {\n                clearColor = TransparentBlack;\n            }\n            else {\n                // use canvas.background\n                var backgroundColor = parseColor(_this.context.config.background);\n                clearColor = _this.context.config.background\n                    ? // use premultipliedAlpha\n                        // @see https://canvatechblog.com/alpha-blending-and-webgl-99feb392779e\n                        colorNewFromRGBA((Number(backgroundColor.r) / 255) *\n                            Number(backgroundColor.alpha), (Number(backgroundColor.g) / 255) *\n                            Number(backgroundColor.alpha), (Number(backgroundColor.b) / 255) *\n                            Number(backgroundColor.alpha), Number(backgroundColor.alpha))\n                    : TransparentWhite;\n            }\n            // retrieve at each frame since canvas may resize\n            var renderInput = {\n                backbufferWidth: canvas.width,\n                backbufferHeight: canvas.height,\n                antialiasingMode: AntialiasingMode.None,\n            };\n            // create main Color RT\n            var mainRenderDesc = makeBackbufferDescSimple(RGAttachmentSlot.Color0, renderInput, makeAttachmentClearDescriptor(clearColor));\n            // create main Depth RT\n            var mainDepthDesc = makeBackbufferDescSimple(RGAttachmentSlot.DepthStencil, renderInput, opaqueWhiteFullClearRenderPassDescriptor);\n            var mainColorTargetID = _this.builder.createRenderTargetID(mainRenderDesc, 'Main Color');\n            var mainDepthTargetID = _this.builder.createRenderTargetID(mainDepthDesc, 'Main Depth');\n            // main render pass\n            _this.builder.pushPass(function (pass) {\n                pass.setDebugName('Main Render Pass');\n                pass.attachRenderTargetID(RGAttachmentSlot.Color0, mainColorTargetID);\n                pass.attachRenderTargetID(RGAttachmentSlot.DepthStencil, mainDepthTargetID);\n                pass.exec(function (passRenderer, scope) {\n                    _this.cameras.forEach(function (_a, i) {\n                        var viewport = _a.viewport;\n                        var x = viewport.x, y = viewport.y, width = viewport.width, height = viewport.height;\n                        var _b = scope['currentPass'], viewportW = _b.viewportW, viewportH = _b.viewportH;\n                        // @see https://github.com/immersive-web/webxr-samples/blob/main/js/render/core/renderer.js#L757\n                        passRenderer.setViewport(x * viewportW, y * viewportH, width * viewportW, height * viewportH);\n                        (i === 0\n                            ? _this.renderLists.leftEye\n                            : _this.renderLists.rightEye).drawOnPassRenderer(renderInstManager.renderCache, passRenderer);\n                    });\n                });\n            });\n            // TODO: other post-processing passes\n            if ((_a = _this.options) === null || _a === void 0 ? void 0 : _a.enableFXAA) {\n                // FXAA\n                pushFXAAPass(_this.builder, _this.renderHelper, renderInput, mainColorTargetID);\n            }\n            // output to screen\n            _this.builder.resolveRenderTargetToExternalTexture(mainColorTargetID, _this.swapChain.getOnscreenTexture());\n        });\n        renderingService.hooks.endFrame.tap(RenderGraphPlugin.tag, function (frame) {\n            var renderInstManager = _this.renderHelper.renderInstManager;\n            var _a = _this.context.config, width = _a.width, height = _a.height;\n            _this.cameras.forEach(function (_a, i) {\n                var viewport = _a.viewport, cameraPosition = _a.cameraPosition, viewMatrix = _a.viewMatrix, projectionMatrix = _a.projectionMatrix, isOrtho = _a.isOrtho;\n                var normalizedW = viewport.width, normalizedH = viewport.height;\n                // Push our outer template, which contains the dynamic UBO bindings...\n                var template = _this.renderHelper.pushTemplateRenderInst();\n                // SceneParams: binding = 0, ObjectParams: binding = 1\n                template.setBindingLayout({ numUniformBuffers: 2, numSamplers: 0 });\n                template.setMegaStateFlags(setAttachmentStateSimple({\n                    depthWrite: true,\n                    blendConstant: TransparentBlack,\n                }, {\n                    rgbBlendMode: BlendMode.ADD,\n                    alphaBlendMode: BlendMode.ADD,\n                    rgbBlendSrcFactor: BlendFactor.SRC_ALPHA,\n                    alphaBlendSrcFactor: BlendFactor.ONE,\n                    rgbBlendDstFactor: BlendFactor.ONE_MINUS_SRC_ALPHA,\n                    alphaBlendDstFactor: BlendFactor.ONE_MINUS_SRC_ALPHA,\n                }));\n                template.setUniforms(SceneUniformBufferIndex, [\n                    {\n                        name: SceneUniform.PROJECTION_MATRIX,\n                        value: projectionMatrix,\n                    },\n                    {\n                        name: SceneUniform.VIEW_MATRIX,\n                        value: viewMatrix,\n                    },\n                    {\n                        name: SceneUniform.CAMERA_POSITION,\n                        value: cameraPosition,\n                    },\n                    {\n                        name: SceneUniform.DEVICE_PIXEL_RATIO,\n                        value: _this.context.contextService.getDPR(),\n                    },\n                    {\n                        name: SceneUniform.VIEWPORT,\n                        value: [width * normalizedW, height * normalizedH],\n                    },\n                    {\n                        name: SceneUniform.IS_ORTHO,\n                        value: isOrtho ? 1 : 0,\n                    },\n                    {\n                        name: SceneUniform.IS_PICKING,\n                        value: 0,\n                    },\n                ]);\n                _this.batchManager.render(i === 0 ? _this.renderLists.leftEye : _this.renderLists.rightEye);\n                renderInstManager.popTemplateRenderInst();\n            });\n            _this.renderHelper.prepareToRender();\n            _this.renderHelper.renderGraph.execute();\n            renderInstManager.resetRenderInsts();\n            // capture here since we don't preserve drawing buffer\n            if (_this.enableCapture && _this.resolveCapturePromise) {\n                var _b = _this.captureOptions, type = _b.type, encoderOptions = _b.encoderOptions;\n                var dataURL = _this.context.contextService.getDomElement().toDataURL(type, encoderOptions);\n                _this.resolveCapturePromise(dataURL);\n                _this.enableCapture = false;\n                _this.captureOptions = undefined;\n                _this.resolveCapturePromise = undefined;\n            }\n        });\n    };\n    /**\n     * load texture in an async way and render when loaded\n     */\n    RenderGraphPlugin.prototype.loadTexture = function (src, descriptor, successCallback) {\n        return this.texturePool.getOrCreateTexture(this.device, src, descriptor, function (t) {\n            if (successCallback) {\n                successCallback(t);\n            }\n        });\n    };\n    RenderGraphPlugin.prototype.toDataURL = function (options) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                // trigger re-render\n                this.enableCapture = true;\n                this.captureOptions = options;\n                this.capturePromise = new Promise(function (resolve) {\n                    _this.resolveCapturePromise = function (dataURL) {\n                        resolve(dataURL);\n                    };\n                });\n                return [2 /*return*/, this.capturePromise];\n            });\n        });\n    };\n    RenderGraphPlugin.tag = 'RenderGraph';\n    return RenderGraphPlugin;\n}());\n\n/**\n * max depth when doing multi-layer picking\n */\nvar MAX_PICKING_DEPTH = 100;\n/**\n * Use color-based picking in GPU\n */\nvar PickingPlugin = /** @class */ (function () {\n    function PickingPlugin(renderHelper, renderGraphPlugin, pickingIdGenerator, batchManager) {\n        this.renderHelper = renderHelper;\n        this.renderGraphPlugin = renderGraphPlugin;\n        this.pickingIdGenerator = pickingIdGenerator;\n        this.batchManager = batchManager;\n    }\n    PickingPlugin.prototype.apply = function (context) {\n        var _this = this;\n        this.context = context;\n        var renderingService = context.renderingService, renderingContext = context.renderingContext;\n        var canvas = renderingContext.root.ownerDocument.defaultView;\n        var handleMounted = function (e) {\n            var object = e.target;\n            // @ts-ignore\n            if (!object.renderable3D) {\n                // @ts-ignore\n                object.renderable3D = new Renderable3D();\n            }\n            // @ts-ignore\n            var renderable3D = object.renderable3D;\n            // generate picking id for later use\n            var pickingId = _this.pickingIdGenerator.getId(object);\n            renderable3D.pickingId = pickingId;\n            renderable3D.encodedPickingColor =\n                _this.pickingIdGenerator.encodePickingColor(pickingId);\n        };\n        var handleUnmounted = function (e) {\n            var object = e.target;\n            // @ts-ignore\n            var renderable3D = object.renderable3D;\n            if (renderable3D) {\n                _this.pickingIdGenerator.deleteById(renderable3D.pickingId);\n            }\n        };\n        renderingService.hooks.init.tap(PickingPlugin.tag, function () {\n            canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n        });\n        renderingService.hooks.destroy.tap(PickingPlugin.tag, function () {\n            canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            _this.pickingIdGenerator.reset();\n        });\n        /**\n         * Sync version is not implemented.\n         */\n        renderingService.hooks.pickSync.tap(PickingPlugin.tag, function (result) {\n            return _this.pick(result);\n        });\n        renderingService.hooks.pick.tapPromise(PickingPlugin.tag, function (result) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.pick(result)];\n            });\n        }); });\n    };\n    PickingPlugin.prototype.pick = function (result) {\n        var topmost = result.topmost, position = result.position;\n        // use viewportX/Y\n        var x = position.viewportX, y = position.viewportY;\n        var dpr = this.context.contextService.getDPR();\n        var width = this.context.config.width * dpr;\n        var height = this.context.config.height * dpr;\n        var xInDevicePixel = x * dpr;\n        var yInDevicePixel = y * dpr;\n        if (!this.renderHelper.renderGraph ||\n            xInDevicePixel > width ||\n            xInDevicePixel < 0 ||\n            yInDevicePixel > height ||\n            yInDevicePixel < 0) {\n            result.picked = [];\n            return result;\n        }\n        // implements multi-layer picking\n        // @see https://github.com/antvis/g/issues/948\n        var pickedDisplayObjects = this.pickByRectangleInDepth(new Rectangle(clamp(Math.round(xInDevicePixel), 0, width - 1), clamp(Math.round(yInDevicePixel), 0, height - 1), 1, 1), topmost ? 1 : MAX_PICKING_DEPTH);\n        result.picked = pickedDisplayObjects;\n        return result;\n    };\n    PickingPlugin.prototype.pickByRectangleInDepth = function (rect, depth) {\n        if (depth === void 0) { depth = MAX_PICKING_DEPTH; }\n        var picked = null;\n        var counter = 1;\n        var targets = [];\n        do {\n            picked = this.pickByRectangle(rect, picked);\n            if (picked) {\n                counter++;\n                targets.push(picked);\n            }\n            else {\n                break;\n            }\n        } while (picked && counter <= depth);\n        if (depth > 1) {\n            // restore encoded picking color\n            this.restorePickingColor(targets);\n        }\n        return targets;\n    };\n    PickingPlugin.prototype.restorePickingColor = function (displayObjects) {\n        var _this = this;\n        displayObjects.forEach(function (picked) {\n            _this.batchManager.updateAttribute(picked, 'pointerEvents', true, true);\n        });\n    };\n    /**\n     * return displayobjects in target rectangle\n     */\n    PickingPlugin.prototype.pickByRectangle = function (rect, picked) {\n        var _this = this;\n        var device = this.renderGraphPlugin.getDevice();\n        var renderLists = this.renderGraphPlugin.getRenderLists();\n        var renderInstManager = this.renderHelper.renderInstManager;\n        var builder = this.renderHelper.renderGraph.newGraphBuilder();\n        var clearColor = TransparentBlack;\n        var camera = this.context.camera;\n        // retrieve at each frame since canvas may resize\n        var x = rect.x, y = rect.y, width = rect.width, height = rect.height;\n        // use a small picking area(like 1x1) instead of a fullscreen rt\n        var renderInput = {\n            backbufferWidth: width,\n            backbufferHeight: height,\n            antialiasingMode: AntialiasingMode.None,\n        };\n        var mainPickingDesc = makeBackbufferDescSimple(RGAttachmentSlot.Color0, renderInput, makeAttachmentClearDescriptor(clearColor));\n        var pickingColorTargetID = builder.createRenderTargetID(mainPickingDesc, 'Picking Color');\n        // create main Depth RT\n        var mainDepthDesc = makeBackbufferDescSimple(RGAttachmentSlot.DepthStencil, renderInput, opaqueWhiteFullClearRenderPassDescriptor);\n        var mainDepthTargetID = builder.createRenderTargetID(mainDepthDesc, 'Picking Depth');\n        // account for current view offset\n        var currentView = __assign({}, camera.getView());\n        // prevent unused RTs like main color being destroyed\n        this.renderHelper.renderGraph.renderTargetDeadPool.forEach(function (rt) {\n            rt.age = -1;\n        });\n        // picking pass\n        var target;\n        builder.pushPass(function (pass) {\n            pass.setDebugName('Picking Pass');\n            pass.attachRenderTargetID(RGAttachmentSlot.Color0, pickingColorTargetID);\n            pass.attachRenderTargetID(RGAttachmentSlot.DepthStencil, mainDepthTargetID);\n            pass.exec(function (passRenderer) {\n                renderLists.picking.drawOnPassRenderer(renderInstManager.renderCache, passRenderer);\n            });\n            pass.post(function (scope) {\n                var texture = scope.getRenderTargetTexture(RGAttachmentSlot.Color0);\n                var readback = device.createReadback();\n                // restore previous view\n                if (currentView && currentView.enabled) {\n                    camera.setViewOffset(currentView.fullWidth, currentView.fullHeight, currentView.offsetX, currentView.offsetY, currentView.width, currentView.height);\n                }\n                else {\n                    camera.clearViewOffset();\n                }\n                camera.setEnableUpdate(true);\n                var pickedColors;\n                try {\n                    pickedColors = readback.readTextureSync(texture, 0, 0, width, height, new Uint8Array(width * height * 4));\n                }\n                catch (e) { }\n                var pickedFeatureIdx = -1;\n                if (pickedColors &&\n                    (pickedColors[0] !== 0 ||\n                        pickedColors[1] !== 0 ||\n                        pickedColors[2] !== 0)) {\n                    pickedFeatureIdx =\n                        _this.pickingIdGenerator.decodePickingColor(pickedColors);\n                }\n                if (pickedFeatureIdx > -1) {\n                    var pickedDisplayObject = _this.pickingIdGenerator.getById(pickedFeatureIdx);\n                    if (pickedDisplayObject &&\n                        pickedDisplayObject.isVisible() &&\n                        pickedDisplayObject.isInteractive()) {\n                        target = pickedDisplayObject;\n                    }\n                }\n                readback.destroy();\n            });\n        });\n        // Push our outer template, which contains the dynamic UBO bindings...\n        var template = this.renderHelper.pushTemplateRenderInst();\n        // SceneParams: binding = 0, ObjectParams: binding = 1\n        template.setBindingLayout({ numUniformBuffers: 2, numSamplers: 0 });\n        template.setMegaStateFlags(setAttachmentStateSimple({\n            depthWrite: true,\n        }, {\n            rgbBlendMode: BlendMode.ADD,\n            rgbBlendSrcFactor: BlendFactor.ONE,\n            rgbBlendDstFactor: BlendFactor.ZERO,\n            alphaBlendMode: BlendMode.ADD,\n            alphaBlendSrcFactor: BlendFactor.ONE,\n            alphaBlendDstFactor: BlendFactor.ZERO,\n        }));\n        // Update Scene Params\n        var _a = this.context.config, canvasWidth = _a.width, canvasHeight = _a.height;\n        var dpr = this.context.contextService.getDPR();\n        camera.setEnableUpdate(false);\n        camera.setViewOffset(canvasWidth * dpr, canvasHeight * dpr, x, y, width, height);\n        template.setUniforms(SceneUniformBufferIndex, [\n            {\n                name: SceneUniform.PROJECTION_MATRIX,\n                value: camera.getPerspective(),\n            },\n            {\n                name: SceneUniform.VIEW_MATRIX,\n                value: camera.getViewTransform(),\n            },\n            {\n                name: SceneUniform.CAMERA_POSITION,\n                value: camera.getPosition(),\n            },\n            {\n                name: SceneUniform.DEVICE_PIXEL_RATIO,\n                value: this.context.contextService.getDPR(),\n            },\n            {\n                name: SceneUniform.VIEWPORT,\n                value: [width, height],\n            },\n            {\n                name: SceneUniform.IS_ORTHO,\n                value: camera.isOrtho() ? 1 : 0,\n            },\n            {\n                name: SceneUniform.IS_PICKING,\n                value: 1,\n            },\n        ]);\n        if (picked) {\n            this.batchManager.updateAttribute(picked, 'pointerEvents', false, true);\n        }\n        this.batchManager.render(renderLists.picking, true);\n        renderInstManager.popTemplateRenderInst();\n        this.renderHelper.prepareToRender();\n        this.renderHelper.renderGraph.execute();\n        renderInstManager.resetRenderInsts();\n        return target;\n    };\n    PickingPlugin.tag = 'WebGLPicker';\n    return PickingPlugin;\n}());\n\n/**\n * render order start from 0, our default camera's Z is 500\n */\nvar RENDER_ORDER_SCALE = 500 / 1000000;\n/**\n * A container for multiple display objects with the same `style`,\n * eg. 1000 Circles with the same stroke color, but their position, radius can be different\n */\nvar Batch = /** @class */ (function () {\n    function Batch() {\n        this.clipPathMeshCreated = false;\n        // private findClipPath(): DisplayObject | null {\n        //   let node = this.instance;\n        //   while (node && node.style) {\n        //     if (node.style.clipPath) {\n        //       return node.style.clipPath;\n        //     }\n        //     node = node.parentNode as DisplayObject;\n        //   }\n        //   return null;\n        // }\n        // private applyClipPath() {\n        //   // find clipPath\n        //   const clipPathShape = this.findClipPath();\n        //   if (clipPathShape && !this.clipPathMeshCreated) {\n        //     if (this.batchMeshList.length === 0) {\n        //       return;\n        //     }\n        //     const clipPathMesh = this.meshFactory(clipPathShape.nodeName);\n        //     clipPathMesh.clipPathTarget = this.instance;\n        //     // draw clipPath first\n        //     this.batchMeshList.unshift(clipPathMesh);\n        //     this.clipPathMeshCreated = true;\n        //     this.batchMeshList.forEach((mesh, i) => {\n        //       mesh.clipPath = clipPathShape;\n        //       if (!mesh.material) {\n        //         mesh.material = new ShaderMaterial(this.device);\n        //       }\n        //       mesh.material.stencilRef = this.batchManager.getStencilRef(clipPathShape);\n        //     });\n        //   }\n        //   // remove clipPath from render queue\n        //   if (!clipPathShape) {\n        //     if (this.batchMeshList.length && this.batchMeshList[0].clipPathTarget) {\n        //       this.batchMeshList.shift();\n        //     }\n        //   }\n        // }\n    }\n    Batch.prototype.beforeUploadUBO = function (renderInst, mesh) { };\n    Batch.prototype.beforeInitMesh = function (mesh) { };\n    Batch.prototype.afterInitMesh = function (mesh) { };\n    return Batch;\n}());\n\nfunction isTexture(t) {\n    return !!(t && t.type);\n}\nvar MaterialEvent;\n(function (MaterialEvent) {\n    MaterialEvent[\"CHANGED\"] = \"changed\";\n})(MaterialEvent || (MaterialEvent = {}));\n/**\n * an encapsulation on top of shaders\n * @see https://doc.babylonjs.com/divingDeeper/materials/using/materials_introduction\n */\nvar Material = /** @class */ (function (_super) {\n    __extends(Material, _super);\n    function Material(device, props) {\n        var _this = _super.call(this) || this;\n        _this.props = {};\n        /**\n         * relative meshes\n         */\n        _this.meshes = [];\n        // USE_XXX\n        _this.defines = {};\n        _this.uniforms = {};\n        _this.uboBuffer = [];\n        _this.textures = {};\n        _this.samplers = [];\n        /**\n         * need re-compiling like vs/fs changed\n         */\n        _this.programDirty = true;\n        /**\n         * need re-upload textures\n         */\n        _this.textureDirty = true;\n        /**\n         * inform geometry to rebuild, eg. wireframe\n         */\n        _this.geometryDirty = true;\n        var _a = copyMegaState(defaultMegaState), cullMode = _a.cullMode, depthCompare = _a.depthCompare, depthWrite = _a.depthWrite, stencilFront = _a.stencilFront, stencilBack = _a.stencilBack, stencilWrite = _a.stencilWrite, frontFace = _a.frontFace, polygonOffset = _a.polygonOffset, attachmentsState = _a.attachmentsState;\n        _this.device = device;\n        // @ts-ignore\n        _this.props = __assign({ cullMode: cullMode, depthTest: true, depthCompare: depthCompare, depthWrite: depthWrite, stencilFront: stencilFront, stencilBack: stencilBack, stencilWrite: stencilWrite, frontFace: frontFace, polygonOffset: polygonOffset, attachmentsState: attachmentsState, dithering: false, wireframe: false, wireframeColor: 'black', wireframeLineWidth: 1, vertexShader: '', fragmentShader: '' }, props);\n        _this.compile();\n        return _this;\n    }\n    Object.defineProperty(Material.prototype, \"cullMode\", {\n        /**\n         * cullFace\n         */\n        get: function () {\n            return this.props.cullMode;\n        },\n        set: function (value) {\n            this.props.cullMode = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"frontFace\", {\n        get: function () {\n            return this.props.frontFace;\n        },\n        set: function (value) {\n            this.props.frontFace = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"blendConstant\", {\n        /**\n         * Blending state\n         */\n        get: function () {\n            return this.props.blendConstant;\n        },\n        set: function (value) {\n            this.props.blendConstant = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"blendEquation\", {\n        get: function () {\n            return this.props.blendEquation;\n        },\n        set: function (value) {\n            this.props.blendEquation = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"blendEquationAlpha\", {\n        get: function () {\n            return this.props.blendEquationAlpha;\n        },\n        set: function (value) {\n            this.props.blendEquationAlpha = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"blendSrc\", {\n        get: function () {\n            return this.props.blendSrc;\n        },\n        set: function (value) {\n            this.props.blendSrc = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"blendDst\", {\n        get: function () {\n            return this.props.blendDst;\n        },\n        set: function (value) {\n            this.props.blendDst = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"blendSrcAlpha\", {\n        get: function () {\n            return this.props.blendSrcAlpha;\n        },\n        set: function (value) {\n            this.props.blendSrcAlpha = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"blendDstAlpha\", {\n        get: function () {\n            return this.props.blendDstAlpha;\n        },\n        set: function (value) {\n            this.props.blendDstAlpha = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"depthCompare\", {\n        get: function () {\n            return this.props.depthCompare;\n        },\n        set: function (value) {\n            this.props.depthCompare = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"depthTest\", {\n        get: function () {\n            return this.props.depthTest;\n        },\n        set: function (value) {\n            this.props.depthTest = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"depthWrite\", {\n        get: function () {\n            return this.props.depthWrite;\n        },\n        set: function (value) {\n            this.props.depthWrite = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"stencilFront\", {\n        get: function () {\n            return this.props.stencilFront;\n        },\n        set: function (value) {\n            this.props.stencilFront = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"stencilBack\", {\n        get: function () {\n            return this.props.stencilBack;\n        },\n        set: function (value) {\n            this.props.stencilBack = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"stencilWrite\", {\n        get: function () {\n            return this.props.stencilWrite;\n        },\n        set: function (value) {\n            this.props.stencilWrite = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"stencilRef\", {\n        get: function () {\n            return this.props.stencilRef;\n        },\n        set: function (value) {\n            this.props.stencilRef = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"polygonOffset\", {\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/WebGLRenderingContext/polygonOffset\n        get: function () {\n            return this.props.polygonOffset;\n        },\n        set: function (value) {\n            this.props.polygonOffset = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"dithering\", {\n        // gl.DITHER\n        get: function () {\n            return this.props.dithering;\n        },\n        set: function (value) {\n            this.props.dithering = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"wireframe\", {\n        // @see https://doc.babylonjs.com/divingDeeper/materials/using/materials_introduction#wireframe\n        get: function () {\n            return this.props.wireframe;\n        },\n        set: function (value) {\n            if (this.props.wireframe !== value) {\n                // need re-generate geometry\n                this.geometryDirty = true;\n                this.programDirty = true;\n                this.props.wireframe = value;\n                this.dispatchMutationEvent();\n            }\n            this.defines.USE_WIREFRAME = !!value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"wireframeColor\", {\n        get: function () {\n            return this.props.wireframeColor;\n        },\n        set: function (value) {\n            this.props.wireframeColor = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"wireframeLineWidth\", {\n        get: function () {\n            return this.props.wireframeLineWidth;\n        },\n        set: function (value) {\n            this.props.wireframeLineWidth = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"vertexShader\", {\n        // shader pairs\n        get: function () {\n            return this.props.vertexShader;\n        },\n        set: function (value) {\n            if (this.props.vertexShader !== value) {\n                this.programDirty = true;\n                this.props.vertexShader = value;\n                this.compile();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Material.prototype, \"fragmentShader\", {\n        get: function () {\n            return this.props.fragmentShader;\n        },\n        set: function (value) {\n            if (this.props.fragmentShader !== value) {\n                this.programDirty = true;\n                this.props.fragmentShader = value;\n                this.compile();\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Material.prototype.compile = function () {\n        var _this = this;\n        // uniform sampler2D u_Texture0;\n        this.props.fragmentShader.replace(/^\\s*uniform\\s*sampler2D\\s*(.*)\\s*;$/gm, function (_, name) {\n            _this.samplers.push(name);\n            return '';\n        });\n        /**\n         * extract from uniform buffer object, should account for struct & pre-defines, eg.\n         * layout(std140) uniform ub_ObjectParams {\n         *   mat4 u_ModelMatrix;\n         *   vec4 u_Color;\n         *   vec4 u_StrokeColor;\n         *   #ifdef NUM_DIR_LIGHTS\n         *     DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n         *   #endif\n         * }\n         */\n        this.uniformNames = getUniforms(this.props.fragmentShader);\n    };\n    /**\n     * @example\n     * material.setUniforms({\n     *   u_ModelMatrix: [1, 2, 3, 4],\n     *   u_Time: 1,\n     *   u_Map: texture,\n     * })\n     */\n    Material.prototype.setUniforms = function (uniforms) {\n        var _this = this;\n        var shoudDispatchMutationEvent = false;\n        Object.keys(uniforms).forEach(function (key) {\n            var value = uniforms[key];\n            var existedTexture = _this.textures[key];\n            if (existedTexture && existedTexture !== value) {\n                // existedTexture.destroy();\n                _this.textureDirty = true;\n            }\n            if (isTexture(value)) {\n                _this.textures[key] = value;\n                _this.textureDirty = true;\n                value.on(TextureEvent.LOADED, function () {\n                    _this.dispatchMutationEvent();\n                });\n            }\n            else {\n                _this.uniforms[key] = value;\n                shoudDispatchMutationEvent = true;\n            }\n            if (isNil(uniforms[key])) {\n                delete _this.textures[key];\n                delete _this.uniforms[key];\n            }\n        });\n        if (shoudDispatchMutationEvent) {\n            this.dispatchMutationEvent();\n        }\n    };\n    Material.prototype.dispatchMutationEvent = function () {\n        this.emit(MaterialEvent.CHANGED);\n    };\n    return Material;\n}(EventEmitter));\n\nvar ShaderMaterial = /** @class */ (function (_super) {\n    __extends(ShaderMaterial, _super);\n    function ShaderMaterial(device, props) {\n        var _this = _super.call(this, device, __assign({}, props)) || this;\n        _this.defines = __assign(__assign({}, _this.defines), { USE_UV: false, USE_MAP: false, USE_WIREFRAME: false, USE_FOG: false, USE_LIGHT: false });\n        return _this;\n    }\n    return ShaderMaterial;\n}(Material));\n\nfunction enumToObject(enumObject) {\n    var result = {};\n    Object.keys(enumObject).forEach(function (key) {\n        if (typeof enumObject[key] === 'number') {\n            result[key] = enumObject[key];\n        }\n    });\n    return result;\n}\nfunction compareDefines(d1, d2) {\n    var d1Keys = Object.keys(d1);\n    var d2Keys = Object.keys(d2);\n    if (d1Keys.length !== d2Keys.length) {\n        return false;\n    }\n    return d1Keys.every(function (key) { return d1[key] === d2[key]; });\n}\nvar definedProps = function (obj) {\n    return Object.fromEntries(Object.entries(obj).filter(function (_a) {\n        var _b = __read(_a, 2); _b[0]; var v = _b[1];\n        return v !== undefined;\n    }));\n};\n\nfunction packUint8ToFloat(a, b) {\n    a = clamp(Math.floor(a), 0, 255);\n    b = clamp(Math.floor(b), 0, 255);\n    return 256 * a + b;\n}\n\nvar counter = 1;\nvar FILL_TEXTURE_MAPPING = 'FillTextureMapping';\n/**\n * WebGPU has max vertex attribute num(8)\n */\nvar VertexAttributeBufferIndex;\n(function (VertexAttributeBufferIndex) {\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"MODEL_MATRIX\"] = 0] = \"MODEL_MATRIX\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"PACKED_COLOR\"] = 1] = \"PACKED_COLOR\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"PACKED_STYLE\"] = 2] = \"PACKED_STYLE\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"PICKING_COLOR\"] = 3] = \"PICKING_COLOR\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"POSITION\"] = 4] = \"POSITION\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"NORMAL\"] = 5] = \"NORMAL\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"UV\"] = 6] = \"UV\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"BARYCENTRIC\"] = 7] = \"BARYCENTRIC\";\n    VertexAttributeBufferIndex[VertexAttributeBufferIndex[\"MAX\"] = 8] = \"MAX\";\n})(VertexAttributeBufferIndex || (VertexAttributeBufferIndex = {}));\n/**\n * GL.MAX_VERTEX_ATTRIBS\n */\nvar VertexAttributeLocation;\n(function (VertexAttributeLocation) {\n    // TODO: bind mat4 in WebGL2 instead of decomposed 4 * vec4?\n    // @see https://stackoverflow.com/questions/38853096/webgl-how-to-bind-values-to-a-mat4-attribute/38853623#38853623\n    VertexAttributeLocation[VertexAttributeLocation[\"MODEL_MATRIX0\"] = 0] = \"MODEL_MATRIX0\";\n    VertexAttributeLocation[VertexAttributeLocation[\"MODEL_MATRIX1\"] = 1] = \"MODEL_MATRIX1\";\n    VertexAttributeLocation[VertexAttributeLocation[\"MODEL_MATRIX2\"] = 2] = \"MODEL_MATRIX2\";\n    VertexAttributeLocation[VertexAttributeLocation[\"MODEL_MATRIX3\"] = 3] = \"MODEL_MATRIX3\";\n    VertexAttributeLocation[VertexAttributeLocation[\"PACKED_COLOR\"] = 4] = \"PACKED_COLOR\";\n    VertexAttributeLocation[VertexAttributeLocation[\"PACKED_STYLE1\"] = 5] = \"PACKED_STYLE1\";\n    VertexAttributeLocation[VertexAttributeLocation[\"PACKED_STYLE2\"] = 6] = \"PACKED_STYLE2\";\n    VertexAttributeLocation[VertexAttributeLocation[\"PICKING_COLOR\"] = 7] = \"PICKING_COLOR\";\n    VertexAttributeLocation[VertexAttributeLocation[\"POSITION\"] = 8] = \"POSITION\";\n    VertexAttributeLocation[VertexAttributeLocation[\"NORMAL\"] = 9] = \"NORMAL\";\n    VertexAttributeLocation[VertexAttributeLocation[\"UV\"] = 10] = \"UV\";\n    VertexAttributeLocation[VertexAttributeLocation[\"BARYCENTRIC\"] = 11] = \"BARYCENTRIC\";\n    VertexAttributeLocation[VertexAttributeLocation[\"MAX\"] = 12] = \"MAX\";\n})(VertexAttributeLocation || (VertexAttributeLocation = {}));\n/**\n * Draw call.\n */\nvar Instanced = /** @class */ (function () {\n    function Instanced(renderHelper, texturePool, lightPool, object, \n    /**\n     * All drawcall constructors.\n     */\n    drawcallCtors, \n    /**\n     * index in renderer.meshes\n     */\n    index, context) {\n        if (index === void 0) { index = -1; }\n        this.renderHelper = renderHelper;\n        this.texturePool = texturePool;\n        this.lightPool = lightPool;\n        this.drawcallCtors = drawcallCtors;\n        this.index = index;\n        this.context = context;\n        /**\n         * unique ID\n         */\n        this.id = counter++;\n        /**\n         * attribute name used for gradient or pattern\n         */\n        this.gradientAttributeName = 'fill';\n        /**\n         * instances\n         */\n        this.objects = [];\n        this.program = new DeviceProgram();\n        this.geometryDirty = true;\n        /**\n         * the same material maybe shared between different canvases\n         */\n        this.materialDirty = true;\n        /**\n         * texture mappings\n         */\n        this.textureMappings = [];\n        /**\n         * Divisor of instanced array.\n         */\n        this.divisor = 1;\n        /**\n         * Account for anchor and merge it into modelMatrix.\n         */\n        this.mergeXYZIntoModelMatrix = false;\n        this.checkNodeName = true;\n        /**\n         * Create a new batch if the number of instances exceeds.\n         */\n        this.maxInstances = Infinity;\n        this.inited = false;\n    }\n    Object.defineProperty(Instanced.prototype, \"instance\", {\n        get: function () {\n            return this.objects[0];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Instanced.prototype.init = function () {\n        if (this.inited) {\n            return;\n        }\n        this.renderer.beforeInitMesh(this);\n        this.material = new ShaderMaterial(this.context.device);\n        this.material.defines = __assign(__assign({}, enumToObject(VertexAttributeLocation)), this.material.defines);\n        this.geometry = new BufferGeometry(this.context.device);\n        // make refs so that we can trigger MutationEvent on every object\n        this.geometry.meshes = this.objects;\n        this.material.meshes = this.objects;\n        this.observeGeometryChanged();\n        this.observeMaterialChanged();\n        this.inited = true;\n        this.renderer.afterInitMesh(this);\n    };\n    Instanced.prototype.observeGeometryChanged = function () {\n        var _this = this;\n        this.geometry.on(GeometryEvent.CHANGED, function () {\n            _this.geometry.meshes.forEach(function (mesh) {\n                mesh.renderable.dirty = true;\n            });\n            _this.context.renderingService.dirtify();\n        });\n    };\n    Instanced.prototype.observeMaterialChanged = function () {\n        var _this = this;\n        this.material.on(MaterialEvent.CHANGED, function () {\n            _this.material.meshes.forEach(function (mesh) {\n                mesh.renderable.dirty = true;\n            });\n            _this.context.renderingService.dirtify();\n        });\n    };\n    Instanced.prototype.shouldMergeColor = function (o1, o2, name) {\n        // c1: CSSRGB | CSSGradientValue[] | Pattern, c2: CSSRGB | CSSGradientValue[] | Pattern\n        // can't be merged if gradients & pattern used\n        var source = o1.parsedStyle[name];\n        var target = o2.parsedStyle[name];\n        if (!source && !target) {\n            return true;\n        }\n        // constant color value\n        if (isCSSRGB(source) && isCSSRGB(target)) {\n            return true;\n        }\n        // pattern\n        if (isPattern(source) &&\n            isPattern(target) &&\n            source.image === target.image) {\n            return true;\n        }\n        // gradients\n        if (Array.isArray(source) &&\n            Array.isArray(target) &&\n            o1.style[name] === o2.style[name]) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * should be merged into current InstancedMesh\n     */\n    Instanced.prototype.shouldMerge = function (object, index) {\n        if (!this.instance) {\n            return true;\n        }\n        // Path / Polyline could be rendered as Line\n        if (this.checkNodeName && this.instance.nodeName !== object.nodeName) {\n            return false;\n        }\n        // can't be merged when using clipPath\n        if (object.parsedStyle.clipPath) {\n            return false;\n        }\n        if (!this.shouldMergeColor(this.instance, object, 'fill') ||\n            !this.shouldMergeColor(this.instance, object, 'stroke')) {\n            return false;\n        }\n        return true;\n    };\n    Instanced.prototype.createGeometry = function (objects) {\n        var _this = this;\n        var _a, _b;\n        var modelMatrix = mat4.create();\n        var modelViewMatrix = mat4.create();\n        // const normalMatrix = mat3.create();\n        var packedModelMatrix = [];\n        var packedFillStroke = [];\n        var packedStyle = [];\n        var packedPicking = [];\n        var divisor = this.divisor;\n        var anchorOffset = ((_a = objects[0]) === null || _a === void 0 ? void 0 : _a.nodeName) === Shape.CIRCLE ||\n            ((_b = objects[0]) === null || _b === void 0 ? void 0 : _b.nodeName) === Shape.ELLIPSE\n            ? 0.5\n            : 0;\n        // const useNormal = this.material.defines.NORMAL;\n        objects.forEach(function (object) {\n            var _a;\n            var _b = object.parsedStyle, fill = _b.fill, stroke = _b.stroke, _c = _b.opacity, opacity = _c === void 0 ? 1 : _c, _d = _b.fillOpacity, fillOpacity = _d === void 0 ? 1 : _d, _e = _b.strokeOpacity, strokeOpacity = _e === void 0 ? 1 : _e, _f = _b.lineWidth, lineWidth = _f === void 0 ? 1 : _f, visibility = _b.visibility, _g = _b.increasedLineWidthForHitTesting, increasedLineWidthForHitTesting = _g === void 0 ? 0 : _g;\n            var fillColor = [0, 0, 0, 0];\n            if (isCSSRGB(fill)) {\n                fillColor = [\n                    Number(fill.r),\n                    Number(fill.g),\n                    Number(fill.b),\n                    Number(fill.alpha) * 255,\n                ];\n            }\n            var strokeColor = [0, 0, 0, 0];\n            if (isCSSRGB(stroke)) {\n                strokeColor = [\n                    Number(stroke.r),\n                    Number(stroke.g),\n                    Number(stroke.b),\n                    Number(stroke.alpha) * 255,\n                ];\n            }\n            // if (this.clipPathTarget) {\n            //   // account for target's rts\n            //   mat4.copy(modelMatrix, object.getLocalTransform());\n            //   fillColor = [255, 255, 255, 255];\n            //   mat4.mul(\n            //     modelMatrix,\n            //     this.clipPathTarget.getWorldTransform(),\n            //     modelMatrix,\n            //   );\n            // } else {\n            //   mat4.copy(modelMatrix, object.getWorldTransform());\n            // }\n            mat4.mul(modelViewMatrix, _this.context.camera.getViewTransform(), modelMatrix);\n            var encodedPickingColor = (object.isInteractive() &&\n                (\n                // @ts-ignore\n                (_a = object.renderable3D) === null || _a === void 0 ? void 0 : _a.encodedPickingColor)) || [0, 0, 0];\n            if (_this.mergeXYZIntoModelMatrix) {\n                var _h = object.parsedStyle, x = _h.x, y = _h.y, z = _h.z;\n                mat4.mul(modelMatrix, object.getWorldTransform(), // apply anchor\n                mat4.fromTranslation(modelMatrix, vec3.fromValues(x, y, z)));\n            }\n            else {\n                mat4.copy(modelMatrix, object.getWorldTransform());\n            }\n            packedModelMatrix.push.apply(packedModelMatrix, __spreadArray([], __read(modelMatrix), false));\n            packedFillStroke.push(packUint8ToFloat(fillColor[0], fillColor[1]), packUint8ToFloat(fillColor[2], fillColor[3]), packUint8ToFloat(strokeColor[0], strokeColor[1]), packUint8ToFloat(strokeColor[2], strokeColor[3]));\n            packedStyle.push(opacity, fillOpacity, strokeOpacity, lineWidth, visibility !== 'hidden' ? 1 : 0, anchorOffset, anchorOffset, increasedLineWidthForHitTesting);\n            packedPicking.push.apply(packedPicking, __spreadArray(__spreadArray([], __read(encodedPickingColor), false), [object.sortable.renderOrder * RENDER_ORDER_SCALE], false));\n            // if (useNormal) {\n            //   // should not calc normal matrix in shader, mat3.invert is not cheap\n            //   // @see https://stackoverflow.com/a/21079741\n            //   mat3.fromMat4(normalMatrix, modelViewMatrix);\n            //   mat3.invert(normalMatrix, normalMatrix);\n            //   mat3.transpose(normalMatrix, normalMatrix);\n            //   const { NORMAL_MATRIX0, NORMAL_MATRIX1, NORMAL_MATRIX2 } = this.material.defines;\n            //   this.bufferGeometry.setVertexBuffer({\n            //     bufferIndex: 4,\n            //     byteStride: 4 * (3 * 3),\n            //     stepMode: VertexStepMode.INSTANCE,\n            //     attributes: [\n            //       {\n            //         format: Format.F32_RGB,\n            //         bufferByteOffset: 4 * 0,\n            //         location: Number(NORMAL_MATRIX0),\n            //         divisor\n            //       },\n            //       {\n            //         format: Format.F32_RGB,\n            //         bufferByteOffset: 4 * 3,\n            //         location: Number(NORMAL_MATRIX1),\n            //         divisor\n            //       },\n            //       {\n            //         format: Format.F32_RGB,\n            //         bufferByteOffset: 4 * 6,\n            //         location: Number(NORMAL_MATRIX2),\n            //         divisor\n            //       },\n            //     ],\n            //     data: new Float32Array(normalMatrix),\n            //   });\n            // }\n        });\n        this.geometry.instancedCount = objects.length;\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.MODEL_MATRIX,\n            byteStride: 4 * (4 * 4),\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.MODEL_MATRIX0,\n                    divisor: divisor,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 4,\n                    location: VertexAttributeLocation.MODEL_MATRIX1,\n                    divisor: divisor,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 8,\n                    location: VertexAttributeLocation.MODEL_MATRIX2,\n                    divisor: divisor,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 12,\n                    location: VertexAttributeLocation.MODEL_MATRIX3,\n                    divisor: divisor,\n                },\n            ],\n            data: new Float32Array(packedModelMatrix),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.PACKED_COLOR,\n            byteStride: 4 * 4,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.PACKED_COLOR,\n                    divisor: divisor,\n                },\n            ],\n            data: new Float32Array(packedFillStroke),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.PACKED_STYLE,\n            byteStride: 4 * 8,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.PACKED_STYLE1,\n                    divisor: divisor,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 4,\n                    location: VertexAttributeLocation.PACKED_STYLE2,\n                    divisor: divisor,\n                },\n            ],\n            data: new Float32Array(packedStyle),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.PICKING_COLOR,\n            byteStride: 4 * 4,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.PICKING_COLOR,\n                    divisor: divisor,\n                },\n            ],\n            data: new Float32Array(packedPicking),\n        });\n    };\n    Instanced.prototype.destroy = function () {\n        if (this.geometry) {\n            this.geometry.destroy();\n        }\n        // if (this.textureMappings) {\n        //   this.textureMappings.forEach((mapping) => {\n        //     mapping.texture.destroy();\n        //   });\n        //   this.textureMappings = [];\n        // }\n    };\n    Instanced.prototype.applyRenderInst = function (renderInst, objects) {\n        var _this = this;\n        // detect if scene changed, eg. lights & fog\n        var fog = this.lightPool.getFog();\n        var useFog = !!fog;\n        if (this.clipPathTarget || this.clipPath) {\n            if (this.clipPathTarget) {\n                this.material.stencilWrite = true;\n                // @see https://open.gl/depthstencils\n                this.material.depthWrite = false;\n                this.material.stencilFront = {\n                    compare: CompareFunction.ALWAYS,\n                    passOp: StencilOp.REPLACE,\n                };\n                this.material.stencilBack = {\n                    compare: CompareFunction.ALWAYS,\n                    passOp: StencilOp.REPLACE,\n                };\n            }\n            else {\n                this.material.stencilWrite = false;\n                this.material.depthWrite = true;\n                this.material.stencilFront = {\n                    compare: CompareFunction.EQUAL,\n                    passOp: StencilOp.KEEP,\n                };\n                this.material.stencilBack = {\n                    compare: CompareFunction.EQUAL,\n                    passOp: StencilOp.KEEP,\n                };\n            }\n        }\n        else {\n            this.material.stencilWrite = false;\n        }\n        if (this.materialDirty || this.material.programDirty) {\n            this.createMaterial(objects);\n        }\n        var oldDefines = __assign({}, this.material.defines);\n        this.material.defines.USE_FOG = useFog;\n        this.material.defines = __assign(__assign(__assign({}, this.lightPool.getDefines()), this.material.defines), this.renderHelper.getDefines());\n        // re-upload textures\n        if (this.material.textureDirty) {\n            this.textureMappings = [];\n            // set texture mappings\n            var fillTextureMapping = this.createFillGradientTextureMapping(objects);\n            if (fillTextureMapping) {\n                this.textureMappings.push(fillTextureMapping);\n            }\n            Object.keys(this.material.textures)\n                .sort(function (a, b) {\n                return _this.material.samplers.indexOf(a) -\n                    _this.material.samplers.indexOf(b);\n            })\n                .forEach(function (key) {\n                var mapping = new TextureMapping();\n                mapping.name = key;\n                mapping.texture = _this.material.textures[key];\n                _this.context.device.setResourceName(mapping.texture, 'Material Texture ' + key);\n                mapping.sampler = _this.renderHelper.getCache().createSampler({\n                    addressModeU: AddressMode.CLAMP_TO_EDGE,\n                    addressModeV: AddressMode.CLAMP_TO_EDGE,\n                    minFilter: FilterMode.POINT,\n                    magFilter: FilterMode.BILINEAR,\n                    mipmapFilter: MipmapFilterMode.LINEAR,\n                    lodMinClamp: 0,\n                    lodMaxClamp: 0,\n                });\n                _this.textureMappings.push(mapping);\n            });\n            if (this.textureMappings.length) {\n                this.material.defines.USE_UV = true;\n                this.material.defines.USE_MAP = true;\n            }\n            else {\n                this.material.defines.USE_UV = false;\n                this.material.defines.USE_MAP = false;\n            }\n            this.material.textureDirty = false;\n        }\n        var needRecompileProgram = !compareDefines(oldDefines, this.material.defines);\n        // re-compile program, eg. DEFINE changed\n        if (needRecompileProgram ||\n            this.material.programDirty ||\n            this.materialDirty) {\n            // set defines\n            this.material.defines = __assign(__assign({}, this.material.defines), enumToObject(VertexAttributeLocation));\n            Object.keys(this.material.defines).forEach(function (key) {\n                var value = _this.material.defines[key];\n                if (typeof value === 'boolean') {\n                    _this.program.setDefineBool(key, value);\n                }\n                else {\n                    _this.program.setDefineString(key, \"\".concat(value));\n                }\n            });\n            // build shaders\n            this.program.vert = this.material.vertexShader;\n            this.program.frag = this.material.fragmentShader;\n            this.material.programDirty = false;\n            this.materialDirty = false;\n        }\n        if (this.material.geometryDirty) {\n            // wireframe 需要额外生成 geometry 重心坐标\n            this.geometryDirty = true;\n            this.material.geometryDirty = false;\n        }\n        if (this.geometryDirty || this.geometry.dirty) {\n            // destroy first\n            if (this.geometry) {\n                this.geometry.destroy();\n            }\n            // re-create buffer geometry\n            this.createGeometry(objects);\n            // generate wireframe\n            if (this.material.wireframe) {\n                this.generateWireframe(this.geometry);\n            }\n            // sync to internal Geometry\n            this.geometryDirty = false;\n            this.geometry.dirty = false;\n        }\n        // cached input layout\n        var program = this.renderHelper\n            .getCache()\n            .createProgramSimple(this.program);\n        var inputLayout = this.renderHelper.getCache().createInputLayout(__assign(__assign({}, this.geometry.inputLayoutDescriptor), { program: program }));\n        var useIndexes = !!this.geometry.indexBuffer;\n        renderInst.renderPipelineDescriptor.topology = this.geometry.drawMode;\n        renderInst.setProgram(program);\n        renderInst.setVertexInput(inputLayout, this.geometry.vertexBuffers\n            .filter(function (b) { return !!b; })\n            .map(function (buffer) { return ({\n            buffer: buffer,\n            byteOffset: 0,\n        }); }), useIndexes ? { buffer: this.geometry.indexBuffer, offset: 0 } : null);\n        this.renderer.beforeUploadUBO(renderInst, this);\n        // upload uniform buffer object\n        this.uploadUBO(renderInst);\n        if (useIndexes) {\n            // drawElements\n            renderInst.drawIndexesInstanced(this.geometry.vertexCount, this.geometry.instancedCount, this.geometry.indexStart);\n        }\n        else {\n            // drawArrays\n            renderInst.drawPrimitives(this.geometry.vertexCount, this.geometry.primitiveStart);\n        }\n        // FIXME: 暂时都当作非透明物体，按照创建顺序排序\n        renderInst.sortKey = makeSortKeyOpaque(RendererLayer.OPAQUE, objects[0].sortable.renderOrder);\n    };\n    /**\n     * update a continuous GPU buffer\n     */\n    Instanced.prototype.updateBatchedAttribute = function (objects, startIndex, name, value) {\n        var _this = this;\n        var _a, _b;\n        if (objects.length === 0) {\n            return;\n        }\n        var stylePacked = [\n            'opacity',\n            'fillOpacity',\n            'strokeOpacity',\n            'lineWidth',\n            'visibility',\n            'anchor',\n            'increasedLineWidthForHitTesting',\n        ];\n        if (name === 'fill' || name === 'stroke') {\n            var packedFillStroke_1 = [];\n            objects.forEach(function (object) {\n                var _a = object.parsedStyle, fill = _a.fill, stroke = _a.stroke;\n                var fillColor = [0, 0, 0, 0];\n                if (isCSSRGB(fill)) {\n                    fillColor = [\n                        Number(fill.r),\n                        Number(fill.g),\n                        Number(fill.b),\n                        Number(fill.alpha) * 255,\n                    ];\n                }\n                var strokeColor = [0, 0, 0, 0];\n                if (isCSSRGB(stroke)) {\n                    strokeColor = [\n                        Number(stroke.r),\n                        Number(stroke.g),\n                        Number(stroke.b),\n                        Number(stroke.alpha) * 255,\n                    ];\n                }\n                packedFillStroke_1.push(packUint8ToFloat(fillColor[0], fillColor[1]), packUint8ToFloat(fillColor[2], fillColor[3]), packUint8ToFloat(strokeColor[0], strokeColor[1]), packUint8ToFloat(strokeColor[2], strokeColor[3]));\n            });\n            this.geometry.updateVertexBuffer(VertexAttributeBufferIndex.PACKED_COLOR, VertexAttributeLocation.PACKED_COLOR, startIndex, new Uint8Array(new Float32Array(packedFillStroke_1).buffer));\n            var fill = this.instance.parsedStyle.fill;\n            var i = this.textureMappings.findIndex(function (m) { return m.name === FILL_TEXTURE_MAPPING; });\n            if (isCSSRGB(fill)) {\n                if (i >= 0) {\n                    // remove original fill texture mapping\n                    this.textureMappings.splice(i, -1);\n                    this.material.textureDirty = true;\n                }\n            }\n            else {\n                var fillTextureMapping = this.createFillGradientTextureMapping([\n                    this.instance,\n                ]);\n                if (i >= 0) {\n                    this.textureMappings.splice(i, 1, fillTextureMapping);\n                }\n                this.material.textureDirty = true;\n            }\n        }\n        else if (stylePacked.indexOf(name) > -1) {\n            var packed_1 = [];\n            var anchorOffset_1 = ((_a = objects[0]) === null || _a === void 0 ? void 0 : _a.nodeName) === Shape.CIRCLE ||\n                ((_b = objects[0]) === null || _b === void 0 ? void 0 : _b.nodeName) === Shape.ELLIPSE\n                ? 0.5\n                : 0;\n            objects.forEach(function (object) {\n                var _a = object.parsedStyle, _b = _a.opacity, opacity = _b === void 0 ? 1 : _b, _c = _a.fillOpacity, fillOpacity = _c === void 0 ? 1 : _c, _d = _a.strokeOpacity, strokeOpacity = _d === void 0 ? 1 : _d, _e = _a.lineWidth, lineWidth = _e === void 0 ? 1 : _e, visibility = _a.visibility, _f = _a.increasedLineWidthForHitTesting, increasedLineWidthForHitTesting = _f === void 0 ? 0 : _f;\n                packed_1.push(opacity, fillOpacity, strokeOpacity, lineWidth, visibility !== 'hidden' ? 1 : 0, anchorOffset_1, anchorOffset_1, increasedLineWidthForHitTesting);\n            });\n            this.geometry.updateVertexBuffer(VertexAttributeBufferIndex.PACKED_STYLE, VertexAttributeLocation.PACKED_STYLE1, startIndex, new Uint8Array(new Float32Array(packed_1).buffer));\n        }\n        else if (name === 'modelMatrix' ||\n            (this.mergeXYZIntoModelMatrix &&\n                (name === 'x' || name === 'y' || name === 'z'))) {\n            var packed_2 = [];\n            var modelMatrix_1 = mat4.create();\n            objects.forEach(function (object) {\n                if (_this.mergeXYZIntoModelMatrix) {\n                    var _a = object.parsedStyle, x = _a.x, y = _a.y, z = _a.z;\n                    mat4.mul(modelMatrix_1, object.getWorldTransform(), // apply anchor\n                    mat4.fromTranslation(modelMatrix_1, vec3.fromValues(x, y, z)));\n                }\n                else {\n                    mat4.copy(modelMatrix_1, object.getWorldTransform());\n                }\n                packed_2.push.apply(packed_2, __spreadArray([], __read(modelMatrix_1), false));\n            });\n            this.geometry.updateVertexBuffer(VertexAttributeBufferIndex.MODEL_MATRIX, VertexAttributeLocation.MODEL_MATRIX0, startIndex, new Uint8Array(new Float32Array(packed_2).buffer));\n        }\n        else if (name === 'pointerEvents') {\n            var packed_3 = [];\n            objects.forEach(function (object) {\n                var _a;\n                var encodedPickingColor = (value &&\n                    object.isInteractive() &&\n                    (\n                    // @ts-ignore\n                    (_a = object.renderable3D) === null || _a === void 0 ? void 0 : _a.encodedPickingColor)) || [0, 0, 0];\n                packed_3.push.apply(packed_3, __spreadArray(__spreadArray([], __read(encodedPickingColor), false), [object.sortable.renderOrder * RENDER_ORDER_SCALE], false));\n            });\n            this.geometry.updateVertexBuffer(VertexAttributeBufferIndex.PICKING_COLOR, VertexAttributeLocation.PICKING_COLOR, startIndex, new Uint8Array(new Float32Array(packed_3).buffer));\n        }\n    };\n    Instanced.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        if (name === 'clipPath') {\n            if (this.clipPath) {\n                this.geometryDirty = true;\n            }\n        }\n    };\n    Instanced.prototype.changeRenderOrder = function (object, renderOrder) {\n        var _a;\n        var index = this.objects.indexOf(object);\n        var encodedPickingColor = (object.isInteractive() &&\n            (\n            // @ts-ignore\n            (_a = object.renderable3D) === null || _a === void 0 ? void 0 : _a.encodedPickingColor)) || [0, 0, 0];\n        this.geometry.updateVertexBuffer(VertexAttributeBufferIndex.PICKING_COLOR, VertexAttributeLocation.PICKING_COLOR, index, new Uint8Array(new Float32Array(__spreadArray(__spreadArray([], __read(encodedPickingColor), false), [\n            renderOrder * RENDER_ORDER_SCALE,\n        ], false)).buffer));\n    };\n    Instanced.prototype.generateWireframe = function (geometry) {\n        // need generate barycentric coordinates\n        var indices = geometry.indices;\n        var indiceNum = geometry.indices.length;\n        var originalVertexBuffers = geometry.vertices.map(function (buffer) {\n            // @ts-ignore\n            return buffer.slice();\n        });\n        for (var i = VertexAttributeBufferIndex.PICKING_COLOR; i < geometry.vertexBuffers.length; i++) {\n            var arrayStride = geometry.inputLayoutDescriptor.vertexBufferDescriptors[i].arrayStride;\n            geometry.vertices[i] = new Float32Array((arrayStride / 4) * indiceNum);\n        }\n        // reallocate attribute data\n        var cursor = 0;\n        var uniqueIndices = new Uint32Array(indiceNum);\n        for (var i = 0; i < indiceNum; i++) {\n            var ii = indices[i];\n            for (var j = 1; j < geometry.vertices.length; j++) {\n                var arrayStride = geometry.inputLayoutDescriptor.vertexBufferDescriptors[j].arrayStride;\n                var size = arrayStride / 4;\n                for (var k = 0; k < size; k++) {\n                    geometry.vertices[j][cursor * size + k] =\n                        originalVertexBuffers[j][ii * size + k];\n                }\n            }\n            uniqueIndices[i] = cursor;\n            cursor++;\n        }\n        for (var i = VertexAttributeBufferIndex.PICKING_COLOR + 1; i < geometry.vertexBuffers.length; i++) {\n            // if (i === 3) {\n            //   continue;\n            // }\n            var _a = geometry.inputLayoutDescriptor.vertexBufferDescriptors[i], stepMode = _a.stepMode, arrayStride = _a.arrayStride;\n            var descriptor = geometry.inputLayoutDescriptor.vertexBufferDescriptors[i].attributes[0];\n            if (descriptor) {\n                var location_1 = descriptor.shaderLocation, bufferByteOffset = descriptor.offset, format = descriptor.format, divisor = descriptor.divisor;\n                geometry.setVertexBuffer({\n                    bufferIndex: i,\n                    byteStride: arrayStride,\n                    stepMode: stepMode,\n                    attributes: [\n                        {\n                            format: format,\n                            bufferByteOffset: bufferByteOffset,\n                            location: location_1,\n                            divisor: divisor,\n                        },\n                    ],\n                    data: geometry.vertices[i],\n                });\n            }\n        }\n        // create barycentric attributes\n        var barycentricBuffer = new Float32Array(indiceNum * 3);\n        for (var i = 0; i < indiceNum;) {\n            for (var j = 0; j < 3; j++) {\n                var ii = uniqueIndices[i++];\n                barycentricBuffer[ii * 3 + j] = 1;\n            }\n        }\n        geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.BARYCENTRIC,\n            byteStride: 4 * 3,\n            stepMode: VertexStepMode.VERTEX,\n            attributes: [\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 0,\n                    location: Number(VertexAttributeLocation.BARYCENTRIC),\n                },\n            ],\n            data: barycentricBuffer,\n        });\n        geometry.setIndexBuffer(uniqueIndices);\n    };\n    Instanced.prototype.beforeUploadUBO = function (renderInst, objects) { };\n    Instanced.prototype.uploadUBO = function (renderInst) {\n        var _this = this;\n        var _a;\n        var numUniformBuffers = 1; // Scene UBO\n        var material = this.material;\n        var lights = this.lightPool.getAllLights();\n        var fog = this.lightPool.getFog();\n        var useFog = !!fog;\n        var useLight = (_a = material.defines.USE_LIGHT) !== null && _a !== void 0 ? _a : !!lights.length;\n        var useWireframe = material.defines.USE_WIREFRAME;\n        // collect uniforms\n        var uniforms = [];\n        if (useWireframe) {\n            var wireframeColor = parseColor(material.wireframeColor);\n            uniforms.push({\n                name: 'u_WireframeLineColor',\n                value: [\n                    Number(wireframeColor.r) / 255,\n                    Number(wireframeColor.g) / 255,\n                    Number(wireframeColor.b) / 255,\n                ],\n            });\n            uniforms.push({\n                name: 'u_WireframeLineWidth',\n                value: material.wireframeLineWidth,\n            });\n        }\n        if (useFog) {\n            this.uploadFog(uniforms, fog);\n        }\n        this.uploadMaterial(uniforms, material);\n        if (useLight) {\n            var counter_1 = {};\n            lights.forEach(function (light) {\n                if (!counter_1[light.define]) {\n                    counter_1[light.define] = -1;\n                }\n                counter_1[light.define]++;\n                light.uploadUBO(uniforms, counter_1[light.define]);\n            });\n        }\n        uniforms.sort(function (a, b) {\n            return _this.material.uniformNames.indexOf(a.name) -\n                _this.material.uniformNames.indexOf(b.name);\n        });\n        // TODO: should not upload all uniforms if no change\n        renderInst.setUniforms(numUniformBuffers, uniforms);\n        var depthCompare = material.depthCompare, depthWrite = material.depthWrite, stencilFront = material.stencilFront, stencilBack = material.stencilBack, stencilWrite = material.stencilWrite, stencilRef = material.stencilRef, cullMode = material.cullMode, frontFace = material.frontFace, polygonOffset = material.polygonOffset, blendConstant = material.blendConstant, blendEquation = material.blendEquation, blendEquationAlpha = material.blendEquationAlpha, blendSrc = material.blendSrc, blendDst = material.blendDst, blendSrcAlpha = material.blendSrcAlpha, blendDstAlpha = material.blendDstAlpha;\n        var materialMegaState = definedProps({\n            blendConstant: blendConstant,\n            depthCompare: depthCompare,\n            depthWrite: depthWrite,\n            stencilFront: stencilFront,\n            stencilBack: stencilBack,\n            stencilWrite: stencilWrite,\n            stencilRef: stencilRef,\n            cullMode: cullMode,\n            frontFace: frontFace,\n            polygonOffset: polygonOffset,\n        });\n        var currentAttachmentsState = renderInst.getMegaStateFlags().attachmentsState[0];\n        renderInst.setMegaStateFlags(__assign({ attachmentsState: [\n                {\n                    // should not affect color buffer when drawing stencil\n                    channelWriteMask: this.material.stencilWrite\n                        ? ChannelWriteMask.NONE\n                        : ChannelWriteMask.ALL,\n                    // channelWriteMask: ChannelWriteMask.AllChannels,\n                    rgbBlendState: __assign(__assign({}, currentAttachmentsState.rgbBlendState), definedProps({\n                        blendMode: blendEquation,\n                        blendSrcFactor: blendSrc,\n                        blendDstFactor: blendDst,\n                    })),\n                    alphaBlendState: __assign(__assign({}, currentAttachmentsState.alphaBlendState), definedProps({\n                        blendMode: blendEquationAlpha,\n                        blendSrcFactor: blendSrcAlpha,\n                        blendDstFactor: blendDstAlpha,\n                    })),\n                },\n            ] }, materialMegaState));\n        renderInst.setBindingLayout({\n            numUniformBuffers: numUniformBuffers,\n            numSamplers: this.textureMappings.length,\n        });\n        renderInst.setSamplerBindingsFromTextureMappings(this.textureMappings);\n    };\n    Instanced.prototype.uploadFog = function (uniforms, fog) {\n        var _a = fog.parsedStyle, type = _a.type, fill = _a.fill, start = _a.start, end = _a.end, density = _a.density;\n        if (isCSSRGB(fill)) {\n            var fillColor = [\n                Number(fill.r) / 255,\n                Number(fill.g) / 255,\n                Number(fill.b) / 255,\n                Number(fill.alpha),\n            ];\n            uniforms.push({\n                name: 'u_FogInfos',\n                value: [type, start, end, density],\n            });\n            uniforms.push({\n                name: 'u_FogColor',\n                value: fillColor,\n            });\n        }\n    };\n    Instanced.prototype.uploadMaterial = function (uniforms, material) {\n        // sort\n        var materialUniforms = Object.keys(material.uniforms).map(function (name) { return ({\n            name: name,\n            value: material.uniforms[name],\n        }); });\n        uniforms.push.apply(uniforms, __spreadArray([], __read(materialUniforms), false));\n    };\n    Instanced.prototype.createFillGradientTextureMapping = function (objects) {\n        var _this = this;\n        var instance = objects[0];\n        // should account for Line, Path, Polyline and Polyline\n        var fill = instance.parsedStyle[this.gradientAttributeName];\n        var texImageSource;\n        // use pattern & gradient\n        if (fill && (isPattern(fill) || Array.isArray(fill))) {\n            if (Array.isArray(fill)) {\n                this.program.setDefineBool('USE_PATTERN', false);\n                this.texturePool.getOrCreateGradient({\n                    gradients: fill,\n                    width: 128,\n                    height: 128,\n                    instance: instance,\n                });\n            }\n            else if (isPattern(fill)) {\n                this.program.setDefineBool('USE_PATTERN', true);\n                this.texturePool.getOrCreatePattern(fill, instance, function () {\n                    // need re-render\n                    objects.forEach(function (object) {\n                        object.renderable.dirty = true;\n                    });\n                    _this.material.textureDirty = true;\n                });\n            }\n            texImageSource = this.texturePool.getOrCreateCanvas();\n            var texture = this.texturePool.getOrCreateTexture(this.context.device, texImageSource, makeTextureDescriptor2D(Format.U8_RGBA_NORM, 1, 1, 1));\n            if (texture) {\n                var fillMapping = new TextureMapping();\n                fillMapping.name = FILL_TEXTURE_MAPPING;\n                fillMapping.texture = texture;\n                fillMapping.texture.on('loaded', function () {\n                    // need re-render\n                    objects.forEach(function (object) {\n                        object.renderable.dirty = true;\n                    });\n                    _this.material.textureDirty = true;\n                });\n                this.context.device.setResourceName(fillMapping.texture, 'Fill Texture' + this.id);\n                fillMapping.sampler = this.renderHelper.getCache().createSampler({\n                    addressModeU: AddressMode.CLAMP_TO_EDGE,\n                    addressModeV: AddressMode.CLAMP_TO_EDGE,\n                    minFilter: FilterMode.POINT,\n                    magFilter: FilterMode.BILINEAR,\n                    mipmapFilter: MipmapFilterMode.LINEAR,\n                    lodMinClamp: 0,\n                    lodMaxClamp: 0,\n                });\n                return fillMapping;\n            }\n        }\n        return null;\n    };\n    return Instanced;\n}());\n\nvar frag$4 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nin vec4 v_PickingResult;\\nin vec4 v_Color;\\nin vec4 v_StrokeColor;\\nin vec4 v_StylePacked1;\\nin vec4 v_StylePacked2;\\n#ifdef USE_UV\\n  in vec2 v_Uv;\\n#endif\\n#ifdef USE_MAP\\n  uniform sampler2D u_Map;\\n#endif\\n\\nin vec2 v_Data;\\nin vec2 v_Radius;\\nin vec3 v_StylePacked3;\\n\\nout vec4 outputColor;\\nfloat epsilon = 0.000001;\\n\\n/**\\n * 2D signed distance field functions\\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\\n */\\n\\nfloat sdCircle(vec2 p, float r) {\\n  return length(p) - r;\\n}\\n\\n// @see http://www.iquilezles.org/www/articles/ellipsoids/ellipsoids.htm\\nfloat sdEllipsoidApproximated(vec2 p, vec2 r) {\\n  float k0 = length(p / r);\\n  float k1 = length(p / (r * r));\\n  return k0 * (k0 - 1.0) / k1;\\n}\\n\\n// @see https://www.shadertoy.com/view/4llXD7\\nfloat sdRoundedBox(vec2 p, vec2 b, float r) {\\n  p = abs(p) - b + r;\\n  return length(max(p, 0.0)) + min(max(p.x, p.y), 0.0) - r;\\n}\\n\\nvoid main() {\\n  int shape = int(floor(v_StylePacked3.x + 0.5));\\n\\n  vec4 u_Color = v_Color;\\nvec4 u_StrokeColor = v_StrokeColor;\\nfloat u_Opacity = v_StylePacked1.x;\\nfloat u_FillOpacity = v_StylePacked1.y;\\nfloat u_StrokeOpacity = v_StylePacked1.z;\\nfloat u_StrokeWidth = v_StylePacked1.w;\\nfloat u_Visible = v_StylePacked2.x;\\nvec3 u_PickingColor = v_PickingResult.xyz;\\n\\nif (u_Visible < 0.5) {\\n    discard;\\n}\\n  #ifdef USE_MAP\\n  #ifdef USE_PATTERN\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #else\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #endif\\n#endif\\n\\n  bool omitStroke = v_StylePacked3.z == 1.0;\\n\\n  vec2 r = (v_Radius - (omitStroke ? 0.0 : u_StrokeWidth)) / v_Radius.y;\\n  float wh = v_Radius.x / v_Radius.y;\\n\\n  float dist = length(v_Data);\\n  float antialiased_blur = -fwidth(dist);\\n\\n  float outer_df;\\n  float inner_df;\\n  // 'circle', 'ellipse', 'rect'\\n  if (shape == 0) {\\n    outer_df = sdCircle(v_Data, 1.0);\\n    inner_df = sdCircle(v_Data, r.x);\\n  } else if (shape == 1) {\\n    outer_df = sdEllipsoidApproximated(v_Data, vec2(wh, 1.0));\\n    inner_df = sdEllipsoidApproximated(v_Data, r);\\n  } else if (shape == 2) {\\n    bool useRadius = v_StylePacked3.y > epsilon;\\n    outer_df = sdRoundedBox(v_Data, vec2(wh, 1.0), useRadius ? (v_StylePacked3.y + u_StrokeWidth / 2.0) / v_Radius.y : 0.0);\\n    inner_df = sdRoundedBox(v_Data, r, useRadius ? (v_StylePacked3.y - u_StrokeWidth / 2.0) / v_Radius.y : 0.0);\\n  }\\n\\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\\n\\n  float color_t = u_StrokeWidth < 0.01 ? 0.0 : smoothstep(\\n    antialiased_blur,\\n    0.0,\\n    inner_df\\n  );\\n\\n  vec4 diffuseColor;\\n  vec4 strokeColor;\\n  if (u_IsPicking > 0.5) {\\n    diffuseColor = vec4(u_PickingColor, 1.0);\\n    strokeColor = vec4(u_PickingColor, 1.0);\\n  } else {\\n    diffuseColor = u_Color;\\n    strokeColor = (u_StrokeColor == vec4(0) || omitStroke) ? vec4(0.0) : u_StrokeColor;\\n  }\\n\\n  outputColor = mix(vec4(diffuseColor.rgb, diffuseColor.a * u_FillOpacity), strokeColor * u_StrokeOpacity, color_t);\\n  outputColor.a = outputColor.a * u_Opacity * opacity_t;\\n\\n  if (outputColor.a < epsilon)\\n    discard;\\n\\n  if (u_IsPicking > 0.5) {\\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\\n      discard;\\n    }\\n  }\\n}\"; // eslint-disable-line\n\nvar vert$4 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\\nlayout(location = PACKED_COLOR) in vec4 a_PackedColor;\\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\\n\\nout vec4 v_PickingResult;\\nout vec4 v_Color;\\nout vec4 v_StrokeColor;\\nout vec4 v_StylePacked1;\\nout vec4 v_StylePacked2;\\n\\n#define COLOR_SCALE 1. / 255.\\nvoid setPickingColor(vec3 pickingColor) {\\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\\n}\\n\\nvec2 unpack_float(const float packedValue) {\\n  int packedIntValue = int(packedValue);\\n  int v0 = packedIntValue / 256;\\n  return vec2(v0, packedIntValue - v0 * 256);\\n}\\nvec4 decode_color(const vec2 encodedColor) {\\n  return vec4(\\n    unpack_float(encodedColor[0]) / 255.0,\\n    unpack_float(encodedColor[1]) / 255.0\\n  );\\n}\\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\\n  return pm * vm * mm * pos;\\n}\\n\\nbool isPerspectiveMatrix(mat4 m) {\\n  return m[2][3] == -1.0;\\n}\\n\\nvec4 billboard(vec2 offset, float rotation, bool isSizeAttenuation, mat4 pm, mat4 vm, mat4 mm, vec3 position) {\\n  vec4 mvPosition = vm * mm * vec4(position, 1.0);\\n  vec2 scale;\\n  scale.x = length(vec3(mm[0][0], mm[0][1], mm[0][2]));\\n  scale.y = length(vec3(mm[1][0], mm[1][1], mm[1][2]));\\n\\n  if (isSizeAttenuation) {\\n    bool isPerspective = isPerspectiveMatrix(pm);\\n    if (isPerspective) {\\n      scale *= -mvPosition.z / 250.0;\\n    }\\n  }\\n\\n  vec2 alignedPosition = offset * scale;\\n  vec2 rotatedPosition;\\n  rotatedPosition.x = cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y;\\n  rotatedPosition.y = sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y;\\n\\n  mvPosition.xy += rotatedPosition;\\n  return pm * mvPosition;\\n}\\n\\nlayout(location = POSITION) in vec3 a_Position;\\nlayout(location = EXTRUDE) in vec2 a_Extrude;\\n// shape, radius, omitStroke, isBillboard\\nlayout(location = PACKED_STYLE3) in vec3 a_StylePacked3;\\nlayout(location = SIZE) in vec4 a_Size;\\n#ifdef USE_UV\\n  layout(location = UV) in vec2 a_Uv;\\n  out vec2 v_Uv;\\n#endif\\n\\nout vec2 v_Data;\\nout vec2 v_Radius;\\nout vec3 v_StylePacked3;\\n\\nvoid main() {\\n  vec4 a_Color = decode_color(a_PackedColor.xy);\\nvec4 a_StrokeColor = decode_color(a_PackedColor.zw);\\n\\nmat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\\nvec4 u_StrokeColor = a_StrokeColor;\\nfloat u_Opacity = a_StylePacked1.x;\\nfloat u_FillOpacity = a_StylePacked1.y;\\nfloat u_StrokeOpacity = a_StylePacked1.z;\\nfloat u_StrokeWidth = a_StylePacked1.w;\\nfloat u_ZIndex = a_PickingColor.w;\\nvec2 u_Anchor = a_StylePacked2.yz;\\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\\n\\nsetPickingColor(a_PickingColor.xyz);\\n\\nv_Color = a_Color;\\nv_StrokeColor = a_StrokeColor;\\nv_StylePacked1 = a_StylePacked1;\\nv_StylePacked2 = a_StylePacked2;\\n\\n// #ifdef CLIPSPACE_NEAR_ZERO\\n//     gl_Position.z = (gl_Position.z + gl_Position.w) * 0.5;\\n// #endif\\n  #ifdef USE_UV\\n  v_Uv = a_Uv;\\n#endif\\n\\n  float strokeWidth;\\n  if (u_IsPicking > 0.5) {\\n    strokeWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\\n  } else {\\n    strokeWidth = u_StrokeWidth;\\n  }\\n\\n  bool omitStroke = a_StylePacked3.z == 1.0;\\n  vec2 radius = a_Size.xy + vec2(omitStroke ? 0.0 : strokeWidth / 2.0);\\n  vec2 offset = (a_Extrude + vec2(1.0) - 2.0 * u_Anchor.xy) * a_Size.xy + a_Extrude * vec2(omitStroke ? 0.0 : strokeWidth / 2.0);\\n\\n  bool isBillboard = a_Size.z > 0.5;\\n  if (isBillboard) {\\n    float rotation = 0.0;\\n    bool isSizeAttenuation = a_Size.w > 0.5;\\n    gl_Position = billboard(offset, rotation, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, a_Position);\\n  } else {\\n    gl_Position = project(vec4(a_Position.xy + offset, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n  }\\n  \\n  v_Radius = radius;\\n  v_Data = vec2(a_Extrude * radius / radius.y);\\n  v_StylePacked3 = a_StylePacked3;\\n}\"; // eslint-disable-line\n\nvar SDFVertexAttributeBufferIndex;\n(function (SDFVertexAttributeBufferIndex) {\n    SDFVertexAttributeBufferIndex[SDFVertexAttributeBufferIndex[\"PACKED_STYLE\"] = 5] = \"PACKED_STYLE\";\n})(SDFVertexAttributeBufferIndex || (SDFVertexAttributeBufferIndex = {}));\nvar SDFVertexAttributeLocation;\n(function (SDFVertexAttributeLocation) {\n    SDFVertexAttributeLocation[SDFVertexAttributeLocation[\"PACKED_STYLE3\"] = 12] = \"PACKED_STYLE3\";\n    SDFVertexAttributeLocation[SDFVertexAttributeLocation[\"EXTRUDE\"] = 13] = \"EXTRUDE\";\n    SDFVertexAttributeLocation[SDFVertexAttributeLocation[\"SIZE\"] = 14] = \"SIZE\";\n})(SDFVertexAttributeLocation || (SDFVertexAttributeLocation = {}));\nvar SDF_Shape = [Shape.CIRCLE, Shape.ELLIPSE, Shape.RECT];\n/**\n * Use SDF to render 2D shapes, eg. circle, ellipse.\n * Use less triangles(2) and vertices compared with normal triangulation.\n */\nvar SDFDrawcall = /** @class */ (function (_super) {\n    __extends(SDFDrawcall, _super);\n    function SDFDrawcall() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SDFDrawcall.prototype.shouldMerge = function (object, index) {\n        var shouldMerge = _super.prototype.shouldMerge.call(this, object, index);\n        if (!shouldMerge) {\n            return false;\n        }\n        // if (\n        //   this.needDrawStrokeSeparately(object.parsedStyle) ||\n        //   this.needDrawStrokeSeparately(this.instance.parsedStyle)\n        // ) {\n        //   return false;\n        // }\n        // const { fill: instanceFill } = this.instance\n        //   .parsedStyle as ParsedBaseStyleProps;\n        // const { fill } = object.parsedStyle as ParsedBaseStyleProps;\n        // if ((instanceFill as CSSRGB).isNone !== (fill as CSSRGB).isNone) {\n        //   return false;\n        // }\n        return true;\n    };\n    SDFDrawcall.prototype.createMaterial = function (objects) {\n        this.material.vertexShader = vert$4;\n        this.material.fragmentShader = frag$4;\n        this.material.defines = __assign(__assign({}, this.material.defines), enumToObject(SDFVertexAttributeLocation));\n    };\n    SDFDrawcall.prototype.createGeometry = function (objects) {\n        var _this = this;\n        // use default common attributes\n        _super.prototype.createGeometry.call(this, objects);\n        var instanced = [];\n        var positions = [];\n        objects.forEach(function (object, i) {\n            var circle = object;\n            // @ts-ignore\n            var radius = circle.parsedStyle.radius;\n            var omitStroke = _this.shouldOmitStroke(circle.parsedStyle);\n            var size = _this.getSize(object.parsedStyle, circle.nodeName);\n            var position = _this.getPosition(object.parsedStyle, circle.nodeName);\n            instanced.push.apply(instanced, __spreadArray(__spreadArray([], __read(size), false), [circle.parsedStyle.isBillboard ? 1 : 0,\n                circle.parsedStyle.isSizeAttenuation ? 1 : 0,\n                SDF_Shape.indexOf(circle.nodeName),\n                (radius && radius[0]) || 0,\n                omitStroke ? 1 : 0], false));\n            positions.push.apply(positions, __spreadArray([], __read(position), false));\n        });\n        this.geometry.setIndexBuffer(new Uint32Array([0, 2, 1, 0, 3, 2]));\n        this.geometry.vertexCount = 6;\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.UV,\n            byteStride: 4 * 4,\n            stepMode: VertexStepMode.VERTEX,\n            attributes: [\n                {\n                    format: Format.F32_RG,\n                    bufferByteOffset: 4 * 0,\n                    location: SDFVertexAttributeLocation.EXTRUDE,\n                },\n                {\n                    format: Format.F32_RG,\n                    bufferByteOffset: 4 * 2,\n                    location: VertexAttributeLocation.UV,\n                },\n            ],\n            data: new Float32Array([\n                -1, -1, 0, 0, 1, -1, 1, 0, 1, 1, 1, 1, -1, 1, 0, 1,\n            ]),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.POSITION,\n            byteStride: 4 * 3,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.POSITION,\n                },\n            ],\n            data: new Float32Array(positions),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: SDFVertexAttributeBufferIndex.PACKED_STYLE,\n            byteStride: 4 * 7,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: SDFVertexAttributeLocation.SIZE,\n                    divisor: 1,\n                },\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 4,\n                    location: SDFVertexAttributeLocation.PACKED_STYLE3,\n                    divisor: 1,\n                },\n            ],\n            data: new Float32Array(instanced),\n        });\n    };\n    SDFDrawcall.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        var _this = this;\n        _super.prototype.updateAttribute.call(this, objects, startIndex, name, value);\n        this.updateBatchedAttribute(objects, startIndex, name, value);\n        if (name === 'r' ||\n            name === 'rx' ||\n            name === 'ry' ||\n            name === 'width' ||\n            name === 'height' ||\n            name === 'lineWidth' ||\n            name === 'stroke' ||\n            name === 'lineDash' ||\n            name === 'strokeOpacity' ||\n            name === 'radius' ||\n            name === 'isBillboard' ||\n            name === 'isSizeAttenuation') {\n            var packed_1 = [];\n            objects.forEach(function (object) {\n                var circle = object;\n                var omitStroke = _this.shouldOmitStroke(circle.parsedStyle);\n                var _a = __read(_this.getSize(object.parsedStyle, object.nodeName), 2), halfWidth = _a[0], halfHeight = _a[1];\n                var size = [halfWidth, halfHeight];\n                packed_1.push.apply(packed_1, __spreadArray(__spreadArray([], __read(size), false), [circle.parsedStyle.isBillboard ? 1 : 0,\n                    circle.parsedStyle.isSizeAttenuation ? 1 : 0,\n                    SDF_Shape.indexOf(object.nodeName),\n                    (object.parsedStyle.radius && object.parsedStyle.radius[0]) || 0,\n                    omitStroke ? 1 : 0], false));\n            });\n            this.geometry.updateVertexBuffer(SDFVertexAttributeBufferIndex.PACKED_STYLE, SDFVertexAttributeLocation.SIZE, startIndex, new Uint8Array(new Float32Array(packed_1).buffer));\n        }\n        else if (name === 'cx' || name === 'cy' || name === 'x' || name === 'y') {\n            var packed_2 = [];\n            objects.forEach(function (object) {\n                var _a = __read(_this.getPosition(object.parsedStyle, object.nodeName), 2), x = _a[0], y = _a[1];\n                packed_2.push(x, y);\n            });\n            this.geometry.updateVertexBuffer(VertexAttributeBufferIndex.POSITION, VertexAttributeLocation.POSITION, startIndex, new Uint8Array(new Float32Array(packed_2).buffer));\n        }\n    };\n    SDFDrawcall.prototype.getPosition = function (parsed, tagName) {\n        var size = [0, 0, 0];\n        if (tagName === Shape.CIRCLE || tagName === Shape.ELLIPSE) {\n            var _a = parsed, _b = _a.cx, cx = _b === void 0 ? 0 : _b, _c = _a.cy, cy = _c === void 0 ? 0 : _c, _d = _a.cz, cz = _d === void 0 ? 0 : _d;\n            size = [cx, cy, cz];\n        }\n        else if (tagName === Shape.RECT) {\n            var _e = parsed, _f = _e.x, x = _f === void 0 ? 0 : _f, _g = _e.y, y = _g === void 0 ? 0 : _g, _h = _e.z, z = _h === void 0 ? 0 : _h;\n            size = [x, y, z];\n        }\n        return size;\n    };\n    SDFDrawcall.prototype.getSize = function (parsed, tagName) {\n        var size = [0, 0];\n        if (tagName === Shape.CIRCLE) {\n            var r = parsed.r;\n            size = [r, r];\n        }\n        else if (tagName === Shape.ELLIPSE) {\n            var _a = parsed, rx = _a.rx, ry = _a.ry;\n            size = [rx, ry];\n        }\n        else if (tagName === Shape.RECT) {\n            var _b = parsed, width = _b.width, height = _b.height;\n            size = [width / 2, height / 2];\n        }\n        return size;\n    };\n    SDFDrawcall.prototype.shouldOmitStroke = function (parsedStyle) {\n        var lineDash = parsedStyle.lineDash, stroke = parsedStyle.stroke, strokeOpacity = parsedStyle.strokeOpacity;\n        var hasStroke = stroke && !stroke.isNone;\n        var hasLineDash = lineDash &&\n            lineDash.length &&\n            lineDash.every(function (item) { return item !== 0; });\n        var hasStrokeOpacity = strokeOpacity < 1;\n        return !hasStroke || (hasStroke && (hasLineDash || hasStrokeOpacity));\n    };\n    return SDFDrawcall;\n}(Instanced));\n\nvar frag$3 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nin vec4 v_PickingResult;\\nin vec4 v_Color;\\nin vec4 v_StrokeColor;\\nin vec4 v_StylePacked1;\\nin vec4 v_StylePacked2;\\n#ifdef USE_UV\\n  in vec2 v_Uv;\\n#endif\\n#ifdef USE_MAP\\n  uniform sampler2D u_Map;\\n#endif\\n\\nin vec4 v_Dash;\\nin vec2 v_Distance;\\n\\nout vec4 outputColor;\\nfloat epsilon = 0.000001;\\n\\nvoid main() {\\n  vec4 u_Color = v_Color;\\nvec4 u_StrokeColor = v_StrokeColor;\\nfloat u_Opacity = v_StylePacked1.x;\\nfloat u_FillOpacity = v_StylePacked1.y;\\nfloat u_StrokeOpacity = v_StylePacked1.z;\\nfloat u_StrokeWidth = v_StylePacked1.w;\\nfloat u_Visible = v_StylePacked2.x;\\nvec3 u_PickingColor = v_PickingResult.xyz;\\n\\nif (u_Visible < 0.5) {\\n    discard;\\n}\\n  #ifdef USE_MAP\\n  #ifdef USE_PATTERN\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #else\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #endif\\n#endif\\n\\n  if (u_IsPicking > 0.5) {\\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\\n      discard;\\n    }\\n    outputColor = vec4(u_PickingColor, 1.0);\\n  } else {\\n    outputColor = u_StrokeColor;\\n    #ifdef USE_MAP\\n      outputColor = u_Color;\\n    #endif\\n\\n    float blur;\\n    if (v_Distance.y < 1.0) {\\n      blur = smoothstep(0.0, v_Distance.y, 1.0 - abs(v_Distance.x));\\n    } else {\\n      blur = 1.0 / v_Distance.y;\\n    }\\n    float u_dash_offset = v_Dash.y;\\n    float u_dash_array = v_Dash.z;\\n    float u_dash_ratio = v_Dash.w;\\n\\n    outputColor.a = outputColor.a\\n      * max(blur, 0.5)\\n      * u_Opacity * u_StrokeOpacity\\n      * (u_dash_array < 1.0 ? (ceil((u_dash_array * u_dash_ratio) - mod(v_Dash.x + u_dash_offset, u_dash_array))) : 1.0);\\n\\n    if (outputColor.a < epsilon) {\\n      discard;\\n    }\\n  }\\n}\"; // eslint-disable-line\n\nvar vert$3 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\\nlayout(location = PACKED_COLOR) in vec4 a_PackedColor;\\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\\n\\nout vec4 v_PickingResult;\\nout vec4 v_Color;\\nout vec4 v_StrokeColor;\\nout vec4 v_StylePacked1;\\nout vec4 v_StylePacked2;\\n\\n#define COLOR_SCALE 1. / 255.\\nvoid setPickingColor(vec3 pickingColor) {\\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\\n}\\n\\nvec2 unpack_float(const float packedValue) {\\n  int packedIntValue = int(packedValue);\\n  int v0 = packedIntValue / 256;\\n  return vec2(v0, packedIntValue - v0 * 256);\\n}\\nvec4 decode_color(const vec2 encodedColor) {\\n  return vec4(\\n    unpack_float(encodedColor[0]) / 255.0,\\n    unpack_float(encodedColor[1]) / 255.0\\n  );\\n}\\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\\n  return pm * vm * mm * pos;\\n}\\n\\nlayout(location = POSITION) in vec3 a_Position;\\nlayout(location = POINTA) in vec3 a_PointA;\\nlayout(location = POINTB) in vec3 a_PointB;\\nlayout(location = CAP) in float a_Cap;\\n#ifdef USE_UV\\n  layout(location = UV) in vec2 a_Uv;\\n  out vec2 v_Uv;\\n#endif\\nlayout(location = DASH) in vec4 a_Dash;\\n\\nout vec4 v_Dash;\\nout vec2 v_Distance;\\n\\nvoid main() {\\n  vec4 a_Color = decode_color(a_PackedColor.xy);\\nvec4 a_StrokeColor = decode_color(a_PackedColor.zw);\\n\\nmat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\\nvec4 u_StrokeColor = a_StrokeColor;\\nfloat u_Opacity = a_StylePacked1.x;\\nfloat u_FillOpacity = a_StylePacked1.y;\\nfloat u_StrokeOpacity = a_StylePacked1.z;\\nfloat u_StrokeWidth = a_StylePacked1.w;\\nfloat u_ZIndex = a_PickingColor.w;\\nvec2 u_Anchor = a_StylePacked2.yz;\\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\\n\\nsetPickingColor(a_PickingColor.xyz);\\n\\nv_Color = a_Color;\\nv_StrokeColor = a_StrokeColor;\\nv_StylePacked1 = a_StylePacked1;\\nv_StylePacked2 = a_StylePacked2;\\n\\n// #ifdef CLIPSPACE_NEAR_ZERO\\n//     gl_Position.z = (gl_Position.z + gl_Position.w) * 0.5;\\n// #endif\\n  #ifdef USE_UV\\n  v_Uv = a_Uv;\\n#endif\\n\\n  float strokeWidth;\\n  if (u_IsPicking > 0.5) {\\n    strokeWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\\n  } else {\\n    strokeWidth = u_StrokeWidth;\\n  }\\n  float clampedStrokeWidth = max(strokeWidth, 1.0);\\n\\n  bool isSizeAttenuation = a_Dash.w > 0.5;\\n  if (isSizeAttenuation) {\\n    vec4 clip0 = project(vec4(a_PointA, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n    vec4 clip1 = project(vec4(a_PointB, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n    // screen space\\n    vec2 screen0 = u_Viewport * (0.5 * clip0.xy / clip0.w + 0.5);\\n    vec2 screen1 = u_Viewport * (0.5 * clip1.xy / clip1.w + 0.5);\\n    vec2 xBasis = normalize(screen1 - screen0);\\n    vec2 yBasis = vec2(-xBasis.y, xBasis.x);\\n    vec2 pt0 = screen0 + clampedStrokeWidth * (a_Position.x * xBasis + a_Position.y * yBasis);\\n    vec2 pt1 = screen1 + clampedStrokeWidth * (a_Position.x * xBasis + a_Position.y * yBasis);\\n    vec2 pt = mix(pt0, pt1, a_Position.z);\\n    vec4 clip = mix(clip0, clip1, a_Position.z);\\n    gl_Position = vec4(clip.w * (2.0 * pt / u_Viewport - 1.0), clip.z, clip.w);\\n  } else {\\n    vec2 xBasis = a_PointB.xy - a_PointA.xy;\\n    vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\\n\\n    vec2 point = a_PointA.xy + xBasis * a_Position.x + yBasis * clampedStrokeWidth * a_Position.y;\\n    point = point - u_Anchor.xy * abs(xBasis);\\n\\n    // round & square\\n    if (a_Cap > 1.0) {\\n      point += sign(a_Position.x - 0.5) * normalize(xBasis) * vec2(clampedStrokeWidth / 2.0);\\n    }\\n    gl_Position = project(vec4(point, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n  }\\n\\n  float antialiasblur = 1.0 / strokeWidth;\\n  v_Distance = vec2(a_Position.y * 2.0, antialiasblur);\\n  v_Dash = vec4(a_Position.x, a_Dash.xyz);\\n}\"; // eslint-disable-line\n\nvar meshFrag = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nin vec4 v_PickingResult;\\nin vec4 v_Color;\\nin vec4 v_StrokeColor;\\nin vec4 v_StylePacked1;\\nin vec4 v_StylePacked2;\\n#ifdef USE_UV\\n  in vec2 v_Uv;\\n#endif\\n#ifdef USE_MAP\\n  uniform sampler2D u_Map;\\n#endif\\n\\nout vec4 outputColor;\\n\\nvoid main(){\\n  vec4 u_Color = v_Color;\\nvec4 u_StrokeColor = v_StrokeColor;\\nfloat u_Opacity = v_StylePacked1.x;\\nfloat u_FillOpacity = v_StylePacked1.y;\\nfloat u_StrokeOpacity = v_StylePacked1.z;\\nfloat u_StrokeWidth = v_StylePacked1.w;\\nfloat u_Visible = v_StylePacked2.x;\\nvec3 u_PickingColor = v_PickingResult.xyz;\\n\\nif (u_Visible < 0.5) {\\n    discard;\\n}\\n  #ifdef USE_MAP\\n  #ifdef USE_PATTERN\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #else\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #endif\\n#endif\\n\\n  if (u_IsPicking > 0.5) {\\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\\n      discard;\\n    }\\n    outputColor = vec4(u_PickingColor, 1.0);\\n  } else {\\n    outputColor = u_Color;\\n\\n    outputColor.a = outputColor.a * u_Opacity * u_FillOpacity;\\n  }\\n}\"; // eslint-disable-line\n\nvar meshVert = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\\nlayout(location = PACKED_COLOR) in vec4 a_PackedColor;\\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\\n\\nout vec4 v_PickingResult;\\nout vec4 v_Color;\\nout vec4 v_StrokeColor;\\nout vec4 v_StylePacked1;\\nout vec4 v_StylePacked2;\\n\\n#define COLOR_SCALE 1. / 255.\\nvoid setPickingColor(vec3 pickingColor) {\\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\\n}\\n\\nvec2 unpack_float(const float packedValue) {\\n  int packedIntValue = int(packedValue);\\n  int v0 = packedIntValue / 256;\\n  return vec2(v0, packedIntValue - v0 * 256);\\n}\\nvec4 decode_color(const vec2 encodedColor) {\\n  return vec4(\\n    unpack_float(encodedColor[0]) / 255.0,\\n    unpack_float(encodedColor[1]) / 255.0\\n  );\\n}\\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\\n  return pm * vm * mm * pos;\\n}\\n\\nbool isPerspectiveMatrix(mat4 m) {\\n  return m[2][3] == -1.0;\\n}\\n\\nvec4 billboard(vec2 offset, float rotation, bool isSizeAttenuation, mat4 pm, mat4 vm, mat4 mm, vec3 position) {\\n  vec4 mvPosition = vm * mm * vec4(position, 1.0);\\n  vec2 scale;\\n  scale.x = length(vec3(mm[0][0], mm[0][1], mm[0][2]));\\n  scale.y = length(vec3(mm[1][0], mm[1][1], mm[1][2]));\\n\\n  if (isSizeAttenuation) {\\n    bool isPerspective = isPerspectiveMatrix(pm);\\n    if (isPerspective) {\\n      scale *= -mvPosition.z / 250.0;\\n    }\\n  }\\n\\n  vec2 alignedPosition = offset * scale;\\n  vec2 rotatedPosition;\\n  rotatedPosition.x = cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y;\\n  rotatedPosition.y = sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y;\\n\\n  mvPosition.xy += rotatedPosition;\\n  return pm * mvPosition;\\n}\\n\\nlayout(location = POSITION) in vec3 a_Position;\\nlayout(location = PACKED_STYLE3) in vec4 a_StylePacked3;\\n\\n#ifdef USE_UV\\n  layout(location = UV) in vec2 a_Uv;\\n  out vec2 v_Uv;\\n#endif\\n\\nvoid main() {\\n  vec4 a_Color = decode_color(a_PackedColor.xy);\\nvec4 a_StrokeColor = decode_color(a_PackedColor.zw);\\n\\nmat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\\nvec4 u_StrokeColor = a_StrokeColor;\\nfloat u_Opacity = a_StylePacked1.x;\\nfloat u_FillOpacity = a_StylePacked1.y;\\nfloat u_StrokeOpacity = a_StylePacked1.z;\\nfloat u_StrokeWidth = a_StylePacked1.w;\\nfloat u_ZIndex = a_PickingColor.w;\\nvec2 u_Anchor = a_StylePacked2.yz;\\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\\n\\nsetPickingColor(a_PickingColor.xyz);\\n\\nv_Color = a_Color;\\nv_StrokeColor = a_StrokeColor;\\nv_StylePacked1 = a_StylePacked1;\\nv_StylePacked2 = a_StylePacked2;\\n\\n// #ifdef CLIPSPACE_NEAR_ZERO\\n//     gl_Position.z = (gl_Position.z + gl_Position.w) * 0.5;\\n// #endif\\n  #ifdef USE_UV\\n  v_Uv = a_Uv;\\n#endif\\n\\n  bool isBillboard = a_StylePacked3.x > 0.5;\\n  if (isBillboard) {\\n    float rotation = a_StylePacked3.y;\\n    bool isSizeAttenuation = a_StylePacked3.z > 0.5;\\n    gl_Position = billboard(a_Position.xy, rotation, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, vec3(0.0));\\n  } else {\\n    gl_Position = project(vec4(a_Position.xy, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n  }\\n}\"; // eslint-disable-line\n\nvar frag$2 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nin vec4 v_PickingResult;\\nin vec4 v_Color;\\nin vec4 v_StrokeColor;\\nin vec4 v_StylePacked1;\\nin vec4 v_StylePacked2;\\n#ifdef USE_UV\\n  in vec2 v_Uv;\\n#endif\\n#ifdef USE_MAP\\n  uniform sampler2D u_Map;\\n#endif\\n\\nin vec4 v_Dash;\\n\\nin vec4 v_Distance;\\nin vec4 v_Arc;\\nin float v_Type;\\nin float v_Travel;\\nin float v_ScalingFactor;\\n\\nout vec4 outputColor;\\nfloat epsilon = 0.000001;\\n\\nvoid main(){\\n  vec4 u_Color = v_Color;\\nvec4 u_StrokeColor = v_StrokeColor;\\nfloat u_Opacity = v_StylePacked1.x;\\nfloat u_FillOpacity = v_StylePacked1.y;\\nfloat u_StrokeOpacity = v_StylePacked1.z;\\nfloat u_StrokeWidth = v_StylePacked1.w;\\nfloat u_Visible = v_StylePacked2.x;\\nvec3 u_PickingColor = v_PickingResult.xyz;\\n\\nif (u_Visible < 0.5) {\\n    discard;\\n}\\n  #ifdef USE_MAP\\n  #ifdef USE_PATTERN\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #else\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #endif\\n#endif\\n\\n  float alpha = 1.0;\\n  float lineWidth = v_Distance.w;\\n  if (v_Type < 0.5) {\\n    float left = max(v_Distance.x - 0.5, -v_Distance.w);\\n    float right = min(v_Distance.x + 0.5, v_Distance.w);\\n    float near = v_Distance.y - 0.5;\\n    float far = min(v_Distance.y + 0.5, 0.0);\\n    float top = v_Distance.z - 0.5;\\n    float bottom = min(v_Distance.z + 0.5, 0.0);\\n    alpha = max(right - left, 0.0) * max(bottom - top, 0.0) * max(far - near, 0.0);\\n  } else if (v_Type < 1.5) {\\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\\n    alpha = a2 * b2 - a1 * b1;\\n  } else if (v_Type < 2.5) {\\n    alpha *= max(min(v_Distance.x + 0.5, 1.0), 0.0);\\n    alpha *= max(min(v_Distance.y + 0.5, 1.0), 0.0);\\n    alpha *= max(min(v_Distance.z + 0.5, 1.0), 0.0);\\n  } else if (v_Type < 3.5) {\\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\\n    float alpha_miter = a2 * b2 - a1 * b1;\\n    float alpha_plane = max(min(v_Distance.z + 0.5, 1.0), 0.0);\\n    float d = length(v_Arc.xy);\\n    float circle_hor = max(min(v_Arc.w, d + 0.5) - max(-v_Arc.w, d - 0.5), 0.0);\\n    float circle_vert = min(v_Arc.w * 2.0, 1.0);\\n    float alpha_circle = circle_hor * circle_vert;\\n    alpha = min(alpha_miter, max(alpha_circle, alpha_plane));\\n  } else {\\n    float a1 = clamp(v_Distance.x + 0.5 - lineWidth, 0.0, 1.0);\\n    float a2 = clamp(v_Distance.x + 0.5 + lineWidth, 0.0, 1.0);\\n    float b1 = clamp(v_Distance.y + 0.5 - lineWidth, 0.0, 1.0);\\n    float b2 = clamp(v_Distance.y + 0.5 + lineWidth, 0.0, 1.0);\\n    alpha = a2 * b2 - a1 * b1;\\n    alpha *= max(min(v_Distance.z + 0.5, 1.0), 0.0);\\n  }\\n\\n  float u_Dash = v_Dash.x;\\n  float u_Gap = v_Dash.y;\\n  float u_DashOffset = v_Dash.z;\\n  if (u_Dash + u_Gap > 1.0) {\\n    float travel = mod(v_Travel + u_Gap * v_ScalingFactor * 0.5 + u_DashOffset, u_Dash * v_ScalingFactor + u_Gap * v_ScalingFactor) - (u_Gap * v_ScalingFactor * 0.5);\\n    float left = max(travel - 0.5, -0.5);\\n    float right = min(travel + 0.5, u_Gap * v_ScalingFactor + 0.5);\\n    alpha *= max(0.0, right - left);\\n  }\\n\\n  if (u_IsPicking > 0.5) {\\n    vec3 pickingColor = u_PickingColor;\\n    if (pickingColor.x == 0.0 && pickingColor.y == 0.0 && pickingColor.z == 0.0) {\\n      discard;\\n    }\\n    outputColor = vec4(pickingColor, 1.0);\\n  } else {\\n    outputColor = u_StrokeColor;\\n    #ifdef USE_MAP\\n      outputColor = u_Color;\\n    #endif\\n\\n    outputColor.a *= alpha * u_Opacity * u_StrokeOpacity;\\n    if (outputColor.a < epsilon) {\\n      discard;\\n    }\\n  }\\n}\"; // eslint-disable-line\n\nvar vert$2 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\\nlayout(location = PACKED_COLOR) in vec4 a_PackedColor;\\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\\n\\nout vec4 v_PickingResult;\\nout vec4 v_Color;\\nout vec4 v_StrokeColor;\\nout vec4 v_StylePacked1;\\nout vec4 v_StylePacked2;\\n\\n#define COLOR_SCALE 1. / 255.\\nvoid setPickingColor(vec3 pickingColor) {\\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\\n}\\n\\nvec2 unpack_float(const float packedValue) {\\n  int packedIntValue = int(packedValue);\\n  int v0 = packedIntValue / 256;\\n  return vec2(v0, packedIntValue - v0 * 256);\\n}\\nvec4 decode_color(const vec2 encodedColor) {\\n  return vec4(\\n    unpack_float(encodedColor[0]) / 255.0,\\n    unpack_float(encodedColor[1]) / 255.0\\n  );\\n}\\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\\n  return pm * vm * mm * pos;\\n}\\n\\nbool isPerspectiveMatrix(mat4 m) {\\n  return m[2][3] == -1.0;\\n}\\n\\nvec4 billboard(vec2 offset, float rotation, bool isSizeAttenuation, mat4 pm, mat4 vm, mat4 mm, vec3 position) {\\n  vec4 mvPosition = vm * mm * vec4(position, 1.0);\\n  vec2 scale;\\n  scale.x = length(vec3(mm[0][0], mm[0][1], mm[0][2]));\\n  scale.y = length(vec3(mm[1][0], mm[1][1], mm[1][2]));\\n\\n  if (isSizeAttenuation) {\\n    bool isPerspective = isPerspectiveMatrix(pm);\\n    if (isPerspective) {\\n      scale *= -mvPosition.z / 250.0;\\n    }\\n  }\\n\\n  vec2 alignedPosition = offset * scale;\\n  vec2 rotatedPosition;\\n  rotatedPosition.x = cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y;\\n  rotatedPosition.y = sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y;\\n\\n  mvPosition.xy += rotatedPosition;\\n  return pm * mvPosition;\\n}\\n\\nlayout(location = PREV) in vec3 a_Prev;\\nlayout(location = POINT1) in vec3 a_Point1;\\nlayout(location = POINT2) in vec3 a_Point2;\\nlayout(location = NEXT) in vec3 a_Next;\\nlayout(location = VERTEX_JOINT) in float a_VertexJoint;\\nlayout(location = VERTEX_NUM) in float a_VertexNum;\\nlayout(location = TRAVEL) in float a_Travel;\\n#ifdef USE_UV\\n  layout(location = UV) in vec2 a_Uv;\\n  out vec2 v_Uv;\\n#endif\\nlayout(location = DASH) in vec4 a_Dash;\\nout vec4 v_Dash;\\n\\nconst float FILL = 1.0;\\nconst float BEVEL = 4.0;\\nconst float MITER = 8.0;\\nconst float ROUND = 12.0;\\nconst float JOINT_CAP_BUTT = 16.0;\\nconst float JOINT_CAP_SQUARE = 18.0;\\nconst float JOINT_CAP_ROUND = 20.0;\\nconst float FILL_EXPAND = 24.0;\\nconst float CAP_BUTT = 1.0;\\nconst float CAP_SQUARE = 2.0;\\nconst float CAP_ROUND = 3.0;\\nconst float CAP_BUTT2 = 4.0;\\n\\nconst float u_Expand = 1.0;\\nconst float u_MiterLimit = 5.0;\\nconst float u_ScaleMode = 1.0;\\nconst float u_Alignment = 0.5;\\n\\nout vec4 v_Distance;\\nout vec4 v_Arc;\\nout float v_Type;\\nout float v_Travel;\\nout float v_ScalingFactor;\\n\\nvec2 doBisect(\\n  vec2 norm, float len, vec2 norm2, float len2, float dy, float inner\\n) {\\n  vec2 bisect = (norm + norm2) / 2.0;\\n  bisect /= dot(norm, bisect);\\n  vec2 shift = dy * bisect;\\n  if (inner > 0.5) {\\n    if (len < len2) {\\n      if (abs(dy * (bisect.x * norm.y - bisect.y * norm.x)) > len) {\\n        return dy * norm;\\n      }\\n    } else {\\n      if (abs(dy * (bisect.x * norm2.y - bisect.y * norm2.x)) > len2) {\\n        return dy * norm;\\n      }\\n    }\\n  }\\n  return dy * bisect;\\n}\\n\\nvec2 clip2ScreenSpace(vec4 clip) {\\n  return u_Viewport * (0.5 * clip.xy / clip.w + 0.5);\\n}\\n\\nvoid main() {\\n  vec4 a_Color = decode_color(a_PackedColor.xy);\\nvec4 a_StrokeColor = decode_color(a_PackedColor.zw);\\n\\nmat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\\nvec4 u_StrokeColor = a_StrokeColor;\\nfloat u_Opacity = a_StylePacked1.x;\\nfloat u_FillOpacity = a_StylePacked1.y;\\nfloat u_StrokeOpacity = a_StylePacked1.z;\\nfloat u_StrokeWidth = a_StylePacked1.w;\\nfloat u_ZIndex = a_PickingColor.w;\\nvec2 u_Anchor = a_StylePacked2.yz;\\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\\n\\nsetPickingColor(a_PickingColor.xyz);\\n\\nv_Color = a_Color;\\nv_StrokeColor = a_StrokeColor;\\nv_StylePacked1 = a_StylePacked1;\\nv_StylePacked2 = a_StylePacked2;\\n\\n// #ifdef CLIPSPACE_NEAR_ZERO\\n//     gl_Position.z = (gl_Position.z + gl_Position.w) * 0.5;\\n// #endif\\n  #ifdef USE_UV\\n  v_Uv = a_Uv;\\n#endif\\n\\n  v_Dash = a_Dash;\\n\\n  vec2 pointA;\\n  vec2 pointB;\\n  vec4 clip0;\\n  vec4 clip1;\\n\\n  float compressed = a_Dash.w;\\n  float is_billboard = floor(compressed / 4.0);\\n  compressed -= is_billboard * 4.0;\\n  float is_size_attenuation = floor(compressed / 2.0);\\n  compressed -= is_size_attenuation * 2.0;\\n  float is_3d_polyline = compressed;\\n\\n  bool isBillboard = is_billboard > 0.5;\\n  bool isSizeAttenuation = is_size_attenuation > 0.5;\\n  bool is3DPolyline = is_3d_polyline > 0.5;\\n  if (isBillboard) {\\n    clip0 = billboard(a_Point1.xy, 0.0, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, vec3(0.0));\\n    clip1 = billboard(a_Point2.xy, 0.0, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, vec3(0.0));\\n  } else if (is3DPolyline) {\\n    clip0 = project(vec4(a_Point1, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n    clip1 = project(vec4(a_Point2, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n  }\\n\\n  if (isBillboard || is3DPolyline) {\\n    pointA = clip2ScreenSpace(clip0);\\n    pointB = clip2ScreenSpace(clip1);\\n  } else {\\n    pointA = (u_ModelMatrix * vec4(a_Point1, 1.0)).xy;\\n    pointB = (u_ModelMatrix * vec4(a_Point2, 1.0)).xy;\\n  }\\n\\n  vec2 xBasis = pointB - pointA;\\n  float len = length(xBasis);\\n  vec2 forward = xBasis / len;\\n  vec2 norm = vec2(forward.y, -forward.x);\\n\\n  float type = a_VertexJoint;\\n\\n  float lineWidth;\\n  if (u_IsPicking > 0.5) {\\n    lineWidth = u_IncreasedLineWidthForHitTesting + u_StrokeWidth;\\n  } else {\\n    lineWidth = u_StrokeWidth;\\n  }\\n\\n  if (u_ScaleMode > 2.5) {\\n    lineWidth *= length(u_ModelMatrix * vec4(1.0, 0.0, 0.0, 0.0));\\n  } else if (u_ScaleMode > 1.5) {\\n    lineWidth *= length(u_ModelMatrix * vec4(0.0, 1.0, 0.0, 0.0));\\n  } else if (u_ScaleMode > 0.5) {\\n    vec2 avgDiag = (u_ModelMatrix * vec4(1.0, 1.0, 0.0, 0.0)).xy;\\n    lineWidth *= sqrt(dot(avgDiag, avgDiag) * 0.5);\\n  }\\n  float capType = floor(type / 32.0);\\n  type -= capType * 32.0;\\n  v_Arc = vec4(0.0);\\n  lineWidth *= 0.5;\\n  float lineAlignment = 2.0 * u_Alignment - 1.0;\\n\\n  vec2 pos;\\n\\n  if (capType == CAP_ROUND) {\\n    if (a_VertexNum < 3.5) {\\n      gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\\n      return;\\n    }\\n    type = JOINT_CAP_ROUND;\\n    capType = 0.0;\\n  }\\n\\n  if (type >= BEVEL) {\\n    float dy = lineWidth + u_Expand;\\n    float inner = 0.0;\\n    if (a_VertexNum >= 1.5) {\\n      dy = -dy;\\n      inner = 1.0;\\n    }\\n\\n    vec2 base, next, xBasis2, bisect;\\n    float flag = 0.0;\\n    float sign2 = 1.0;\\n    if (a_VertexNum < 0.5 || a_VertexNum > 2.5 && a_VertexNum < 3.5) {\\n      if (isBillboard) {\\n        next = clip2ScreenSpace(billboard(a_Prev.xy, 0.0, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, vec3(0.0)));\\n      } else if (is3DPolyline) {\\n        next = clip2ScreenSpace(project(vec4(a_Prev, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix));\\n      } else {\\n        next = (u_ModelMatrix * vec4(a_Prev, 1.0)).xy;\\n      }\\n\\n      base = pointA;\\n      flag = type - floor(type / 2.0) * 2.0;\\n      sign2 = -1.0;\\n    } else {\\n      if (isBillboard) {\\n        next = clip2ScreenSpace(billboard(a_Next.xy, 0.0, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, vec3(0.0)));\\n      } else if (is3DPolyline) {\\n        next = clip2ScreenSpace(project(vec4(a_Next, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix));\\n      } else {\\n        next = (u_ModelMatrix * vec4(a_Next, 1.0)).xy;\\n      }\\n      \\n      base = pointB;\\n      if (type >= MITER && type < MITER + 3.5) {\\n        flag = step(MITER + 1.5, type);\\n        // check miter limit here?\\n      }\\n    }\\n    xBasis2 = next - base;\\n    float len2 = length(xBasis2);\\n    vec2 norm2 = vec2(xBasis2.y, -xBasis2.x) / len2;\\n    float D = norm.x * norm2.y - norm.y * norm2.x;\\n    if (D < 0.0) {\\n      inner = 1.0 - inner;\\n    }\\n    norm2 *= sign2;\\n\\n    if (abs(lineAlignment) > 0.01) {\\n      float shift = lineWidth * lineAlignment;\\n      pointA += norm * shift;\\n      pointB += norm * shift;\\n      if (abs(D) < 0.01) {\\n        base += norm * shift;\\n      } else {\\n        base += doBisect(norm, len, norm2, len2, shift, 0.0);\\n      }\\n    }\\n\\n    float collinear = step(0.0, dot(norm, norm2));\\n    v_Type = 0.0;\\n    float dy2 = -1000.0;\\n    float dy3 = -1000.0;\\n    if (abs(D) < 0.01 && collinear < 0.5) {\\n      if (type >= ROUND && type < ROUND + 1.5) {\\n        type = JOINT_CAP_ROUND;\\n      }\\n      // TODO: BUTT here too\\n    }\\n\\n    if (a_VertexNum < 3.5) {\\n      if (abs(D) < 0.01) {\\n        pos = dy * norm;\\n      } else {\\n        if (flag < 0.5 && inner < 0.5) {\\n          pos = dy * norm;\\n        } else {\\n          pos = doBisect(norm, len, norm2, len2, dy, inner);\\n        }\\n      }\\n      if (capType >= CAP_BUTT && capType < CAP_ROUND) {\\n        float extra = step(CAP_SQUARE, capType) * lineWidth;\\n        vec2 back = -forward;\\n        if (a_VertexNum < 0.5 || a_VertexNum > 2.5) {\\n          pos += back * (u_Expand + extra);\\n          dy2 = u_Expand;\\n        } else {\\n          dy2 = dot(pos + base - pointA, back) - extra;\\n        }\\n      }\\n      if (type >= JOINT_CAP_BUTT && type < JOINT_CAP_SQUARE + 0.5) {\\n        float extra = step(JOINT_CAP_SQUARE, type) * lineWidth;\\n        if (a_VertexNum < 0.5 || a_VertexNum > 2.5) {\\n          dy3 = dot(pos + base - pointB, forward) - extra;\\n        } else {\\n          pos += forward * (u_Expand + extra);\\n          dy3 = u_Expand;\\n          if (capType >= CAP_BUTT) {\\n            dy2 -= u_Expand + extra;\\n          }\\n        }\\n      }\\n    } else if (type >= JOINT_CAP_ROUND && type < JOINT_CAP_ROUND + 1.5) {\\n      if (inner > 0.5) {\\n        dy = -dy;\\n        inner = 0.0;\\n      }\\n      vec2 d2 = abs(dy) * forward;\\n      if (a_VertexNum < 4.5) {\\n        dy = -dy;\\n        pos = dy * norm;\\n      } else if (a_VertexNum < 5.5) {\\n        pos = dy * norm;\\n      } else if (a_VertexNum < 6.5) {\\n        pos = dy * norm + d2;\\n        v_Arc.x = abs(dy);\\n      } else {\\n        dy = -dy;\\n        pos = dy * norm + d2;\\n        v_Arc.x = abs(dy);\\n      }\\n      dy2 = 0.0;\\n      v_Arc.y = dy;\\n      v_Arc.z = 0.0;\\n      v_Arc.w = lineWidth;\\n      v_Type = 3.0;\\n    } else if (abs(D) < 0.01) {\\n      pos = dy * norm;\\n    } else {\\n      if (type >= ROUND && type < ROUND + 1.5) {\\n        if (inner > 0.5) {\\n          dy = -dy;\\n          inner = 0.0;\\n        }\\n        if (a_VertexNum < 4.5) {\\n          pos = doBisect(norm, len, norm2, len2, -dy, 1.0);\\n        } else if (a_VertexNum < 5.5) {\\n          pos = dy * norm;\\n        } else if (a_VertexNum > 7.5) {\\n          pos = dy * norm2;\\n        } else {\\n          pos = doBisect(norm, len, norm2, len2, dy, 0.0);\\n          float d2 = abs(dy);\\n          if (length(pos) > abs(dy) * 1.5) {\\n            if (a_VertexNum < 6.5) {\\n              pos.x = dy * norm.x - d2 * norm.y;\\n              pos.y = dy * norm.y + d2 * norm.x;\\n            } else {\\n              pos.x = dy * norm2.x + d2 * norm2.y;\\n              pos.y = dy * norm2.y - d2 * norm2.x;\\n            }\\n          }\\n        }\\n        vec2 norm3 = normalize(norm + norm2);\\n        float sign = step(0.0, dy) * 2.0 - 1.0;\\n        v_Arc.x = sign * dot(pos, norm3);\\n        v_Arc.y = pos.x * norm3.y - pos.y * norm3.x;\\n        v_Arc.z = dot(norm, norm3) * lineWidth;\\n        v_Arc.w = lineWidth;\\n        dy = -sign * dot(pos, norm);\\n        dy2 = -sign * dot(pos, norm2);\\n        dy3 = v_Arc.z - v_Arc.x;\\n        v_Type = 3.0;\\n      } else {\\n        float hit = 0.0;\\n        if (type >= BEVEL && type < BEVEL + 1.5) {\\n          if (dot(norm, norm2) > 0.0) {\\n            type = MITER;\\n          }\\n        }\\n        if (type >= MITER && type < MITER + 3.5) {\\n          if (inner > 0.5) {\\n            dy = -dy;\\n            inner = 0.0;\\n          }\\n          float sign = step(0.0, dy) * 2.0 - 1.0;\\n          pos = doBisect(norm, len, norm2, len2, dy, 0.0);\\n          if (length(pos) > abs(dy) * u_MiterLimit) {\\n            type = BEVEL;\\n          } else {\\n            if (a_VertexNum < 4.5) {\\n              dy = -dy;\\n              pos = doBisect(norm, len, norm2, len2, dy, 1.0);\\n            } else if (a_VertexNum < 5.5) {\\n              pos = dy * norm;\\n            } else if (a_VertexNum > 6.5) {\\n              pos = dy * norm2;\\n            }\\n            v_Type = 1.0;\\n            dy = -sign * dot(pos, norm);\\n            dy2 = -sign * dot(pos, norm2);\\n            hit = 1.0;\\n          }\\n        }\\n        if (type >= BEVEL && type < BEVEL + 1.5) {\\n          if (inner > 0.5) {\\n            dy = -dy;\\n            inner = 0.0;\\n          }\\n          float d2 = abs(dy);\\n          vec2 pos3 = vec2(dy * norm.x - d2 * norm.y, dy * norm.y + d2 * norm.x);\\n          vec2 pos4 = vec2(dy * norm2.x + d2 * norm2.y, dy * norm2.y - d2 * norm2.x);\\n          if (a_VertexNum < 4.5) {\\n            pos = doBisect(norm, len, norm2, len2, -dy, 1.0);\\n          } else if (a_VertexNum < 5.5) {\\n            pos = dy * norm;\\n          } else if (a_VertexNum > 7.5) {\\n            pos = dy * norm2;\\n          } else {\\n            if (a_VertexNum < 6.5) {\\n              pos = pos3;\\n            } else {\\n              pos = pos4;\\n            }\\n          }\\n          vec2 norm3 = normalize(norm + norm2);\\n          float sign = step(0.0, dy) * 2.0 - 1.0;\\n          dy = -sign * dot(pos, norm);\\n          dy2 = -sign * dot(pos, norm2);\\n          dy3 = (-sign * dot(pos, norm3)) + lineWidth;\\n          v_Type = 4.0;\\n          hit = 1.0;\\n        }\\n        if (hit < 0.5) {\\n          gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\\n          return;\\n        }\\n      }\\n    }\\n    pos += base;\\n    v_Distance = vec4(dy, dy2, dy3, lineWidth) * u_DevicePixelRatio;\\n    v_Arc = v_Arc * u_DevicePixelRatio;\\n    v_Travel = a_Travel + dot(pos - pointA, vec2(-norm.y, norm.x));\\n  }\\n\\n  v_ScalingFactor = sqrt(u_ModelMatrix[0][0] * u_ModelMatrix[0][0] + u_ModelMatrix[0][1] * u_ModelMatrix[0][1] + u_ModelMatrix[0][2] * u_ModelMatrix[0][2]);\\n\\n  if (isBillboard || is3DPolyline) {\\n    vec4 clip = mix(clip0, clip1, 0.5);\\n    gl_Position = vec4(clip.w * (2.0 * pos / u_Viewport - 1.0), clip.z, clip.w);\\n  } else {\\n    gl_Position = u_ProjectionMatrix * u_ViewMatrix * vec4(pos, u_ZIndex, 1.0);\\n  }\\n}\"; // eslint-disable-line\n\nvar SEGMENT_LENGTH = 10;\nvar MIN_SEGMENT_NUM = 8;\nvar MAX_SEGMENT_NUM = 100;\nfunction quadCurveTo(cpX, cpY, toX, toY, points, segmentNum) {\n    var fromX = points[points.length - 3];\n    var fromY = points[points.length - 2];\n    var n = segmentNum !== null && segmentNum !== void 0 ? segmentNum : clamp(quadLength(fromX, fromY, cpX, cpY, toX, toY) / SEGMENT_LENGTH, MIN_SEGMENT_NUM, MAX_SEGMENT_NUM);\n    var xa = 0;\n    var ya = 0;\n    for (var i = 1; i <= n; ++i) {\n        var j = i / n;\n        xa = fromX + (cpX - fromX) * j;\n        ya = fromY + (cpY - fromY) * j;\n        points.push(xa + (cpX + (toX - cpX) * j - xa) * j, ya + (cpY + (toY - cpY) * j - ya) * j, 0);\n    }\n}\nfunction bezierCurveTo(cpX, cpY, cpX2, cpY2, toX, toY, points, segmentNum) {\n    var fromX = points[points.length - 3];\n    var fromY = points[points.length - 2];\n    points.length -= 3;\n    var n = segmentNum !== null && segmentNum !== void 0 ? segmentNum : clamp(cubicLength(fromX, fromY, cpX, cpY, cpX2, cpY2, toX, toY) /\n        SEGMENT_LENGTH, MIN_SEGMENT_NUM, MAX_SEGMENT_NUM);\n    var dt = 0;\n    var dt2 = 0;\n    var dt3 = 0;\n    var t2 = 0;\n    var t3 = 0;\n    points.push(fromX, fromY, 0);\n    for (var i = 1, j = 0; i <= n; ++i) {\n        j = i / n;\n        dt = 1 - j;\n        dt2 = dt * dt;\n        dt3 = dt2 * dt;\n        t2 = j * j;\n        t3 = t2 * j;\n        points.push(dt3 * fromX + 3 * dt2 * j * cpX + 3 * dt * t2 * cpX2 + t3 * toX, dt3 * fromY + 3 * dt2 * j * cpY + 3 * dt * t2 * cpY2 + t3 * toY, 0);\n    }\n}\n\n/**\n * Borrow from https://github.com/mapbox/tiny-sdf\n */\nvar INF = 1e20;\nvar TinySDF = /** @class */ (function () {\n    function TinySDF(options, runtime) {\n        var _a = options.fontSize, fontSize = _a === void 0 ? 24 : _a, _b = options.buffer, buffer = _b === void 0 ? 3 : _b, _c = options.radius, radius = _c === void 0 ? 8 : _c, _d = options.cutoff, cutoff = _d === void 0 ? 0.25 : _d, _e = options.fontFamily, fontFamily = _e === void 0 ? 'sans-serif' : _e, _f = options.fontWeight, fontWeight = _f === void 0 ? 'normal' : _f, _g = options.fontStyle, fontStyle = _g === void 0 ? 'normal' : _g, canvas = options.canvas;\n        this.buffer = buffer;\n        this.cutoff = cutoff;\n        this.radius = radius;\n        // make the canvas size big enough to both have the specified buffer around the glyph\n        // for \"halo\", and account for some glyphs possibly being larger than their font size\n        var size = (this.size = fontSize + buffer * 4);\n        var $offscreenCanvas = runtime.offscreenCanvasCreator.getOrCreateCanvas(canvas);\n        // canvas.width = canvas.height = size;\n        // $offscreenCanvas.width = width * dpr;\n        // $offscreenCanvas.height = height * dpr;\n        $offscreenCanvas.width = size;\n        $offscreenCanvas.height = size;\n        var ctx = runtime.offscreenCanvasCreator.getOrCreateContext(canvas, {\n            willReadFrequently: true,\n        });\n        this.ctx = ctx;\n        // const ctx = (this.ctx = canvas.getContext('2d', {\n        //   willReadFrequently: true,\n        // }));\n        ctx.font = \"\".concat(fontStyle, \" \").concat(fontWeight, \" \").concat(fontSize, \"px \").concat(fontFamily);\n        ctx.textBaseline = 'alphabetic';\n        ctx.textAlign = 'left'; // Necessary so that RTL text doesn't have different alignment\n        ctx.fillStyle = 'black';\n        // temporary arrays for the distance transform\n        this.gridOuter = new Float64Array(size * size);\n        this.gridInner = new Float64Array(size * size);\n        this.f = new Float64Array(size);\n        this.z = new Float64Array(size + 1);\n        this.v = new Uint16Array(size);\n    }\n    // _createCanvas(size) {\n    //   const canvas = document.createElement('canvas');\n    //   canvas.width = canvas.height = size;\n    //   return canvas;\n    // }\n    TinySDF.prototype.draw = function (char) {\n        var _a = this.ctx.measureText(char), glyphAdvance = _a.width, actualBoundingBoxAscent = _a.actualBoundingBoxAscent, actualBoundingBoxDescent = _a.actualBoundingBoxDescent, actualBoundingBoxLeft = _a.actualBoundingBoxLeft, actualBoundingBoxRight = _a.actualBoundingBoxRight;\n        // The integer/pixel part of the top alignment is encoded in metrics.glyphTop\n        // The remainder is implicitly encoded in the rasterization\n        var glyphTop = Math.ceil(actualBoundingBoxAscent);\n        var glyphLeft = 0;\n        // If the glyph overflows the canvas size, it will be clipped at the bottom/right\n        var glyphWidth = Math.max(0, Math.min(this.size - this.buffer, Math.ceil(actualBoundingBoxRight - actualBoundingBoxLeft)));\n        var glyphHeight = Math.min(this.size - this.buffer, glyphTop + Math.ceil(actualBoundingBoxDescent));\n        var width = glyphWidth + 2 * this.buffer;\n        var height = glyphHeight + 2 * this.buffer;\n        var len = Math.max(width * height, 0);\n        var data = new Uint8ClampedArray(len);\n        var glyph = {\n            data: data,\n            width: width,\n            height: height,\n            glyphWidth: glyphWidth,\n            glyphHeight: glyphHeight,\n            glyphTop: glyphTop,\n            glyphLeft: glyphLeft,\n            glyphAdvance: glyphAdvance,\n        };\n        if (glyphWidth === 0 || glyphHeight === 0)\n            return glyph;\n        var _b = this, ctx = _b.ctx, buffer = _b.buffer, gridInner = _b.gridInner, gridOuter = _b.gridOuter;\n        ctx.clearRect(buffer, buffer, glyphWidth, glyphHeight);\n        ctx.fillText(char, buffer, buffer + glyphTop);\n        var imgData = ctx.getImageData(buffer, buffer, glyphWidth, glyphHeight);\n        // Initialize grids outside the glyph range to alpha 0\n        gridOuter.fill(INF, 0, len);\n        gridInner.fill(0, 0, len);\n        for (var y = 0; y < glyphHeight; y++) {\n            for (var x = 0; x < glyphWidth; x++) {\n                var a = imgData.data[4 * (y * glyphWidth + x) + 3] / 255; // alpha value\n                if (a === 0)\n                    continue; // empty pixels\n                var j = (y + buffer) * width + x + buffer;\n                if (a === 1) {\n                    // fully drawn pixels\n                    gridOuter[j] = 0;\n                    gridInner[j] = INF;\n                }\n                else {\n                    // aliased pixels\n                    var d = 0.5 - a;\n                    gridOuter[j] = d > 0 ? d * d : 0;\n                    gridInner[j] = d < 0 ? d * d : 0;\n                }\n            }\n        }\n        edt(gridOuter, 0, 0, width, height, width, this.f, this.v, this.z);\n        edt(gridInner, buffer, buffer, glyphWidth, glyphHeight, width, this.f, this.v, this.z);\n        for (var i = 0; i < len; i++) {\n            var d = Math.sqrt(gridOuter[i]) - Math.sqrt(gridInner[i]);\n            data[i] = Math.round(255 - 255 * (d / this.radius + this.cutoff));\n        }\n        return glyph;\n    };\n    return TinySDF;\n}());\n// 2D Euclidean squared distance transform by Felzenszwalb & Huttenlocher https://cs.brown.edu/~pff/papers/dt-final.pdf\nfunction edt(data, x0, y0, width, height, gridSize, f, v, z) {\n    for (var x = x0; x < x0 + width; x++)\n        edt1d(data, y0 * gridSize + x, gridSize, height, f, v, z);\n    for (var y = y0; y < y0 + height; y++)\n        edt1d(data, y * gridSize + x0, 1, width, f, v, z);\n}\n// 1D squared distance transform\nfunction edt1d(grid, offset, stride, length, f, v, z) {\n    v[0] = 0;\n    z[0] = -INF;\n    z[1] = INF;\n    f[0] = grid[offset];\n    for (var q = 1, k = 0, s = 0; q < length; q++) {\n        f[q] = grid[offset + q * stride];\n        var q2 = q * q;\n        do {\n            var r = v[k];\n            s = (f[q] - f[r] + q2 - r * r) / (q - r) / 2;\n        } while (s <= z[k] && --k > -1);\n        k++;\n        v[k] = q;\n        z[k] = s;\n        z[k + 1] = INF;\n    }\n    for (var q = 0, k = 0; q < length; q++) {\n        while (z[k + 1] < q)\n            k++;\n        var r = v[k];\n        var qr = q - r;\n        grid[offset + q * stride] = f[r] + qr * qr;\n    }\n}\n\nvar LineVertexAttributeBufferIndex;\n(function (LineVertexAttributeBufferIndex) {\n    LineVertexAttributeBufferIndex[LineVertexAttributeBufferIndex[\"PACKED\"] = 5] = \"PACKED\";\n    LineVertexAttributeBufferIndex[LineVertexAttributeBufferIndex[\"VERTEX_NUM\"] = 6] = \"VERTEX_NUM\";\n    LineVertexAttributeBufferIndex[LineVertexAttributeBufferIndex[\"TRAVEL\"] = 7] = \"TRAVEL\";\n    LineVertexAttributeBufferIndex[LineVertexAttributeBufferIndex[\"DASH\"] = 8] = \"DASH\";\n})(LineVertexAttributeBufferIndex || (LineVertexAttributeBufferIndex = {}));\nvar LineVertexAttributeLocation;\n(function (LineVertexAttributeLocation) {\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"PREV\"] = 8] = \"PREV\";\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"POINT1\"] = 9] = \"POINT1\";\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"POINT2\"] = 10] = \"POINT2\";\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"NEXT\"] = 11] = \"NEXT\";\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"VERTEX_JOINT\"] = 12] = \"VERTEX_JOINT\";\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"VERTEX_NUM\"] = 13] = \"VERTEX_NUM\";\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"TRAVEL\"] = 14] = \"TRAVEL\";\n    LineVertexAttributeLocation[LineVertexAttributeLocation[\"DASH\"] = 15] = \"DASH\";\n})(LineVertexAttributeLocation || (LineVertexAttributeLocation = {}));\nvar SEGMENT_NUM$1 = 12;\nfunction packBoolean(a, b, c) {\n    return (a ? 1 : 0) * 4 + (b ? 1 : 0) * 2 + (c ? 1 : 0);\n}\nfunction is3DPolyline(object) {\n    var isPolyline = object.nodeName === Shape.POLYLINE;\n    if (!isPolyline) {\n        return false;\n    }\n    // Polyline supports 3 dimensions so that each point is shaped like [x, y, z].\n    var polylineControlPoints = object.parsedStyle.points.points;\n    var length = polylineControlPoints.length;\n    return length && !isNil(polylineControlPoints[0][2]);\n}\n/**\n * Used for Curve only contains 2 commands, e.g. [[M], [C | Q | A]]\n */\nvar InstancedPathDrawcall = /** @class */ (function (_super) {\n    __extends(InstancedPathDrawcall, _super);\n    function InstancedPathDrawcall(renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) {\n        var _this = _super.call(this, renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) || this;\n        _this.renderHelper = renderHelper;\n        _this.texturePool = texturePool;\n        _this.lightPool = lightPool;\n        // protected mergeAnchorIntoModelMatrix = true;\n        _this.segmentNum = -1;\n        _this.segmentNum = _this.calcSegmentNum(object);\n        _this.gradientAttributeName = 'stroke';\n        return _this;\n    }\n    InstancedPathDrawcall.calcSubpathNum = function (object) {\n        if (object.nodeName === Shape.PATH) {\n            var absolutePath = object.parsedStyle.d.absolutePath;\n            return absolutePath.filter(function (d) { return d[0] === 'M'; }).length;\n        }\n        return 1;\n    };\n    InstancedPathDrawcall.prototype.calcSegmentNum = function (object) {\n        // FIXME: only need to collect instanced count\n        var instancedCount = updateBuffer(object, false, SEGMENT_NUM$1, this.calcSubpathIndex(object)).instancedCount;\n        return instancedCount;\n    };\n    InstancedPathDrawcall.prototype.calcSubpathIndex = function (object) {\n        if (object.nodeName === Shape.PATH) {\n            var fillDrawcallCount = this.drawcallCtors.filter(function (ctor) { return ctor === InstancedFillDrawcall; }).length;\n            return this.index - fillDrawcallCount;\n        }\n        return 0;\n    };\n    /**\n     * Paths with the same number of vertices should be merged.\n     */\n    InstancedPathDrawcall.prototype.shouldMerge = function (object, index) {\n        var shouldMerge = _super.prototype.shouldMerge.call(this, object, index);\n        if (!shouldMerge) {\n            return false;\n        }\n        if (this.index !== index) {\n            return false;\n        }\n        var segmentNum = this.calcSegmentNum(object);\n        return this.segmentNum === segmentNum;\n    };\n    InstancedPathDrawcall.prototype.createMaterial = function (objects) {\n        this.material.vertexShader = vert$2;\n        this.material.fragmentShader = frag$2;\n        this.material.defines = __assign(__assign({}, this.material.defines), enumToObject(LineVertexAttributeLocation));\n    };\n    InstancedPathDrawcall.prototype.createGeometry = function (objects) {\n        var _this = this;\n        var indices = [];\n        var pointsBuffer = [];\n        var travelBuffer = [];\n        var packedDash = [];\n        var instancedCount = 0;\n        var offset = 0;\n        objects.forEach(function (object) {\n            var _a = updateBuffer(object, false, SEGMENT_NUM$1, _this.calcSubpathIndex(object)), pBuffer = _a.pointsBuffer, tBuffer = _a.travelBuffer, count = _a.instancedCount;\n            var _b = object.parsedStyle, lineDash = _b.lineDash, lineDashOffset = _b.lineDashOffset, isBillboard = _b.isBillboard, isSizeAttenuation = _b.isSizeAttenuation;\n            packedDash.push((lineDash && lineDash[0]) || 0, // DASH\n            (lineDash && lineDash[1]) || 0, // GAP\n            lineDashOffset || 0, packBoolean(isBillboard, isSizeAttenuation, is3DPolyline(object)));\n            instancedCount += count;\n            // Can't use interleaved buffer here, we should spread them like:\n            // | prev - pointA - pointB - next |. This will allocate ~4x buffer memory space.\n            for (var i = 0; i < pBuffer.length - 3 * 4; i += 4) {\n                pointsBuffer.push(pBuffer[i], pBuffer[i + 1], pBuffer[i + 2], pBuffer[i + 3], pBuffer[i + 4], pBuffer[i + 5], pBuffer[i + 6], pBuffer[i + 7], pBuffer[i + 8], pBuffer[i + 9], pBuffer[i + 10], pBuffer[i + 11], pBuffer[i + 12], pBuffer[i + 13], pBuffer[i + 14], pBuffer[i + 15]);\n            }\n            travelBuffer.push.apply(travelBuffer, __spreadArray([], __read(tBuffer), false));\n            indices.push(0 + offset, 2 + offset, 1 + offset, 0 + offset, 3 + offset, 2 + offset, 4 + offset, 6 + offset, 5 + offset, 4 + offset, 7 + offset, 6 + offset, 4 + offset, 7 + offset, 8 + offset);\n            offset += 9;\n        });\n        if (pointsBuffer.length) {\n            this.geometry.setVertexBuffer({\n                bufferIndex: LineVertexAttributeBufferIndex.PACKED,\n                byteStride: 4 * (4 + 4 + 4 + 4),\n                stepMode: VertexStepMode.INSTANCE,\n                attributes: [\n                    {\n                        format: Format.F32_RGB,\n                        bufferByteOffset: 4 * 0,\n                        location: LineVertexAttributeLocation.PREV,\n                        divisor: 1,\n                    },\n                    {\n                        format: Format.F32_RGB,\n                        bufferByteOffset: 4 * 4,\n                        location: LineVertexAttributeLocation.POINT1,\n                        divisor: 1,\n                    },\n                    {\n                        format: Format.F32_R,\n                        bufferByteOffset: 4 * 7,\n                        location: LineVertexAttributeLocation.VERTEX_JOINT,\n                        divisor: 1,\n                    },\n                    {\n                        format: Format.F32_RGB,\n                        bufferByteOffset: 4 * 8,\n                        location: LineVertexAttributeLocation.POINT2,\n                        divisor: 1,\n                    },\n                    {\n                        format: Format.F32_RGB,\n                        bufferByteOffset: 4 * 12,\n                        location: LineVertexAttributeLocation.NEXT,\n                        divisor: 1,\n                    },\n                ],\n                data: new Float32Array(pointsBuffer),\n            });\n            this.geometry.setVertexBuffer({\n                bufferIndex: LineVertexAttributeBufferIndex.VERTEX_NUM,\n                byteStride: 4 * 1,\n                stepMode: VertexStepMode.INSTANCE,\n                attributes: [\n                    {\n                        format: Format.F32_R,\n                        bufferByteOffset: 4 * 0,\n                        byteStride: 4 * 1,\n                        location: LineVertexAttributeLocation.VERTEX_NUM,\n                        divisor: 0,\n                    },\n                ],\n                data: new Float32Array([0, 1, 2, 3, 4, 5, 6, 7, 8]),\n            });\n            this.geometry.setVertexBuffer({\n                bufferIndex: LineVertexAttributeBufferIndex.TRAVEL,\n                byteStride: 4 * 1,\n                stepMode: VertexStepMode.INSTANCE,\n                attributes: [\n                    {\n                        format: Format.F32_R,\n                        bufferByteOffset: 4 * 0,\n                        byteStride: 4 * 1,\n                        location: LineVertexAttributeLocation.TRAVEL,\n                        divisor: 1,\n                    },\n                ],\n                data: new Float32Array(travelBuffer),\n            });\n            // this attribute only changes for each n instance\n            this.divisor = instancedCount / objects.length;\n            this.geometry.setVertexBuffer({\n                bufferIndex: LineVertexAttributeBufferIndex.DASH,\n                byteStride: 4 * 4,\n                stepMode: VertexStepMode.INSTANCE,\n                attributes: [\n                    {\n                        format: Format.F32_RGBA,\n                        bufferByteOffset: 4 * 0,\n                        location: LineVertexAttributeLocation.DASH,\n                        divisor: this.divisor,\n                    },\n                ],\n                data: new Float32Array(packedDash),\n            });\n            // use default common attributes\n            _super.prototype.createGeometry.call(this, objects);\n            this.geometry.vertexCount = 15;\n            this.geometry.instancedCount = instancedCount;\n            this.geometry.setIndexBuffer(new Uint32Array(indices));\n        }\n    };\n    InstancedPathDrawcall.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        var _this = this;\n        _super.prototype.updateAttribute.call(this, objects, startIndex, name, value);\n        this.updateBatchedAttribute(objects, startIndex, name, value);\n        if (name === 'r' ||\n            name === 'rx' ||\n            name === 'ry' ||\n            name === 'width' ||\n            name === 'height' ||\n            name === 'radius' ||\n            name === 'x1' ||\n            name === 'y1' ||\n            name === 'x2' ||\n            name === 'y2' ||\n            name === 'points' ||\n            name === 'path' ||\n            name === 'd' ||\n            name === 'lineJoin' ||\n            name === 'lineCap' ||\n            name === 'markerStartOffset' ||\n            name === 'markerEndOffset' ||\n            name === 'markerStart' ||\n            name === 'markerEnd') {\n            var pointsBuffer_1 = [];\n            var travelBuffer_1 = [];\n            var instancedCount_1 = 0;\n            objects.forEach(function (object) {\n                var _a = updateBuffer(object, false, SEGMENT_NUM$1, _this.calcSubpathIndex(object)), pBuffer = _a.pointsBuffer, tBuffer = _a.travelBuffer, iCount = _a.instancedCount;\n                instancedCount_1 = iCount;\n                // Can't use interleaved buffer here, we should spread them like:\n                // | prev - pointA - pointB - next |. This will allocate ~4x buffer memory space.\n                for (var i = 0; i < pBuffer.length - 3 * 4; i += 4) {\n                    pointsBuffer_1.push(pBuffer[i], pBuffer[i + 1], pBuffer[i + 2], pBuffer[i + 3], pBuffer[i + 4], pBuffer[i + 5], pBuffer[i + 6], pBuffer[i + 7], pBuffer[i + 8], pBuffer[i + 9], pBuffer[i + 10], pBuffer[i + 11], pBuffer[i + 12], pBuffer[i + 13], pBuffer[i + 14], pBuffer[i + 15]);\n                }\n                travelBuffer_1.push.apply(travelBuffer_1, __spreadArray([], __read(tBuffer), false));\n            });\n            this.geometry.updateVertexBuffer(LineVertexAttributeBufferIndex.PACKED, LineVertexAttributeLocation.PREV, startIndex * instancedCount_1, new Uint8Array(new Float32Array(pointsBuffer_1).buffer));\n            this.geometry.updateVertexBuffer(LineVertexAttributeBufferIndex.TRAVEL, LineVertexAttributeLocation.TRAVEL, startIndex, new Uint8Array(new Float32Array(travelBuffer_1).buffer));\n        }\n        else if (name === 'lineDashOffset' ||\n            name === 'lineDash' ||\n            name === 'isBillboard' ||\n            name === 'isSizeAttenuation') {\n            var packedDash_1 = [];\n            objects.forEach(function (object) {\n                var _a = object.parsedStyle, lineDash = _a.lineDash, lineDashOffset = _a.lineDashOffset, isBillboard = _a.isBillboard, isSizeAttenuation = _a.isSizeAttenuation;\n                packedDash_1.push((lineDash && lineDash[0]) || 0, // DASH\n                (lineDash && lineDash[1]) || 0, // GAP\n                lineDashOffset || 0, packBoolean(isBillboard, isSizeAttenuation, is3DPolyline(object)));\n            });\n            this.geometry.updateVertexBuffer(LineVertexAttributeBufferIndex.DASH, LineVertexAttributeLocation.DASH, startIndex, new Uint8Array(new Float32Array(packedDash_1).buffer));\n        }\n    };\n    return InstancedPathDrawcall;\n}(Instanced));\nvar JOINT_TYPE;\n(function (JOINT_TYPE) {\n    JOINT_TYPE[JOINT_TYPE[\"NONE\"] = 0] = \"NONE\";\n    JOINT_TYPE[JOINT_TYPE[\"FILL\"] = 1] = \"FILL\";\n    JOINT_TYPE[JOINT_TYPE[\"JOINT_BEVEL\"] = 4] = \"JOINT_BEVEL\";\n    JOINT_TYPE[JOINT_TYPE[\"JOINT_MITER\"] = 8] = \"JOINT_MITER\";\n    JOINT_TYPE[JOINT_TYPE[\"JOINT_ROUND\"] = 12] = \"JOINT_ROUND\";\n    JOINT_TYPE[JOINT_TYPE[\"JOINT_CAP_BUTT\"] = 16] = \"JOINT_CAP_BUTT\";\n    JOINT_TYPE[JOINT_TYPE[\"JOINT_CAP_SQUARE\"] = 18] = \"JOINT_CAP_SQUARE\";\n    JOINT_TYPE[JOINT_TYPE[\"JOINT_CAP_ROUND\"] = 20] = \"JOINT_CAP_ROUND\";\n    JOINT_TYPE[JOINT_TYPE[\"FILL_EXPAND\"] = 24] = \"FILL_EXPAND\";\n    JOINT_TYPE[JOINT_TYPE[\"CAP_BUTT\"] = 32] = \"CAP_BUTT\";\n    JOINT_TYPE[JOINT_TYPE[\"CAP_SQUARE\"] = 64] = \"CAP_SQUARE\";\n    JOINT_TYPE[JOINT_TYPE[\"CAP_ROUND\"] = 96] = \"CAP_ROUND\";\n    JOINT_TYPE[JOINT_TYPE[\"CAP_BUTT2\"] = 128] = \"CAP_BUTT2\";\n})(JOINT_TYPE || (JOINT_TYPE = {}));\nvar stridePoints = 3;\nvar strideFloats = 4;\nfunction updateBuffer(object, needEarcut, segmentNum, subPathIndex) {\n    var _a;\n    if (needEarcut === void 0) { needEarcut = false; }\n    if (subPathIndex === void 0) { subPathIndex = 0; }\n    var _b = object.parsedStyle, lineCap = _b.lineCap, lineJoin = _b.lineJoin;\n    var zIndex = object.sortable.renderOrder * RENDER_ORDER_SCALE;\n    var defX = 0;\n    var defY = 0;\n    var _c = object.parsedStyle, markerStart = _c.markerStart, markerEnd = _c.markerEnd, markerStartOffset = _c.markerStartOffset, markerEndOffset = _c.markerEndOffset;\n    var points = [];\n    var triangles = [];\n    if (object.nodeName === Shape.POLYLINE || object.nodeName === Shape.POLYGON) {\n        var polylineControlPoints = object.parsedStyle.points\n            .points;\n        var length_1 = polylineControlPoints.length;\n        var startOffsetX_1 = 0;\n        var startOffsetY_1 = 0;\n        var endOffsetX_1 = 0;\n        var endOffsetY_1 = 0;\n        var rad = 0;\n        var x = void 0;\n        var y = void 0;\n        if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n            x = polylineControlPoints[1][0] - polylineControlPoints[0][0];\n            y = polylineControlPoints[1][1] - polylineControlPoints[0][1];\n            rad = Math.atan2(y, x);\n            startOffsetX_1 = Math.cos(rad) * (markerStartOffset || 0);\n            startOffsetY_1 = Math.sin(rad) * (markerStartOffset || 0);\n        }\n        if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n            x =\n                polylineControlPoints[length_1 - 2][0] -\n                    polylineControlPoints[length_1 - 1][0];\n            y =\n                polylineControlPoints[length_1 - 2][1] -\n                    polylineControlPoints[length_1 - 1][1];\n            rad = Math.atan2(y, x);\n            endOffsetX_1 = Math.cos(rad) * (markerEndOffset || 0);\n            endOffsetY_1 = Math.sin(rad) * (markerEndOffset || 0);\n        }\n        var isPolyline_1 = object.nodeName === Shape.POLYLINE;\n        points[0] = polylineControlPoints.reduce(function (prev, cur, i) {\n            var offsetX = 0;\n            var offsetY = 0;\n            if (i === 0) {\n                offsetX = startOffsetX_1;\n                offsetY = startOffsetY_1;\n            }\n            else if (i === length_1 - 1) {\n                offsetX = endOffsetX_1;\n                offsetY = endOffsetY_1;\n            }\n            prev.push(cur[0] + offsetX, cur[1] + offsetY, isPolyline_1 ? cur[2] || 0 : zIndex);\n            return prev;\n        }, []);\n        // close polygon, dealing with extra joint\n        if (object.nodeName === Shape.POLYGON) {\n            if (needEarcut) {\n                // use earcut for triangulation\n                triangles = earcut(points[0], [], 3);\n                return {\n                    pointsBuffer: points[0],\n                    travelBuffer: [],\n                    triangles: triangles,\n                    instancedCount: Math.round(points[0].length / stridePoints),\n                };\n            }\n            else {\n                points[0].push(points[0][0], points[0][1], points[0][2] || zIndex);\n                (_a = points[0]).push.apply(_a, __spreadArray([], __read(addTailSegment(points[0][0], points[0][1], points[0][2] || zIndex, points[0][3], points[0][4], points[0][5] || zIndex)), false));\n            }\n        }\n    }\n    else if (object.nodeName === Shape.PATH ||\n        object.nodeName === Shape.CIRCLE ||\n        object.nodeName === Shape.ELLIPSE ||\n        object.nodeName === Shape.RECT) {\n        var path = void 0;\n        if (object.nodeName !== Shape.PATH) {\n            path = parsePath(convertToPath(object, mat4.identity(mat4.create())));\n            // support negative width/height of Rect\n            if (object.nodeName === Shape.RECT) {\n                var _d = object.parsedStyle, width = _d.width, height = _d.height;\n                if (width < 0) {\n                    defX += path.rect.width;\n                }\n                if (height < 0) {\n                    defY += path.rect.height;\n                }\n            }\n        }\n        else {\n            path = object.parsedStyle.d;\n        }\n        var absolutePath_1 = path.absolutePath, segments_1 = path.segments;\n        var startOffsetX_2 = 0;\n        var startOffsetY_2 = 0;\n        var endOffsetX_2 = 0;\n        var endOffsetY_2 = 0;\n        var rad = 0;\n        var x = void 0;\n        var y = void 0;\n        if (markerStart &&\n            markerStart.parentNode &&\n            isDisplayObject(markerStart) &&\n            markerStartOffset) {\n            var _e = __read(markerStart.parentNode.getStartTangent(), 2), p1 = _e[0], p2 = _e[1];\n            x = p1[0] - p2[0];\n            y = p1[1] - p2[1];\n            rad = Math.atan2(y, x);\n            startOffsetX_2 = Math.cos(rad) * (markerStartOffset || 0);\n            startOffsetY_2 = Math.sin(rad) * (markerStartOffset || 0);\n        }\n        if (markerEnd &&\n            markerEnd.parentNode &&\n            isDisplayObject(markerEnd) &&\n            markerEndOffset) {\n            var _f = __read(markerEnd.parentNode.getEndTangent(), 2), p1 = _f[0], p2 = _f[1];\n            x = p1[0] - p2[0];\n            y = p1[1] - p2[1];\n            rad = Math.atan2(y, x);\n            endOffsetX_2 = Math.cos(rad) * (markerEndOffset || 0);\n            endOffsetY_2 = Math.sin(rad) * (markerEndOffset || 0);\n        }\n        var startPointIndex_1 = -1;\n        var mCommandsNum_1 = -1;\n        absolutePath_1.forEach(function (_a, i) {\n            var _b;\n            var _c = __read(_a), command = _c[0], params = _c.slice(1);\n            var nextSegment = absolutePath_1[i + 1];\n            var useStartOffset = i === 0 && (startOffsetX_2 !== 0 || startOffsetY_2 !== 0);\n            var useEndOffset = (i === absolutePath_1.length - 1 ||\n                (nextSegment &&\n                    (nextSegment[0] === 'M' || nextSegment[0] === 'Z'))) &&\n                endOffsetX_2 !== 0 &&\n                endOffsetY_2 !== 0;\n            if (command === 'M') {\n                mCommandsNum_1++;\n                points[mCommandsNum_1] = [];\n                startPointIndex_1 = points[mCommandsNum_1].length;\n                if (useStartOffset) {\n                    points[mCommandsNum_1].push(params[0] - defX + startOffsetX_2, params[1] - defY + startOffsetY_2, zIndex, params[0] - defX, params[1] - defY, zIndex);\n                }\n                else {\n                    points[mCommandsNum_1].push(params[0] - defX, params[1] - defY, zIndex);\n                }\n            }\n            else if (command === 'L') {\n                if (useEndOffset) {\n                    points[mCommandsNum_1].push(params[0] - defX + endOffsetX_2, params[1] - defY + endOffsetY_2, zIndex);\n                }\n                else {\n                    points[mCommandsNum_1].push(params[0] - defX, params[1] - defY, zIndex);\n                }\n            }\n            else if (command === 'Q') {\n                quadCurveTo(params[0] - defX, params[1] - defY, params[2] - defX, params[3] - defY, points[mCommandsNum_1], segmentNum);\n                if (useEndOffset) {\n                    points[mCommandsNum_1].push(params[2] - defX + endOffsetX_2, params[3] - defY + endOffsetY_2, zIndex);\n                }\n            }\n            else if (command === 'A') {\n                // convert Arc to Cubic\n                var _d = __read(segments_1[i].prePoint, 2), px1 = _d[0], py1 = _d[1];\n                var args = arcToCubic(px1, py1, params[0], params[1], params[2], params[3], params[4], params[5], params[6], undefined);\n                // fixArc\n                for (var i_1 = 0; i_1 < args.length; i_1 += 6) {\n                    bezierCurveTo(args[i_1] - defX, args[i_1 + 1] - defY, args[i_1 + 2] - defX, args[i_1 + 3] - defY, args[i_1 + 4] - defX, args[i_1 + 5] - defY, points[mCommandsNum_1], segmentNum);\n                }\n                if (useEndOffset) {\n                    points[mCommandsNum_1].push(params[5] - defX + endOffsetX_2, params[6] - defY + endOffsetY_2, zIndex);\n                }\n            }\n            else if (command === 'C') {\n                bezierCurveTo(params[0] - defX, params[1] - defY, params[2] - defX, params[3] - defY, params[4] - defX, params[5] - defY, points[mCommandsNum_1], segmentNum);\n                if (useEndOffset) {\n                    points[mCommandsNum_1].push(params[4] - defX + endOffsetX_2, params[5] - defY + endOffsetY_2, zIndex);\n                }\n            }\n            else if (command === 'Z' &&\n                (object.nodeName === Shape.PATH || object.nodeName === Shape.RECT)) {\n                var epsilon = 0.0001;\n                // skip if already closed\n                if (Math.abs(points[mCommandsNum_1][points[mCommandsNum_1].length - 2] -\n                    points[mCommandsNum_1][startPointIndex_1]) > epsilon ||\n                    Math.abs(points[mCommandsNum_1][points[mCommandsNum_1].length - 1] -\n                        points[mCommandsNum_1][startPointIndex_1 + 1]) > epsilon) {\n                    points[mCommandsNum_1].push(points[mCommandsNum_1][startPointIndex_1], points[mCommandsNum_1][startPointIndex_1 + 1], zIndex);\n                }\n                (_b = points[mCommandsNum_1]).push.apply(_b, __spreadArray([], __read(addTailSegment(points[mCommandsNum_1][startPointIndex_1], points[mCommandsNum_1][startPointIndex_1 + 1], points[mCommandsNum_1][startPointIndex_1 + 2], points[mCommandsNum_1][startPointIndex_1 + 3], points[mCommandsNum_1][startPointIndex_1 + 4], points[mCommandsNum_1][startPointIndex_1 + 5])), false));\n            }\n        });\n        if (needEarcut) {\n            var pointsBuffer = points[subPathIndex];\n            // use earcut for triangulation\n            triangles = earcut(pointsBuffer, [], 3);\n            return {\n                pointsBuffer: pointsBuffer,\n                travelBuffer: [],\n                triangles: triangles,\n                instancedCount: Math.round(pointsBuffer.length / stridePoints),\n            };\n        }\n    }\n    var jointType = getJointType(lineJoin);\n    var capType = getCapType(lineCap);\n    var endJoint = capType;\n    if (capType === JOINT_TYPE.CAP_ROUND) {\n        endJoint = JOINT_TYPE.JOINT_CAP_ROUND;\n    }\n    if (capType === JOINT_TYPE.CAP_BUTT) {\n        endJoint = JOINT_TYPE.JOINT_CAP_BUTT;\n    }\n    if (capType === JOINT_TYPE.CAP_SQUARE) {\n        endJoint = JOINT_TYPE.JOINT_CAP_SQUARE;\n    }\n    var subPath = points[subPathIndex];\n    {\n        var points_1 = subPath;\n        var j = (Math.round(0 / stridePoints) + 2) * strideFloats;\n        // const needDash = !isNil(lineDash);\n        var dist = 0;\n        var pointsBuffer = [];\n        var travelBuffer = [];\n        for (var i = 0; i < points_1.length; i += stridePoints) {\n            // calc travel\n            // if (needDash) {\n            if (i > 1) {\n                dist += Math.sqrt(Math.pow(points_1[i] - points_1[i - stridePoints], 2) +\n                    Math.pow(points_1[i + 1] - points_1[i + 1 - stridePoints], 2) +\n                    Math.pow(points_1[i + 2] - points_1[i + 2 - stridePoints], 2));\n            }\n            travelBuffer.push(dist);\n            // } else {\n            //   travelBuffer.push(0);\n            // }\n            pointsBuffer[j++] = points_1[i];\n            pointsBuffer[j++] = points_1[i + 1];\n            pointsBuffer[j++] = points_1[i + 2] || 0;\n            pointsBuffer[j] = jointType;\n            if (i == 0 && capType !== JOINT_TYPE.CAP_ROUND) {\n                pointsBuffer[j] += capType;\n            }\n            if (i + stridePoints * 2 >= points_1.length) {\n                pointsBuffer[j] += endJoint - jointType;\n            }\n            else if (i + stridePoints >= points_1.length) {\n                pointsBuffer[j] = 0;\n            }\n            j++;\n        }\n        pointsBuffer[j++] = points_1[points_1.length - 6];\n        pointsBuffer[j++] = points_1[points_1.length - 5];\n        pointsBuffer[j++] = points_1[points_1.length - 4] || zIndex;\n        pointsBuffer[j++] = 0;\n        pointsBuffer[0] = points_1[0];\n        pointsBuffer[1] = points_1[1];\n        pointsBuffer[2] = points_1[2] || zIndex;\n        pointsBuffer[3] = 0;\n        pointsBuffer[4] = points_1[3];\n        pointsBuffer[5] = points_1[4];\n        pointsBuffer[6] = points_1[5] || zIndex;\n        pointsBuffer[7] = capType === JOINT_TYPE.CAP_ROUND ? capType : 0;\n        var instancedCount = Math.round(points_1.length / stridePoints);\n        return {\n            pointsBuffer: pointsBuffer,\n            travelBuffer: travelBuffer,\n            triangles: triangles,\n            instancedCount: instancedCount,\n        };\n    }\n}\nfunction getJointType(lineJoin) {\n    var joint;\n    switch (lineJoin) {\n        case 'bevel':\n            joint = JOINT_TYPE.JOINT_BEVEL;\n            break;\n        case 'round':\n            joint = JOINT_TYPE.JOINT_ROUND;\n            break;\n        default:\n            joint = JOINT_TYPE.JOINT_MITER;\n            break;\n    }\n    return joint;\n}\nfunction getCapType(lineCap) {\n    var cap;\n    switch (lineCap) {\n        case 'square':\n            cap = JOINT_TYPE.CAP_SQUARE;\n            break;\n        case 'round':\n            cap = JOINT_TYPE.CAP_ROUND;\n            break;\n        default:\n            cap = JOINT_TYPE.CAP_BUTT;\n            break;\n    }\n    return cap;\n}\nfunction addTailSegment(x1, y1, z1, x2, y2, z2) {\n    if (x2 === void 0) { x2 = x1; }\n    if (y2 === void 0) { y2 = y1; }\n    if (z2 === void 0) { z2 = z1; }\n    var vec = [x2 - x1, y2 - y1, z2 - z1];\n    var length = 0.01;\n    return [x1 + vec[0] * length, y1 + vec[1] * length, z1 + vec[2] * length];\n}\n\nvar SEGMENT_NUM = 12;\nvar FillVertexAttributeBufferIndex;\n(function (FillVertexAttributeBufferIndex) {\n    FillVertexAttributeBufferIndex[FillVertexAttributeBufferIndex[\"PACKED_STYLE\"] = 5] = \"PACKED_STYLE\";\n})(FillVertexAttributeBufferIndex || (FillVertexAttributeBufferIndex = {}));\nvar FillVertexAttributeLocation;\n(function (FillVertexAttributeLocation) {\n    FillVertexAttributeLocation[FillVertexAttributeLocation[\"PACKED_STYLE3\"] = 12] = \"PACKED_STYLE3\";\n})(FillVertexAttributeLocation || (FillVertexAttributeLocation = {}));\nvar InstancedFillDrawcall = /** @class */ (function (_super) {\n    __extends(InstancedFillDrawcall, _super);\n    // protected mergeAnchorIntoModelMatrix = true;\n    function InstancedFillDrawcall(renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) {\n        var _this = _super.call(this, renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) || this;\n        _this.renderHelper = renderHelper;\n        _this.texturePool = texturePool;\n        _this.lightPool = lightPool;\n        _this.trianglesHash = [[], []];\n        _this.trianglesHash = _this.calcSegmentNum(object);\n        return _this;\n    }\n    InstancedFillDrawcall.prototype.calcSegmentNum = function (object) {\n        var _a = updateBuffer(object, true, SEGMENT_NUM, this.calcSubpathIndex(object)), triangles = _a.triangles, pointsBuffer = _a.pointsBuffer;\n        return [triangles, pointsBuffer];\n    };\n    InstancedFillDrawcall.prototype.calcSubpathIndex = function (object) {\n        if (object.nodeName === Shape.PATH) {\n            return this.index;\n        }\n        return 0;\n    };\n    InstancedFillDrawcall.prototype.compareTrianglesHash = function (hash) {\n        var _a = __read(this.trianglesHash, 2), triangles = _a[0], points = _a[1];\n        var _b = __read(hash, 2), t = _b[0], p = _b[1];\n        if (triangles.length !== t.length || points.length !== p.length) {\n            return false;\n        }\n        if (triangles.some(function (n, i) { return n !== t[i]; }) ||\n            points.some(function (n, i) { return n !== p[i]; })) {\n            return false;\n        }\n        return true;\n    };\n    InstancedFillDrawcall.prototype.shouldMerge = function (object, index) {\n        var shouldMerge = _super.prototype.shouldMerge.call(this, object, index);\n        if (!shouldMerge) {\n            return false;\n        }\n        if (this.index !== index) {\n            return false;\n        }\n        var trianglesHash = this.calcSegmentNum(object);\n        return this.compareTrianglesHash(trianglesHash);\n    };\n    InstancedFillDrawcall.prototype.createGeometry = function (objects) {\n        var _this = this;\n        var indices = [];\n        var pointsBuffer = [];\n        var uvsBuffer = [];\n        var offset = 0;\n        objects.forEach(function (object, i) {\n            // use triangles for Polygon\n            var _a = updateBuffer(object, true, SEGMENT_NUM, _this.calcSubpathIndex(object)), triangles = _a.triangles, pBuffer = _a.pointsBuffer;\n            if (triangles.length) {\n                var halfExtents_1 = object.getGeometryBounds().halfExtents;\n                // pointsBuffer use 3D\n                var uvBuffer_1 = [];\n                pBuffer.forEach(function (x, i) {\n                    if (i % 3 !== 2) {\n                        uvBuffer_1.push(x / halfExtents_1[i % 3] / 2);\n                    }\n                });\n                offset += pointsBuffer.length / 3;\n                pointsBuffer.push.apply(pointsBuffer, __spreadArray([], __read(pBuffer), false));\n                uvsBuffer.push.apply(uvsBuffer, __spreadArray([], __read(uvBuffer_1), false));\n                indices.push.apply(indices, __spreadArray([], __read(triangles.map(function (n) { return n + offset; })), false));\n            }\n        });\n        if (pointsBuffer.length) {\n            // use default common attributes\n            _super.prototype.createGeometry.call(this, objects);\n            var packedStyle_1 = [];\n            objects.forEach(function (object) {\n                var _a = object.parsedStyle, isBillboard = _a.isBillboard, billboardRotation = _a.billboardRotation, isSizeAttenuation = _a.isSizeAttenuation;\n                packedStyle_1.push(isBillboard ? 1 : 0, billboardRotation !== null && billboardRotation !== void 0 ? billboardRotation : 0, isSizeAttenuation ? 1 : 0, 0);\n            });\n            this.geometry.setVertexBuffer({\n                bufferIndex: VertexAttributeBufferIndex.POSITION,\n                byteStride: 4 * 3,\n                stepMode: VertexStepMode.VERTEX,\n                attributes: [\n                    {\n                        format: Format.F32_RGB,\n                        bufferByteOffset: 4 * 0,\n                        location: VertexAttributeLocation.POSITION,\n                    },\n                ],\n                data: new Float32Array(pointsBuffer),\n            });\n            this.geometry.setVertexBuffer({\n                bufferIndex: FillVertexAttributeBufferIndex.PACKED_STYLE,\n                byteStride: 4 * 4,\n                stepMode: VertexStepMode.INSTANCE,\n                attributes: [\n                    {\n                        format: Format.F32_RGBA,\n                        bufferByteOffset: 4 * 0,\n                        location: FillVertexAttributeLocation.PACKED_STYLE3,\n                        divisor: 1,\n                    },\n                ],\n                data: new Float32Array(packedStyle_1),\n            });\n            this.geometry.setVertexBuffer({\n                bufferIndex: VertexAttributeBufferIndex.UV,\n                byteStride: 4 * 2,\n                stepMode: VertexStepMode.VERTEX,\n                attributes: [\n                    {\n                        format: Format.F32_RG,\n                        bufferByteOffset: 4 * 0,\n                        location: VertexAttributeLocation.UV,\n                    },\n                ],\n                data: new Float32Array(uvsBuffer),\n            });\n            this.geometry.vertexCount = indices.length / objects.length;\n            this.geometry.setIndexBuffer(new Uint32Array(indices));\n        }\n    };\n    InstancedFillDrawcall.prototype.createMaterial = function (objects) {\n        this.material.vertexShader = meshVert;\n        this.material.fragmentShader = meshFrag;\n        this.material.defines = __assign(__assign(__assign({}, this.material.defines), enumToObject(FillVertexAttributeLocation)), { INSTANCED: true });\n    };\n    InstancedFillDrawcall.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        _super.prototype.updateAttribute.call(this, objects, startIndex, name, value);\n        this.updateBatchedAttribute(objects, startIndex, name, value);\n        if (name === 'isBillboard' ||\n            name === 'billboardRotation' ||\n            name === 'isSizeAttenuation') {\n            var packed_1 = [];\n            objects.forEach(function (object) {\n                var _a = object.parsedStyle, isBillboard = _a.isBillboard, billboardRotation = _a.billboardRotation, isSizeAttenuation = _a.isSizeAttenuation;\n                packed_1.push(isBillboard ? 1 : 0, billboardRotation !== null && billboardRotation !== void 0 ? billboardRotation : 0, isSizeAttenuation ? 1 : 0, 0);\n            });\n            this.geometry.updateVertexBuffer(FillVertexAttributeBufferIndex.PACKED_STYLE, FillVertexAttributeLocation.PACKED_STYLE3, startIndex, new Uint8Array(new Float32Array(packed_1).buffer));\n        }\n    };\n    return InstancedFillDrawcall;\n}(Instanced));\n\nvar segmentInstanceGeometry = [\n    0, -0.5, 0, 0, 0, 1, -0.5, 1, 1, 0, 1, 0.5, 1, 1, 1, 0, 0.5, 0, 0, 1,\n];\nvar InstancedLineVertexAttributeBufferIndex;\n(function (InstancedLineVertexAttributeBufferIndex) {\n    InstancedLineVertexAttributeBufferIndex[InstancedLineVertexAttributeBufferIndex[\"POINT\"] = 5] = \"POINT\";\n    InstancedLineVertexAttributeBufferIndex[InstancedLineVertexAttributeBufferIndex[\"CAP\"] = 6] = \"CAP\";\n    InstancedLineVertexAttributeBufferIndex[InstancedLineVertexAttributeBufferIndex[\"DASH\"] = 7] = \"DASH\";\n})(InstancedLineVertexAttributeBufferIndex || (InstancedLineVertexAttributeBufferIndex = {}));\nvar InstancedLineVertexAttributeLocation;\n(function (InstancedLineVertexAttributeLocation) {\n    InstancedLineVertexAttributeLocation[InstancedLineVertexAttributeLocation[\"POSITION\"] = 8] = \"POSITION\";\n    InstancedLineVertexAttributeLocation[InstancedLineVertexAttributeLocation[\"UV\"] = 10] = \"UV\";\n    InstancedLineVertexAttributeLocation[InstancedLineVertexAttributeLocation[\"POINTA\"] = 9] = \"POINTA\";\n    InstancedLineVertexAttributeLocation[InstancedLineVertexAttributeLocation[\"POINTB\"] = 11] = \"POINTB\";\n    InstancedLineVertexAttributeLocation[InstancedLineVertexAttributeLocation[\"CAP\"] = 12] = \"CAP\";\n    InstancedLineVertexAttributeLocation[InstancedLineVertexAttributeLocation[\"DASH\"] = 13] = \"DASH\";\n})(InstancedLineVertexAttributeLocation || (InstancedLineVertexAttributeLocation = {}));\nvar LineCap_MAP = {\n    butt: 1,\n    round: 2,\n    square: 3,\n};\nvar InstancedLineDrawcall = /** @class */ (function (_super) {\n    __extends(InstancedLineDrawcall, _super);\n    function InstancedLineDrawcall(renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) {\n        var _this = _super.call(this, renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) || this;\n        _this.renderHelper = renderHelper;\n        _this.texturePool = texturePool;\n        _this.lightPool = lightPool;\n        _this.gradientAttributeName = 'stroke';\n        return _this;\n    }\n    InstancedLineDrawcall.isLine = function (object, subpathIndex) {\n        if (object.nodeName === Shape.PATH) {\n            var absolutePath = object.parsedStyle.d.absolutePath;\n            var mSegmentCount = 0;\n            var mCommandIndex = 0;\n            for (var i = 0; i < absolutePath.length; i++) {\n                var segment = absolutePath[i];\n                if (segment[0] === 'M') {\n                    if (mSegmentCount === subpathIndex) {\n                        mCommandIndex = i;\n                        break;\n                    }\n                    mSegmentCount++;\n                }\n            }\n            // only contains M & L commands\n            if (absolutePath[mCommandIndex][0] === 'M' &&\n                absolutePath[mCommandIndex + 1][0] === 'L' &&\n                (absolutePath[mCommandIndex + 2] === undefined ||\n                    absolutePath[mCommandIndex + 2][0] === 'M')) {\n                return true;\n            }\n        }\n        else if (object.nodeName === Shape.POLYLINE) {\n            var points = object.parsedStyle.points.points;\n            var tangent = (points[1][0] - points[1][1]) / (points[0][0] - points[0][1]);\n            for (var i = 1; i < points.length - 1; i++) {\n                if ((points[i + 1][0] - points[i + 1][1]) /\n                    (points[i][0] - points[i][1]) !==\n                    tangent) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        return false;\n    };\n    InstancedLineDrawcall.prototype.shouldMerge = function (object, index) {\n        var shouldMerge = _super.prototype.shouldMerge.call(this, object, index);\n        if (!shouldMerge) {\n            return false;\n        }\n        return true;\n    };\n    InstancedLineDrawcall.prototype.createMaterial = function (objects) {\n        this.material.vertexShader = vert$3;\n        this.material.fragmentShader = frag$3;\n        this.material.defines = __assign(__assign({}, this.material.defines), enumToObject(InstancedLineVertexAttributeLocation));\n    };\n    InstancedLineDrawcall.prototype.calcSubpathIndex = function (object) {\n        if (object.nodeName === Shape.PATH) {\n            var fillDrawcallCount = this.drawcallCtors.filter(function (ctor) { return ctor === InstancedFillDrawcall; }).length;\n            return this.index - fillDrawcallCount;\n        }\n        return 0;\n    };\n    InstancedLineDrawcall.prototype.createGeometry = function (objects) {\n        var _this = this;\n        // use default common attributes\n        _super.prototype.createGeometry.call(this, objects);\n        var interleaved = [];\n        var packedCap = [];\n        var packedDash = [];\n        var indices = [];\n        var offset = 0;\n        objects.forEach(function (object) {\n            var parsedLineStyleProps;\n            var totalLength;\n            if (object.nodeName === Shape.LINE) {\n                parsedLineStyleProps = object.parsedStyle;\n                totalLength = object.getTotalLength();\n            }\n            else if (object.nodeName === Shape.POLYLINE) {\n                var _a = object.parsedStyle, points = _a.points.points, lineCap_1 = _a.lineCap, lineDash = _a.lineDash, lineDashOffset = _a.lineDashOffset, markerStart = _a.markerStart, markerEnd = _a.markerEnd, markerStartOffset = _a.markerStartOffset, markerEndOffset = _a.markerEndOffset, isBillboard_1 = _a.isBillboard, \n                // @ts-ignore\n                isSizeAttenuation_1 = _a.isSizeAttenuation;\n                parsedLineStyleProps = {\n                    x1: points[0][0],\n                    y1: points[0][1],\n                    x2: points[points.length - 1][0],\n                    y2: points[points.length - 1][1],\n                    z1: 0,\n                    z2: 0,\n                    lineCap: lineCap_1,\n                    lineDash: lineDash,\n                    lineDashOffset: lineDashOffset,\n                    isBillboard: isBillboard_1,\n                    isSizeAttenuation: isSizeAttenuation_1,\n                    markerStart: markerStart,\n                    markerEnd: markerEnd,\n                    markerStartOffset: markerStartOffset,\n                    markerEndOffset: markerEndOffset,\n                };\n                totalLength = object.getTotalLength();\n            }\n            else if (object.nodeName === Shape.PATH) {\n                var _b = object.parsedStyle, absolutePath = _b.d.absolutePath, lineCap_2 = _b.lineCap, lineDash = _b.lineDash, lineDashOffset = _b.lineDashOffset, markerStart = _b.markerStart, markerEnd = _b.markerEnd, markerStartOffset = _b.markerStartOffset, markerEndOffset = _b.markerEndOffset, isBillboard_2 = _b.isBillboard, isSizeAttenuation_2 = _b.isSizeAttenuation;\n                var mSegmentCount = 0;\n                var mCommandIndex = 0;\n                var index = _this.calcSubpathIndex(object);\n                for (var i = 0; i < absolutePath.length; i++) {\n                    var segment = absolutePath[i];\n                    if (segment[0] === 'M') {\n                        if (mSegmentCount === index) {\n                            mCommandIndex = i;\n                            break;\n                        }\n                        mSegmentCount++;\n                    }\n                }\n                parsedLineStyleProps = {\n                    x1: absolutePath[mCommandIndex][1],\n                    y1: absolutePath[mCommandIndex][2],\n                    x2: absolutePath[mCommandIndex + 1][1],\n                    y2: absolutePath[mCommandIndex + 1][2],\n                    z1: 0,\n                    z2: 0,\n                    lineCap: lineCap_2,\n                    lineDash: lineDash,\n                    lineDashOffset: lineDashOffset,\n                    isBillboard: isBillboard_2,\n                    isSizeAttenuation: isSizeAttenuation_2,\n                    markerStart: markerStart,\n                    markerEnd: markerEnd,\n                    markerStartOffset: markerStartOffset,\n                    markerEndOffset: markerEndOffset,\n                };\n                totalLength = object.getTotalLength();\n            }\n            var x1 = parsedLineStyleProps.x1, y1 = parsedLineStyleProps.y1, x2 = parsedLineStyleProps.x2, y2 = parsedLineStyleProps.y2, z1 = parsedLineStyleProps.z1, z2 = parsedLineStyleProps.z2, lineCap = parsedLineStyleProps.lineCap, isBillboard = parsedLineStyleProps.isBillboard, isSizeAttenuation = parsedLineStyleProps.isSizeAttenuation;\n            var _c = _this.calcOffset(parsedLineStyleProps), startOffsetX = _c.startOffsetX, startOffsetY = _c.startOffsetY, endOffsetX = _c.endOffsetX, endOffsetY = _c.endOffsetY;\n            var _d = _this.calcDash(parsedLineStyleProps, totalLength), dashOffset = _d.dashOffset, dashSegmentPercent = _d.dashSegmentPercent, dashRatioInEachSegment = _d.dashRatioInEachSegment;\n            packedCap.push(\n            // caps\n            LineCap_MAP[lineCap]);\n            packedDash.push(dashOffset, dashSegmentPercent, dashRatioInEachSegment, \n            // isSizeAttenuation\n            isBillboard || isSizeAttenuation ? 1 : 0);\n            interleaved.push(x1 + startOffsetX, y1 + startOffsetY, z1, x2 + endOffsetX, y2 + endOffsetY, z2);\n            indices.push(0 + offset, 2 + offset, 1 + offset, 0 + offset, 3 + offset, 2 + offset);\n            offset += 4;\n        });\n        this.geometry.setIndexBuffer(new Uint32Array(indices));\n        this.geometry.vertexCount = 6;\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.POSITION,\n            byteStride: 4 * 5,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 0,\n                    location: InstancedLineVertexAttributeLocation.POSITION,\n                    divisor: 0,\n                },\n                {\n                    format: Format.F32_RG,\n                    bufferByteOffset: 4 * 3,\n                    location: InstancedLineVertexAttributeLocation.UV,\n                    divisor: 0,\n                },\n            ],\n            data: new Float32Array(segmentInstanceGeometry),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: InstancedLineVertexAttributeBufferIndex.POINT,\n            byteStride: 4 * (3 + 3),\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 0,\n                    location: InstancedLineVertexAttributeLocation.POINTA,\n                    divisor: 1,\n                },\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 3,\n                    location: InstancedLineVertexAttributeLocation.POINTB,\n                    divisor: 1,\n                },\n            ],\n            data: new Float32Array(interleaved),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: InstancedLineVertexAttributeBufferIndex.CAP,\n            byteStride: 4 * 1,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_R,\n                    bufferByteOffset: 4 * 0,\n                    location: InstancedLineVertexAttributeLocation.CAP,\n                    divisor: 1,\n                },\n            ],\n            data: new Float32Array(packedCap),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: InstancedLineVertexAttributeBufferIndex.DASH,\n            byteStride: 4 * 4,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: InstancedLineVertexAttributeLocation.DASH,\n                    divisor: 1,\n                },\n            ],\n            data: new Float32Array(packedDash),\n        });\n    };\n    InstancedLineDrawcall.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        var _this = this;\n        _super.prototype.updateAttribute.call(this, objects, startIndex, name, value);\n        this.updateBatchedAttribute(objects, startIndex, name, value);\n        if (name === 'x1' ||\n            name === 'y1' ||\n            name === 'x2' ||\n            name === 'y2' ||\n            name === 'z1' ||\n            name === 'z2' ||\n            name === 'markerStartOffset' ||\n            name === 'markerEndOffset' ||\n            name === 'markerStart' ||\n            name === 'markerEnd' ||\n            name === 'points' ||\n            name === 'd') {\n            var packed_1 = [];\n            objects.forEach(function (object) {\n                var parsedLineStyleProps;\n                if (object.nodeName === Shape.LINE) {\n                    parsedLineStyleProps = object.parsedStyle;\n                }\n                else if (object.nodeName === Shape.POLYLINE) {\n                    var _a = object.parsedStyle, points = _a.points.points, lineCap = _a.lineCap, markerStart = _a.markerStart, markerEnd = _a.markerEnd, markerStartOffset = _a.markerStartOffset, markerEndOffset = _a.markerEndOffset, isBillboard = _a.isBillboard, \n                    // @ts-ignore\n                    isSizeAttenuation = _a.isSizeAttenuation;\n                    parsedLineStyleProps = {\n                        x1: points[0][0],\n                        y1: points[0][1],\n                        x2: points[points.length - 1][0],\n                        y2: points[points.length - 1][1],\n                        z1: 0,\n                        z2: 0,\n                        lineCap: lineCap,\n                        isSizeAttenuation: isSizeAttenuation,\n                        isBillboard: isBillboard,\n                        markerStart: markerStart,\n                        markerEnd: markerEnd,\n                        markerStartOffset: markerStartOffset,\n                        markerEndOffset: markerEndOffset,\n                    };\n                }\n                else if (object.nodeName === Shape.PATH) {\n                    var _b = object.parsedStyle, absolutePath = _b.d.absolutePath, lineCap = _b.lineCap, markerStart = _b.markerStart, markerEnd = _b.markerEnd, markerStartOffset = _b.markerStartOffset, markerEndOffset = _b.markerEndOffset, isBillboard = _b.isBillboard, isSizeAttenuation = _b.isSizeAttenuation;\n                    parsedLineStyleProps = {\n                        x1: absolutePath[0][1],\n                        y1: absolutePath[0][2],\n                        x2: absolutePath[1][1],\n                        y2: absolutePath[1][2],\n                        z1: 0,\n                        z2: 0,\n                        lineCap: lineCap,\n                        isBillboard: isBillboard,\n                        isSizeAttenuation: isSizeAttenuation,\n                        markerStart: markerStart,\n                        markerEnd: markerEnd,\n                        markerStartOffset: markerStartOffset,\n                        markerEndOffset: markerEndOffset,\n                    };\n                }\n                var x1 = parsedLineStyleProps.x1, y1 = parsedLineStyleProps.y1, x2 = parsedLineStyleProps.x2, y2 = parsedLineStyleProps.y2, z1 = parsedLineStyleProps.z1, z2 = parsedLineStyleProps.z2;\n                var _c = _this.calcOffset(parsedLineStyleProps), startOffsetX = _c.startOffsetX, startOffsetY = _c.startOffsetY, endOffsetX = _c.endOffsetX, endOffsetY = _c.endOffsetY;\n                packed_1.push(x1 + startOffsetX, y1 + startOffsetY, z1, x2 + endOffsetX, y2 + endOffsetY, z2);\n            });\n            this.geometry.updateVertexBuffer(InstancedLineVertexAttributeBufferIndex.POINT, InstancedLineVertexAttributeLocation.POINTA, startIndex, new Uint8Array(new Float32Array(packed_1).buffer));\n        }\n        else if (name === 'lineDashOffset' ||\n            name === 'lineDash' ||\n            name === 'isSizeAttenuation' ||\n            name === 'isBillboard') {\n            var packed_2 = [];\n            objects.forEach(function (object) {\n                var totalLength = object.getTotalLength();\n                var _a = _this.calcDash(object.parsedStyle, totalLength), dashOffset = _a.dashOffset, dashSegmentPercent = _a.dashSegmentPercent, dashRatioInEachSegment = _a.dashRatioInEachSegment;\n                packed_2.push(dashOffset, dashSegmentPercent, dashRatioInEachSegment, object.parsedStyle.isBillboard || object.parsedStyle.isSizeAttenuation\n                    ? 1\n                    : 0);\n            });\n            this.geometry.updateVertexBuffer(InstancedLineVertexAttributeBufferIndex.DASH, InstancedLineVertexAttributeLocation.DASH, startIndex, new Uint8Array(new Float32Array(packed_2).buffer));\n        }\n        else if (name === 'lineCap') {\n            var packed_3 = [];\n            objects.forEach(function (object) {\n                var lineCap = object.parsedStyle.lineCap;\n                packed_3.push(LineCap_MAP[lineCap]);\n            });\n            this.geometry.updateVertexBuffer(InstancedLineVertexAttributeBufferIndex.CAP, InstancedLineVertexAttributeLocation.CAP, startIndex, new Uint8Array(new Float32Array(packed_3).buffer));\n        }\n    };\n    InstancedLineDrawcall.prototype.calcOffset = function (parsedStyle) {\n        var x1 = parsedStyle.x1, y1 = parsedStyle.y1, x2 = parsedStyle.x2, y2 = parsedStyle.y2, markerStart = parsedStyle.markerStart, markerEnd = parsedStyle.markerEnd, markerStartOffset = parsedStyle.markerStartOffset, markerEndOffset = parsedStyle.markerEndOffset;\n        var startOffsetX = 0;\n        var startOffsetY = 0;\n        var endOffsetX = 0;\n        var endOffsetY = 0;\n        var rad = 0;\n        var x;\n        var y;\n        if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n            x = x2 - x1;\n            y = y2 - y1;\n            rad = Math.atan2(y, x);\n            startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n            startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n        }\n        if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n            x = x1 - x2;\n            y = y1 - y2;\n            rad = Math.atan2(y, x);\n            endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n            endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n        }\n        return {\n            startOffsetX: startOffsetX,\n            startOffsetY: startOffsetY,\n            endOffsetX: endOffsetX,\n            endOffsetY: endOffsetY,\n        };\n    };\n    InstancedLineDrawcall.prototype.calcDash = function (parsedLineStyle, totalLength) {\n        var lineDash = parsedLineStyle.lineDash, lineDashOffset = parsedLineStyle.lineDashOffset;\n        var dashOffset = 0;\n        var dashSegmentPercent = 1;\n        var dashRatioInEachSegment = 0;\n        if (lineDash && lineDash.length) {\n            dashOffset = (lineDashOffset || 0) / totalLength;\n            var segmentsLength = lineDash.reduce(function (cur, prev) { return cur + prev; }, 0);\n            if (segmentsLength === 0) {\n                dashSegmentPercent = 1;\n                dashRatioInEachSegment = 0;\n            }\n            else {\n                dashSegmentPercent = segmentsLength / totalLength;\n                dashRatioInEachSegment = lineDash[1] / segmentsLength;\n            }\n        }\n        return {\n            dashOffset: dashOffset,\n            dashSegmentPercent: dashSegmentPercent,\n            dashRatioInEachSegment: dashRatioInEachSegment,\n        };\n    };\n    return InstancedLineDrawcall;\n}(Instanced));\n\nvar frag$1 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\n\\nin vec4 v_PickingResult;\\nin vec4 v_Color;\\nin vec4 v_StrokeColor;\\nin vec4 v_StylePacked1;\\nin vec4 v_StylePacked2;\\n#ifdef USE_UV\\n  in vec2 v_Uv;\\n#endif\\n#ifdef USE_MAP\\n  uniform sampler2D u_Map;\\n#endif\\n\\nout vec4 outputColor;\\n\\nfloat epsilon = 0.000001;\\n\\nvoid main() {\\n  vec4 u_Color = v_Color;\\nvec4 u_StrokeColor = v_StrokeColor;\\nfloat u_Opacity = v_StylePacked1.x;\\nfloat u_FillOpacity = v_StylePacked1.y;\\nfloat u_StrokeOpacity = v_StylePacked1.z;\\nfloat u_StrokeWidth = v_StylePacked1.w;\\nfloat u_Visible = v_StylePacked2.x;\\nvec3 u_PickingColor = v_PickingResult.xyz;\\n\\nif (u_Visible < 0.5) {\\n    discard;\\n}\\n  #ifdef USE_MAP\\n  #ifdef USE_PATTERN\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #else\\n    vec4 texelColor = texture(SAMPLER_2D(u_Map), v_Uv);\\n    u_Color = texelColor;\\n  #endif\\n#endif\\n\\n  if (u_IsPicking > 0.5) {\\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\\n      discard;\\n    }\\n\\n    // TODO: pointer-events: non-transparent-pixel\\n    // if (u_Color.x == 0.0 && u_Color.y == 0.0 && u_Color.z == 0.0) {\\n    //   discard;\\n    // }\\n    outputColor = vec4(u_PickingColor, 1.0);\\n  } else {\\n    outputColor = u_Color;\\n    outputColor.a = outputColor.a * u_Opacity;\\n\\n    if (outputColor.a < epsilon) {\\n      discard;\\n    }\\n  }\\n}\"; // eslint-disable-line\n\nvar vert$1 = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\\nlayout(location = PACKED_COLOR) in vec4 a_PackedColor;\\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\\n\\nout vec4 v_PickingResult;\\nout vec4 v_Color;\\nout vec4 v_StrokeColor;\\nout vec4 v_StylePacked1;\\nout vec4 v_StylePacked2;\\n\\n#define COLOR_SCALE 1. / 255.\\nvoid setPickingColor(vec3 pickingColor) {\\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\\n}\\n\\nvec2 unpack_float(const float packedValue) {\\n  int packedIntValue = int(packedValue);\\n  int v0 = packedIntValue / 256;\\n  return vec2(v0, packedIntValue - v0 * 256);\\n}\\nvec4 decode_color(const vec2 encodedColor) {\\n  return vec4(\\n    unpack_float(encodedColor[0]) / 255.0,\\n    unpack_float(encodedColor[1]) / 255.0\\n  );\\n}\\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\\n  return pm * vm * mm * pos;\\n}\\n\\nbool isPerspectiveMatrix(mat4 m) {\\n  return m[2][3] == -1.0;\\n}\\n\\nvec4 billboard(vec2 offset, float rotation, bool isSizeAttenuation, mat4 pm, mat4 vm, mat4 mm, vec3 position) {\\n  vec4 mvPosition = vm * mm * vec4(position, 1.0);\\n  vec2 scale;\\n  scale.x = length(vec3(mm[0][0], mm[0][1], mm[0][2]));\\n  scale.y = length(vec3(mm[1][0], mm[1][1], mm[1][2]));\\n\\n  if (isSizeAttenuation) {\\n    bool isPerspective = isPerspectiveMatrix(pm);\\n    if (isPerspective) {\\n      scale *= -mvPosition.z / 250.0;\\n    }\\n  }\\n\\n  vec2 alignedPosition = offset * scale;\\n  vec2 rotatedPosition;\\n  rotatedPosition.x = cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y;\\n  rotatedPosition.y = sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y;\\n\\n  mvPosition.xy += rotatedPosition;\\n  return pm * mvPosition;\\n}\\n\\nlayout(location = POSITION) in vec3 a_Position;\\nlayout(location = SIZE) in vec2 a_Size;\\nlayout(location = PACKED_STYLE3) in vec4 a_StylePacked3;\\n\\n#ifdef USE_UV\\n  layout(location = UV) in vec2 a_Uv;\\n  out vec2 v_Uv;\\n#endif\\n\\nvoid main() {\\n  vec4 a_Color = decode_color(a_PackedColor.xy);\\nvec4 a_StrokeColor = decode_color(a_PackedColor.zw);\\n\\nmat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\\nvec4 u_StrokeColor = a_StrokeColor;\\nfloat u_Opacity = a_StylePacked1.x;\\nfloat u_FillOpacity = a_StylePacked1.y;\\nfloat u_StrokeOpacity = a_StylePacked1.z;\\nfloat u_StrokeWidth = a_StylePacked1.w;\\nfloat u_ZIndex = a_PickingColor.w;\\nvec2 u_Anchor = a_StylePacked2.yz;\\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\\n\\nsetPickingColor(a_PickingColor.xyz);\\n\\nv_Color = a_Color;\\nv_StrokeColor = a_StrokeColor;\\nv_StylePacked1 = a_StylePacked1;\\nv_StylePacked2 = a_StylePacked2;\\n\\n// #ifdef CLIPSPACE_NEAR_ZERO\\n//     gl_Position.z = (gl_Position.z + gl_Position.w) * 0.5;\\n// #endif\\n\\n  vec2 offset = (a_Uv - u_Anchor.xy) * a_Size;\\n\\n  bool isBillboard = a_StylePacked3.x > 0.5;\\n  if (isBillboard) {\\n    float rotation = a_StylePacked3.y;\\n    bool isSizeAttenuation = a_StylePacked3.z > 0.5;\\n    gl_Position = billboard(offset, rotation, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, a_Position);\\n  } else {\\n    gl_Position = project(vec4(a_Position.xy + offset, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n  }\\n\\n  #ifdef USE_UV\\n  v_Uv = a_Uv;\\n#endif\\n\\n}\"; // eslint-disable-line\n\nvar ImageVertexAttributeBufferIndex;\n(function (ImageVertexAttributeBufferIndex) {\n    ImageVertexAttributeBufferIndex[ImageVertexAttributeBufferIndex[\"PACKED_STYLE\"] = 5] = \"PACKED_STYLE\";\n    ImageVertexAttributeBufferIndex[ImageVertexAttributeBufferIndex[\"SIZE\"] = 8] = \"SIZE\";\n})(ImageVertexAttributeBufferIndex || (ImageVertexAttributeBufferIndex = {}));\nvar ImageVertexAttributeLocation;\n(function (ImageVertexAttributeLocation) {\n    ImageVertexAttributeLocation[ImageVertexAttributeLocation[\"PACKED_STYLE3\"] = 12] = \"PACKED_STYLE3\";\n    ImageVertexAttributeLocation[ImageVertexAttributeLocation[\"SIZE\"] = 13] = \"SIZE\";\n})(ImageVertexAttributeLocation || (ImageVertexAttributeLocation = {}));\nvar ImageDrawcall = /** @class */ (function (_super) {\n    __extends(ImageDrawcall, _super);\n    function ImageDrawcall() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ImageDrawcall.prototype.shouldMerge = function (object, index) {\n        var shouldMerge = _super.prototype.shouldMerge.call(this, object, index);\n        if (!shouldMerge) {\n            return false;\n        }\n        if (this.instance.parsedStyle.src !== object.parsedStyle.src) {\n            return false;\n        }\n        return true;\n    };\n    // private calculateWithAspectRatio(\n    //   object: Image,\n    //   imageWidth: number,\n    //   imageHeight: number,\n    // ) {\n    //   const { width, height } = object.parsedStyle;\n    //   // if (width && !height) {\n    //   //   object.setAttribute('height', (imageHeight / imageWidth) * width);\n    //   // } else if (!width && height) {\n    //   //   object.setAttribute('width', (imageWidth / imageHeight) * height);\n    //   // }\n    // }\n    ImageDrawcall.prototype.createMaterial = function (objects) {\n        var instance = objects[0];\n        var src = instance.parsedStyle.src;\n        this.material.defines = __assign(__assign({}, this.material.defines), enumToObject(ImageVertexAttributeLocation));\n        this.material.vertexShader = vert$1;\n        this.material.fragmentShader = frag$1;\n        var map = this.texturePool.getOrCreateTexture(this.context.device, src, undefined);\n        this.material.setUniforms({\n            u_Map: map,\n        });\n    };\n    ImageDrawcall.prototype.createGeometry = function (objects) {\n        // use default common attributes\n        _super.prototype.createGeometry.call(this, objects);\n        var positions = [];\n        var sizes = [];\n        var packedStyle = [];\n        objects.forEach(function (object, i) {\n            var image = object;\n            var _a = image.parsedStyle, _b = _a.x, x = _b === void 0 ? 0 : _b, _c = _a.y, y = _c === void 0 ? 0 : _c, _d = _a.z, z = _d === void 0 ? 0 : _d, width = _a.width, height = _a.height, isBillboard = _a.isBillboard, billboardRotation = _a.billboardRotation, isSizeAttenuation = _a.isSizeAttenuation;\n            positions.push(x, y, z);\n            sizes.push(width, height);\n            packedStyle.push(isBillboard ? 1 : 0, billboardRotation !== null && billboardRotation !== void 0 ? billboardRotation : 0, isSizeAttenuation ? 1 : 0, 0);\n        });\n        this.geometry.setIndexBuffer(new Uint32Array([0, 2, 1, 0, 3, 2]));\n        this.geometry.vertexCount = 6;\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.POSITION,\n            byteStride: 4 * 3,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.POSITION,\n                },\n            ],\n            data: new Float32Array(positions),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: ImageVertexAttributeBufferIndex.SIZE,\n            byteStride: 4 * 2,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RG,\n                    bufferByteOffset: 4 * 0,\n                    location: ImageVertexAttributeLocation.SIZE,\n                },\n            ],\n            data: new Float32Array(sizes),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: ImageVertexAttributeBufferIndex.PACKED_STYLE,\n            byteStride: 4 * 4,\n            stepMode: VertexStepMode.INSTANCE,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: ImageVertexAttributeLocation.PACKED_STYLE3,\n                    divisor: 1,\n                },\n            ],\n            data: new Float32Array(packedStyle),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.UV,\n            byteStride: 4 * 2,\n            stepMode: VertexStepMode.VERTEX,\n            attributes: [\n                {\n                    format: Format.F32_RG,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.UV,\n                },\n            ],\n            data: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),\n        });\n    };\n    ImageDrawcall.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        _super.prototype.updateAttribute.call(this, objects, startIndex, name, value);\n        this.updateBatchedAttribute(objects, startIndex, name, value);\n        if (name === 'x' || name === 'y' || name === 'z') {\n            var packed_1 = [];\n            objects.forEach(function (object) {\n                var image = object;\n                var _a = image.parsedStyle, _b = _a.x, x = _b === void 0 ? 0 : _b, _c = _a.y, y = _c === void 0 ? 0 : _c, _d = _a.z, z = _d === void 0 ? 0 : _d;\n                packed_1.push(x, y, z);\n            });\n            this.geometry.updateVertexBuffer(VertexAttributeBufferIndex.POSITION, VertexAttributeLocation.POSITION, startIndex, new Uint8Array(new Float32Array(packed_1).buffer));\n        }\n        else if (name === 'width' || name === 'height') {\n            var packed_2 = [];\n            objects.forEach(function (object) {\n                var image = object;\n                var _a = image.parsedStyle, width = _a.width, height = _a.height;\n                packed_2.push(width, height);\n            });\n            this.geometry.updateVertexBuffer(ImageVertexAttributeBufferIndex.SIZE, ImageVertexAttributeLocation.SIZE, startIndex, new Uint8Array(new Float32Array(packed_2).buffer));\n        }\n        else if (name === 'isBillboard' ||\n            name === 'billboardRotation' ||\n            name === 'isSizeAttenuation') {\n            var packed_3 = [];\n            objects.forEach(function (object) {\n                var image = object;\n                var _a = image.parsedStyle, isBillboard = _a.isBillboard, billboardRotation = _a.billboardRotation, isSizeAttenuation = _a.isSizeAttenuation;\n                packed_3.push(isBillboard ? 1 : 0, billboardRotation !== null && billboardRotation !== void 0 ? billboardRotation : 0, isSizeAttenuation ? 1 : 0, 0);\n            });\n            this.geometry.updateVertexBuffer(ImageVertexAttributeBufferIndex.PACKED_STYLE, ImageVertexAttributeLocation.PACKED_STYLE3, startIndex, new Uint8Array(new Float32Array(packed_3).buffer));\n        }\n        else if (name === 'src') {\n            var map = this.texturePool.getOrCreateTexture(this.context.device, value);\n            this.material.setUniforms({\n                u_Map: map,\n            });\n        }\n    };\n    return ImageDrawcall;\n}(Instanced));\n\nvar frag = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\nin vec4 v_PickingResult;\\nin vec4 v_Color;\\nin vec4 v_StrokeColor;\\nin vec4 v_StylePacked1;\\nin vec4 v_StylePacked2;\\nlayout(std140) uniform ub_ObjectParams {\\n  vec2 u_SDFMapSize;\\n  float u_FontSize;\\n  float u_GammaScale;\\n  float u_StrokeBlur;\\n  float u_HasStroke;\\n};\\n#ifdef USE_UV\\n  in vec2 v_Uv;\\n#endif\\n\\nuniform sampler2D u_SDFMap;\\n\\n#define SDF_PX 8.0\\n\\nout vec4 outputColor;\\nfloat epsilon = 0.000001;\\n\\nvoid main() {\\n  vec4 u_Color = v_Color;\\nvec4 u_StrokeColor = v_StrokeColor;\\nfloat u_Opacity = v_StylePacked1.x;\\nfloat u_FillOpacity = v_StylePacked1.y;\\nfloat u_StrokeOpacity = v_StylePacked1.z;\\nfloat u_StrokeWidth = v_StylePacked1.w;\\nfloat u_Visible = v_StylePacked2.x;\\nvec3 u_PickingColor = v_PickingResult.xyz;\\n\\nif (u_Visible < 0.5) {\\n    discard;\\n}\\n\\n  float dist = texture(SAMPLER_2D(u_SDFMap), v_Uv).a;\\n\\n  float fontScale = u_FontSize / 24.0;\\n  lowp vec4 color = u_Color;\\n  lowp float buff = (256.0 - 64.0) / 256.0;\\n  float opacity = u_FillOpacity;\\n  if (u_HasStroke > 0.5 && u_StrokeWidth > 0.0) {\\n    color = u_StrokeColor;\\n    buff = (6.0 - u_StrokeWidth / fontScale / 2.0) / SDF_PX;\\n    opacity = u_StrokeOpacity;\\n  }\\n\\n  highp float gamma_scaled = fwidth(dist);\\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\\n\\n  opacity *= alpha * u_Opacity;\\n\\n  if (u_IsPicking > 0.5) {\\n    if (u_PickingColor.x == 0.0 && u_PickingColor.y == 0.0 && u_PickingColor.z == 0.0) {\\n      discard;\\n    }\\n    outputColor = vec4(u_PickingColor, 1.0);\\n  } else {\\n\\n    if (opacity < epsilon) {\\n      discard;\\n    }\\n\\n    outputColor = color;\\n    outputColor.a *= opacity;\\n  }\\n}\"; // eslint-disable-line\n\nvar vert = \"#define GLSLIFY 1\\nlayout(std140) uniform ub_SceneParams {\\n  mat4 u_ProjectionMatrix;\\n  mat4 u_ViewMatrix;\\n  vec3 u_CameraPosition;\\n  float u_DevicePixelRatio;\\n  vec2 u_Viewport;\\n  float u_IsOrtho;\\n  float u_IsPicking;\\n};\\nlayout(location = MODEL_MATRIX0) in vec4 a_ModelMatrix0;\\nlayout(location = MODEL_MATRIX1) in vec4 a_ModelMatrix1;\\nlayout(location = MODEL_MATRIX2) in vec4 a_ModelMatrix2;\\nlayout(location = MODEL_MATRIX3) in vec4 a_ModelMatrix3;\\nlayout(location = PACKED_COLOR) in vec4 a_PackedColor;\\nlayout(location = PACKED_STYLE1) in vec4 a_StylePacked1;\\nlayout(location = PACKED_STYLE2) in vec4 a_StylePacked2;\\nlayout(location = PICKING_COLOR) in vec4 a_PickingColor;\\n\\nout vec4 v_PickingResult;\\nout vec4 v_Color;\\nout vec4 v_StrokeColor;\\nout vec4 v_StylePacked1;\\nout vec4 v_StylePacked2;\\n\\n#define COLOR_SCALE 1. / 255.\\nvoid setPickingColor(vec3 pickingColor) {\\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\\n}\\n\\nvec2 unpack_float(const float packedValue) {\\n  int packedIntValue = int(packedValue);\\n  int v0 = packedIntValue / 256;\\n  return vec2(v0, packedIntValue - v0 * 256);\\n}\\nvec4 decode_color(const vec2 encodedColor) {\\n  return vec4(\\n    unpack_float(encodedColor[0]) / 255.0,\\n    unpack_float(encodedColor[1]) / 255.0\\n  );\\n}\\n\\nlayout(std140) uniform ub_ObjectParams {\\n  vec2 u_SDFMapSize;\\n  float u_FontSize;\\n  float u_GammaScale;\\n  float u_StrokeBlur;\\n  float u_HasStroke;\\n};\\nvec4 project(vec4 pos, mat4 pm, mat4 vm, mat4 mm) {\\n  return pm * vm * mm * pos;\\n}\\n\\nbool isPerspectiveMatrix(mat4 m) {\\n  return m[2][3] == -1.0;\\n}\\n\\nvec4 billboard(vec2 offset, float rotation, bool isSizeAttenuation, mat4 pm, mat4 vm, mat4 mm, vec3 position) {\\n  vec4 mvPosition = vm * mm * vec4(position, 1.0);\\n  vec2 scale;\\n  scale.x = length(vec3(mm[0][0], mm[0][1], mm[0][2]));\\n  scale.y = length(vec3(mm[1][0], mm[1][1], mm[1][2]));\\n\\n  if (isSizeAttenuation) {\\n    bool isPerspective = isPerspectiveMatrix(pm);\\n    if (isPerspective) {\\n      scale *= -mvPosition.z / 250.0;\\n    }\\n  }\\n\\n  vec2 alignedPosition = offset * scale;\\n  vec2 rotatedPosition;\\n  rotatedPosition.x = cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y;\\n  rotatedPosition.y = sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y;\\n\\n  mvPosition.xy += rotatedPosition;\\n  return pm * mvPosition;\\n}\\n\\nlayout(location = POSITION) in vec3 a_Position;\\nlayout(location = TEX) in vec2 a_Tex;\\nlayout(location = OFFSET) in vec2 a_Offset;\\n\\nout vec2 v_Uv;\\n\\nvoid main() {\\n  vec4 a_Color = decode_color(a_PackedColor.xy);\\nvec4 a_StrokeColor = decode_color(a_PackedColor.zw);\\n\\nmat4 u_ModelMatrix = mat4(a_ModelMatrix0, a_ModelMatrix1, a_ModelMatrix2, a_ModelMatrix3);\\nvec4 u_StrokeColor = a_StrokeColor;\\nfloat u_Opacity = a_StylePacked1.x;\\nfloat u_FillOpacity = a_StylePacked1.y;\\nfloat u_StrokeOpacity = a_StylePacked1.z;\\nfloat u_StrokeWidth = a_StylePacked1.w;\\nfloat u_ZIndex = a_PickingColor.w;\\nvec2 u_Anchor = a_StylePacked2.yz;\\nfloat u_IncreasedLineWidthForHitTesting = a_StylePacked2.w;\\n\\nsetPickingColor(a_PickingColor.xyz);\\n\\nv_Color = a_Color;\\nv_StrokeColor = a_StrokeColor;\\nv_StylePacked1 = a_StylePacked1;\\nv_StylePacked2 = a_StylePacked2;\\n\\n// #ifdef CLIPSPACE_NEAR_ZERO\\n//     gl_Position.z = (gl_Position.z + gl_Position.w) * 0.5;\\n// #endif\\n\\n  v_Uv = a_Tex / u_SDFMapSize;\\n  float fontScale = u_FontSize / 24.;\\n\\n  vec2 bufferOffset = vec2(0.7, 2.0);\\n  vec2 offset = a_Offset * fontScale + + bufferOffset;\\n\\n  bool isBillboard = a_StylePacked2.y > 0.5;\\n  if (isBillboard) {\\n    float rotation =  a_StylePacked2.w;\\n    bool isSizeAttenuation = a_StylePacked2.z > 0.5;\\n    gl_Position = billboard(offset, rotation, isSizeAttenuation, u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix, a_Position );\\n  } else {\\n    gl_Position = project(vec4(a_Position.xy + offset, u_ZIndex, 1.0), u_ProjectionMatrix, u_ViewMatrix, u_ModelMatrix);\\n  }\\n}\"; // eslint-disable-line\n\n// borrow from mapbox/src/symbol\nfunction createImage(image, _a, channels, data) {\n    var width = _a.width, height = _a.height;\n    if (!data) {\n        data = new Uint8Array(width * height * channels);\n    }\n    else if (data.length !== width * height * channels) {\n        throw new RangeError('mismatched image size');\n    }\n    image.width = width;\n    image.height = height;\n    image.data = data;\n    return image;\n}\nfunction resizeImage(image, _a, channels) {\n    var width = _a.width, height = _a.height;\n    if (width === image.width && height === image.height) {\n        return;\n    }\n    var newImage = createImage({}, { width: width, height: height }, channels);\n    copyImage(image, newImage, { x: 0, y: 0 }, { x: 0, y: 0 }, {\n        width: Math.min(image.width, width),\n        height: Math.min(image.height, height),\n    }, channels);\n    image.width = width;\n    image.height = height;\n    image.data = newImage.data;\n}\nfunction copyImage(srcImg, dstImg, srcPt, dstPt, size, channels) {\n    if (size.width === 0 || size.height === 0) {\n        return dstImg;\n    }\n    if (size.width > srcImg.width ||\n        size.height > srcImg.height ||\n        srcPt.x > srcImg.width - size.width ||\n        srcPt.y > srcImg.height - size.height) {\n        throw new RangeError('out of range source coordinates for image copy');\n    }\n    if (size.width > dstImg.width ||\n        size.height > dstImg.height ||\n        dstPt.x > dstImg.width - size.width ||\n        dstPt.y > dstImg.height - size.height) {\n        throw new RangeError('out of range destination coordinates for image copy');\n    }\n    var srcData = srcImg.data;\n    var dstData = dstImg.data;\n    for (var y = 0; y < size.height; y++) {\n        var srcOffset = ((srcPt.y + y) * srcImg.width + srcPt.x) * channels;\n        var dstOffset = ((dstPt.y + y) * dstImg.width + dstPt.x) * channels;\n        for (var i = 0; i < size.width * channels; i++) {\n            dstData[dstOffset + i] = srcData[srcOffset + i];\n        }\n    }\n    return dstImg;\n}\nvar AlphaImage = /** @class */ (function () {\n    function AlphaImage(size, data) {\n        createImage(this, size, 1, data);\n    }\n    AlphaImage.prototype.resize = function (size) {\n        resizeImage(this, size, 1);\n    };\n    AlphaImage.prototype.clone = function () {\n        return new AlphaImage({ width: this.width, height: this.height }, new Uint8Array(this.data));\n    };\n    AlphaImage.copy = function (srcImg, dstImg, srcPt, dstPt, size) {\n        copyImage(srcImg, dstImg, srcPt, dstPt, size, 1);\n    };\n    return AlphaImage;\n}());\n\n// borrow from https://github.com/mapbox/potpack/blob/master/index.mjs\n// @see https://github.com/antvis/g/issues/836\nfunction potpack(boxes) {\n    var e_1, _a, e_2, _b;\n    // calculate total box area and maximum box width\n    var area = 0;\n    var maxWidth = 0;\n    try {\n        for (var boxes_1 = __values(boxes), boxes_1_1 = boxes_1.next(); !boxes_1_1.done; boxes_1_1 = boxes_1.next()) {\n            var box = boxes_1_1.value;\n            area += box.w * box.h;\n            maxWidth = Math.max(maxWidth, box.w);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (boxes_1_1 && !boxes_1_1.done && (_a = boxes_1.return)) _a.call(boxes_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    // sort the boxes for insertion by height, descending\n    boxes.sort(function (a, b) { return b.h - a.h; });\n    // aim for a squarish resulting container,\n    // slightly adjusted for sub-100% space utilization\n    var startWidth = Math.max(Math.ceil(Math.sqrt(area / 0.95)), maxWidth);\n    // start with a single empty space, unbounded at the bottom\n    var spaces = [{ x: 0, y: 0, w: startWidth, h: Infinity }];\n    var width = 0;\n    var height = 0;\n    try {\n        for (var boxes_2 = __values(boxes), boxes_2_1 = boxes_2.next(); !boxes_2_1.done; boxes_2_1 = boxes_2.next()) {\n            var box = boxes_2_1.value;\n            // look through spaces backwards so that we check smaller spaces first\n            for (var i = spaces.length - 1; i >= 0; i--) {\n                var space = spaces[i];\n                // look for empty spaces that can accommodate the current box\n                if (box.w > space.w || box.h > space.h)\n                    continue;\n                // found the space; add the box to its top-left corner\n                // |-------|-------|\n                // |  box  |       |\n                // |_______|       |\n                // |         space |\n                // |_______________|\n                box.x = space.x;\n                box.y = space.y;\n                height = Math.max(height, box.y + box.h);\n                width = Math.max(width, box.x + box.w);\n                if (box.w === space.w && box.h === space.h) {\n                    // space matches the box exactly; remove it\n                    var last = spaces.pop();\n                    if (i < spaces.length)\n                        spaces[i] = last;\n                }\n                else if (box.h === space.h) {\n                    // space matches the box height; update it accordingly\n                    // |-------|---------------|\n                    // |  box  | updated space |\n                    // |_______|_______________|\n                    space.x += box.w;\n                    space.w -= box.w;\n                }\n                else if (box.w === space.w) {\n                    // space matches the box width; update it accordingly\n                    // |---------------|\n                    // |      box      |\n                    // |_______________|\n                    // | updated space |\n                    // |_______________|\n                    space.y += box.h;\n                    space.h -= box.h;\n                }\n                else {\n                    // otherwise the box splits the space into two spaces\n                    // |-------|-----------|\n                    // |  box  | new space |\n                    // |_______|___________|\n                    // | updated space     |\n                    // |___________________|\n                    spaces.push({\n                        x: space.x + box.w,\n                        y: space.y,\n                        w: space.w - box.w,\n                        h: box.h,\n                    });\n                    space.y += box.h;\n                    space.h -= box.h;\n                }\n                break;\n            }\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (boxes_2_1 && !boxes_2_1.done && (_b = boxes_2.return)) _b.call(boxes_2);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return {\n        w: width, // container width\n        h: height, // container height\n        fill: area / (width * height) || 0, // space utilization\n    };\n}\nvar padding = 1;\n/**\n * Merge SDFs into a large squared atlas with `potpack`,\n * because on WebGL1 context, all textures are resized to a power of two to produce the best quality.\n *\n * @see https://doc.babylonjs.com/advanced_topics/webGL2#power-of-two-textures\n */\nvar GlyphAtlas = /** @class */ (function () {\n    function GlyphAtlas(stacks) {\n        var positions = {};\n        var bins = [];\n        for (var stack in stacks) {\n            var glyphs = stacks[stack];\n            // @ts-ignore\n            var stackPositions = (positions[stack] = {});\n            for (var id in glyphs) {\n                var src = glyphs[+id];\n                if (!src || src.bitmap.width === 0 || src.bitmap.height === 0)\n                    continue;\n                var bin = {\n                    x: 0,\n                    y: 0,\n                    w: src.bitmap.width + 2 * padding,\n                    h: src.bitmap.height + 2 * padding,\n                };\n                bins.push(bin);\n                // @ts-ignore\n                stackPositions[id] = { rect: bin, metrics: src.metrics };\n            }\n        }\n        var _a = potpack(bins), w = _a.w, h = _a.h;\n        var image = new AlphaImage({ width: w || 1, height: h || 1 });\n        for (var stack in stacks) {\n            var glyphs = stacks[stack];\n            for (var id in glyphs) {\n                var src = glyphs[+id];\n                if (!src || src.bitmap.width === 0 || src.bitmap.height === 0)\n                    continue;\n                // @ts-ignore\n                var bin = positions[stack][id].rect;\n                AlphaImage.copy(src.bitmap, image, { x: 0, y: 0 }, { x: bin.x + padding, y: bin.y + padding }, src.bitmap);\n            }\n        }\n        this.image = image;\n        this.positions = positions;\n    }\n    return GlyphAtlas;\n}());\n\nvar BASE_FONT_WIDTH = 24;\nvar BASE_FONT_BUFFER = 3;\nvar fontSize = BASE_FONT_WIDTH; // Font size in pixels\nvar buffer = BASE_FONT_BUFFER; // Whitespace buffer around a glyph in pixels\nvar radius = 8; // How many pixels around the glyph shape to use for encoding distance\nvar cutoff = 0.25; // How much of the radius (relative) is used for the inside part the glyph\nfunction getDefaultCharacterSet() {\n    var charSet = [];\n    for (var i = 32; i < 128; i++) {\n        charSet.push(String.fromCharCode(i));\n    }\n    return charSet;\n}\n/**\n * TODO: use one atlas for all fontstacks, each fontstack has one texture now\n */\nvar GlyphManager = /** @class */ (function () {\n    function GlyphManager(runtime) {\n        this.runtime = runtime;\n        this.sdfGeneratorCache = {};\n        this.textMetricsCache = {};\n        this.glyphMap = {};\n    }\n    GlyphManager.prototype.destroy = function () {\n        if (this.glyphAtlasTexture) {\n            this.glyphAtlasTexture.destroy();\n        }\n    };\n    GlyphManager.prototype.getMap = function () {\n        return this.glyphMap;\n    };\n    GlyphManager.prototype.getAtlas = function () {\n        return this.glyphAtlas;\n    };\n    GlyphManager.prototype.getAtlasTexture = function () {\n        return this.glyphAtlasTexture;\n    };\n    GlyphManager.prototype.layout = function (lines, fontStack, lineHeight, textAlign, letterSpacing, offsetX, offsetY) {\n        var _this = this;\n        var positionedGlyphs = [];\n        var x = offsetX;\n        var y = offsetY;\n        var justify = textAlign === 'right' || textAlign === 'end'\n            ? 1\n            : textAlign === 'left' || textAlign === 'start'\n                ? 0\n                : 0.5;\n        lines.forEach(function (line) {\n            var lineStartIndex = positionedGlyphs.length;\n            Array.from(line).forEach(function (char) {\n                // fontStack\n                var positions = _this.glyphMap[fontStack];\n                var charCode = char.charCodeAt(0);\n                var glyph = positions && positions[charCode];\n                if (glyph) {\n                    positionedGlyphs.push({\n                        glyph: charCode,\n                        x: x,\n                        y: y,\n                        scale: 1,\n                        fontStack: fontStack,\n                    });\n                    x += glyph.metrics.advance + letterSpacing;\n                }\n            });\n            var lineWidth = x - letterSpacing;\n            for (var i = lineStartIndex; i < positionedGlyphs.length; i++) {\n                positionedGlyphs[i].x = positionedGlyphs[i].x - justify * lineWidth;\n            }\n            x = 0;\n            y += lineHeight;\n        });\n        return positionedGlyphs;\n    };\n    GlyphManager.prototype.generateAtlas = function (canvas, fontStack, fontFamily, fontWeight, fontStyle, text, device) {\n        var _this = this;\n        if (fontStack === void 0) { fontStack = ''; }\n        if (fontStyle === void 0) { fontStyle = ''; }\n        var newChars = [];\n        if (!this.glyphMap[fontStack]) {\n            newChars = getDefaultCharacterSet();\n        }\n        var existedChars = Object.keys(this.glyphMap[fontStack] || {});\n        Array.from(new Set(text.split(''))).forEach(function (char) {\n            if (existedChars.indexOf(char.charCodeAt(0).toString()) === -1) {\n                newChars.push(char);\n            }\n        });\n        if (newChars.length) {\n            var glyphMap = newChars\n                .map(function (char) {\n                return _this.generateSDF(canvas, fontStack, fontFamily, fontWeight, fontStyle, char);\n            })\n                .reduce(function (prev, cur) {\n                // @ts-ignore\n                prev[cur.id] = cur;\n                return prev;\n            }, {});\n            this.glyphMap[fontStack] = __assign(__assign({}, this.glyphMap[fontStack]), glyphMap);\n            this.glyphAtlas = new GlyphAtlas(this.glyphMap);\n            var _a = this.glyphAtlas.image, atlasWidth = _a.width, atlasHeight = _a.height, data = _a.data;\n            if (this.glyphAtlasTexture) {\n                this.glyphAtlasTexture.destroy();\n            }\n            this.glyphAtlasTexture = device.createTexture(__assign(__assign({}, makeTextureDescriptor2D(Format.ALPHA, atlasWidth, atlasHeight, 1)), { pixelStore: {\n                    unpackFlipY: false,\n                    unpackAlignment: 1,\n                } }));\n            this.glyphAtlasTexture.setImageData([data]);\n        }\n    };\n    GlyphManager.prototype.generateSDF = function (canvas, fontStack, fontFamily, fontWeight, fontStyle, char) {\n        if (fontStack === void 0) { fontStack = ''; }\n        var charCode = char.charCodeAt(0);\n        var sdfGenerator = this.sdfGeneratorCache[fontStack];\n        if (!sdfGenerator) {\n            // 创建 SDF\n            sdfGenerator = this.sdfGeneratorCache[fontStack] =\n                // TODO: use OffscreenCanvas in TextService\n                new TinySDF({\n                    canvas: canvas,\n                    fontSize: fontSize,\n                    fontFamily: fontFamily,\n                    fontWeight: fontWeight,\n                    fontStyle: fontStyle,\n                    buffer: buffer,\n                    radius: radius,\n                    cutoff: cutoff,\n                }, this.runtime);\n        }\n        if (!this.textMetricsCache[fontStack]) {\n            this.textMetricsCache[fontStack] = {};\n        }\n        if (!this.textMetricsCache[fontStack][char]) {\n            // 使用 mapbox/tiny-sdf 中的 context\n            // @see https://stackoverflow.com/questions/46126565/how-to-get-font-glyphs-metrics-details-in-javascript\n            this.textMetricsCache[fontStack][char] =\n                // @ts-ignore\n                sdfGenerator.ctx.measureText(char).width;\n        }\n        // use sdf 2.x @see https://github.com/mapbox/tiny-sdf\n        var _a = sdfGenerator.draw(char), data = _a.data, width = _a.width, height = _a.height, glyphWidth = _a.glyphWidth, glyphHeight = _a.glyphHeight, glyphLeft = _a.glyphLeft, glyphTop = _a.glyphTop, glyphAdvance = _a.glyphAdvance;\n        return {\n            id: charCode,\n            // 在 canvas 中绘制字符，使用 Uint8Array 存储 30*30 sdf 数据\n            bitmap: new AlphaImage({\n                width: width,\n                height: height,\n            }, data),\n            metrics: {\n                width: glyphWidth,\n                height: glyphHeight,\n                left: glyphLeft,\n                top: glyphTop - BASE_FONT_WIDTH + BASE_FONT_BUFFER,\n                advance: glyphAdvance,\n            },\n        };\n    };\n    return GlyphManager;\n}());\n\n/**\n * Create the quads used for rendering a text label.\n */\nfunction getGlyphQuads(positionedGlyphs, positions) {\n    var quads = [];\n    for (var k = 0; k < positionedGlyphs.length; k++) {\n        var positionedGlyph = positionedGlyphs[k];\n        var glyphPositions = positions[positionedGlyph.fontStack];\n        var glyph = glyphPositions && glyphPositions[positionedGlyph.glyph];\n        if (!glyph)\n            continue;\n        var rect = glyph.rect;\n        if (!rect)\n            continue;\n        // The rects have an addditional buffer that is not included in their size.\n        var glyphPadding = 1.0;\n        // const glyphPadding = 0.0;\n        var rectBuffer = BASE_FONT_BUFFER + glyphPadding;\n        var halfAdvance = (glyph.metrics.advance * positionedGlyph.scale) / 2;\n        var glyphOffset = [0, 0];\n        var builtInOffset = [positionedGlyph.x + halfAdvance, positionedGlyph.y];\n        var x1 = (glyph.metrics.left - rectBuffer) * positionedGlyph.scale - halfAdvance + builtInOffset[0];\n        var y1 = (-glyph.metrics.top - rectBuffer) * positionedGlyph.scale + builtInOffset[1];\n        var x2 = x1 + rect.w * positionedGlyph.scale;\n        var y2 = y1 + rect.h * positionedGlyph.scale;\n        var tl = { x: x1, y: y1 };\n        var tr = { x: x2, y: y1 };\n        var bl = { x: x1, y: y2 };\n        var br = { x: x2, y: y2 };\n        quads.push({ tl: tl, tr: tr, bl: bl, br: br, tex: rect, glyphOffset: glyphOffset });\n    }\n    return quads;\n}\n\nvar TextVertexAttributeBufferIndex;\n(function (TextVertexAttributeBufferIndex) {\n    TextVertexAttributeBufferIndex[TextVertexAttributeBufferIndex[\"INSTANCED\"] = 5] = \"INSTANCED\";\n    TextVertexAttributeBufferIndex[TextVertexAttributeBufferIndex[\"TEX\"] = 6] = \"TEX\";\n})(TextVertexAttributeBufferIndex || (TextVertexAttributeBufferIndex = {}));\nvar TextVertexAttributeLocation;\n(function (TextVertexAttributeLocation) {\n    TextVertexAttributeLocation[TextVertexAttributeLocation[\"TEX\"] = 12] = \"TEX\";\n    TextVertexAttributeLocation[TextVertexAttributeLocation[\"OFFSET\"] = 13] = \"OFFSET\";\n})(TextVertexAttributeLocation || (TextVertexAttributeLocation = {}));\nvar TextUniform;\n(function (TextUniform) {\n    TextUniform[\"SDF_MAP\"] = \"u_SDFMap\";\n    TextUniform[\"SDF_MAP_SIZE\"] = \"u_SDFMapSize\";\n    TextUniform[\"FONT_SIZE\"] = \"u_FontSize\";\n    TextUniform[\"GAMMA_SCALE\"] = \"u_GammaScale\";\n    TextUniform[\"STROKE_BLUR\"] = \"u_StrokeBlur\";\n    TextUniform[\"HAS_STROKE\"] = \"u_HasStroke\";\n})(TextUniform || (TextUniform = {}));\nvar TextDrawcall = /** @class */ (function (_super) {\n    __extends(TextDrawcall, _super);\n    function TextDrawcall(renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) {\n        var _this = _super.call(this, renderHelper, texturePool, lightPool, object, drawcallCtors, index, context) || this;\n        _this.renderHelper = renderHelper;\n        _this.texturePool = texturePool;\n        _this.lightPool = lightPool;\n        _this.packedBufferObjectMap = new WeakMap();\n        _this.tmpMat4 = mat4.create();\n        _this.fontHash = _this.calcFontHash(object);\n        _this.glyphManager = new GlyphManager(_this.context);\n        return _this;\n    }\n    TextDrawcall.prototype.calcFontHash = function (object) {\n        // Trigger text geometry calculation.\n        object.getBounds();\n        var instancedAttributes = [\n            'fontSize',\n            'fontFamily',\n            'fontWeight',\n            'textBaseline',\n            'letterSpacing',\n        ];\n        return (object.parsedStyle.metrics.font +\n            instancedAttributes.reduce(function (prev, cur) {\n                return prev + object.parsedStyle[cur];\n            }, ''));\n    };\n    TextDrawcall.prototype.shouldMerge = function (object, index) {\n        var shouldMerge = _super.prototype.shouldMerge.call(this, object, index);\n        if (!shouldMerge) {\n            return false;\n        }\n        if (this.index !== index) {\n            return false;\n        }\n        return this.fontHash === this.calcFontHash(object);\n    };\n    TextDrawcall.prototype.createGeometry = function (objects) {\n        var _this = this;\n        var object = this.instance;\n        var _a = object.parsedStyle, _b = _a.fontSize, fontSize = _b === void 0 ? 16 : _b, _c = _a.letterSpacing, letterSpacing = _c === void 0 ? 0 : _c;\n        var _d = object.parsedStyle.textBaseline, textBaseline = _d === void 0 ? 'alphabetic' : _d;\n        // scale current font size to base(24)\n        var fontScale = BASE_FONT_WIDTH / fontSize;\n        var indices = [];\n        var positions = [];\n        var uvOffsets = [];\n        var packed = [];\n        var indicesOff = 0;\n        objects.forEach(function (object) {\n            var _a = object.parsedStyle, metrics = _a.metrics, _b = _a.dx, dx = _b === void 0 ? 0 : _b, _c = _a.dy, dy = _c === void 0 ? 0 : _c;\n            var font = metrics.font, lines = metrics.lines, height = metrics.height, lineHeight = metrics.lineHeight;\n            // account for dx & dy\n            var offsetX = dx;\n            var offsetY = dy;\n            if (!_this.context.enableCSSParsing && textBaseline === 'alphabetic') {\n                textBaseline = 'bottom';\n            }\n            var linePositionY = 0;\n            // handle vertical text baseline\n            if (textBaseline === 'middle') {\n                linePositionY += -height / 2;\n            }\n            else if (textBaseline === 'bottom') {\n                linePositionY += -height;\n            }\n            else if (textBaseline === 'top' || textBaseline === 'hanging') {\n                linePositionY += 0;\n            }\n            else if (textBaseline === 'alphabetic') {\n                linePositionY += -height + lineHeight * 0.25;\n            }\n            else if (textBaseline === 'ideographic') {\n                linePositionY += -height;\n            }\n            var glyphAtlas = _this.glyphManager.getAtlas();\n            var _d = _this.buildTextBuffers({\n                object: object,\n                lines: lines,\n                fontStack: font,\n                lineHeight: fontScale * lineHeight,\n                offsetX: fontScale * offsetX,\n                offsetY: fontScale * (linePositionY + offsetY),\n                letterSpacing: fontScale * letterSpacing,\n                glyphAtlas: glyphAtlas,\n                indicesOffset: indicesOff,\n            }), indicesOffset = _d.indicesOffset, indexBuffer = _d.indexBuffer, charUVOffsetBuffer = _d.charUVOffsetBuffer, charPositionsBuffer = _d.charPositionsBuffer, charPackedBuffer = _d.charPackedBuffer;\n            indicesOff = indicesOffset;\n            var start = packed.length;\n            packed.push.apply(packed, __spreadArray([], __read(charPackedBuffer), false));\n            var end = packed.length;\n            _this.packedBufferObjectMap.set(object, [start, end]);\n            uvOffsets.push.apply(uvOffsets, __spreadArray([], __read(charUVOffsetBuffer), false));\n            positions.push.apply(positions, __spreadArray([], __read(charPositionsBuffer), false));\n            indices.push.apply(indices, __spreadArray([], __read(indexBuffer), false));\n        });\n        this.geometry.vertexCount = indices.length;\n        this.geometry.setIndexBuffer(new Uint32Array(indices));\n        this.geometry.setVertexBuffer({\n            bufferIndex: TextVertexAttributeBufferIndex.INSTANCED,\n            byteStride: 4 * (4 * 4 + 4 + 4 + 4 + 4), // 32\n            stepMode: VertexStepMode.VERTEX,\n            attributes: [\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.MODEL_MATRIX0,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 4,\n                    location: VertexAttributeLocation.MODEL_MATRIX1,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 8,\n                    location: VertexAttributeLocation.MODEL_MATRIX2,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 12,\n                    location: VertexAttributeLocation.MODEL_MATRIX3,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 16,\n                    location: VertexAttributeLocation.PACKED_COLOR,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 20,\n                    location: VertexAttributeLocation.PACKED_STYLE1,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 24,\n                    location: VertexAttributeLocation.PACKED_STYLE2,\n                },\n                {\n                    format: Format.F32_RGBA,\n                    bufferByteOffset: 4 * 28,\n                    location: VertexAttributeLocation.PICKING_COLOR,\n                },\n            ],\n            data: new Float32Array(packed),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: VertexAttributeBufferIndex.POSITION,\n            byteStride: 4 * 3,\n            stepMode: VertexStepMode.VERTEX,\n            attributes: [\n                {\n                    format: Format.F32_RGB,\n                    bufferByteOffset: 4 * 0,\n                    location: VertexAttributeLocation.POSITION,\n                },\n            ],\n            data: new Float32Array(positions),\n        });\n        this.geometry.setVertexBuffer({\n            bufferIndex: TextVertexAttributeBufferIndex.TEX,\n            byteStride: 4 * (2 + 2),\n            stepMode: VertexStepMode.VERTEX,\n            attributes: [\n                {\n                    format: Format.F32_RG,\n                    bufferByteOffset: 4 * 0,\n                    location: TextVertexAttributeLocation.TEX,\n                },\n                {\n                    format: Format.F32_RG,\n                    bufferByteOffset: 4 * 2,\n                    location: TextVertexAttributeLocation.OFFSET,\n                },\n            ],\n            data: new Float32Array(uvOffsets),\n        });\n    };\n    TextDrawcall.prototype.createMaterial = function (objects) {\n        var _a;\n        this.material.vertexShader = vert;\n        this.material.fragmentShader = frag;\n        this.material.cullMode = CullMode.BACK;\n        this.material.defines = __assign(__assign({}, this.material.defines), enumToObject(TextVertexAttributeLocation));\n        var object = this.instance;\n        var _b = object.parsedStyle, _c = _b.fontSize, fontSize = _c === void 0 ? 16 : _c, _d = _b.fontFamily, fontFamily = _d === void 0 ? 'sans-serif' : _d, _e = _b.fontWeight, fontWeight = _e === void 0 ? 'normal' : _e, _f = _b.fontStyle, fontStyle = _f === void 0 ? 'normal' : _f, metrics = _b.metrics;\n        var font = metrics.font;\n        var allText = objects.map(function (object) { return object.parsedStyle.text; }).join('');\n        this.glyphManager.generateAtlas(this.texturePool.context.config.offscreenCanvas, font, fontFamily, fontWeight.toString(), fontStyle, allText, this.context.device);\n        var glyphAtlasTexture = this.glyphManager.getAtlasTexture();\n        var glyphAtlas = this.glyphManager.getAtlas();\n        this.context.device.setResourceName(glyphAtlasTexture, 'TextSDF Texture');\n        var _g = glyphAtlas.image, atlasWidth = _g.width, atlasHeight = _g.height;\n        this.material.setUniforms((_a = {},\n            _a[TextUniform.SDF_MAP] = glyphAtlasTexture,\n            _a[TextUniform.SDF_MAP_SIZE] = [atlasWidth, atlasHeight],\n            _a[TextUniform.FONT_SIZE] = fontSize,\n            _a[TextUniform.GAMMA_SCALE] = 1,\n            _a[TextUniform.STROKE_BLUR] = 0.2,\n            _a[TextUniform.HAS_STROKE] = this.index,\n            _a));\n    };\n    TextDrawcall.prototype.changeRenderOrder = function (object, renderOrder) {\n        var vertice = this.geometry.vertices[TextVertexAttributeBufferIndex.INSTANCED];\n        var arrayStride = this.geometry.inputLayoutDescriptor.vertexBufferDescriptors[TextVertexAttributeBufferIndex.INSTANCED].arrayStride;\n        var bytes = arrayStride / 4;\n        var _a = __read(this.packedBufferObjectMap.get(object), 2), start = _a[0], end = _a[1];\n        var sliced = vertice.slice(start, end);\n        for (var i = 0; i < end - start; i += bytes) {\n            sliced[i + bytes - 1] = renderOrder * RENDER_ORDER_SCALE;\n        }\n        this.geometry.updateVertexBuffer(TextVertexAttributeBufferIndex.INSTANCED, VertexAttributeLocation.MODEL_MATRIX0, start / bytes, new Uint8Array(sliced.buffer));\n    };\n    TextDrawcall.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        var _this = this;\n        if (name === 'text' ||\n            name === 'fontFamily' ||\n            name === 'fontSize' ||\n            name === 'fontWeight' ||\n            name === 'fontStyle' ||\n            name === 'fontVariant' ||\n            name === 'textBaseline' ||\n            name === 'letterSpacing' ||\n            name === 'wordWrapWidth' ||\n            name === 'lineHeight' ||\n            name === 'wordWrap' ||\n            name === 'textAlign' ||\n            name === 'x' ||\n            name === 'y' ||\n            name === 'dx' ||\n            name === 'dy') {\n            this.material.programDirty = true;\n            this.material.geometryDirty = true;\n            // need re-upload SDF texture\n            this.material.textureDirty = true;\n        }\n        else if (name === 'modelMatrix' ||\n            name === 'fill' ||\n            name === 'fillOpacity' ||\n            name === 'stroke' ||\n            name === 'strokeOpacity' ||\n            name === 'opacity' ||\n            name === 'lineWidth' ||\n            name === 'visibility' ||\n            name === 'pointerEvents' ||\n            name === 'isBillboard' ||\n            name === 'billboardRotation' ||\n            name === 'isSizeAttenuation') {\n            var vertice_1 = this.geometry.vertices[TextVertexAttributeBufferIndex.INSTANCED];\n            var arrayStride = this.geometry.inputLayoutDescriptor.vertexBufferDescriptors[TextVertexAttributeBufferIndex.INSTANCED].arrayStride;\n            var bytes_1 = arrayStride / 4;\n            objects.forEach(function (object) {\n                var _a;\n                var _b = object.parsedStyle, fill = _b.fill, stroke = _b.stroke, _c = _b.opacity, opacity = _c === void 0 ? 1 : _c, _d = _b.fillOpacity, fillOpacity = _d === void 0 ? 1 : _d, _e = _b.strokeOpacity, strokeOpacity = _e === void 0 ? 1 : _e, _f = _b.lineWidth, lineWidth = _f === void 0 ? 1 : _f, visibility = _b.visibility, isBillboard = _b.isBillboard, billboardRotation = _b.billboardRotation, isSizeAttenuation = _b.isSizeAttenuation;\n                var fillColor = [0, 0, 0, 0];\n                if (isCSSRGB(fill)) {\n                    fillColor = [\n                        Number(fill.r),\n                        Number(fill.g),\n                        Number(fill.b),\n                        Number(fill.alpha) * 255,\n                    ];\n                }\n                var strokeColor = [0, 0, 0, 0];\n                if (isCSSRGB(stroke)) {\n                    strokeColor = [\n                        Number(stroke.r),\n                        Number(stroke.g),\n                        Number(stroke.b),\n                        Number(stroke.alpha) * 255,\n                    ];\n                }\n                var encodedPickingColor = (object.isInteractive() &&\n                    (\n                    // @ts-ignore\n                    (_a = object.renderable3D) === null || _a === void 0 ? void 0 : _a.encodedPickingColor)) || [0, 0, 0];\n                var modelMatrix = mat4.copy(_this.tmpMat4, object.getWorldTransform());\n                var _g = __read(_this.packedBufferObjectMap.get(object), 2), start = _g[0], end = _g[1];\n                var sliced = vertice_1.slice(start, end);\n                for (var i = 0; i < end - start; i += bytes_1) {\n                    // if (name === 'modelMatrix') {\n                    sliced[i + 0] = modelMatrix[0];\n                    sliced[i + 1] = modelMatrix[1];\n                    sliced[i + 2] = modelMatrix[2];\n                    sliced[i + 3] = modelMatrix[3];\n                    sliced[i + 4] = modelMatrix[4];\n                    sliced[i + 5] = modelMatrix[5];\n                    sliced[i + 6] = modelMatrix[6];\n                    sliced[i + 7] = modelMatrix[7];\n                    sliced[i + 8] = modelMatrix[8];\n                    sliced[i + 9] = modelMatrix[9];\n                    sliced[i + 10] = modelMatrix[10];\n                    sliced[i + 11] = modelMatrix[11];\n                    sliced[i + 12] = modelMatrix[12];\n                    sliced[i + 13] = modelMatrix[13];\n                    sliced[i + 14] = modelMatrix[14];\n                    sliced[i + 15] = modelMatrix[15];\n                    // } else if (name === 'fill') {\n                    sliced[i + 16] = packUint8ToFloat(fillColor[0], fillColor[1]);\n                    sliced[i + 17] = packUint8ToFloat(fillColor[2], fillColor[3]);\n                    // } else if (name === 'stroke') {\n                    sliced[i + 18] = packUint8ToFloat(strokeColor[0], strokeColor[1]);\n                    sliced[i + 19] = packUint8ToFloat(strokeColor[2], strokeColor[3]);\n                    // }\n                    sliced[i + 20] = opacity;\n                    sliced[i + 21] = fillOpacity;\n                    sliced[i + 22] = strokeOpacity;\n                    sliced[i + 23] = lineWidth;\n                    sliced[i + 24] = visibility !== 'hidden' ? 1 : 0;\n                    sliced[i + 25] = isBillboard ? 1 : 0;\n                    sliced[i + 26] = isSizeAttenuation ? 1 : 0;\n                    sliced[i + 27] = billboardRotation !== null && billboardRotation !== void 0 ? billboardRotation : 0;\n                    sliced[i + 28] = encodedPickingColor[0];\n                    sliced[i + 29] = encodedPickingColor[1];\n                    sliced[i + 30] = encodedPickingColor[2];\n                    // sliced[i + 31] = object.sortable.renderOrder * RENDER_ORDER_SCALE;\n                }\n                _this.geometry.updateVertexBuffer(TextVertexAttributeBufferIndex.INSTANCED, VertexAttributeLocation.MODEL_MATRIX0, start / bytes_1, new Uint8Array(sliced.buffer));\n            });\n        }\n    };\n    TextDrawcall.prototype.buildTextBuffers = function (_a) {\n        var _b;\n        var object = _a.object, lines = _a.lines, fontStack = _a.fontStack, lineHeight = _a.lineHeight, letterSpacing = _a.letterSpacing, offsetX = _a.offsetX, offsetY = _a.offsetY, glyphAtlas = _a.glyphAtlas, indicesOffset = _a.indicesOffset;\n        var _c = object.parsedStyle, _d = _c.textAlign, textAlign = _d === void 0 ? 'start' : _d, fill = _c.fill, stroke = _c.stroke, _e = _c.opacity, opacity = _e === void 0 ? 1 : _e, _f = _c.fillOpacity, fillOpacity = _f === void 0 ? 1 : _f, _g = _c.strokeOpacity, strokeOpacity = _g === void 0 ? 1 : _g, _h = _c.lineWidth, lineWidth = _h === void 0 ? 1 : _h, visibility = _c.visibility, isBillboard = _c.isBillboard, billboardRotation = _c.billboardRotation, isSizeAttenuation = _c.isSizeAttenuation, _j = _c.x, x = _j === void 0 ? 0 : _j, _k = _c.y, y = _k === void 0 ? 0 : _k, _l = _c.z, z = _l === void 0 ? 0 : _l;\n        var fillColor = [0, 0, 0, 0];\n        if (isCSSRGB(fill)) {\n            fillColor = [\n                Number(fill.r),\n                Number(fill.g),\n                Number(fill.b),\n                Number(fill.alpha) * 255,\n            ];\n        }\n        var strokeColor = [0, 0, 0, 0];\n        if (isCSSRGB(stroke)) {\n            strokeColor = [\n                Number(stroke.r),\n                Number(stroke.g),\n                Number(stroke.b),\n                Number(stroke.alpha) * 255,\n            ];\n        }\n        var encodedPickingColor = (object.isInteractive() &&\n            (\n            // @ts-ignore\n            (_b = object.renderable3D) === null || _b === void 0 ? void 0 : _b.encodedPickingColor)) || [0, 0, 0];\n        var modelMatrix = mat4.copy(this.tmpMat4, object.getWorldTransform());\n        var charPackedBuffer = [];\n        var charUVOffsetBuffer = [];\n        var charPositionsBuffer = [];\n        var indexBuffer = [];\n        var i = indicesOffset;\n        var positionedGlyphs = this.glyphManager.layout(lines, fontStack, lineHeight, textAlign, letterSpacing, offsetX, offsetY);\n        // 计算每个独立字符相对于锚点的位置信息\n        var glyphQuads = getGlyphQuads(positionedGlyphs, glyphAtlas.positions);\n        glyphQuads.forEach(function (quad) {\n            // rollup will use `concat`\n            var temp = [];\n            temp.push.apply(temp, __spreadArray([], __read(modelMatrix), false));\n            var packed = __spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(temp), false), [\n                packUint8ToFloat(fillColor[0], fillColor[1]),\n                packUint8ToFloat(fillColor[2], fillColor[3]),\n                packUint8ToFloat(strokeColor[0], strokeColor[1]),\n                packUint8ToFloat(strokeColor[2], strokeColor[3]),\n                opacity,\n                fillOpacity,\n                strokeOpacity,\n                lineWidth,\n                visibility !== 'hidden' ? 1 : 0,\n                isBillboard ? 1 : 0,\n                isSizeAttenuation ? 1 : 0,\n                billboardRotation !== null && billboardRotation !== void 0 ? billboardRotation : 0\n            ], false), __read(encodedPickingColor), false), [\n                object.sortable.renderOrder * RENDER_ORDER_SCALE,\n            ], false);\n            // Can't use instanced here since the total number of each Text can be different.\n            charPackedBuffer.push.apply(charPackedBuffer, __spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(packed), false), __read(packed), false), __read(packed), false), __read(packed), false));\n            // interleaved uv & offsets\n            charUVOffsetBuffer.push(quad.tex.x, quad.tex.y, quad.tl.x, quad.tl.y);\n            charUVOffsetBuffer.push(quad.tex.x + quad.tex.w, quad.tex.y, quad.tr.x, quad.tr.y);\n            charUVOffsetBuffer.push(quad.tex.x + quad.tex.w, quad.tex.y + quad.tex.h, quad.br.x, quad.br.y);\n            charUVOffsetBuffer.push(quad.tex.x, quad.tex.y + quad.tex.h, quad.bl.x, quad.bl.y);\n            charPositionsBuffer.push(x, y, z, x, y, z, x, y, z, x, y, z);\n            indexBuffer.push(0 + i, 2 + i, 1 + i);\n            indexBuffer.push(2 + i, 0 + i, 3 + i);\n            i += 4;\n        });\n        return {\n            indexBuffer: indexBuffer,\n            charUVOffsetBuffer: charUVOffsetBuffer,\n            charPositionsBuffer: charPositionsBuffer,\n            charPackedBuffer: charPackedBuffer,\n            indicesOffset: i,\n        };\n    };\n    TextDrawcall.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.glyphManager.destroy();\n    };\n    return TextDrawcall;\n}(Instanced));\n\nvar MeshDrawcall = /** @class */ (function (_super) {\n    __extends(MeshDrawcall, _super);\n    function MeshDrawcall() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.mergeXYZIntoModelMatrix = false;\n        return _this;\n    }\n    MeshDrawcall.prototype.shouldMerge = function (object, index) {\n        var shouldMerge = _super.prototype.shouldMerge.call(this, object, index);\n        if (!shouldMerge) {\n            return false;\n        }\n        if (this.instance.nodeName === Shape.MESH) {\n            if (this.instance.parsedStyle.material !== object.parsedStyle.material ||\n                this.instance.parsedStyle.geometry !== object.parsedStyle.geometry) {\n                return false;\n            }\n        }\n        return true;\n    };\n    MeshDrawcall.prototype.updateAttribute = function (objects, startIndex, name, value) {\n        _super.prototype.updateAttribute.call(this, objects, startIndex, name, value);\n        this.updateBatchedAttribute(objects, startIndex, name, value);\n    };\n    MeshDrawcall.prototype.createMaterial = function (objects) {\n        var material = this.instance.parsedStyle.material;\n        this.material = material;\n        this.observeMaterialChanged();\n    };\n    MeshDrawcall.prototype.createGeometry = function (objects) {\n        var geometry = this.instance.parsedStyle.geometry;\n        this.geometry = geometry;\n        // use default common attributes\n        _super.prototype.createGeometry.call(this, objects);\n        this.geometry.build(objects);\n        // TODO: clear dirty listener\n        this.observeGeometryChanged();\n    };\n    return MeshDrawcall;\n}(Instanced));\n\n/**\n * Use 2 meshes:\n * * SDF to draw fill & simple stroke if needed.\n * * InstancedPathDrawcall to draw stroke separately.\n */\nvar CircleRenderer = /** @class */ (function (_super) {\n    __extends(CircleRenderer, _super);\n    function CircleRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    CircleRenderer.prototype.getDrawcallCtors = function (object) {\n        var drawcalls = [];\n        var fill = object.parsedStyle.fill;\n        if (fill && !fill.isNone) {\n            drawcalls.push(SDFDrawcall);\n        }\n        if (this.needDrawStrokeSeparately(object)) {\n            drawcalls.push(InstancedPathDrawcall);\n        }\n        return drawcalls;\n    };\n    /**\n     * need an additional mesh to draw stroke:\n     * 1. strokeOpacity < 1\n     * 2. lineDash used\n     * 3. stroke is not 'none'\n     */\n    CircleRenderer.prototype.needDrawStrokeSeparately = function (object) {\n        var _a = object.parsedStyle, fill = _a.fill, stroke = _a.stroke, lineDash = _a.lineDash, lineWidth = _a.lineWidth, strokeOpacity = _a.strokeOpacity;\n        var hasFill = fill && !fill.isNone;\n        var hasStroke = stroke && !stroke.isNone;\n        var hasDash = lineDash &&\n            lineDash.length &&\n            lineDash.every(function (item) { return item !== 0; });\n        return (!hasFill || (hasStroke && lineWidth > 0 && (strokeOpacity < 1 || hasDash)));\n    };\n    return CircleRenderer;\n}(Batch));\n\n/**\n * Use the following perf enhancements:\n * * Downgrading the \"simple\" Path / Polyline to {@link InstancedLineDrawcall}, e.g. 'M 0 0 L 100 0'\n * * Merge the Path into {@link InstancedPathDrawcall} which contains only one curve command, e.g 'M 0 0 Q 10 10 100 100'\n * @see https://github.com/antvis/G/issues/1113\n */\nvar PathRenderer = /** @class */ (function (_super) {\n    __extends(PathRenderer, _super);\n    function PathRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    // meshes = [\n    //   InstancedFillDrawcall ?,\n    //   (InstancedLineDrawcall | InstancedPathDrawcall) *, // sub paths\n    // ];\n    PathRenderer.prototype.getDrawcallCtors = function (object) {\n        var _a = object.parsedStyle, fill = _a.fill, stroke = _a.stroke, opacity = _a.opacity, strokeOpacity = _a.strokeOpacity, lineWidth = _a.lineWidth;\n        var hasStroke = stroke && !stroke.isNone;\n        var subpathNum = InstancedPathDrawcall.calcSubpathNum(object);\n        var drawcalls = [];\n        // Polyline don't need fill\n        if (!(object.nodeName === Shape.POLYLINE || (fill === null || fill === void 0 ? void 0 : fill.isNone))) {\n            for (var i = 0; i < subpathNum; i++) {\n                drawcalls.push(InstancedFillDrawcall);\n            }\n        }\n        for (var i = 0; i < subpathNum; i++) {\n            if (!(strokeOpacity === 0 || opacity === 0 || lineWidth === 0 || !hasStroke)) {\n                var isLine = InstancedLineDrawcall.isLine(object, i);\n                if (isLine) {\n                    drawcalls.push(InstancedLineDrawcall);\n                }\n                else {\n                    drawcalls.push(InstancedPathDrawcall);\n                }\n            }\n        }\n        return drawcalls;\n    };\n    return PathRenderer;\n}(Batch));\n\n/** @class */ ((function (_super) {\n    __extends(GroupRenderer, _super);\n    function GroupRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    GroupRenderer.prototype.getDrawcallCtors = function () {\n        return [];\n    };\n    return GroupRenderer;\n})(Batch));\n\nvar ImageRenderer = /** @class */ (function (_super) {\n    __extends(ImageRenderer, _super);\n    function ImageRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ImageRenderer.prototype.getDrawcallCtors = function () {\n        return [ImageDrawcall];\n    };\n    return ImageRenderer;\n}(Batch));\n\nvar TextRenderer = /** @class */ (function (_super) {\n    __extends(TextRenderer, _super);\n    function TextRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * one for fill, one for stroke\n     */\n    TextRenderer.prototype.getDrawcallCtors = function (object) {\n        var drawcalls = [];\n        var _a = object.parsedStyle, stroke = _a.stroke, _b = _a.lineWidth, lineWidth = _b === void 0 ? 1 : _b;\n        var hasStroke = !!(stroke && !stroke.isNone && lineWidth);\n        if (hasStroke) {\n            drawcalls.push(TextDrawcall);\n        }\n        drawcalls.push(TextDrawcall);\n        return drawcalls;\n    };\n    TextRenderer.prototype.beforeUploadUBO = function (renderInst, mesh) {\n        var _a;\n        var drawcallNum = mesh.instance.renderable3D\n            .drawcalls.length;\n        mesh.material.setUniforms((_a = {},\n            _a[TextUniform.HAS_STROKE] = drawcallNum === 1 ? 0 : 1 - mesh.index,\n            _a));\n    };\n    return TextRenderer;\n}(Batch));\n\n/**\n * use instanced for each segment\n * @see https://blog.scottlogic.com/2019/11/18/drawing-lines-with-webgl.html\n *\n * support dash array\n * TODO: joint & cap\n */\nvar LineRenderer = /** @class */ (function (_super) {\n    __extends(LineRenderer, _super);\n    function LineRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    LineRenderer.prototype.getDrawcallCtors = function () {\n        return [InstancedLineDrawcall];\n    };\n    return LineRenderer;\n}(Batch));\n\nvar MeshRenderer = /** @class */ (function (_super) {\n    __extends(MeshRenderer, _super);\n    function MeshRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    MeshRenderer.prototype.getDrawcallCtors = function () {\n        return [MeshDrawcall];\n    };\n    return MeshRenderer;\n}(Batch));\n\n/**\n * Use 2 meshes:\n * * For simple Rect with fill & simple stroke, we use SDFDrawcall to draw which has a better performance.\n * * FillMesh & LineMesh to draw rounded rect with different radius.\n */\nvar RectRenderer = /** @class */ (function (_super) {\n    __extends(RectRenderer, _super);\n    function RectRenderer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    RectRenderer.prototype.getDrawcallCtors = function (object) {\n        var drawcalls = [];\n        var _a = object.parsedStyle, fill = _a.fill, radius = _a.radius;\n        var hasDifferentRadius = radius && radius.length && radius.some(function (r) { return r !== radius[0]; });\n        if (!((fill === null || fill === void 0 ? void 0 : fill.isNone) || hasDifferentRadius)) {\n            drawcalls.push(SDFDrawcall);\n        }\n        if (hasDifferentRadius) {\n            drawcalls.push(InstancedFillDrawcall);\n        }\n        if (hasDifferentRadius\n            ? hasDifferentRadius\n            : this.needDrawStrokeSeparately(object)) {\n            drawcalls.push(InstancedPathDrawcall);\n        }\n        return drawcalls;\n    };\n    /**\n     * need an additional mesh to draw stroke:\n     * 1. strokeOpacity < 1\n     * 2. lineDash used\n     * 3. stroke is not 'none'\n     */\n    RectRenderer.prototype.needDrawStrokeSeparately = function (object) {\n        var _a = object.parsedStyle, fill = _a.fill, stroke = _a.stroke, lineDash = _a.lineDash, lineWidth = _a.lineWidth, strokeOpacity = _a.strokeOpacity;\n        var hasFill = fill && !fill.isNone;\n        var hasStroke = stroke && !stroke.isNone;\n        var hasDash = lineDash && lineDash.length && lineDash.every(function (item) { return item !== 0; });\n        return (!hasFill || (hasStroke && lineWidth > 0 && (strokeOpacity < 1 || hasDash)));\n    };\n    return RectRenderer;\n}(Batch));\n\nvar stencilRefCounter = 1;\nvar BatchManager = /** @class */ (function () {\n    function BatchManager(renderHelper, rendererFactory, texturePool, lightPool) {\n        this.renderHelper = renderHelper;\n        this.rendererFactory = rendererFactory;\n        this.texturePool = texturePool;\n        this.lightPool = lightPool;\n        /**\n         * draw calls\n         */\n        this.drawcalls = [];\n        /**\n         * update patches which can be merged before rendering\n         */\n        this.pendingUpdatePatches = {};\n        this.stencilRefCache = {};\n    }\n    BatchManager.prototype.destroy = function () {\n        this.drawcalls.forEach(function (drawcall) {\n            drawcall.destroy();\n        });\n        this.drawcalls = [];\n        this.pendingUpdatePatches = {};\n    };\n    BatchManager.prototype.render = function (list, isPicking) {\n        var _this = this;\n        if (isPicking === void 0) { isPicking = false; }\n        if (!isPicking) {\n            this.updatePendingPatches();\n        }\n        this.drawcalls.forEach(function (mesh) {\n            // init rendering service, create geometry & material\n            mesh.init();\n            var objects = mesh.objects;\n            if (mesh.clipPathTarget) {\n                objects = [mesh.clipPath];\n            }\n            // new render instance\n            var renderInst = _this.renderHelper.renderInstManager.newRenderInst();\n            renderInst.setAllowSkippingIfPipelineNotReady(false);\n            mesh.applyRenderInst(renderInst, objects);\n            _this.renderHelper.renderInstManager.submitRenderInst(renderInst, list);\n            // console.log('submit: ', mesh);\n            if (!isPicking) {\n                // finish rendering...\n                mesh.objects.forEach(function (object) {\n                    object.renderable.dirty = false;\n                });\n            }\n        });\n    };\n    /**\n     * get called in RenderGraphPlugin\n     */\n    BatchManager.prototype.attach = function (context) {\n        this.context = context;\n    };\n    BatchManager.prototype.add = function (object) {\n        var _this = this;\n        var renderable3D = object.renderable3D;\n        if (renderable3D && !renderable3D.drawcalls.length) {\n            var renderer_1 = this.rendererFactory[object.nodeName];\n            if (renderer_1) {\n                // A complex Path can be splitted into multple sub paths.\n                renderer_1\n                    .getDrawcallCtors(object)\n                    .forEach(function (drawcallCtor, i, drawcallCtors) {\n                    var existedDrawcall = _this.drawcalls.find(function (mesh) {\n                        return drawcallCtor === mesh.constructor &&\n                            mesh.index === i &&\n                            mesh.objects.length < mesh.maxInstances &&\n                            mesh.shouldMerge(object, i);\n                    });\n                    if (!existedDrawcall ||\n                        existedDrawcall.key !== object.parsedStyle.batchKey) {\n                        existedDrawcall = new drawcallCtor(_this.renderHelper, _this.texturePool, _this.lightPool, object, drawcallCtors, i, _this.context);\n                        existedDrawcall.renderer = renderer_1;\n                        _this.drawcalls.push(existedDrawcall);\n                        if (object.parsedStyle.batchKey) {\n                            existedDrawcall.key = object.parsedStyle.batchKey;\n                        }\n                    }\n                    if (existedDrawcall) {\n                        existedDrawcall.objects.push(object);\n                        renderable3D.drawcalls[i] = existedDrawcall;\n                        existedDrawcall.geometryDirty = true;\n                    }\n                });\n            }\n        }\n    };\n    BatchManager.prototype.remove = function (object) {\n        var _this = this;\n        // @ts-ignore\n        var renderable3D = object.renderable3D;\n        if (renderable3D) {\n            renderable3D.drawcalls.forEach(function (mesh) {\n                if (mesh) {\n                    // remove from mesh\n                    var index = mesh.objects.indexOf(object);\n                    if (index > -1) {\n                        mesh.objects.splice(index, 1);\n                        mesh.geometryDirty = true;\n                    }\n                    if (mesh.objects.length === 0) {\n                        var deletedDrawcalls = _this.drawcalls.splice(_this.drawcalls.indexOf(mesh), 1);\n                        deletedDrawcalls.forEach(function (deletedDrawcall) {\n                            deletedDrawcall.destroy();\n                        });\n                    }\n                }\n            });\n            renderable3D.drawcalls = [];\n        }\n    };\n    BatchManager.prototype.updateAttribute = function (object, attributeName, newValue, immediately) {\n        var _this = this;\n        if (immediately === void 0) { immediately = false; }\n        var renderable3D = object.renderable3D;\n        var renderer = this.rendererFactory[object.nodeName];\n        if (renderer) {\n            var drawcallCtors = renderer.getDrawcallCtors(object);\n            drawcallCtors.forEach(function (drawcallCtor, i, drawcallCtors) {\n                var existedDrawcall = renderable3D.drawcalls.find(function (mesh) {\n                    return mesh && mesh.index === i && mesh.constructor === drawcallCtor;\n                });\n                if (!existedDrawcall) {\n                    // Clear invalid drawcall.\n                    existedDrawcall = renderable3D.drawcalls[i];\n                    if (existedDrawcall) {\n                        // remove from mesh\n                        existedDrawcall.objects.splice(existedDrawcall.objects.indexOf(object), 1);\n                        existedDrawcall.geometryDirty = true;\n                        if (existedDrawcall.objects.length === 0) {\n                            _this.drawcalls.splice(_this.drawcalls.indexOf(existedDrawcall), 1);\n                        }\n                        renderable3D.drawcalls[renderable3D.drawcalls.indexOf(existedDrawcall)] = undefined;\n                    }\n                    // We should create a new drawcall from scratch.\n                    existedDrawcall = _this.drawcalls.find(function (mesh) {\n                        return drawcallCtor === mesh.constructor &&\n                            mesh.index === i &&\n                            mesh.objects.length < mesh.maxInstances &&\n                            mesh.shouldMerge(object, i);\n                    });\n                    if (!existedDrawcall) {\n                        // @ts-ignore\n                        existedDrawcall = new drawcallCtor(_this.renderHelper, _this.texturePool, _this.lightPool, object, drawcallCtors, i, _this.context);\n                        existedDrawcall.renderer = renderer;\n                        existedDrawcall.init();\n                        _this.drawcalls.push(existedDrawcall);\n                    }\n                    else {\n                        existedDrawcall.geometryDirty = true;\n                    }\n                    existedDrawcall.objects.push(object);\n                    renderable3D.drawcalls[i] = existedDrawcall;\n                }\n                if (existedDrawcall.inited && !existedDrawcall.geometryDirty) {\n                    var shouldMerge = existedDrawcall.shouldMerge(object, i);\n                    if (shouldMerge) {\n                        var objectIdx = existedDrawcall.objects.indexOf(object);\n                        if (immediately) {\n                            object.parsedStyle[attributeName] = newValue;\n                            existedDrawcall.updateAttribute([object], objectIdx, attributeName, newValue);\n                        }\n                        else {\n                            var patchKey = existedDrawcall.id + attributeName;\n                            if (!_this.pendingUpdatePatches[patchKey]) {\n                                _this.pendingUpdatePatches[patchKey] = {\n                                    instance: existedDrawcall,\n                                    objectIndices: [],\n                                    name: attributeName,\n                                    value: newValue,\n                                };\n                            }\n                            if (_this.pendingUpdatePatches[patchKey].objectIndices.indexOf(objectIdx) === -1) {\n                                _this.pendingUpdatePatches[patchKey].objectIndices.push(objectIdx);\n                            }\n                        }\n                    }\n                    else {\n                        _this.remove(object);\n                        _this.add(object);\n                    }\n                }\n                else {\n                    _this.remove(object);\n                    _this.add(object);\n                }\n            });\n            // Clear redundant drawcalls.\n            if (renderable3D.drawcalls.length > drawcallCtors.length) {\n                var drawcallNum = renderable3D.drawcalls.length;\n                for (var i = drawcallNum - 1; i >= drawcallCtors.length; i--) {\n                    var existedDrawcall = renderable3D.drawcalls[i];\n                    // remove from mesh\n                    existedDrawcall.objects.splice(existedDrawcall.objects.indexOf(object), 1);\n                    existedDrawcall.geometryDirty = true;\n                    if (existedDrawcall.objects.length === 0) {\n                        this.drawcalls.splice(this.drawcalls.indexOf(existedDrawcall), 1);\n                    }\n                    renderable3D.drawcalls.pop();\n                }\n            }\n        }\n    };\n    BatchManager.prototype.changeRenderOrder = function (object, renderOrder) {\n        // @ts-ignore\n        var renderable3D = object.renderable3D;\n        if (renderable3D && renderable3D.drawcalls.length) {\n            renderable3D.drawcalls.forEach(function (mesh) {\n                if (mesh && mesh.inited && !mesh.geometryDirty) {\n                    if (mesh.inited) {\n                        mesh.changeRenderOrder(object, renderOrder);\n                    }\n                }\n            });\n        }\n    };\n    BatchManager.prototype.getStencilRef = function (object) {\n        if (!this.stencilRefCache[object.entity]) {\n            this.stencilRefCache[object.entity] = stencilRefCounter++;\n        }\n        return this.stencilRefCache[object.entity];\n    };\n    BatchManager.prototype.updatePendingPatches = function () {\n        var _this = this;\n        // merge update patches to reduce `setSubData` calls\n        Object.keys(this.pendingUpdatePatches).forEach(function (patchKey) {\n            var _a = _this.pendingUpdatePatches[patchKey], instance = _a.instance, objectIndices = _a.objectIndices, name = _a.name, value = _a.value;\n            objectIndices.sort(function (a, b) { return a - b; });\n            var updatePatches = [];\n            objectIndices.forEach(function (i) {\n                var lastUpdateBatch = updatePatches[updatePatches.length - 1];\n                if (!lastUpdateBatch ||\n                    i !== lastUpdateBatch[lastUpdateBatch.length - 1] + 1) {\n                    updatePatches.push([i]);\n                }\n                else {\n                    lastUpdateBatch.push(i);\n                }\n            });\n            updatePatches.forEach(function (indices) {\n                instance.updateAttribute(instance.objects.slice(indices[0], indices[0] + indices.length), indices[0], name, value);\n            });\n        });\n        this.pendingUpdatePatches = {};\n    };\n    return BatchManager;\n}());\n\nvar TexturePool = /** @class */ (function () {\n    function TexturePool(context, runtime) {\n        this.context = context;\n        this.runtime = runtime;\n        this.textureCache = {};\n    }\n    TexturePool.prototype.getOrCreateTexture = function (device, src, descriptor, successCallback) {\n        var _this = this;\n        // use Image URL or src as cache key\n        // @ts-ignore\n        var id = typeof src === 'string' ? src : src.src || '';\n        var texture;\n        if (!id || !this.textureCache[id]) {\n            texture = device.createTexture(__assign({ format: Format.U8_RGBA_NORM, width: 1, height: 1, depthOrArrayLayers: 1, mipLevelCount: 1, dimension: TextureDimension.TEXTURE_2D, usage: TextureUsage.SAMPLED, pixelStore: {\n                    unpackFlipY: false,\n                } }, descriptor));\n            if (id) {\n                this.textureCache[id] = texture;\n            }\n            if (!isString(src)) {\n                texture.setImageData([src]);\n                texture.emit(TextureEvent.LOADED);\n                this.context.renderingService.dirtify();\n            }\n            else {\n                // @see https://github.com/antvis/g/issues/938\n                var createImage = this.context.config.createImage;\n                var image_1;\n                if (createImage) {\n                    image_1 = createImage(src);\n                }\n                else if (isBrowser) {\n                    image_1 = new window.Image();\n                }\n                if (image_1) {\n                    image_1.onload = function () {\n                        var onSuccess = function (bitmap) {\n                            _this.textureCache[id].setImageData([bitmap]);\n                            _this.textureCache[id].emit(TextureEvent.LOADED);\n                            _this.context.renderingService.dirtify();\n                            if (successCallback) {\n                                successCallback(_this.textureCache[id], bitmap);\n                            }\n                        };\n                        if (_this.runtime.globalThis.createImageBitmap) {\n                            _this.runtime.globalThis\n                                .createImageBitmap(image_1)\n                                .then(function (bitmap) { return onSuccess(bitmap); })\n                                .catch(function () {\n                                // Unhandled Rejection (InvalidStateError):\n                                // Failed to execute 'createImageBitmap' on 'Window':\n                                // The image element contains an SVG image without intrinsic dimensions,\n                                // and no resize options or crop region are specified.\n                                onSuccess(image_1);\n                            });\n                        }\n                        else {\n                            onSuccess(image_1);\n                        }\n                    };\n                    image_1.onerror = function () { };\n                    image_1.crossOrigin = 'Anonymous';\n                    image_1.src = src;\n                }\n            }\n        }\n        else {\n            texture = this.textureCache[id];\n            texture.emit(TextureEvent.LOADED);\n        }\n        return texture;\n    };\n    TexturePool.prototype.getOrCreateCanvas = function () {\n        return this.runtime.offscreenCanvasCreator.getOrCreateCanvas(this.context.config.offscreenCanvas);\n    };\n    TexturePool.prototype.getOrCreateGradient = function (params) {\n        var instance = params.instance, gradients = params.gradients;\n        var halfExtents = instance.getGeometryBounds().halfExtents;\n        var width = halfExtents[0] * 2 || 1;\n        var height = halfExtents[1] * 2 || 1;\n        var offscreenCanvas = this.context.config.offscreenCanvas;\n        var canvas = this.runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n        var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas);\n        canvas.width = width;\n        canvas.height = height;\n        // @ts-ignore\n        var imagePool = this.context.imagePool;\n        gradients.forEach(function (g) {\n            var gradient = imagePool.getOrCreateGradient(__assign(__assign({ type: g.type }, g.value), { width: width, height: height, min: [0, 0] }), context);\n            // used as canvas' ID\n            // @ts-ignore\n            // canvas.src = key;\n            context.fillStyle = gradient;\n            context.fillRect(0, 0, width, height);\n        });\n    };\n    TexturePool.prototype.getOrCreatePattern = function (pattern, instance, callback) {\n        var image = pattern.image, repetition = pattern.repetition, transform = pattern.transform;\n        var halfExtents = instance.getGeometryBounds().halfExtents;\n        var width = halfExtents[0] * 2 || 1;\n        var height = halfExtents[1] * 2 || 1;\n        var offscreenCanvas = this.context.config.offscreenCanvas;\n        var canvas = this.runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n        var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas);\n        canvas.width = width;\n        canvas.height = height;\n        var src;\n        // Image URL\n        if (isString(image)) {\n            // @ts-ignore\n            src = this.context.imagePool.getImageSync(image, callback);\n        }\n        else {\n            src = image;\n        }\n        var canvasPattern = src && context.createPattern(src, repetition);\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasPattern/setTransform\n        if (transform) {\n            var mat = parsedTransformToMat4(parseTransform(transform), new DisplayObject({}));\n            canvasPattern.setTransform({\n                a: mat[0],\n                b: mat[1],\n                c: mat[4],\n                d: mat[5],\n                e: mat[12],\n                f: mat[13],\n            });\n        }\n        context.fillStyle = canvasPattern;\n        context.fillRect(0, 0, width, height);\n    };\n    TexturePool.prototype.destroy = function () {\n        for (var key in this.textureCache) {\n            this.textureCache[key].destroy();\n        }\n        this.textureCache = {};\n    };\n    return TexturePool;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.options = options;\n        _this.name = 'device-renderer';\n        _this.parameters = {\n            /**\n             * ToneMapping is a renderer-level parameter, it will affect all materials.\n             * @see https://threejs.org/docs/#api/en/renderers/WebGLRenderer.toneMapping\n             */\n            toneMapping: ToneMapping.NONE,\n            toneMappingExposure: 1,\n        };\n        return _this;\n    }\n    Plugin.prototype.init = function (runtime) {\n        var _a;\n        runtime.geometryUpdaterFactory[Shape.MESH] = new MeshUpdater();\n        var renderHelper = new RenderHelper(this.parameters);\n        var lightPool = new LightPool();\n        var texturePool = new TexturePool(this.context, runtime);\n        var pickingIdGenerator = new PickingIdGenerator();\n        var circleRenderer = new CircleRenderer();\n        var pathRenderer = new PathRenderer();\n        var rendererFactory = (_a = {},\n            _a[Shape.CIRCLE] = circleRenderer,\n            _a[Shape.ELLIPSE] = circleRenderer,\n            _a[Shape.POLYLINE] = pathRenderer,\n            _a[Shape.PATH] = pathRenderer,\n            _a[Shape.POLYGON] = pathRenderer,\n            _a[Shape.RECT] = new RectRenderer(),\n            _a[Shape.IMAGE] = new ImageRenderer(),\n            _a[Shape.LINE] = new LineRenderer(),\n            _a[Shape.TEXT] = new TextRenderer(),\n            _a[Shape.MESH] = new MeshRenderer(),\n            _a[Shape.GROUP] = undefined,\n            _a[Shape.HTML] = undefined,\n            _a);\n        var batchManager = new BatchManager(renderHelper, rendererFactory, texturePool, lightPool);\n        var renderGraphPlugin = new RenderGraphPlugin(renderHelper, lightPool, texturePool, batchManager, this.options);\n        this.addRenderingPlugin(renderGraphPlugin);\n        this.addRenderingPlugin(new PickingPlugin(renderHelper, renderGraphPlugin, pickingIdGenerator, batchManager));\n    };\n    Plugin.prototype.destroy = function (runtime) {\n        delete runtime.geometryUpdaterFactory[Shape.MESH];\n    };\n    Plugin.prototype.getRenderGraphPlugin = function () {\n        return this.plugins[0];\n    };\n    Plugin.prototype.getDevice = function () {\n        return this.getRenderGraphPlugin().getDevice();\n    };\n    Plugin.prototype.getSwapChain = function () {\n        return this.getRenderGraphPlugin().getSwapChain();\n    };\n    Plugin.prototype.loadTexture = function (src, descriptor, successCallback) {\n        return this.getRenderGraphPlugin().loadTexture(src, descriptor, successCallback);\n    };\n    Plugin.prototype.toDataURL = function (options) {\n        return this.getRenderGraphPlugin().toDataURL(options);\n    };\n    Plugin.prototype.setParameters = function (parameters) {\n        this.parameters = __assign(__assign({}, this.parameters), parameters);\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { AntialiasingMode, Batch, BufferGeometry, DeviceProgram, DynamicUniformBuffer, FILL_TEXTURE_MAPPING, Fog, FogType, GeometryEvent, HashMap, ImageDrawcall, Instanced, InstancedFillDrawcall, InstancedLineDrawcall, InstancedPathDrawcall, JOINT_TYPE, Light, Material, MaterialEvent, Mesh, MeshDrawcall, Plugin, RGAttachmentSlot, RenderCache, RenderGraphPlugin, RenderHelper, RenderInst, RenderInstExecutionOrder, RenderInstFlags, RenderInstList, RenderInstManager, Renderable3D, RendererLayer, SDFDrawcall, ShaderMaterial, SingleSampledTexture, TemporalTexture, TextDrawcall, TextUniform, TextureMapping, TexturePool, TinySDF, ToneMapping, VertexAttributeBufferIndex, VertexAttributeLocation, bezierCurveTo, compareDefines, definedProps, enumToObject, fillColor, fillMatrix4x4, fillVec3v, fillVec4, fillVec4v, getSortKeyDepth, getSortKeyLayer, hashCodeNumberFinish, hashCodeNumberUpdate, makeAttachmentClearDescriptor, makeBackbufferDescSimple, makeDataBuffer, makeDepthKey, makeSortKey, makeSortKeyOpaque, makeSortKeyTranslucent, nullHashFunc, opaqueBlackFullClearRenderPassDescriptor, opaqueWhiteFullClearRenderPassDescriptor, projectionMatrixConvertClipSpaceNearZ, pushFXAAPass, quadCurveTo, renderInstCompareNone, renderInstCompareSortKey, segmentInstanceGeometry, setBackbufferDescSimple, setSortKeyBias, setSortKeyDepth, setSortKeyDepthKey, setSortKeyLayer, setSortKeyOpaqueDepth, setSortKeyProgramKey, setSortKeyTranslucentDepth, standardFullClearRenderPassDescriptor, updateBuffer };\n//# sourceMappingURL=index.esm.js.map\n","import { __extends, __spreadArray, __read } from 'tslib';\nimport { AbstractRendererPlugin } from '@antv/g-lite';\n\n// const MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n/**\n * listen to mouse/touch/pointer events on DOM wrapper, trigger pointer events\n */\nvar DOMInteractionPlugin = /** @class */ (function () {\n    function DOMInteractionPlugin() {\n    }\n    DOMInteractionPlugin.prototype.apply = function (context, runtime) {\n        var _this = this;\n        var renderingService = context.renderingService, renderingContext = context.renderingContext, config = context.config;\n        this.context = context;\n        var canvas = renderingContext.root.ownerDocument.defaultView;\n        // const SUPPORT_ONLY_TOUCH = canvas.supportsTouchEvents && MOBILE_REGEX.test(navigator.userAgent);\n        var onPointerMove = function (ev) {\n            renderingService.hooks.pointerMove.call(ev);\n        };\n        var onPointerUp = function (ev) {\n            renderingService.hooks.pointerUp.call(ev);\n        };\n        var onPointerDown = function (ev) {\n            renderingService.hooks.pointerDown.call(ev);\n        };\n        var onPointerOver = function (ev) {\n            renderingService.hooks.pointerOver.call(ev);\n        };\n        var onPointerOut = function (ev) {\n            renderingService.hooks.pointerOut.call(ev);\n        };\n        var onPointerCancel = function (ev) {\n            renderingService.hooks.pointerCancel.call(ev);\n        };\n        var onPointerWheel = function (ev) {\n            renderingService.hooks.pointerWheel.call(ev);\n        };\n        var onClick = function (ev) {\n            renderingService.hooks.click.call(ev);\n        };\n        var addPointerEventListener = function ($el) {\n            runtime.globalThis.document.addEventListener('pointermove', onPointerMove, true);\n            $el.addEventListener('pointerdown', onPointerDown, true);\n            $el.addEventListener('pointerleave', onPointerOut, true);\n            $el.addEventListener('pointerover', onPointerOver, true);\n            runtime.globalThis.addEventListener('pointerup', onPointerUp, true);\n            runtime.globalThis.addEventListener('pointercancel', onPointerCancel, true);\n        };\n        var addTouchEventListener = function ($el) {\n            $el.addEventListener('touchstart', onPointerDown, true);\n            $el.addEventListener('touchend', onPointerUp, true);\n            $el.addEventListener('touchmove', onPointerMove, true);\n            $el.addEventListener('touchcancel', onPointerCancel, true);\n        };\n        var addMouseEventListener = function ($el) {\n            runtime.globalThis.document.addEventListener('mousemove', onPointerMove, true);\n            $el.addEventListener('mousedown', onPointerDown, true);\n            $el.addEventListener('mouseout', onPointerOut, true);\n            $el.addEventListener('mouseover', onPointerOver, true);\n            runtime.globalThis.addEventListener('mouseup', onPointerUp, true);\n        };\n        var removePointerEventListener = function ($el) {\n            runtime.globalThis.document.removeEventListener('pointermove', onPointerMove, true);\n            $el.removeEventListener('pointerdown', onPointerDown, true);\n            $el.removeEventListener('pointerleave', onPointerOut, true);\n            $el.removeEventListener('pointerover', onPointerOver, true);\n            runtime.globalThis.removeEventListener('pointerup', onPointerUp, true);\n        };\n        var removeTouchEventListener = function ($el) {\n            $el.removeEventListener('touchstart', onPointerDown, true);\n            $el.removeEventListener('touchend', onPointerUp, true);\n            $el.removeEventListener('touchmove', onPointerMove, true);\n            $el.removeEventListener('touchcancel', onPointerCancel, true);\n        };\n        var removeMouseEventListener = function ($el) {\n            runtime.globalThis.document.removeEventListener('mousemove', onPointerMove, true);\n            $el.removeEventListener('mousedown', onPointerDown, true);\n            $el.removeEventListener('mouseout', onPointerOut, true);\n            $el.removeEventListener('mouseover', onPointerOver, true);\n            runtime.globalThis.removeEventListener('mouseup', onPointerUp, true);\n        };\n        renderingService.hooks.init.tap(DOMInteractionPlugin.tag, function () {\n            var $el = _this.context.contextService.getDomElement();\n            // @ts-ignore\n            if (runtime.globalThis.navigator.msPointerEnabled) {\n                // @ts-ignore\n                $el.style.msContentZooming = 'none';\n                // @ts-ignore\n                $el.style.msTouchAction = 'none';\n            }\n            else if (canvas.supportsPointerEvents) {\n                $el.style.touchAction = 'none';\n            }\n            if (canvas.supportsPointerEvents) {\n                addPointerEventListener($el);\n            }\n            else {\n                addMouseEventListener($el);\n            }\n            if (canvas.supportsTouchEvents) {\n                addTouchEventListener($el);\n            }\n            if (config.useNativeClickEvent) {\n                $el.addEventListener('click', onClick, true);\n            }\n            // use passive event listeners\n            // @see https://zhuanlan.zhihu.com/p/24555031\n            $el.addEventListener('wheel', onPointerWheel, {\n                passive: true,\n                capture: true,\n            });\n        });\n        renderingService.hooks.destroy.tap(DOMInteractionPlugin.tag, function () {\n            var $el = _this.context.contextService.getDomElement();\n            // @ts-ignore\n            if (runtime.globalThis.navigator.msPointerEnabled) {\n                // @ts-ignore\n                $el.style.msContentZooming = '';\n                // @ts-ignore\n                $el.style.msTouchAction = '';\n            }\n            else if (canvas.supportsPointerEvents) {\n                $el.style.touchAction = '';\n            }\n            if (canvas.supportsPointerEvents) {\n                removePointerEventListener($el);\n            }\n            else {\n                removeMouseEventListener($el);\n            }\n            if (canvas.supportsTouchEvents) {\n                removeTouchEventListener($el);\n            }\n            if (config.useNativeClickEvent) {\n                $el.removeEventListener('click', onClick, true);\n            }\n            $el.removeEventListener('wheel', onPointerWheel, true);\n        });\n    };\n    DOMInteractionPlugin.tag = 'DOMInteraction';\n    return DOMInteractionPlugin;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.name = 'dom-interaction';\n        return _this;\n    }\n    Plugin.prototype.init = function () {\n        this.addRenderingPlugin(new DOMInteractionPlugin());\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","import { __extends, __spreadArray, __read } from 'tslib';\nimport { CanvasEvent, ElementEvent, RenderReason, isCSSRGB, isPattern, Shape, AbstractRendererPlugin } from '@antv/g-lite';\nimport { isNil, isNumber, isString } from '@antv/util';\n\nvar CANVAS_CAMERA_ID = 'g-canvas-camera';\nvar HTMLRenderingPlugin = /** @class */ (function () {\n    function HTMLRenderingPlugin() {\n        this.displayObjectHTMLElementMap = new WeakMap();\n    }\n    HTMLRenderingPlugin.prototype.joinTransformMatrix = function (matrix) {\n        return \"matrix(\".concat([\n            matrix[0],\n            matrix[1],\n            matrix[4],\n            matrix[5],\n            matrix[12],\n            matrix[13],\n        ].join(','), \")\");\n    };\n    HTMLRenderingPlugin.prototype.apply = function (context, runtime) {\n        var _this = this;\n        var camera = context.camera, renderingContext = context.renderingContext, renderingService = context.renderingService;\n        this.context = context;\n        var canvas = renderingContext.root.ownerDocument.defaultView;\n        var nativeHTMLMap = canvas.context.eventService.nativeHTMLMap;\n        var setTransform = function (object, $el) {\n            $el.style.transform = _this.joinTransformMatrix(object.getWorldTransform());\n        };\n        var handleMounted = function (e) {\n            var object = e.target;\n            if (object.nodeName === Shape.HTML) {\n                if (!_this.$camera) {\n                    _this.$camera = _this.createCamera(camera);\n                }\n                // create DOM element\n                var $el_1 = _this.getOrCreateEl(object);\n                _this.$camera.appendChild($el_1);\n                // apply documentElement's style\n                if (runtime.enableCSSParsing) {\n                    var attributes_1 = object.ownerDocument.documentElement.attributes;\n                    Object.keys(attributes_1).forEach(function (name) {\n                        $el_1.style[name] = attributes_1[name];\n                    });\n                }\n                Object.keys(object.attributes).forEach(function (name) {\n                    _this.updateAttribute(name, object);\n                });\n                setTransform(object, $el_1);\n                nativeHTMLMap.set($el_1, object);\n            }\n        };\n        var handleUnmounted = function (e) {\n            var object = e.target;\n            if (object.nodeName === Shape.HTML && _this.$camera) {\n                var $el = _this.getOrCreateEl(object);\n                if ($el) {\n                    $el.remove();\n                    nativeHTMLMap.delete($el);\n                }\n            }\n        };\n        var handleAttributeChanged = function (e) {\n            var object = e.target;\n            if (object.nodeName === Shape.HTML) {\n                var attrName = e.attrName;\n                _this.updateAttribute(attrName, object);\n            }\n        };\n        var handleBoundsChanged = function (e) {\n            var object = e.target;\n            if (object.nodeName === Shape.HTML) {\n                var $el = _this.getOrCreateEl(object);\n                setTransform(object, $el);\n            }\n        };\n        var handleCanvasResize = function () {\n            if (_this.$camera) {\n                var _a = _this.context.config, width = _a.width, height = _a.height;\n                _this.$camera.style.width = \"\".concat(width || 0, \"px\");\n                _this.$camera.style.height = \"\".concat(height || 0, \"px\");\n            }\n        };\n        renderingService.hooks.init.tap(HTMLRenderingPlugin.tag, function () {\n            canvas.addEventListener(CanvasEvent.RESIZE, handleCanvasResize);\n            canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n            canvas.addEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n        });\n        renderingService.hooks.endFrame.tap(HTMLRenderingPlugin.tag, function () {\n            if (_this.$camera &&\n                renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED)) {\n                _this.$camera.style.transform = _this.joinTransformMatrix(camera.getOrthoMatrix());\n            }\n        });\n        renderingService.hooks.destroy.tap(HTMLRenderingPlugin.tag, function () {\n            // remove camera\n            if (_this.$camera) {\n                _this.$camera.remove();\n            }\n            canvas.removeEventListener(CanvasEvent.RESIZE, handleCanvasResize);\n            canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n            canvas.removeEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n        });\n    };\n    HTMLRenderingPlugin.prototype.createCamera = function (camera) {\n        var _a = this.context.config, doc = _a.document, width = _a.width, height = _a.height;\n        var $canvas = this.context.contextService.getDomElement();\n        var $container = $canvas.parentNode;\n        if ($container) {\n            var cameraId = CANVAS_CAMERA_ID;\n            var $existedCamera = $container.querySelector('#' + cameraId);\n            if (!$existedCamera) {\n                var $camera = (doc || document).createElement('div');\n                $existedCamera = $camera;\n                $camera.id = cameraId;\n                // use absolute position\n                $camera.style.position = 'absolute';\n                // account for DOM element's offset @see https://github.com/antvis/G/issues/1150\n                $camera.style.left = \"\".concat($canvas.offsetLeft || 0, \"px\");\n                $camera.style.top = \"\".concat($canvas.offsetTop || 0, \"px\");\n                $camera.style.transformOrigin = 'left top';\n                $camera.style.transform = this.joinTransformMatrix(camera.getOrthoMatrix());\n                // HTML elements should not overflow with canvas @see https://github.com/antvis/G/issues/1163\n                $camera.style.overflow = 'hidden';\n                $camera.style.pointerEvents = 'none';\n                $camera.style.width = \"\".concat(width || 0, \"px\");\n                $camera.style.height = \"\".concat(height || 0, \"px\");\n                $container.appendChild($camera);\n            }\n            return $existedCamera;\n        }\n        return null;\n    };\n    HTMLRenderingPlugin.prototype.getOrCreateEl = function (object) {\n        var doc = this.context.config.document;\n        var $existedElement = this.displayObjectHTMLElementMap.get(object);\n        if (!$existedElement) {\n            $existedElement = (doc || document).createElement('div');\n            object.parsedStyle.$el = $existedElement;\n            this.displayObjectHTMLElementMap.set(object, $existedElement);\n            if (object.id) {\n                $existedElement.id = object.id;\n            }\n            if (object.name) {\n                $existedElement.setAttribute('name', object.name);\n            }\n            if (object.className) {\n                $existedElement.className = object.className;\n            }\n            // use absolute position\n            $existedElement.style.position = 'absolute';\n            // @see https://github.com/antvis/G/issues/1150\n            $existedElement.style['will-change'] = 'transform';\n            $existedElement.style.transform = this.joinTransformMatrix(object.getWorldTransform());\n        }\n        return $existedElement;\n    };\n    HTMLRenderingPlugin.prototype.updateAttribute = function (name, object) {\n        var $el = this.getOrCreateEl(object);\n        switch (name) {\n            case 'innerHTML':\n                var innerHTML = object.parsedStyle.innerHTML;\n                if (isString(innerHTML)) {\n                    $el.innerHTML = innerHTML;\n                }\n                else {\n                    $el.innerHTML = '';\n                    $el.appendChild(innerHTML);\n                }\n                break;\n            case 'x':\n                $el.style.left = \"\".concat(object.parsedStyle.x, \"px\");\n                break;\n            case 'y':\n                $el.style.top = \"\".concat(object.parsedStyle.y, \"px\");\n                break;\n            case 'transformOrigin':\n                var transformOrigin = object.parsedStyle.transformOrigin;\n                $el.style['transform-origin'] = \"\".concat(transformOrigin[0].value, \" \").concat(transformOrigin[1].value);\n                break;\n            case 'width':\n                if (this.context.enableCSSParsing) {\n                    var width = object.computedStyleMap().get('width');\n                    $el.style.width = width.toString();\n                }\n                else {\n                    var width = object.parsedStyle.width;\n                    $el.style.width = isNumber(width)\n                        ? \"\".concat(width, \"px\")\n                        : width.toString();\n                }\n                break;\n            case 'height':\n                if (this.context.enableCSSParsing) {\n                    var height = object.computedStyleMap().get('height');\n                    $el.style.height = height.toString();\n                }\n                else {\n                    var height = object.parsedStyle.height;\n                    $el.style.height = isNumber(height)\n                        ? \"\".concat(height, \"px\")\n                        : height.toString();\n                }\n                break;\n            case 'zIndex':\n                var zIndex = object.parsedStyle.zIndex;\n                $el.style['z-index'] = \"\".concat(zIndex);\n                break;\n            case 'visibility':\n                var visibility = object.parsedStyle.visibility;\n                $el.style.visibility = visibility;\n                break;\n            case 'pointerEvents':\n                var _a = object.parsedStyle.pointerEvents, pointerEvents = _a === void 0 ? 'auto' : _a;\n                $el.style.pointerEvents = pointerEvents;\n                break;\n            case 'opacity':\n                var opacity = object.parsedStyle.opacity;\n                $el.style.opacity = \"\".concat(opacity);\n                break;\n            case 'fill':\n                var fill = object.parsedStyle.fill;\n                var color = '';\n                if (isCSSRGB(fill)) {\n                    if (fill.isNone) {\n                        color = 'transparent';\n                    }\n                    else {\n                        color = object.getAttribute('fill');\n                    }\n                }\n                else if (Array.isArray(fill)) {\n                    color = object.getAttribute('fill');\n                }\n                else if (isPattern(fill)) ;\n                $el.style.background = color;\n                break;\n            case 'stroke':\n                var stroke = object.parsedStyle.stroke;\n                var borderColor = '';\n                if (isCSSRGB(stroke)) {\n                    if (stroke.isNone) {\n                        borderColor = 'transparent';\n                    }\n                    else {\n                        borderColor = object.getAttribute('stroke');\n                    }\n                }\n                else if (Array.isArray(stroke)) {\n                    borderColor = object.getAttribute('stroke');\n                }\n                else if (isPattern(stroke)) ;\n                $el.style['border-color'] = borderColor;\n                $el.style['border-style'] = 'solid';\n                break;\n            case 'lineWidth':\n                var lineWidth = object.parsedStyle.lineWidth;\n                $el.style['border-width'] = \"\".concat(lineWidth || 0, \"px\");\n                break;\n            case 'lineDash':\n                $el.style['border-style'] = 'dashed';\n                break;\n            case 'filter':\n                var filter = object.style.filter;\n                $el.style.filter = filter;\n                break;\n            default:\n                if (!isNil(object.style[name]) && object.style[name] !== '') {\n                    $el.style[name] = object.style[name];\n                }\n        }\n    };\n    HTMLRenderingPlugin.tag = 'HTMLRendering';\n    return HTMLRenderingPlugin;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.name = 'html-renderer';\n        return _this;\n    }\n    Plugin.prototype.init = function () {\n        this.addRenderingPlugin(new HTMLRenderingPlugin());\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","import { __extends, __spreadArray, __read } from 'tslib';\nimport { isBrowser, parsedTransformToMat4, parseTransform, DisplayObject, GradientType, computeLinearGradient, computeRadialGradient, UnitType, ElementEvent, Shape, AbstractRendererPlugin } from '@antv/g-lite';\nimport { isString } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\n\nvar ImagePool = /** @class */ (function () {\n    function ImagePool(canvasConfig) {\n        this.canvasConfig = canvasConfig;\n        this.imageCache = {};\n        this.gradientCache = {};\n        this.patternCache = {};\n    }\n    ImagePool.prototype.getImageSync = function (src, callback) {\n        if (!this.imageCache[src]) {\n            this.getOrCreateImage(src).then(function (img) {\n                if (callback) {\n                    callback(img);\n                }\n            });\n        }\n        else {\n            if (callback) {\n                callback(this.imageCache[src]);\n            }\n        }\n        return this.imageCache[src];\n    };\n    ImagePool.prototype.getOrCreateImage = function (src) {\n        var _this = this;\n        if (this.imageCache[src]) {\n            return Promise.resolve(this.imageCache[src]);\n        }\n        // @see https://github.com/antvis/g/issues/938\n        var createImage = this.canvasConfig.createImage;\n        return new Promise(function (resolve, reject) {\n            var image;\n            if (createImage) {\n                image = createImage(src);\n            }\n            else if (isBrowser) {\n                image = new window.Image();\n            }\n            if (image) {\n                image.onload = function () {\n                    _this.imageCache[src] = image;\n                    resolve(image);\n                };\n                image.onerror = function (ev) {\n                    reject(ev);\n                };\n                image.crossOrigin = 'Anonymous';\n                image.src = src;\n            }\n        });\n    };\n    ImagePool.prototype.getOrCreatePatternSync = function (pattern, context, $offscreenCanvas, dpr, min, callback) {\n        var patternKey = this.generatePatternKey(pattern);\n        if (patternKey && this.patternCache[patternKey]) {\n            return this.patternCache[patternKey];\n        }\n        var image = pattern.image, repetition = pattern.repetition, transform = pattern.transform;\n        var src;\n        var needScaleWithDPR = false;\n        // Image URL\n        if (isString(image)) {\n            src = this.getImageSync(image, callback);\n        }\n        else if ($offscreenCanvas) {\n            src = $offscreenCanvas;\n            needScaleWithDPR = true;\n        }\n        else {\n            src = image;\n        }\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createPattern\n        var canvasPattern = src && context.createPattern(src, repetition);\n        if (canvasPattern) {\n            var mat = void 0;\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasPattern/setTransform\n            if (transform) {\n                mat = parsedTransformToMat4(parseTransform(transform), new DisplayObject({}));\n            }\n            else {\n                mat = mat4.identity(mat4.create());\n            }\n            if (needScaleWithDPR) {\n                mat4.scale(mat, mat, [1 / dpr, 1 / dpr, 1]);\n            }\n            canvasPattern.setTransform({\n                a: mat[0],\n                b: mat[1],\n                c: mat[4],\n                d: mat[5],\n                e: mat[12] + min[0],\n                f: mat[13] + min[1],\n            });\n        }\n        if (patternKey && canvasPattern) {\n            this.patternCache[patternKey] = canvasPattern;\n        }\n        return canvasPattern;\n    };\n    ImagePool.prototype.getOrCreateGradient = function (params, context) {\n        var key = this.generateGradientKey(params);\n        var type = params.type, steps = params.steps, min = params.min, width = params.width, height = params.height, angle = params.angle, cx = params.cx, cy = params.cy, size = params.size;\n        if (this.gradientCache[key]) {\n            return this.gradientCache[key];\n        }\n        var gradient = null;\n        if (type === GradientType.LinearGradient) {\n            var _a = computeLinearGradient(min, width, height, angle), x1 = _a.x1, y1 = _a.y1, x2 = _a.x2, y2 = _a.y2;\n            // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\n            gradient = context.createLinearGradient(x1, y1, x2, y2);\n        }\n        else if (type === GradientType.RadialGradient) {\n            var _b = computeRadialGradient(min, width, height, cx, cy, size), x = _b.x, y = _b.y, r = _b.r;\n            // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\n            gradient = context.createRadialGradient(x, y, 0, x, y, r);\n        }\n        if (gradient) {\n            steps.forEach(function (_a) {\n                var offset = _a.offset, color = _a.color;\n                if (offset.unit === UnitType.kPercentage) {\n                    gradient === null || gradient === void 0 ? void 0 : gradient.addColorStop(offset.value / 100, color.toString());\n                }\n            });\n            this.gradientCache[key] = gradient;\n        }\n        return this.gradientCache[key];\n    };\n    ImagePool.prototype.generateGradientKey = function (params) {\n        var type = params.type, min = params.min, width = params.width, height = params.height, steps = params.steps, angle = params.angle, cx = params.cx, cy = params.cy, size = params.size;\n        return \"gradient-\".concat(type, \"-\").concat((angle === null || angle === void 0 ? void 0 : angle.toString()) || 0, \"-\").concat((cx === null || cx === void 0 ? void 0 : cx.toString()) || 0, \"-\").concat((cy === null || cy === void 0 ? void 0 : cy.toString()) || 0, \"-\").concat((size === null || size === void 0 ? void 0 : size.toString()) || 0, \"-\").concat(min[0], \"-\").concat(min[1], \"-\").concat(width, \"-\").concat(height, \"-\").concat(steps\n            .map(function (_a) {\n            var offset = _a.offset, color = _a.color;\n            return \"\".concat(offset).concat(color);\n        })\n            .join('-'));\n    };\n    ImagePool.prototype.generatePatternKey = function (pattern) {\n        var image = pattern.image, repetition = pattern.repetition;\n        // only generate cache for Image\n        if (isString(image)) {\n            return \"pattern-\".concat(image, \"-\").concat(repetition);\n        }\n        else if (image.nodeName === 'rect') {\n            return \"pattern-\".concat(image.entity, \"-\").concat(repetition);\n        }\n    };\n    return ImagePool;\n}());\n\nvar LoadImagePlugin = /** @class */ (function () {\n    function LoadImagePlugin() {\n    }\n    LoadImagePlugin.prototype.apply = function (context) {\n        var renderingService = context.renderingService, renderingContext = context.renderingContext, imagePool = context.imagePool;\n        var canvas = renderingContext.root.ownerDocument.defaultView;\n        var calculateWithAspectRatio = function (object, imageWidth, imageHeight) {\n            var _a = object.parsedStyle, width = _a.width, height = _a.height;\n            if (width && !height) {\n                object.setAttribute('height', (imageHeight / imageWidth) * width);\n            }\n            else if (!width && height) {\n                object.setAttribute('width', (imageWidth / imageHeight) * height);\n            }\n        };\n        var handleMounted = function (e) {\n            var object = e.target;\n            var nodeName = object.nodeName, attributes = object.attributes;\n            if (nodeName === Shape.IMAGE) {\n                var src = attributes.src, keepAspectRatio_1 = attributes.keepAspectRatio;\n                if (isString(src)) {\n                    imagePool.getImageSync(src, function (_a) {\n                        var width = _a.width, height = _a.height;\n                        if (keepAspectRatio_1) {\n                            calculateWithAspectRatio(object, width, height);\n                        }\n                        // set dirty rectangle flag\n                        object.renderable.dirty = true;\n                        renderingService.dirtify();\n                    });\n                }\n            }\n        };\n        var handleAttributeChanged = function (e) {\n            var object = e.target;\n            var attrName = e.attrName, newValue = e.newValue;\n            if (object.nodeName === Shape.IMAGE) {\n                if (attrName === 'src') {\n                    if (isString(newValue)) {\n                        imagePool.getOrCreateImage(newValue).then(function (_a) {\n                            var width = _a.width, height = _a.height;\n                            if (object.attributes.keepAspectRatio) {\n                                calculateWithAspectRatio(object, width, height);\n                            }\n                            // set dirty rectangle flag\n                            object.renderable.dirty = true;\n                            renderingService.dirtify();\n                        });\n                    }\n                }\n            }\n        };\n        renderingService.hooks.init.tap(LoadImagePlugin.tag, function () {\n            canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        });\n        renderingService.hooks.destroy.tap(LoadImagePlugin.tag, function () {\n            canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n        });\n    };\n    LoadImagePlugin.tag = 'LoadImage';\n    return LoadImagePlugin;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.name = 'image-loader';\n        return _this;\n    }\n    Plugin.prototype.init = function () {\n        // @ts-ignore\n        this.context.imagePool = new ImagePool(this.context.config);\n        this.addRenderingPlugin(new LoadImagePlugin());\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { ImagePool, Plugin };\n//# sourceMappingURL=index.esm.js.map\n",null,null,null,null,null,null],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","pop","push","__values","o","m","__read","r","ar","error","__spreadArray","to","from","pack","l","slice","concat","isNil$1","toString","isType$1","type","isString","str","isType","clamp$1","a","min","max","isNumber$1","EPSILON","ARRAY_TYPE","Float32Array","out","glMatrix.ARRAY_TYPE","copy","fromValues","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","identity","invert","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","multiply","b0","b1","b2","b3","scale","x","z","fromTranslation","fromRotationTranslation","q","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","getScaling","mat","Math","hypot","perspectiveNO","fovy","aspect","near","far","nf","tan","Infinity","orthoNO","left","right","bottom","top","lr","bt","subtract","sqrt","mul","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a14","a15","b4","b5","b6","b7","b8","b9","b12","b13","b14","b15","abs","glMatrix.EPSILON","yx","zx","zy","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","rad","axis","c","len","sin","cos","sx","sy","sz","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","rl","tb","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","fov","upTan","upDegrees","PI","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","b20","b21","b22","target","rotateVector","arcToCubic","X1","Y1","RX","RY","angle","LAF","SF","X2","Y2","recursive","f1","f2","cx","cy","rx","ry","d120","res","h","rx2","ry2","k","asin","df","f2old","x2old","y2old","c1","s1","c2","s2","hx","hy","m1","m2","m3","m4","newres","ii","has","prefix","Events","EE","fn","context","once","addListener","emitter","event","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","eventNames","events","name","names","listeners","handlers","ee","listenerCount","emit","args","removeListener","undefined","j","on","removeAllListeners","off","prefixed","module","exports","GL","ResourceType","CompareFunction","FrontFace","CullMode","BlendFactor","BlendMode","AddressMode","FilterMode","MipmapFilterMode","PrimitiveTopology","BufferUsage","BufferFrequencyHint","VertexStepMode","TextureEvent","TextureDimension","TextureUsage","ChannelWriteMask","StencilOp","SamplerFormatKind","ViewportOrigin","ClipSpaceNearZ","QueryPoolType","FormatTypeFlags","FormatCompFlags","FormatFlags","Format","makeTextureDescriptor2D","format","width","height","mipLevelCount","dimension","TEXTURE_2D","depthOrArrayLayers","usage","SAMPLED","makeFormat","comp","flags","getFormatCompFlags","fmt","getFormatTypeFlags","getFormatFlags","getFormatTypeFlagsByteSize","typeFlags","F32","U32","S32","U16","S16","F16","U8","S8","Error","getFormatCompByteSize","getFormatSamplerKind","Depth","Normalized","Float","Uint","Sint","assert","message","assertExists","colorEqual","c0","colorCopy","dst","src","colorNewCopy","colorNewFromRGBA","A","None","Luminance","R","RG","RGB","RGBA","sRGB","U16_PACKED_5551","U16_PACKED_565","BC1","BC2","BC3","BC4_UNORM","BC4_SNORM","BC5_UNORM","BC5_SNORM","D24","D24S8","Stencil","D32F","D32FS8","RenderTarget","TransparentBlack","OpaqueBlack","TransparentWhite","OpaqueWhite","isPowerOfTwo","fallbackUndefined","fallback","nullify","fillArray","L","fill","align","multiple","mask","alignNonPowerOfTwo","setBitFlagEnabled","enabled","nArray","copyChannelBlendState","blendDstFactor","blendSrcFactor","blendMode","copyStencilFaceState","compare","depthFailOp","passOp","failOp","copyAttachmentState","rgbBlendState","alphaBlendState","channelWriteMask","copyAttachmentsState","setMegaStateFlags","attachmentsState","blendConstant","depthCompare","depthWrite","stencilWrite","stencilFront","stencilBack","cullMode","frontFace","polygonOffset","copyMegaState","defaultBlendState","ADD","ONE","ZERO","defaultMegaState","ALL","LEQUAL","ALWAYS","KEEP","NONE","CCW","fullscreenMegaState","other","makeMegaState","setAttachmentStateSimple","simple","rgbBlendMode","alphaBlendMode","rgbBlendSrcFactor","alphaBlendSrcFactor","rgbBlendDstFactor","alphaBlendDstFactor","copyAttachmentStateFromSimple","_a","defaultBindingLayoutSamplerDescriptor","texture","sampler","formatKind","arrayEqual","arrayCopy","copyFunc","textureBindingEquals","binding","bufferBindingEquals","buffer","size","offset","samplerBindingEquals","comparison","bindingsDescriptorEquals","samplerBindings","uniformBufferBindings","storageBufferBindings","storageTextureBindings","channelBlendStateEquals","attachmentStateEquals","stencilFaceStateEquals","programEquals","id","formatEquals","renderPipelineDescriptorEquals","topology","inputLayout","sampleCount","megaStateDescriptor","megaStateDescriptorEquals","program","colorAttachmentFormats","depthStencilAttachmentFormat","vertexAttributeDescriptorEquals","shaderLocation","divisor","inputLayoutBufferDescriptorEquals","isNil","arrayStride","stepMode","attributes","inputLayoutDescriptorEquals","indexBufferFormat","vertexBufferDescriptors","samplerDescriptorEquals","addressModeU","addressModeV","minFilter","magFilter","mipmapFilter","lodMinClamp","lodMaxClamp","maxAnisotropy","compareFunction","samplerBindingCopy","bufferBindingCopy","textureBindingCopy","vertexAttributeDescriptorCopy","inputLayoutBufferDescriptorCopy","UNIFORM_NAME_REGEXP","parseUniformName","isArray","matches","match","Number","getSamplerSetter","cache","gl","location","update","uniform1i","getArraySetter","functionName","toArray","uniformSetter","cacheLength","arrayValue","set","setVectorUniform","setMatrixUniform","FLOAT_ARRAY","INT_ARRAY","UINT_ARRAY","array1","toTypedArray","uniformLength","Type","isFinite","toFloatArray","toIntArray","Int32Array","toUIntArray","Uint32Array","UNIFORM_SETTERS","FLOAT","bind","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","INT","INT_VEC2","INT_VEC3","INT_VEC4","BOOL","BOOL_VEC2","BOOL_VEC3","BOOL_VEC4","FLOAT_MAT2","FLOAT_MAT3","FLOAT_MAT4","UNSIGNED_INT","UNSIGNED_INT_VEC2","UNSIGNED_INT_VEC3","UNSIGNED_INT_VEC4","FLOAT_MAT2x3","FLOAT_MAT2x4","FLOAT_MAT3x2","FLOAT_MAT3x4","FLOAT_MAT4x2","FLOAT_MAT4x3","SAMPLER_2D","SAMPLER_CUBE","SAMPLER_3D","SAMPLER_2D_SHADOW","SAMPLER_2D_ARRAY","SAMPLER_2D_ARRAY_SHADOW","SAMPLER_CUBE_SHADOW","INT_SAMPLER_2D","INT_SAMPLER_3D","INT_SAMPLER_CUBE","INT_SAMPLER_2D_ARRAY","UNSIGNED_INT_SAMPLER_2D","UNSIGNED_INT_SAMPLER_3D","UNSIGNED_INT_SAMPLER_CUBE","UNSIGNED_INT_SAMPLER_2D_ARRAY","getUniformSetter","info","setter","dtypes","defineStr","parseBinding","layout","exec","bindingNum","parseInt","isNaN","getSeparateSamplerTypes","combinedSamplerType","preprocessShader_GLSL","vendorInfo","source","defines","usePrecision","isGLSL100","glslVersion","useMRT","lines","replace","split","map","filter","test","definesString","keys","key","join","precision","find","line","startsWith","rest","extraDefines","viewportOrigin","UPPER_LEFT","clipSpaceNearZ","explicitBindingLocations","set_1","implicitBinding_1","location_1","substr","cap","separateSamplerTextures","samplerName","textureType","samplerType","trim","tok","implicitBinding_2","samplerNames_1","forEach","_b","RegExp","dataType","uniforms","uniform","trimmed","gBuffers_1","lastIndexOfMain","lastIndexOf","substring","gBuffer","glFragColor_1","ResourceBase_GL","_super","device","_this","trackResourceCreated","destroy","trackResourceDestroyed","Bindings_GL","descriptor","Bindings","bindingLayouts","createBindingLayouts","firstUniformBuffer","firstSampler","bindingLayoutTables","numUniformBuffers","numSamplers","isWebGL2","WebGL2RenderingContext","_version","isTextureFormatCompressed","isFormatSizedInteger","translateBufferUsageToTarget","INDEX","ELEMENT_ARRAY_BUFFER","VERTEX","ARRAY_BUFFER","UNIFORM","UNIFORM_BUFFER","translateVertexFormat$1","compFlags","UNSIGNED_BYTE","UNSIGNED_SHORT","BYTE","SHORT","HALF_FLOAT","translateType","translateSize","normalized","translateAddressMode$1","wrapMode","CLAMP_TO_EDGE","REPEAT","MIRRORED_REPEAT","translateFilterMode","LINEAR","BILINEAR","LINEAR_MIPMAP_LINEAR","POINT","NEAREST_MIPMAP_LINEAR","NEAREST","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_NEAREST","NO_MIP","getPlatformBuffer$1","buffer_","byteOffset","gl_buffer_pages","pageByteSize","getPlatformTexture","texture_","gl_texture","getPlatformSampler$1","sampler_","gl_sampler","assignPlatformName","__SPECTOR_Metadata","findall","haystack","needle","results","isBlendStateNone","blendState","translateTextureDimension$1","TEXTURE_2D_ARRAY","TEXTURE_CUBE_MAP","TEXTURE_3D","isBlockCompressSized","bh","ProgramCompileState_GL","Buffer_GL","Buffer","viewOrSize","hint","STATIC","uniformBufferMaxPageByteSize","isUBO","bindVertexArray","OES_vertex_array_object","bindVertexArrayOES","byteSize","isNumber","byteLength","byteSizeLeft","createBufferPage","gl_target","setSubData","Uint8Array","dstByteOffset","data","srcByteOffset","dstPageByteSize","virtBufferByteOffsetEnd","virtBufferByteOffset","physBufferByteOffset","COPY_WRITE_BUFFER","ubo","bindBuffer","bufferSubData","deleteBuffer","gl_buffer","ensureResourceExists","createBuffer","gl_hint","STATIC_DRAW","DYNAMIC","DYNAMIC_DRAW","translateBufferHint","bufferData","InputLayout_GL","e_1","e_2","_c","_d","InputLayout","U16_R","U32_R","indexBufferType","U8_R","translateIndexFormat$1","indexBufferCompByteSize","vao","createVertexArray","createVertexArrayOES","_e","_f","vertexBufferDescriptor","attributes_1","attributes_1_1","attribute","_g","vertexFormat","vertexAttribPointer","INSTANCE","vertexAttribDivisor","ANGLE_instanced_arrays","vertexAttribDivisorANGLE","enableVertexAttribArray","e_2_1","e_1_1","deleteVertexArray","deleteVertexArrayOES","Texture_GL","fake","Texture","clampmipLevelCount","immutable","RENDER_TARGET","pixelStore","mipmaps","createTexture","gl_type","translateTextureType","internalformat","translateTextureInternalFormat","setActiveTexture","TEXTURE0","preprocessImage","bindTexture","texStorage2D","level","DEPTH_COMPONENT","isNPOT","D24_S8","WEBGL_depth_texture","texImage2D","texParameteri","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","texStorage3D","setImageData","levelDatas","lod","is3D","isCube","isTA","gl_format","translateTextureFormat","gl_internal_format","translateInternalTextureFormat","levelData","TEXTURE_CUBE_MAP_POSITIVE_X","texSubImage2D","texImage3D","generateMipmap","deleteTexture","unpackFlipY","pixelStorei","UNPACK_FLIP_Y_WEBGL","packAlignment","PACK_ALIGNMENT","unpackAlignment","UNPACK_ALIGNMENT","TEXTURE_BASE_LEVEL","TEXTURE_MAX_LEVEL","log2","TEXTURE_MAG_FILTER","RenderTarget_GL","gl_renderbuffer","useRenderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorageMultisample","renderbufferStorage","deleteRenderbuffer","Program_GL","rawVertexGLSL","Program","uniformSetters","gl_program","createProgram","gl_shader_vert","gl_shader_frag","compileState","NeedsCompile","tryCompileProgram","deleteProgram","deleteShader","vertex","fragment","glsl","compileShader","postprocess","VERTEX_SHADER","FRAGMENT_SHADER","attachShader","linkProgram","Compiling","readUniformLocationsFromLinkedProgram","readAttributesFromLinkedProgram","count","getProgramParameter","ACTIVE_ATTRIBUTES","shader","getDefines","locations","vert","getAttributeLocations","_loop_1","index","getActiveAttrib","this_1","name_1","getAttribLocation","definedLocation","numUniforms","ACTIVE_UNIFORMS","getActiveUniform","name_2","location_2","getUniformLocation","contents","createShader","shaderSource","setUniformsLegacy","programUsed","uniformName","useProgram","textureIndex","QueryPool_GL","QueryPool","gl_query","elemCount","createQuery","gl_query_type","OcclusionConservative","ANY_SAMPLES_PASSED_CONSERVATIVE","translateQueryPoolType$1","queryResultOcclusion","dstOffs","getQueryParameter","QUERY_RESULT_AVAILABLE","QUERY_RESULT","deleteQuery","Readback_GL","Readback","gl_pbo","gl_sync","clientWaitAsync","sync","interval_ms","clientWaitSync","WAIT_FAILED","TIMEOUT_EXPIRED","setTimeout","clamp","MAX_CLIENT_WAIT_TIMEOUT_WEBGL","getBufferSubDataAsync","dstBuffer","dstOffset","fenceSync","SYNC_GPU_COMMANDS_COMPLETE","flush","getBufferSubData","readTexture","formatByteSize","PIXEL_PACK_BUFFER","STREAM_READ","bindFramebuffer","READ_FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","readPixels","readTextureSync","FRAMEBUFFER","readBuffer","deleteSync","RenderPipeline_GL","RenderPipeline","drawMode","TRIANGLES","POINTS","TRIANGLE_STRIP","LINES","LINE_STRIP","translatePrimitiveTopology","megaState","ComputePipeline_GL","ComputePipeline","ResourceCreationTracker","liveObjects","Set","creationStacks","Map","deletionStacks","stack","add","console","warn","get","delete","checkForLeaks","values","setResourceLeakCheck","Sampler_GL","Sampler","createSampler","samplerParameteri","TEXTURE_WRAP_R","addressModeW","samplerParameterf","TEXTURE_MIN_LOD","TEXTURE_MAX_LOD","TEXTURE_COMPARE_MODE","COMPARE_REF_TO_TEXTURE","TEXTURE_COMPARE_FUNC","EXT_texture_filter_anisotropic","TEXTURE_MAX_ANISOTROPY_EXT","setTextureParameters","deleteSampler","ComputePass_GL","dispatchWorkgroups","workgroupCountX","workgroupCountY","workgroupCountZ","dispatchWorkgroupsIndirect","indirectBuffer","indirectOffset","setPipeline","pipeline_","setBindings","bindings_","pushDebugGroup","popDebugGroup","insertDebugMarker","markerLabel","RenderBundle_GL","RenderBundle","commands","replay","UNIFROM_BLOCK_REGEXP","Device_GL","configuration","shaderDebug","OES_texture_float","OES_draw_buffers_indexed","WEBGL_draw_buffers","WEBGL_color_buffer_float","EXT_color_buffer_half_float","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","EXT_texture_compression_rgtc","KHR_parallel_shader_compile","EXT_texture_norm16","EXT_color_buffer_float","OES_texture_float_linear","OES_texture_half_float_linear","scTexture","scPlatformFramebuffer","currentActiveTexture","currentBoundVAO","currentProgram","resourceCreationTracker","resourceUniqueId","currentColorAttachments","currentColorAttachmentLevels","currentColorResolveTos","currentColorResolveToLevels","currentSampleCount","currentIndexBufferByteOffset","currentMegaState","currentSamplers","currentTextures","currentUniformBuffers","currentUniformBufferByteOffsets","currentUniformBufferByteSizes","currentScissorEnabled","currentStencilRef","currentRenderPassDescriptor","currentRenderPassDescriptorStack","debugGroupStack","resolveColorAttachmentsChanged","resolveDepthStencilAttachmentsChanged","LOWER_LEFT","NEGATIVE_ONE","supportMRT","inBlitRenderPass","supportedSampleCounts","occlusionQueriesRecommended","computeShadersSupported","contextAttributes","getContextAttributes","getExtension","platformString","getNextUniqueId","alpha","U8_RGB_RT","U8_RGBA_RT","resolveColorReadFramebuffer","createFramebuffer","resolveColorDrawFramebuffer","resolveDepthStencilReadFramebuffer","resolveDepthStencilDrawFramebuffer","renderPassDrawFramebuffer","readbackFramebuffer","fallbackTexture2D","createFallbackTexture","fallbackTexture2DDepth","fallbackVertexBuffer","fallbackTexture2DArray","fallbackTexture3D","fallbackTextureCube","LESS","enable","DEPTH_TEST","STENCIL_TEST","checkLimits","trackResources","blitBindings","blitInputLayout","blitRenderPipeline","blitVertexBuffer","blitProgram","U8_RGBA_NORM","maxVertexAttribs","getParameter","MAX_VERTEX_ATTRIBS","MAX_UNIFORM_BLOCK_SIZE","uniformBufferWordAlignment","UNIFORM_BUFFER_OFFSET_ALIGNMENT","getInternalformatParameter","DEPTH32F_STENCIL8","SAMPLES","uniformBufferMaxPageWordSize","includes","sort","configureSwapChain","platformFramebuffer","getDevice","getCanvas","canvas","getOnscreenTexture","beginFrame","endFrame","isRenderbufferStorage","ALPHA","U8_LUMINANCE","F16_LUMINANCE","F32_LUMINANCE","LUMINANCE","F16_R","R16F","F16_RG","RG16F","F16_RGB","RGB16F","F16_RGBA","RGBA16F","F32_R","R32F","F32_RG","RG32F","F32_RGB","RGB32F","F32_RGBA","RGBA32F","RGBA32F_EXT","U8_R_NORM","R8","U8_RG_NORM","RG8","U8_RGB_NORM","RGB8","U8_RGB_SRGB","SRGB8","RGBA8","RGBA4","U8_RGBA","U8_RGBA_SRGB","U8_RGBA_RT_SRGB","SRGB8_ALPHA8","R16UI","U16_R_NORM","R16_EXT","U16_RG_NORM","RG16_EXT","U16_RGBA_NORM","RGBA16_EXT","U16_RGBA_5551","RGB5_A1","U16_RGB_565","RGB565","R32UI","S8_RGBA_NORM","RGBA8_SNORM","S8_RG_NORM","RG8_SNORM","COMPRESSED_RGBA_S3TC_DXT1_EXT","BC1_SRGB","COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","BC2_SRGB","COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","BC3_SRGB","COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT","COMPRESSED_RED_RGTC1_EXT","COMPRESSED_SIGNED_RED_RGTC1_EXT","COMPRESSED_RED_GREEN_RGTC2_EXT","COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT","D32F_S8","DEPTH_STENCIL","DEPTH_COMPONENT16","DEPTH24_STENCIL8","DEPTH_COMPONENT32F","DEPTH_COMPONENT24","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","FLOAT_32_UNSIGNED_INT_24_8_REV","supportDepthTexture","isInteger","RED_INTEGER","RED","RG_INTEGER","RGB_INTEGER","activeTexture","bindVAO","programCompiled","NeedsBind","checkProgramCompilationForErrors","resource","getError","createRenderTarget","createRenderTargetFromTexture","queryVendorInfo","createProgramSimple","createBindings","createInputLayout","createRenderPipeline","createComputePass","createComputePipeline","createReadback","createQueryPool","formatRenderPassDescriptor","colorAttachment","depthClearValue","stencilClearValue","colorAttachmentLevel","colorResolveToLevel","colorClearColor","colorStore","createRenderBundle","beginBundle","bundle","renderBundle","endBundle","executeBundles","renderBundles","createRenderPass","colorResolveTo","depthStencilAttachment","depthStencilResolveTo","skipBlit","setRenderPassParametersBegin","setRenderPassParametersColor","setRenderPassParametersDepthStencil","validateCurrentAttachments","clearColor","setRenderPassParametersClearColor","setRenderPassParametersClearDepthStencil","submitPass","pass","endPass","copySubTexture2D","dst_","dstX","dstY","src_","srcX","srcY","DRAW_FRAMEBUFFER","bindFramebufferAttachment","blitFramebuffer","COLOR_BUFFER_BIT","rt","submitBlitRenderPass","queryLimits","queryTextureFormatSupported","queryProgramReady","complete","COMPLETION_STATUS_KHR","ReadyToUse","queryPlatformAvailable","isContextLost","queryRenderPass","queryRenderTarget","setResourceName","programPatched","getBufferData","wordOffset","COPY_READ_BUFFER","debugGroupStatisticsDrawCall","drawCallCount","debugGroupStatisticsBufferUpload","bufferUploadCount","debugGroupStatisticsTextureBind","textureBindCount","debugGroupStatisticsTriangles","triangleCount","reportShaderError","status","getShaderParameter","COMPILE_STATUS","lineStart","spaces","ch","leftPad","prependLineNo","debug_shaders","getTranslatedShaderSource","getShaderInfoLog","LINK_STATUS","getProgramInfoLog","framebuffer","attachment","framebufferRenderbuffer","bindFramebufferDepthStencilAttachment","depth","stencil","DEPTH_STENCIL_ATTACHMENT","DEPTH_ATTACHMENT","STENCIL_ATTACHMENT","currentDepthStencilAttachment","numColorAttachments","toScreen","drawBuffers","COLOR_ATTACHMENT1","COLOR_ATTACHMENT2","COLOR_ATTACHMENT3","drawBuffersWEBGL","COLOR_ATTACHMENT0_WEBGL","COLOR_ATTACHMENT1_WEBGL","COLOR_ATTACHMENT2_WEBGL","COLOR_ATTACHMENT3_WEBGL","attachmentLevel","resolveToLevel","gl2","currentDepthStencilResolveTo","slot","colorMaskiOES","colorMask","setScissorRectEnabled","clearBufferfv","COLOR","clear","depthMask","DEPTH","clearDepth","DEPTH_BUFFER_BIT","stencilMask","clearBufferiv","STENCIL","clearStencil","STENCIL_BUFFER_BIT","bindingLayoutTable","platformBufferByteOffset","platformBuffer","bindBufferRange","samplerIndex","bindSampler","samplerEntry","getFallbackTexture","setViewport","viewport","setScissorRect","scissor","applyAttachmentStateIndexed","currentAttachmentState","newAttachmentState","dbi","GREEN","BLUE","blendModeChanged","blendFuncChanged","enableiOES","BLEND","disableiOES","blendEquationSeparateiOES","blendFuncSeparateiOES","applyAttachmentState","disable","blendEquationSeparate","blendFuncSeparate","setMegaState","newMegaState","blendColor","depthFunc","shouldApplyStencil","stencilOpSeparate","FRONT","setStencilReference","BACK","applyStencil","CULL_FACE","cullFace","FRONT_AND_BACK","POLYGON_OFFSET_FILL","validatePipelineFormats","pipeline","currentPipeline","prog","deviceProgram","uniformBlocks","blockIdx","getUniformBlockIndex","uniformBlockBinding","samplers","samplerUniformLocation","setVertexInput","inputLayout_","vertexBuffers","indexBuffer","vertexBuffer","draw","vertexCount","instanceCount","firstVertex","firstInstance","params","drawArraysInstanced","drawArraysInstancedANGLE","drawArrays","drawIndexed","indexCount","firstIndex","baseVertex","drawElementsInstanced","drawElementsInstancedANGLE","drawElements","drawIndirect","drawIndexedIndirect","beginOcclusionQuery","queryIndex","queryPool","occlusionQueryPool","beginQuery","endOcclusionQuery","endQuery","pipelineQueryReady","pipelineForceReady","didUnbindDraw","colorResolveFrom","didBindRead","depthStencilResolveFrom","depthStencilStore","invalidateFramebuffer","SCISSOR_TEST","stencilFuncSeparate","resolveFrom","resolveTo","COPY_DST","u_Texture","blitRenderPass","WebGLDeviceContribution","pluginOptions","createSwapChain","$canvas","targets","options","antialias","preserveDrawingBuffer","premultipliedAlpha","xrCompatible","handleContextEvents","getContext","onContextLost","onContextRestored","onContextCreationError","addEventListener","cachedTextDecoder","TextDecoder","ignoreBOM","fatal","decode","heap","TextEncoder","GPUTextureUsage$1","GPUMapMode","translateTextureViewDimension","translateAddressMode","translateMinMagFilter","texFilter","translateMipFilter","getPlatformBuffer","gpuBuffer","translateQueryPoolType","translateCompareFunction","NEVER","EQUAL","GREATER","NOTEQUAL","GEQUAL","translateVertexStepMode","translateVertexFormat","U8_RG","U8_RGB","S8_RGB_NORM","S16_RG_NORM","S16_RGBA_NORM","S16_RG","allocateAndCopyTypedBuffer","sizeOrDstBuffer","sizeInBytes","copyBuffer","S8_R","S8_R_NORM","buffer_1","ArrayBuffer","Int8Array","buffer_2","S16_R","S16_RGB_NORM","S16_RGBA","buffer_3","Int16Array","U16_RGB","buffer_4","Uint16Array","S32_R","buffer_5","U32_RG","buffer_6","buffer_7","getBlockInformationFromFormat","GPUTextureUsage","ResourceBase_WebGPU","Bindings_WebGPU","gpuBindGroupEntries","numBindings","gpuBufferBinding","textureBinding","gpuTextureView","samplerBinding","gpuSampler","lastGroupIndex","findLastIndex","group","gpuBindGroup","createBindGroup","getBindGroupLayout","entries","Buffer_WebGPU","useMapRead","MAP_READ","usage_","GPUBufferUsage","STORAGE","COPY_SRC","INDIRECT","translateBufferUsage","mapBuffer","view","mappedAtCreation","getMappedRange","unmap","chunkStart","chunkEnd","alignedLength","tempView","maxChunk","queue","writeBuffer","ComputePipeline_WebGPU","gpuComputePipeline","computeStage","compute","InputLayout_WebGPU","buffers","indexFormat","translateIndexFormat","Program_WebGPU","vertexStage","fragmentStage","createShaderStage","shaderStage","entryPoint","code","wgsl","depthTextureName","sub","createShaderModule","QueryPool_WebGPU","querySet","createQuerySet","resolveBuffer","QUERY_RESOLVE","cpuBuffer","BigInt","Readback_WebGPU","blockInformation","bytesPerRow","bytesPerRowAligned","commandEncoder","gpuTextureformat","ceil","createCommandEncoder","copyTextureToBuffer","gpuTexture","mipLevel","origin","submit","finish","dstArrayBufferView","_size","noDataConversion","floatFormat","BYTES_PER_ELEMENT","gpuReadBuffer","copyBufferToBuffer","mapAsync","READ","copyArrayBuffer","getHalfFloatAsFloatRGBAArrayBuffer","ctor","data2","offset2","reason","dataLength","arrayBuffer","destArray","srcData","pow","NaN","RenderPipeline_WebGPU","isCreatingAsync","gpuRenderPipeline","Sampler_WebGPU","Texture_WebGPU","skipCreate","flipY","createTextureShared","textureFromImageBitmapOrCanvas","sources","textureDescriptor","TEXTURE_BINDING","RENDER_ATTACHMENT","copyExternalImageToTexture","isImageBitmapOrCanvases","datas","ImageBitmap","HTMLCanvasElement","OffscreenCanvas","isVideo","HTMLVideoElement","importExternalTexture","bytesPerRow_1","writeTexture","createView","RenderBundle_WebGPU","renderBundleEncoder","createRenderBundleEncoder","colorFormats","earcut","holeIndices","dim","minX","minY","maxX","maxY","invSize","hasHoles","outerLen","outerNode","linkedList","triangles","prev","list","steiner","getLeftmost","compareX","filterPoints","eliminateHole","eliminateHoles","earcutLinked","start","end","clockwise","last","signedArea","insertNode","equals","removeNode","again","area","ear","zOrder","prevZ","nextZ","tail","numMerges","pSize","qSize","inSize","sortLinked","indexCurve","stop","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","maxTX","maxTY","minZ","maxZ","intersects","locallyInside","isValidDiagonal","splitPolygon","hole","bridge","qx","mx","my","tanMin","sectorContainsSector","findHoleBridge","bridgeReverse","filteredBridge","leftmost","px","py","intersectsPolygon","inside","middleInside","p1","p2","q1","q2","o1","sign","o2","o3","o4","onSegment","num","Node","an","bp","sum","earcutModule","earcut$2","default","deviation","polygonArea","trianglesArea","flatten","vertices","holes","dimensions","holeIndex","distance","dx","dy","pointAt$3","cubicAt","p0","p3","onet","cubicLength","x3","y3","x4","y4","iterationCount","xArr","yArr","totalLength","snapLength","cubics","xt","yt","c3","c12","c23","divideCubic","quadraticAt","quadraticLength","quadratics","controlPoint1","controlPoint2","divideQuadratic","Renderable3D","drawcalls","tag","LightPool","lights","addLight","light","sortLights","removeLight","splice","addFog","fog","removeFog","getFog","getAllLights","USE_LIGHT","define","order","Mesh","style","Shape","MESH","lineWidth","cullable","geometry","meshes","material","DisplayObject","MeshUpdater","parsedStyle","aabb","computeBoundingBox","cz","hwidth","halfExtents","hheight","hdepth","PickingIdGenerator","counter","id2DisplayObjectMap","getId","displayObject","getById","deleteById","reset","decodePickingColor","color","encodePickingColor","featureIdx","DeviceProgram","preprocessedVert","preprocessedFrag","both","frag","definesChanged","setDefineString","setDefineBool","getDefineString","getDefineBool","DynamicUniformBuffer","currentBufferWordSize","currentWordOffset","shadowBufferF32","shadowBufferU8","limits","isSupportedUBO","findPageIndex","allocateChunk","wordCount","ensureShadowBuffer","newWordCount","newBuffer","mapBufferF32","prepareToRender","hashCodeNumberUpdate","hash","hashCodeNumberFinish","nullHashFunc","HashBucket","HashMap","keyEqualFunc","keyHashFunc","buckets","findBucketIndex","bucket","findBucket","bi","acc","preprocessProgramObj_GLSL","obj","preprocessProgram_GLSL","programDescriptorSimpleEquals","blendStateHash","attachmentStateHash","megaStateDescriptorHash","_h","colorHash","renderPipelineDescriptorHash","bindingsDescriptorHash","ToneMapping","RGAttachmentSlot","RenderCache","bindingsCache","renderPipelinesCache","inputLayoutsCache","programCache","samplerCache","bindings","descriptorCopy","renderPipeline","preprocessedVert_1","preprocessedFrag_1","e_3","e_4","e_5","_j","_k","_l","e_3_1","_m","_o","e_4_1","_p","_q","e_5_1","RendererLayer","RenderGraphPass","renderTargetIDs","renderTargetLevels","resolveTextureOutputIDs","resolveTextureOutputExternalTextures","resolveTextureOutputExternalTextureLevel","resolveTextureInputIDs","renderTargetExtraRefs","resolveTextureInputTextures","renderTargets","viewportX","viewportY","viewportW","viewportH","execFunc","postFunc","debugThumbnails","setDebugName","debugName","pushDebugThumbnail","attachmentSlot","attachRenderTargetID","renderTargetID","attachResolveTexture","resolveTextureID","attachOcclusionQueryPool","func","post","addExtraRef","RGRenderTarget","desc","needsClear","age","matchesDescription","SingleSampledTexture","GraphImpl","renderTargetDescriptions","resolveTextureRenderTargetIDs","passes","renderTargetDebugNames","RenderGraph","currentPass","renderTargetDeadPool","singleSampledTextureDeadPool","currentGraph","renderTargetOutputCount","renderTargetResolveCount","resolveTextureUseCount","renderTargetAliveForID","singleSampledTextureForResolveTextureID","acquireRenderTargetForDescription","freeRenderTarget","acquireSingleSampledTextureForDescription","freeSingleSampledTexture","beginGraphBuilder","pushPass","setupFunc","createRenderTargetID","createResolveTextureID","findMostRecentPassThatAttachedRenderTarget","resolveRenderTargetPassAttachmentSlot","renderPass","findPassForResolveRenderTarget","resolveRenderTarget","resolveRenderTargetToExternalTexture","getRenderTargetDescription","scheduleAddUseCount","graph","acquireRenderTargetForID","newRenderTarget","releaseRenderTargetForID","forOutput","renderTarget","acquireResolveTextureInputTextureForID","singleSampledTexture","determineResolveParam","resolveTextureOutputID","externalTexture","hasResolveTextureOutputID","hasExternalTexture","store","schedulePass","depthStencilRenderTargetID","DepthStencil","Color0","ColorMax","colorRenderTargetID","colorRenderTarget","store_1","depthStencilRenderTarget","rtWidth","rtHeight","rtSampleCount","scheduleGraph","execPass","execGraph","execute","getDebug","getPasses","getPassDebugThumbnails","getPassRenderTargetID","getRenderTargetIDDebugName","getResolveTextureForID","currentGraphPass","getRenderTargetAttachment","getRenderTargetTexture","newGraphBuilder","MAX_DEPTH","DEPTH_BITS","makeDepthKey","flipDepth","maxDepth","normalizedDepth","setSortKeyLayer","sortKey","layer","setSortKeyProgramKey","programKey","makeSortKeyOpaque","setSortKeyOpaqueDepth","depthKey","makeSortKeyTranslucent","setSortKeyTranslucentDepth","mtxOpenGLFromD3D","mat4.fromValues","RenderInstFlags","mtxD3DFromOpenGL","fillVec4","offs","v0","v1","v2","v3","RenderInstExecutionOrder","RenderInst","debug","bindingDescriptors","bindingLayout","dynamicUniformBufferByteOffsets","drawStart","drawCount","drawInstanceCount","renderPipelineDescriptor","AllowSkippingIfPipelineNotReady","setFromTemplate","uniformBuffer","InheritedFlags","tbd","obd","setBindingLayout","setSamplerBindingsFromTextureMappings","validate","bd","setProgram","getMegaStateFlags","drawIndexes","indexStart","Indexed","drawIndexesInstanced","drawPrimitives","primitiveCount","primitiveStart","setUniforms","bufferIndex","uboBuffer","array","emptySpace_1","emptySpace","allocateUniformBuffer","mapUniformBufferF32","setUniformBuffer","getUniformBufferOffset","getUniformBuffer","mappings","setAllowSkippingIfPipelineNotReady","setAttachmentFormatsFromRenderPass","passRenderer","passDescriptor","colorAttachmentDescriptor","depthStencilAttachmentDescriptor","drawOnPass","gfxPipeline","uniformsMap","gfxBindings","renderInstCompareSortKey","RenderInstList","executionOrder","Forwards","renderInsts","usePostSort","checkUsePostSort","insertSorted","renderInst","idx","lo","hi","mid","bisectRight","submitRenderInst","Draw","ensureSorted","drawOnPassRendererNoReset","drawOnPassRenderer","RenderInstPool","pool","allocCount","allocRenderInstIndex","popRenderInst","RenderInstManager","renderCache","instPool","templatePool","simpleRenderInstList","currentRenderInstList","newRenderInst","templateIndex","renderInstIndex","setCurrentRenderInstList","pushTemplateRenderInst","newTemplateIndex","newTemplate","Template","popTemplateRenderInst","getTemplateRenderInst","resetRenderInsts","disableSimpleMode","RenderHelper","parameters","setDevice","renderGraph","renderInstManager","template","getCache","USE_TONEMAPPING","toneMapping","RGRenderTargetDescription","setDimensions","copyDimensions","makeAttachmentClearDescriptor","AntialiasingMode","standardFullClearRenderPassDescriptor","opaqueBlackFullClearRenderPassDescriptor","opaqueWhiteFullClearRenderPassDescriptor","setBackbufferDescSimple","renderInput","antialiasingMode","MSAAx4","selectSampleCount","backbufferWidth","backbufferHeight","makeBackbufferDescSimple","clearDescriptor","pixelFormat","selectFormatSimple","FogType","TextureMapping","lodBias","TemporalTexture","inputTexture","outputTexture","setDescription","getTextureForSampling","getTextureForResolving","Light","intensity","GeometryEvent","Fog","density","makeDataBuffer","BufferGeometry","props","inputLayoutDescriptor","instancedCount","dirty","mesh","build","AABB","setIndexBuffer","indices","isView","setVertexBuffer","byteStride","bufferByteOffset","existed","getVertexBuffer","updateVertexBuffer","bufferDescriptor","CHANGED","updateIndices","FXAAProgram","features","textureMapping","pushFXAAPass","builder","renderHelper","mainColorTargetID","mainColorResolveTextureID","fxaaProgram","scope","SceneUniform","MaterialEvent","RenderGraphPlugin","lightPool","texturePool","batchManager","renderLists","leftEye","rightEye","picking","cameras","getSwapChain","swapChain","getRenderLists","renderingService","config","renderingContext","root","ownerDocument","defaultView","disableRenderHooks","handleMounted","object","nodeName","renderable3D","handleUnmounted","remove","handleAttributeChanged","attrName","newValue","parentNode","child","changeRenderOrder","sortable","renderOrder","updateAttribute","handleBoundsChanged","hooks","initAsync","tapPromise","ElementEvent","MOUNTED","UNMOUNTED","ATTR_MODIFIED","BOUNDS_CHANGED","renderer","getConfig","enableDirtyRectangleRendering","contextService","getDomElement","resize","deviceContribution","CanvasEvent","RESIZE","attach","tap","removeEventListener","frame","session","layer_1","renderState","baseLayer","layers","framebufferWidth","framebufferHeight","pose","getViewerPose","referenceSpace","views","getViewport","cameraMatrix","mat4","transform","matrix","projectionMatrix","viewMatrix","mat4.invert","mat4.create","mat4.scale","vec3.fromValues","position","cameraPosition","isOrtho","camera","getPerspective","getViewTransform","getPosition","background","backgroundColor","parseColor","mainRenderDesc","mainDepthDesc","mainDepthTargetID","enableFXAA","normalizedW","normalizedH","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","PROJECTION_MATRIX","VIEW_MATRIX","CAMERA_POSITION","DEVICE_PIXEL_RATIO","getDPR","VIEWPORT","IS_ORTHO","IS_PICKING","render","enableCapture","resolveCapturePromise","captureOptions","encoderOptions","dataURL","toDataURL","loadTexture","successCallback","getOrCreateTexture","capturePromise","PickingPlugin","renderGraphPlugin","pickingIdGenerator","pickingId","encodedPickingColor","init","pickSync","pick","topmost","dpr","xInDevicePixel","yInDevicePixel","picked","pickedDisplayObjects","pickByRectangleInDepth","Rectangle","round","rect","pickByRectangle","restorePickingColor","displayObjects","mainPickingDesc","pickingColorTargetID","currentView","getView","pickedColors","readback","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","clearViewOffset","setEnableUpdate","pickedFeatureIdx","pickedDisplayObject","isVisible","isInteractive","canvasWidth","canvasHeight","RENDER_ORDER_SCALE","Batch","clipPathMeshCreated","beforeUploadUBO","beforeInitMesh","afterInitMesh","Material","textures","programDirty","textureDirty","geometryDirty","depthTest","dithering","wireframe","wireframeColor","wireframeLineWidth","vertexShader","fragmentShader","compile","defineProperty","enumerable","configurable","blendEquation","blendEquationAlpha","blendSrc","blendDst","blendSrcAlpha","blendDstAlpha","stencilRef","dispatchMutationEvent","USE_WIREFRAME","uniformNames","structs","uniformStr","struct","getUniforms","shoudDispatchMutationEvent","existedTexture","LOADED","ShaderMaterial","USE_UV","USE_MAP","USE_FOG","enumToObject","enumObject","compareDefines","d1","d2","d1Keys","every","definedProps","fromEntries","packUint8ToFloat","floor","VertexAttributeBufferIndex","VertexAttributeLocation","FILL_TEXTURE_MAPPING","SDFVertexAttributeBufferIndex","SDFVertexAttributeLocation","Instanced","drawcallCtors","gradientAttributeName","objects","materialDirty","textureMappings","mergeXYZIntoModelMatrix","checkNodeName","maxInstances","inited","observeGeometryChanged","observeMaterialChanged","renderable","dirtify","shouldMergeColor","isCSSRGB","isPattern","image","shouldMerge","instance","clipPath","createGeometry","modelMatrix","modelViewMatrix","packedModelMatrix","packedFillStroke","packedStyle","packedPicking","anchorOffset","CIRCLE","ELLIPSE","stroke","opacity","fillOpacity","strokeOpacity","visibility","increasedLineWidthForHitTesting","fillColor","strokeColor","mat4.mul","getWorldTransform","mat4.fromTranslation","mat4.copy","MODEL_MATRIX","MODEL_MATRIX0","MODEL_MATRIX1","MODEL_MATRIX2","MODEL_MATRIX3","PACKED_COLOR","PACKED_STYLE","PACKED_STYLE1","PACKED_STYLE2","PICKING_COLOR","applyRenderInst","useFog","clipPathTarget","REPLACE","createMaterial","oldDefines","fillTextureMapping","createFillGradientTextureMapping","mapping","generateWireframe","useIndexes","uploadUBO","OPAQUE","updateBatchedAttribute","startIndex","packedFillStroke_1","findIndex","packed_1","anchorOffset_1","packed_2","modelMatrix_1","packed_3","indiceNum","originalVertexBuffers","cursor","uniqueIndices","barycentricBuffer","BARYCENTRIC","useLight","uploadFog","uploadMaterial","counter_1","materialMegaState","currentAttachmentsState","materialUniforms","texImageSource","getOrCreateGradient","gradients","getOrCreatePattern","getOrCreateCanvas","fillMapping","SDF_Shape","RECT","SDFDrawcall","instanced","positions","circle","radius","omitStroke","shouldOmitStroke","getSize","isBillboard","isSizeAttenuation","UV","EXTRUDE","POSITION","SIZE","PACKED_STYLE3","parsed","tagName","lineDash","hasStroke","isNone","hasLineDash","item","SEGMENT_LENGTH","MIN_SEGMENT_NUM","MAX_SEGMENT_NUM","quadCurveTo","cpX","cpY","toX","toY","points","segmentNum","fromX","fromY","xa","ya","bezierCurveTo","cpX2","cpY2","dt","dt2","dt3","t2","t3","LineVertexAttributeBufferIndex","LineVertexAttributeLocation","INF","TinySDF","runtime","fontSize","cutoff","fontFamily","fontWeight","fontStyle","$offscreenCanvas","offscreenCanvasCreator","ctx","getOrCreateContext","willReadFrequently","font","textBaseline","textAlign","fillStyle","gridOuter","Float64Array","gridInner","char","measureText","glyphAdvance","actualBoundingBoxDescent","actualBoundingBoxLeft","actualBoundingBoxRight","glyphTop","actualBoundingBoxAscent","glyphWidth","glyphHeight","Uint8ClampedArray","glyph","glyphLeft","clearRect","fillText","imgData","getImageData","edt","gridSize","edt1d","grid","stride","qr","packBoolean","is3DPolyline","POLYLINE","polylineControlPoints","JOINT_TYPE","InstancedPathDrawcall","calcSegmentNum","calcSubpathNum","PATH","absolutePath","updateBuffer","calcSubpathIndex","fillDrawcallCount","InstancedFillDrawcall","pointsBuffer","travelBuffer","packedDash","pBuffer","tBuffer","lineDashOffset","PACKED","PREV","POINT1","VERTEX_JOINT","POINT2","NEXT","VERTEX_NUM","TRAVEL","DASH","pointsBuffer_1","travelBuffer_1","instancedCount_1","packedDash_1","stridePoints","strideFloats","needEarcut","subPathIndex","lineCap","lineJoin","zIndex","defX","defY","markerStart","markerEnd","markerStartOffset","markerEndOffset","POLYGON","length_1","startOffsetX_1","startOffsetY_1","endOffsetX_1","endOffsetY_1","isDisplayObject","atan2","isPolyline_1","reduce","cur","addTailSegment","path","parsePath","convertToPath","mat4.identity","absolutePath_1","segments_1","segments","startOffsetX_2","startOffsetY_2","endOffsetX_2","endOffsetY_2","getStartTangent","getEndTangent","startPointIndex_1","mCommandsNum_1","command","nextSegment","useStartOffset","useEndOffset","prePoint","i_1","epsilon","jointType","joint","JOINT_BEVEL","JOINT_ROUND","JOINT_MITER","getJointType","capType","CAP_SQUARE","CAP_ROUND","CAP_BUTT","getCapType","endJoint","JOINT_CAP_ROUND","JOINT_CAP_BUTT","JOINT_CAP_SQUARE","points_1","dist","vec","FillVertexAttributeBufferIndex","FillVertexAttributeLocation","InstancedLineVertexAttributeBufferIndex","InstancedLineVertexAttributeLocation","trianglesHash","compareTrianglesHash","some","uvsBuffer","halfExtents_1","getGeometryBounds","uvBuffer_1","packedStyle_1","billboardRotation","INSTANCED","segmentInstanceGeometry","ImageVertexAttributeBufferIndex","ImageVertexAttributeLocation","LineCap_MAP","butt","square","InstancedLineDrawcall","isLine","subpathIndex","mSegmentCount","mCommandIndex","tangent","interleaved","packedCap","parsedLineStyleProps","LINE","getTotalLength","lineCap_2","isBillboard_2","isSizeAttenuation_2","calcOffset","startOffsetX","startOffsetY","endOffsetX","endOffsetY","calcDash","dashOffset","dashSegmentPercent","dashRatioInEachSegment","POINTA","POINTB","CAP","parsedLineStyle","segmentsLength","ImageDrawcall","u_Map","sizes","createImage","channels","RangeError","copyImage","srcImg","dstImg","srcPt","dstPt","dstData","srcOffset","AlphaImage","newImage","resizeImage","clone","GlyphAtlas","stacks","bins","glyphs","stackPositions","bitmap","bin","metrics","boxes","maxWidth","boxes_1","boxes_1_1","box","boxes_2","boxes_2_1","space","potpack","TextVertexAttributeBufferIndex","TextVertexAttributeLocation","TextUniform","GlyphManager","sdfGeneratorCache","textMetricsCache","glyphMap","glyphAtlasTexture","getMap","getAtlas","glyphAtlas","getAtlasTexture","fontStack","lineHeight","letterSpacing","positionedGlyphs","justify","lineStartIndex","charCode","charCodeAt","advance","generateAtlas","text","newChars","charSet","String","fromCharCode","getDefaultCharacterSet","existedChars","generateSDF","atlasWidth","atlasHeight","sdfGenerator","TextDrawcall","packedBufferObjectMap","WeakMap","tmpMat4","fontHash","calcFontHash","glyphManager","getBounds","fontScale","uvOffsets","packed","indicesOff","enableCSSParsing","linePositionY","buildTextBuffers","indicesOffset","charUVOffsetBuffer","charPositionsBuffer","charPackedBuffer","TEX","OFFSET","allText","offscreenCanvas","SDF_MAP","SDF_MAP_SIZE","FONT_SIZE","GAMMA_SCALE","STROKE_BLUR","HAS_STROKE","vertice","bytes","sliced","vertice_1","bytes_1","glyphQuads","quads","positionedGlyph","glyphPositions","halfAdvance","builtInOffset","BASE_FONT_BUFFER","tl","tr","bl","br","tex","glyphOffset","getGlyphQuads","quad","temp","MeshDrawcall","CircleRenderer","getDrawcallCtors","needDrawStrokeSeparately","hasFill","hasDash","PathRenderer","subpathNum","GroupRenderer","ImageRenderer","TextRenderer","LineRenderer","MeshRenderer","RectRenderer","hasDifferentRadius","stencilRefCounter","BatchManager","rendererFactory","pendingUpdatePatches","stencilRefCache","drawcall","isPicking","updatePendingPatches","renderer_1","drawcallCtor","existedDrawcall","batchKey","deletedDrawcall","attributeName","immediately","objectIdx","patchKey","objectIndices","getStencilRef","entity","updatePatches","lastUpdateBatch","TexturePool","textureCache","image_1","isBrowser","window","Image","onload","onSuccess","globalThis","createImageBitmap","catch","onerror","crossOrigin","imagePool","gradient","fillRect","pattern","callback","repetition","canvasPattern","getImageSync","createPattern","parsedTransformToMat4","parseTransform","setTransform","Plugin","toneMappingExposure","geometryUpdaterFactory","circleRenderer","pathRenderer","IMAGE","TEXT","GROUP","HTML","addRenderingPlugin","getRenderGraphPlugin","plugins","setParameters","AbstractRendererPlugin","TRANSLUCENT","projectionMatrixOpenGLFromD3D","projectionMatrixD3DFromOpenGL","bias","isTranslucent","DOMInteractionPlugin","onPointerMove","ev","pointerMove","onPointerUp","pointerUp","onPointerDown","pointerDown","onPointerOver","pointerOver","onPointerOut","pointerOut","onPointerCancel","pointerCancel","onPointerWheel","pointerWheel","onClick","click","$el","navigator","msPointerEnabled","msContentZooming","msTouchAction","supportsPointerEvents","touchAction","document","addPointerEventListener","addMouseEventListener","supportsTouchEvents","addTouchEventListener","useNativeClickEvent","passive","capture","removePointerEventListener","removeMouseEventListener","removeTouchEventListener","removeAllRenderingPlugins","HTMLRenderingPlugin","displayObjectHTMLElementMap","joinTransformMatrix","nativeHTMLMap","eventService","$camera","createCamera","$el_1","getOrCreateEl","appendChild","documentElement","handleCanvasResize","renderReasons","RenderReason","CAMERA_CHANGED","getOrthoMatrix","doc","$container","cameraId","$existedCamera","querySelector","createElement","offsetLeft","offsetTop","transformOrigin","overflow","pointerEvents","$existedElement","setAttribute","className","innerHTML","computedStyleMap","getAttribute","borderColor","ImagePool","canvasConfig","imageCache","gradientCache","patternCache","getOrCreateImage","img","getOrCreatePatternSync","patternKey","generatePatternKey","needScaleWithDPR","generateGradientKey","steps","GradientType","LinearGradient","computeLinearGradient","createLinearGradient","RadialGradient","computeRadialGradient","createRadialGradient","unit","UnitType","kPercentage","addColorStop","LoadImagePlugin","calculateWithAspectRatio","imageWidth","imageHeight","keepAspectRatio_1","keepAspectRatio","WebGLContextService","deviceRendererPlugin","container","parentElement","getElementById","getBoundingClientRect","removeChild","devicePixelRatio","dpr_1","setDOMSize","applyCursorStyle","ContextRegisterPlugin","rendererPlugin","ContextService","DEFAULT_EVENT","CustomEvent","WebXRController","targetRay","connect","inputSource","dispatchEvent","disconnect","visible","inputPose","visibilityState","getPose","targetRaySpace","setLocalTransform","linearVelocity","hasLinearVelocity","angularVelocity","hasAngularVelocity","getTargetRaySpace","Group","vec3.create","detail","WebXRManager","plugin","controllers","controllerInputSources","onSessionEnd","onSessionEvent","onInputSourcesChange","controllerIndex","controller","removed","added","setSession","makeXRCompatible","glBaseLayer","XRWebGLLayer","framebufferScaleFactor","updateRenderState","requestReferenceSpace","referenceSpaceType","requestAnimationFrame","setReferenceSpaceType","getSession","getReferenceSpace","getOrCreateController","getController","ARButton","createButton","sessionInit","button","disableButton","display","onmouseenter","onmouseleave","onclick","stylizeElement","element","padding","border","borderRadius","outline","xr","isSessionSupported","supported","currentSession","textContent","onSessionEnded","domOverlay","onSessionStarted","overlay","svg","createElementNS","optionalFeatures","requestSession","showStartAR","exception","isSecureContext","href","textDecoration","Renderer","enableSizeAttenuation","DeviceRenderer.Plugin","registerPlugin","ImageLoader.Plugin","DomInteraction.Plugin","HTMLRenderer.Plugin","AbstractRenderer"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13]}